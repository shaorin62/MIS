<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="PACA0030">

<!--  
 *   프로그램명 : 제작 전표처리 화면  
 *   작 성 일 : 2016.10.20
 *   작 성 자 : 오세훈
 *   비   고 :
 *   Copyright (c) 2016 JNF Communication Co.,Ltd All Rights reserved. 
 -->
	
	<!--==================== 매출 조회 ====================-->
	<!-- 미완료  검색 조건 -->
	<sql id="search">
		<isNotEmpty prepend="AND" property="TAXY_MONT" >
			  A.TAXY_MONT = #TAXY_MONT#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="CUST_CODE" >
			  A.CUST_CODE = #CUST_CODE#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="CUST_NAME" >
			  A.CUST_NAME LIKE '%' || #CUST_NAME# || '%'
		</isNotEmpty>
	</sql>
	
	<!-- 완료  검색 조건 -->
	<sql id="search2">
		<isNotEmpty prepend="AND" property="TAXY_MONT" >
			 SUBSTR(A.POST_DATE,0,6) = #TAXY_MONT#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="CUST_CODE" >
			  A.OUTS_CODE = #CUST_CODE#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="CUST_NAME" >
			  B.CUST_NAME  LIKE '%' || #CUST_NAME# || '%'
		</isNotEmpty>
	</sql>
	<!--==================== 매출 조회 ====================-->
	<!--==================== 매입 미완료 조회 ====================-->
	<sql id="search3">
		<isNotEmpty prepend="AND" property="SUJU_DATE" >
			  SUBSTR(A.SUJU_DATE,0,6) = #SUJU_DATE#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="CUST_CODE" >
			  A.OUTS_CODE = #CUST_CODE#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="CUST_NAME" >
			 B.CUST_NAME LIKE '%' || #CUST_NAME# || '%'
		</isNotEmpty>
	</sql>
	<!--==================== 매입 미완료 조회 ====================-->
	<!--==================== 매입 완료 조회 ====================-->
	<sql id="search4">
		<isNotEmpty prepend="AND" property="TAXY_MONT" >
			  SUBSTR(A.POST_DATE,0,6) = #TAXY_MONT#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="CUST_CODE" >
			  A.CUST_CODE = #CUST_CODE#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="CUST_NAME" >
			  B.CUST_NAME  LIKE '%' || #CUST_NAME# || '%'
		</isNotEmpty>
	</sql>
	<!--==================== 매입 완료 조회 ====================-->
	
	<!-- 
	/***********************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2016.10.20
     내      용 : 제작 전표처리 매출전표 미완료 조회
     파라미터   : 
    /*********************************************************************************** 
     -->
	<select id="PACA0030.SEARCH00" parameterClass="hashmap" resultClass="hashmap">
	        <![CDATA[ 
					
						SELECT														/* PACA0030.SEARCH00.제작 전표처리 미완료 조회[전표처리 미완료] */
						'0' CHK														/* 선택 */
						, TO_CHAR(SYSDATE, 'YYYYMMDD') AS POST_DATE		/* 전기일 */
						, A.CUST_CODE											/* 광고주코드 */
						, B.CUST_NAME											/* 광고주명 */
						, A.MEMO_FILD											/* 적요 */
						,CASE A.DTIX_TYPE WHEN '01' THEN 'FA180010'
						WHEN '02' THEN 'FA180010'
						ELSE 'FA180020' END AS DTIX_TYPE				/* 증빙종류 */
						, A.TAXX_GUBN											/* 세금계산서분류 */
						, NVL(A.TAXX_AMTX,0) AS TAXX_AMTX			/* 금액 */
						, NVL(A.TAXX_VATX,0) AS TAXX_VATX				/* 부가세액 */
						, NVL(A.TAXX_AMTX,0) + NVL(A.TAXX_VATX,0) SUMM_AMTX		/* 총액 */
						, '100' FILD_BUSI											/* 사업영역 */
						, E.CSTC_CODE AS COST_CENT                      /* 코스트센터 */
						, A.DEND_DATE											/* 청구일자 */
						, A.DEND_DATE AS MATU_DATE						/* 지급기일 */
						, A.DEND_DATE AS DOCU_DATE						/* 증빙일 */
						, C.SACH_NUMB											/* 전표번호 */
						, C.CUST_ANID 											/* 계좌코드 */
						, CASE NVL(C.DEBT_CODE,' ') WHEN ' ' THEN
						 CASE WHEN NVL(B.CUTY_CODE,' ') = 'TS100010' THEN '1111613' ELSE '1111614' END   
						 ELSE C.DEBT_CODE
						END  AS DEBT_CODE   									/* 차변계정 */
						, CASE NVL(C.ACCT_CODE,' ') WHEN ' ' THEN
						 CASE WHEN NVL(B.CUTY_CODE,' ') = 'TS100010' THEN '5120010' ELSE '5120020' END   
						 ELSE C.ACCT_CODE
						END  AS ACCT_CODE   									/* 대변계정 */
						, A.TAXY_MONT											/* 계산서 년월 */
						, A.TAXX_NUMB											/* 계산서 번호 */
						, 1 AS TRAN_RANK										/* 합산순번 */
						, D.PLAN_DEPT
						, DECODE(B.BIZR_NUMB,NULL,B.RERN_NUMB,B.BIZR_NUMB) AS BIZR_NUMB			/* 사업자(주민) 번호 */
						, CASE WHEN NVL(B.CITY_CODE,' ') = '1' THEN 'A' ELSE 'B' END  AS CITY_CODE   /* 개인일반 구분 */
						, D.JOBN_NAME 																/* 제작명 */	
						, F.CUST_SEQX
						, G.CLAS_SEQX
						, I.JOBN_SEQX															
						FROM PD_SATXXH A 
						LEFT JOIN TA_CUSTXM B ON A.CUST_CODE = B.CUST_CODE
						LEFT JOIN PD_VOCHXM C ON A.TAXY_MONT = C.TAXY_MONT AND A.TAXX_NUMB = C.TAXX_NUMB AND C.GBNX_FLAG = 'P'
						LEFT JOIN PD_JOBNXM D ON SF_GET_TAXJOBNO(A.TAXY_MONT,A.TAXX_NUMB) = D.JOBN_NUMB
						LEFT JOIN TA_CSTCXM E ON D.PLAN_DEPT = E.DEPT_CODE 
						LEFT JOIN PD_SEQXXM F ON A.TAXY_MONT = F.TAXY_MONT AND A.CUST_CODE = F.CUST_CODE
						LEFT JOIN PD_SEQXXM G ON A.TAXY_MONT = G.TAXY_MONT AND A.MEDA_CODE = G.CLAS_CODE
						LEFT JOIN PD_SATXXD H ON A.TAXX_NUMB = H.TAXX_NUMB AND A.TAXY_MONT = H.TAXY_MONT AND H.TAXX_IDXX = '1'
						LEFT JOIN PD_SEQXXM I ON A.TAXY_MONT = I.TAXY_MONT AND H.JOBN_NUMB = I.JOBN_NUMB
						WHERE 1=1
						AND NVL(A.SACH_NUMB,' ') = ' '
						AND NVL(A.INPT_GUBN,0) = 0
			]]>
			     <include refid="search" />	
			<![CDATA[
				 ORDER BY  F.CUST_SEQX, G.CLAS_SEQX, I.JOBN_SEQX ,A.TAXY_MONT, A.TAXX_NUMB
			]]>
	</select>
	
	
	<!-- 
	/***********************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2016.10.20
     내      용 : 제작 전표 저리 완료 조회
     파라미터   : 
    /*********************************************************************************** 
     -->
	<select id="PACA0030.SEARCH01" parameterClass="hashmap" resultClass="hashmap">
	        <![CDATA[ 
					
						SELECT 						/* PACA0030.SEARCH01.제작 전표처리 완료 조회[전표처리 완료] */
						'0' CHK    					/* 선택 */
						, A.SEQX_IDXX              /* 전표순번 */
						, A.POST_DATE              /* 전기일자 */
						, A.CUST_CODE              /* 거래처코드 */
						, B.CUST_NAME              /* 거래처명 */
						, A.MEMO_FILD              /* 적요 */
						, A.TAXX_AMTX              /* 금액 */
						, A.TAXX_VATX              /* 부가세액 */
						, A.TAXX_AMTX + A.TAXX_VATX AS SUMM_AMTX /* 총액 */ 
						, A.FILD_BUSI              /* 사업영역 */
						, A.COST_CENT              /* 코스트센터 */
						, A.DEND_DATE              /* 청구일자 */
						, A.MATU_DATE              /* 지급기일(만기일) */
						, A.DOCU_DATE              /* 증빙일자 */
						, A.SACH_NUMB              /* 매출전표번호 */
						, A.CUST_ANID              /* 거래처계좌코드 */
						, A.DEBT_CODE              /* 차변계정 */
						, A.ACCT_CODE              /* 대변계정 */
						, A.IFXX_GUBN              /* 인터페이스구분 */
						, A.EROR_CODE              /* 에러코드 */
						, A.EROR_MSGE              /* 에러메시지 */
						, A.TAXY_MONT              /* 세금계산서년월 */
						, A.TAXX_NUMB              /* 세금계산서번호 */
						FROM PD_VOCHXM A
						LEFT JOIN TA_CUSTXM B ON A.CUST_CODE = B.CUST_CODE
						WHERE 1=1
						AND A.GBNX_FLAG = 'P'
						AND NVL(EROR_CODE,' ')  = ' '
			]]>
			     <include refid="search2" />	
			<![CDATA[
				 ORDER BY A.SEQX_IDXX, A.TAXY_MONT, A.TAXX_NUMB
			]]>
	</select>
	
	<!-- 
	/***********************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2016.10.20
     내      용 : 제작 매입전표 미완료 조회
     파라미터   : 
    /*********************************************************************************** 
     -->
	<select id="PACA0030.SEARCH02" parameterClass="hashmap" resultClass="hashmap">
	        <![CDATA[ 
					
						SELECT 											/* PACA0030.SEARCH02.제작 매입전표처리 미완료 조회[매입전표 처리 미완료] */
						'0' CHK    										/* 선택 */
						,A.SUJU_DATE	AS POST_DATE			/* 전기일자 */
						,A.OUTS_CODE AS CUST_CODE			/* 거래처코드 */
						,B.CUST_NAME									/* 거래처명 */
						,D.JOBN_NUMB                                /* 제작번호 */
						,D.JOBN_NAME									/* 제작명 */
						,D.JOBN_NAME AS MEMO_FILD   /* 적요 */
						,'FA180090' AS EVID_DOCU									/* 증빙방법 */
						,NVL(A.SUJU_AMTX,0) AS TAXX_AMTX			/* 금액 */
						,TRUNC(NVL(A.SUJU_AMTX,0)*0.1) AS TAXX_VATX	/* 부가세액 */
						,'100' FILD_BUSI											/* 사업영역 */
						, DECODE(NVL(G.CSTC_CODE,''),NULL,'CC7010041',G.CSTC_CODE) AS COST_CENT /* 코스트센터*/
						, A.SUJU_DATE AS DEND_DATE					/* 청구일자 */
						, A.SUJU_DATE AS MATU_DATE					/* 지급기일 */
						, A.SUJU_DATE AS DOCU_DATE					/* 증빙일자 */
						, NULL AS PUCH_NUMB										/* 전표번호 */
						, NULL AS CUST_ANID											/* 계좌코드 */
						, CASE F.AGCY_YSNO WHEN 'Y' THEN '5339100'
						  ELSE CASE WHEN D.MEDA_CODE = 'C' THEN '5343100' 
						  WHEN D.MEDA_CODE = 'G' THEN '5343200'
						  ELSE '5343400' END END AS DEBT_CODE /* 차변계정 */
						, CASE WHEN NVL(B.CUTY_CODE,' ') = 'TS100010' THEN '3111110' 
						  ELSE '3111120' END AS ACCT_CODE                  /* 대변계정 */
						, NULL AS EROR_CODE										/* 에러코드 */
						, NULL AS EROR_MSGE										/* 에러메시지 */
						, A.PREE_CODE   										/* 견적번호 */
						, A.PREE_IDXX 										/* 정산ID */
						, A.PREE_CODE AS TAXY_MONT                  /* 전표 세금계산서 년월 */
						, A.PREE_IDXX AS TAXX_NUMB                   /* 전표 세금계산서 번호 */
						, F.AGCY_YSNO										/* 에이전시 구분 */
						, B.CITY_CODE											/* 개인사업자 구분 */
						, DENSE_RANK() OVER(ORDER BY A.OUTS_CODE) AS TRAN_RANK	/* 제작사별 합산 */
						, 1 AS TRAN_RANK2		/* 집합전표 기준 */
						, DENSE_RANK() OVER(ORDER BY A.OUTS_CODE, CASE F.AGCY_YSNO WHEN 'Y' THEN '5339100' ELSE CASE WHEN D.MEDA_CODE = 'C' THEN '5343100' 
						  WHEN D.MEDA_CODE = 'G' THEN '5343200'
						  ELSE '5343400' END END) AS TRAN_RANK3	/* 합산계정별 합산 생성 */
						, DECODE(NVL(G.CSTC_CODE,''),NULL,'000000',D.PLAN_DEPT) AS PLAN_DEPT
						, D.PLAN_DEPT AS DEPT_CODE
						, DECODE(B.BIZR_NUMB,NULL,B.RERN_NUMB,B.BIZR_NUMB) AS BIZR_NUMB			/* 사업자(주민) 번호 */
						, CASE WHEN NVL(B.CITY_CODE,' ') = '1' THEN 'A' ELSE 'B' END  AS CITY_CODE2   /* 개인일반 구분 */
						, NVL(A.SUJU_AMTX,0) - (ROUND(NVL(A.SUJU_AMTX,0) * 0.03) + ROUND((NVL(A.SUJU_AMTX,0) * 0.03)* 0.1)) AS ACCT_AMTX 		/* 개인 모델료 대변금액 */
						, ROUND(NVL(A.SUJU_AMTX,0) * 0.03) AS YESU_AMTX    /* 예수금(자유직업소득세) */
						, ROUND((NVL(A.SUJU_AMTX,0) * 0.03)* 0.1) AS YESU_AMTX2  /* 예수금(자유직업주민세) */
						, D.CUST_CODE AS CLIENT_CODE /* 광고주코드 */
						FROM 
						PD_SUJUMD A 
						LEFT JOIN TA_CUSTXM  B ON A.OUTS_CODE = B.CUST_CODE
						LEFT JOIN PD_SUJUMH C ON A.PREE_CODE = C.PREE_CODE AND A.JOBN_NUMB = C.JOBN_NUMB 
						LEFT JOIN PD_JOBNXM D ON A.JOBN_NUMB = D.JOBN_NUMB
						LEFT JOIN PD_CLASXM F ON B.CUST_CODE = F.CUST_CODE
						LEFT JOIN TA_CSTCXM G ON D.PLAN_DEPT  = G.DEPT_CODE AND G.COST_GUBN IN ('21','22')
						LEFT JOIN TM_OFFICE H ON H.ACCT_GUBN = '100' AND H.OFFI_GUBN ='1'
						WHERE 1=1
						AND NVL(B.BIZR_NUMB,' ') <> H.BSNS_NUMB
						AND NVL(A.PUCH_NUMB,' ') = ' '
						AND D.COMP_DATE IS NOT NULL        /* 청구완료일 입력된 사항 만 세금계산서 생성 할 수 있음 */
			]]>
			     <include refid="search3" />	
			<![CDATA[
				 ORDER BY  A.OUTS_CODE, A.SUJU_AMTX desc, CASE F.AGCY_YSNO WHEN 'Y' THEN '5339100' ELSE CASE WHEN D.MEDA_CODE = 'C' THEN '5343100'	WHEN D.MEDA_CODE = 'G' THEN '5343200' ELSE '5343400' END END
			]]>
	</select>
	
	<!-- 
	/***********************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2016.10.21
     내      용 : 제작 매입전표 완료 처리
     파라미터   : 
    /*********************************************************************************** 
     -->
	<select id="PACA0030.SEARCH03" parameterClass="hashmap" resultClass="hashmap">
	        <![CDATA[ 
					
						SELECT 						/* PACA0030.SEARCH03.제작 전표처리 완료 조회[전표처리 완료] */
						'0' CHK    					/* 선택 */
						, A.SEQX_IDXX              /* 전표순번 */
						, A.POST_DATE              /* 전기일자 */
						, A.CUST_CODE              /* 거래처코드 */
						, B.CUST_NAME              /* 거래처명 */
						, D.JOBN_NAME				/* 제작명 */	
						, A.MEMO_FILD              /* 적요 */
						, A.TAXX_AMTX              /* 금액 */
						, A.TAXX_VATX              /* 부가세액 */
						, A.FILD_BUSI              /* 사업영역 */
						, A.COST_CENT              /* 코스트센터 */
						, A.DEND_DATE              /* 청구일자 */
						, A.MATU_DATE              /* 지급기일(만기일) */
						, A.DOCU_DATE              /* 증빙일자 */
						, A.PUCH_NUMB              /* 매입전표번호 */
						, A.CUST_ANID              /* 거래처계좌코드 */
						, A.DEBT_CODE              /* 차변계정 */
						, A.ACCT_CODE              /* 대변계정 */
						, A.IFXX_GUBN              /* 인터페이스구분 */
						, A.EROR_CODE              /* 에러코드 */
						, A.EROR_MSGE              /* 에러메시지 */
						, A.TAXY_MONT              /* 세금계산서년월 */
						, A.TAXX_NUMB              /* 세금계산서번호 */
						FROM PD_VOCHXM A
						LEFT JOIN TA_CUSTXM B ON A.CUST_CODE = B.CUST_CODE
						LEFT JOIN PD_SUJUMD C ON A.TAXY_MONT = C.PREE_CODE AND A.TAXX_NUMB = C.PREE_IDXX
						LEFT JOIN PD_JOBNXM D ON C.JOBN_NUMB = D.JOBN_NUMB
						WHERE 1=1
						AND A.GBNX_FLAG = 'B'
						AND NVL(EROR_CODE, ' ')  = ' '
			]]>
			     <include refid="search4" />	
			<![CDATA[
				 ORDER BY A.SEQX_IDXX, A.TAXY_MONT, A.TAXX_NUMB
			]]>
	</select>
	
	
	
	
<!-- 
/***********************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2016.10.21
     내      용 : 제작 매출 전표 생성 로직
     파라미터   : 
/***********************************************************************************     			 				
     -->
	<insert id="PACA0030.SAVE00" parameterClass="hashmap">
	<![CDATA[

              INSERT INTO PD_VOCHXM (  /* PACA0030.SAVE00.제작 매출전표 저장 [매출전표 로직 저장] */
                SEQX_IDXX        /* 전표순번 */
               ,POST_DATE        /* 전기일자 */
               ,CUST_CODE        /* 거래처코드 */
               ,MEMO_FILD        /* 적요 */
               ,TAXX_AMTX        /* 금액 */
               ,TAXX_VATX        /* 부가세액 */
               ,FILD_BUSI        /* 사업영역 */
               ,COST_CENT        /* 코스트센터 */
               ,DEND_DATE        /* 청구일자 */
               ,MATU_DATE        /* 지급기일(만기일) */
               ,DOCU_DATE        /* 증빙일자 */
               ,SACH_NUMB        /* 전표번호 */
               ,PUCH_NUMB        /* 매입전표번호 */
               ,CUST_ANID        /* 거래처계좌코드 */
               ,DEBT_CODE        /* 차변계정 */
               ,ACCT_CODE        /* 대변계정 */
               ,IFXX_GUBN        /* 인터페이스구분 */
               ,EROR_CODE        /* 에러코드 */
               ,EROR_MSGE        /* 에러메시지 */
               ,TAXY_MONT        /* 세금계산서년월 */
               ,TAXX_NUMB        /* 세금계산서번호 */
               ,GBNX_FLAG        /* 구분 */
               ,REF1_FILD        /* 여분1 */
               ,REF2_FILD        /* 여분2 */
               ,REF3_FILD        /* 여분3 */
               ,REF4_FILD        /* 여분4 */
               ,REF5_FILD        /* 여분5 */
               ,INST_USID        /* 생성자 */
               ,INST_DATE        /* 생성일자 */
               ,UPDT_USID        /* 수정자 */
               ,UPDT_DATE        /* 수정일자 */
              )
       VALUES (
               #SEQX_IDXX#       /* 전표순번 */
              ,#POST_DATE#       /* 전기일자 */
              ,#CUST_CODE#       /* 거래처코드 */
              ,#MEMO_FILD#       /* 적요 */
              ,#TAXX_AMTX#       /* 금액 */
              ,#TAXX_VATX#       /* 부가세액 */
              ,#FILD_BUSI#       /* 사업영역 */
              ,#COST_CENT#       /* 코스트센터 */
              ,#DEND_DATE#       /* 청구일자 */
              ,#MATU_DATE#       /* 지급기일(만기일) */
              ,#DOCU_DATE#       /* 증빙일자 */
              ,#SACH_NUMB#       /* 전표번호 */
              ,#PUCH_NUMB#       /* 전표번호 */
              ,#CUST_ANID#       /* 거래처계좌코드 */
              ,#DEBT_CODE#       /* 차변계정 */
              ,#ACCT_CODE#       /* 대변계정 */
              ,#IFXX_GUBN#       /* 인터페이스구분 */
              ,#EROR_CODE#       /* 에러코드 */
              ,#EROR_MSGE#       /* 에러메시지 */
              ,#TAXY_MONT#       /* 세금계산서년월 */
              ,#TAXX_NUMB#       /* 세금계산서번호 */
              ,#GBNX_FLAG#       /* 구분 */
              ,#REF1_FILD#       /* 여분1 */
              ,#REF2_FILD#       /* 여분2 */
              ,#REF3_FILD#       /* 여분3 */
              ,#REF4_FILD#       /* 여분4 */
              ,#REF5_FILD#       /* 여분5 */
              ,#UPDT_USID#       /* 생성자 */
              ,TO_CHAR(SYSDATE, 'YYYY-MM-DD AM HH:MI:SS')   /* 입력일시 */
		      ,#UPDT_USID#   	 				/* 수정작업자 */
		      ,TO_CHAR(SYSDATE, 'YYYY-MM-DD AM HH:MI:SS')   /* 수정일시 */
              )
	]]>
	</insert>
	
	<!--
/***********************************************************************************  
     작  성  자 : 오세훈
     작  성  일 : 2016.10.21
     수  정  일 : 2016.11.11
     내      용 : 전표 번호 업데이트
     파라미터   : 				
/*********************************************************************************** 
     -->
	<update id="PACA0030.UPDATE00" parameterClass="hashmap">
	<![CDATA[
	  
					DECLARE
					BEGIN
					
						UPDATE PD_VOCHXM 
						SET SACH_NUMB = (
						    SELECT SACH_NUMB FROM PD_SATXXH
						    WHERE 1=1
						    AND TAXY_MONT = #TAXY_MONT#
							AND TAXX_NUMB = #TAXX_NUMB#
						)
						WHERE 1=1
						AND GBNX_FLAG = 'P'
						AND TAXY_MONT = #TAXY_MONT#
						AND TAXX_NUMB = #TAXX_NUMB#
					;
					
			       	END;

	]]>
	</update>
		
<!--
/***********************************************************************************  
     작  성  자 : 오세훈
     작  성  일 : 2016.10.21
     내      용 : 정산 데이터에 전표 번호 업데이트 
     파라미터   : 				
/*********************************************************************************** 
     -->
	<update id="PACA0030.UPDATE01" parameterClass="hashmap">
	<![CDATA[

				DECLARE
				BEGIN

						UPDATE PD_VOCHXM 
						SET PUCH_NUMB = (
						    SELECT PUCH_NUMB FROM PD_SUJUMD
						    WHERE 1=1
						    AND PREE_CODE = #PREE_CODE#
							AND PREE_IDXX = #PREE_IDXX#
						)
						WHERE 1=1
						AND GBNX_FLAG = 'B'
						AND TAXY_MONT = #PREE_CODE#
						AND TAXX_NUMB = #PREE_IDXX#
					;
				END;

	]]>
	</update>
	
	
	<!--
/***********************************************************************************  
     작  성  자 : 오세훈
     작  성  일 : 2017.01.19
     내      용 : 수주데이터에 전표 번호 입력 
     파라미터   : 				
/*********************************************************************************** 
     -->
	<update id="PACA0030.UPDATE02" parameterClass="hashmap">
	<![CDATA[

				DECLARE
				BEGIN
			
						  UPDATE PD_SUJUMD
						  SET PUCH_NUMB = #SLIP_NUMB#
						  WHERE 1=1
						  AND PREE_CODE = #PREE_CODE#
						  AND PREE_IDXX = #PREE_IDXX#
						  ;

				END;				
	]]>
	</update>
	
	
	<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2016. 11. 09
     내      용 : 제작 매출 전표처리 
********************************************************************************/
 -->
	<insert id="PACA0030.PROC00" parameterClass="hashmap" >
		<![CDATA[
		DECLARE
	       /*PACA0030.PROC00.제작 매출 전표처리*/
			CURSOR CUR_PD_SATXXH (
	             P_TAXY_MONT  IN PD_SATXXH.TAXY_MONT%TYPE   /*계산서년월*/
	            ,P_TAXX_NUMB  IN PD_SATXXH.TAXX_NUMB%TYPE   /*계산서번호*/
	        ) IS
	        
	             SELECT
					A.CUST_CODE
					,A.SACH_NUMB
					,'100' AS ACCT_GUBN
					,B.PLAN_DEPT 
					,A.MEMO_FILD
					,B.JOBN_NAME
					,CASE A.TAXX_GUBN WHEN '01' THEN 'FA210010'
					WHEN '02' THEN 'FA210020' ELSE 'FA210010' END AS TAXX_GUBN														
					,CASE A.DTIX_TYPE WHEN '01' THEN 'FA180010'
					WHEN '02' THEN 'FA180010'
					ELSE 'FA180020' END AS DTIX_TYPE
					,NVL(A.TAXX_AMTX,0) AS TAXX_AMTX
					,NVL(A.TAXX_VATX,0) AS TAXX_VATX
					,NVL(A.SUMM_AMTX,0) AS SUMM_AMTX
					,CASE WHEN NVL(C.CUTY_CODE,' ') = 'TS100010' THEN '1111613' ELSE '1111614' END  AS DEBT_CODE   /* 차변계정 */
					,CASE WHEN NVL(C.CUTY_CODE,' ') = 'TS100010' THEN '5120010' ELSE '5120020' END  AS ACCT_CODE   /* 대변계정 */
					,NULL AS CSTC_CODE												/* 코스트센터  현재 필수값이 아니라는 에러 D.CSTC_CODE */
					,DECODE(C.BIZR_NUMB,NULL,C.RERN_NUMB,C.BIZR_NUMB) AS BIZR_NUMB			/* 사업자(주민) 번호 */
					,CASE WHEN NVL(C.CITY_CODE,' ') = '1' THEN 'A' ELSE 'B' END  AS CITY_CODE   /* 개인일반 구분 */
					FROM PD_SATXXH A
					LEFT JOIN PD_JOBNXM B ON SF_GET_TAXJOBNO(A.TAXY_MONT,A.TAXX_NUMB) = B.JOBN_NUMB
					LEFT JOIN TA_CUSTXM C ON B.CUST_CODE = C.CUST_CODE
					LEFT JOIN TA_CSTCXM D ON B.PLAN_DEPT = D.DEPT_CODE 
					LEFT JOIN PD_SEQXXM F ON A.TAXY_MONT = F.TAXY_MONT AND A.CUST_CODE = F.CUST_CODE
					LEFT JOIN PD_SEQXXM G ON A.TAXY_MONT = G.TAXY_MONT AND A.MEDA_CODE = G.CLAS_CODE
					LEFT JOIN PD_SATXXD H ON A.TAXX_NUMB = H.TAXX_NUMB AND A.TAXY_MONT = H.TAXY_MONT AND H.TAXX_IDXX = '1'
					LEFT JOIN PD_SEQXXM I ON A.TAXY_MONT = I.TAXY_MONT AND H.JOBN_NUMB = I.JOBN_NUMB
					WHERE 1=1
					AND A.TAXY_MONT = P_TAXY_MONT
					AND A.TAXX_NUMB = P_TAXX_NUMB
					ORDER BY  F.CUST_SEQX, G.CLAS_SEQX, I.JOBN_SEQX
	        ;
	
	        rPD_SATXXH      CUR_PD_SATXXH%ROWTYPE;          /*[세금계산서 정보]*/
	        sSLIP_DATE      TA_SLIPXM.SLIP_DATE%TYPE;   /*발의일자*/
	        sEMPL_NUMB      TA_SLIPXM.EMPL_NUMB%TYPE;   /*입력자*/
	        sDEPT_CODE      TA_SLIPXM.DEPT_CODE%TYPE;   /*입력부서*/
	        sACCT_GUBN      TA_SLIPXM.ACCT_GUBN%TYPE;   /*사업장*/
	        sTITL_NAME      TA_SLIPXM.TITL_NAME%TYPE;   /*대표적요*/
	        nSLIP_LINE      TA_SLIPNT.SLIP_LINE%TYPE;   /*전표순번*/
	
	        nCURS_SEQN      TA_SLIPNT.SLIP_LINE%TYPE;   /*커서SEQ*/
	        
			sSLIP_NUMB      TA_SLIPXM.SLIP_NUMB%TYPE;   /*전표번호*/
	
	    BEGIN
	
        /*======================================================================================
            STEP 1. 전표 생성 여부 체크
        ======================================================================================*/
	        BEGIN
	            OPEN CUR_PD_SATXXH( #TAXY_MONT#     /*계산서년월*/
	                               ,#TAXX_NUMB#     			  /*계산서번호*/
	                               );
	            FETCH CUR_PD_SATXXH INTO rPD_SATXXH;
	            CLOSE CUR_PD_SATXXH;
	
	        END;
	
	        IF NVL(rPD_SATXXH.SACH_NUMB,' ') != ' ' THEN
	            RAISE_APPLICATION_ERROR(-20000, '이미 생성 된  전표(' || rPD_SATXXH.SACH_NUMB || ')가 존재 합니다.');
	        END IF;
	
        /*======================================================================================
            STEP 2. 전표 생성
        ======================================================================================*/
	
	        /* 전표전기일자*/
	        sSLIP_DATE := #POST_DATE#;
	
	        /* 사용자 정보 조회*/
	        /*
	        BEGIN
	            SELECT U.EMPL_NUMB, U.DEPT_CODE, D.ACCT_GUBN
	              INTO   sEMPL_NUMB, sDEPT_CODE, sACCT_GUBN     
	              FROM   HR_MASTXM U
	              LEFT JOIN VI_DEPTXM D
	                ON  D.DEPT_CODE = U.DEPT_CODE
	             WHERE  USER_IDXX = UPDT_USID;
	
	        END;
	        */
	
	        /* 대표적요 구성 */
	        sTITL_NAME :=  rPD_SATXXH.JOBN_NAME;
	        
			
			 BEGIN
	        
	           	SELECT TO_CHAR(SYSDATE, 'YYYYMMDD')
	           	INTO  sSLIP_DATE
	           	FROM DUAL; 

	         END;
	         
          /* PARAM -----------------------------------------------------
	            2-0. 제작 매출 전표 > SP_MASTER 추가
	      --------------------------------------------------------------*/
	    BEGIN
	        
		PKG_FAMIFSLIP.SP_MASTER_SAVE(#SYST_LNCD#,     	/* ●시스템언어코드*/
									 #UPDT_USID#,      						/* ●수정작업자*/
									 '10',      									/* ●회계단위 */
									 #ACCT_GUBN#,      						/* ●회계구분_사업장 */
									 #POST_DATE#,       					/* ●전표일자(회계일자) */ 
									 #SLIP_GUBN#,      						/* ●전표유형구분 */
									 sTITL_NAME,       						/* ●제목 */
									 #UPDT_USID#,      						/* ●사원번호  */
									 #DEPT_CODE#,	   						/* ●부서코드 */ 						 
									 #SOUS_LNKY#,              				/* ●출처연결키 */
									 NULL,
									 NULL,
									 NULL,
									 NULL,
									 NULL,
									 sSLIP_NUMB);      /* ●전표번호(생성된 전표번호 반환) */
	        END;
	        
	        /*--------------------------------------------------------------
	            2-1.제작 매출 전표 > LINE 추가[차>대>차변 순서대로 SLIP_LINE저장요망]
	        --------------------------------------------------------------*/
	            nSLIP_LINE := 0; 
	            
            /*--------------------------------------------------------------
	            2-1-1. 제작 매출 전표 > LINE 추가 > (차변)
	        --------------------------------------------------------------*/
	        IF rPD_SATXXH.TAXX_AMTX > 0 THEN
	            /*nSLIP_LINE := SLIP_LINE;*/        /*JAVA 에서 받아옴 nSLIP_LINE + 1;*/
	            nSLIP_LINE := nSLIP_LINE + 1;
	
	            BEGIN 
	            
		            PKG_FAMIFSLIP.SP_LINE_SAVE(
	                        #SYST_LNCD#,					/* ●시스템언어코드*/
	                        #UPDT_USID#,					/* ●수정작업자*/
	                        sSLIP_NUMB,						/* ●전표번호 */
	                        lpad(nSLIP_LINE , '4', '0'),		/* ●전표라인번호 */
	                        '10',									/* ●회계단위 */
	                        #ACCT_GUBN#,					/* ●회계구분_사업장 */
	                        rPD_SATXXH.DEBT_CODE,		/* ●계정과목코드 OR 분개코드 */
	                        rPD_SATXXH.PLAN_DEPT,		/* ●사용부서 */
	                        rPD_SATXXH.CSTC_CODE,		/* ◎코스트센터코드 */
	                        'D',									/* ●차대구분 */
	                        'KRW',								/* ●통화구분 */
	                        1,										/* ●환율 */
	                        rPD_SATXXH.SUMM_AMTX,		/* ●외화금액 */
	                        rPD_SATXXH.SUMM_AMTX,		/* ●전표금액 */
	                        '',										/* ◎상대전표번호 */
	                        '',										/* ◎상대전표순번 */
	                        '',										/* ◎예산구분 */
	                        '',										/* ◎프로젝트코드 */
	                        '',										/* ◎예산품의번호 */
	                        '',										/* ◎예산부서코드 */
	                        '',										/* ◎예산년월 */
	                        '',										/* ◎예산과목코드 */
	                        '',										/* ◎예산세목코드 */
	                        sTITL_NAME,						/* ●적요 */
	                        '',										/* ◎증빙종류 */
	                        '',										/* ◎출납처리여부 */
	                        '',										/* ◎지급일 */
	                        '',										/* ◎출납방법 */
	                        '',										/* ◎입출구분 */
	                        '',										/* ◎출력순서 */
	                        lpad(nSLIP_LINE , '4', '0'),		/* ◎정렬순서 */
	                        '',										/* ◎미사용여분인수1 */
	                        '',										/* ◎미사용여분인수2 */
	                        '',										/* ◎미사용여분인수3 */
	                        '',										/* ◎미사용여분인수4 */
	                        '');										
		                      
                END;	     
 	                
 	                
                 /*==================================================================
					 2-1-1 관리항목 저장  
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0002'      								/* ◎관리항목코드1 */
			      		  ,rPD_SATXXH.CUST_CODE      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	       
 	                
	          END IF;
	          
	              
	        /*=============================================================
	            2-1-2. 제작 매출 전표 > LINE 추가 > (대변)
	        ===============================================================*/
	        IF rPD_SATXXH.SUMM_AMTX > 0 THEN		        
	            nSLIP_LINE := nSLIP_LINE + 1;
	            
	                 BEGIN
	
	                 PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,					/* ●시스템언어코드*/
	                                        #UPDT_USID#,					/* ●수정작업자*/
	                                        sSLIP_NUMB,						/* ●전표번호 */
	                                        lpad(nSLIP_LINE , '4', '0'),		/* ●전표라인번호 */
	                                        '10',									/* ●회계단위 */
	                                        #ACCT_GUBN#,	     			/* ●회계구분_사업장 */                                   
	                                        rPD_SATXXH.ACCT_CODE,		/* 계정과목코드 */
	                                        rPD_SATXXH.PLAN_DEPT,		/* 사용부서 */
	                                        rPD_SATXXH.CSTC_CODE,		/* 코스트센터코드 */
	                                        'C',									/* 차대구분 */
	                                        'KRW',								/* 통화구분 */
	                                        1,										/* 환율 */
	                                        rPD_SATXXH.TAXX_AMTX,		/* 외화금액 */
	                                        rPD_SATXXH.TAXX_AMTX,		/* 전표금액 */
	                                        '',										/* 상대전표번호 */
	                                        '',										/* 상대전표순번 */
	                                        '',										/* 예산구분 */
	                                        '',										/* 프로젝트코드 */
	                                        '',										/* 예산품의번호 */
	                                        '',										/* 예산부서코드 */
	                                        '',										/* 예산년월 */
	                                        '',										/* 예산과목코드 */
	                                        '',										/* 예산세목코드 */
	                                        sTITL_NAME,						/* 적요 */
	                                        '',  /*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */
	                                        '',										/* 출납처리여부 */
	                                        '',										 /* ◎입출구분 */
	                                        '',										/* 출납처리여부 */
	                                        '',										/* 지급일 */
	                                        '',										/* ◎출력순서 */		
	                                       lpad(nSLIP_LINE , '4', '0'),		/* 정렬순서 */
	                                        '',
	                                        '',
	                                        '',
	                                        '',
	                                        '');	                
 	                END;

 	                 /*==================================================================
						 2-1-2 관리항목 저장  
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			/* ●시스템언어코드*/
						  ,#UPDT_USID#   		/* ●수정작업자*/
					      ,sSLIP_NUMB      		/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0002'      /* ◎관리항목코드1 */
					      ,rPD_SATXXH.CUST_CODE      		/* ◎관리항목값1 */
					      ,NULL      /* ◎관리항목코드2 */
					      ,NULL      /* ◎관리항목값2 */
					      ,NULL      /* ◎관리항목코드3 */
					      ,NULL      /* ◎관리항목값3 */
					      ,NULL      /* ◎관리항목코드4 */
					      ,NULL      /* ◎관리항목값4 */
					      ,NULL      /* ◎관리항목코드5 */
					      ,NULL      /* ◎관리항목값5 */
					      ,NULL      /* ◎관리항목코드6 */
					      ,NULL      /* ◎관리항목값6 */
					      ,NULL      /* ◎관리항목코드7 */
					      ,NULL      /* ◎관리항목값7 */
					      ,NULL      /* ◎관리항목코드8 */
					      ,NULL      /* ◎관리항목값8 */
					      ,NULL      /* ◎관리항목코드9 */
					      ,NULL      /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	  
	
	       END IF;
	       
         /*=============================================================
            2-1-3. 자산등록 전표 > LINE 추가 > 부가가치세 매출 세액(대변)
        ===============================================================*/
	        IF rPD_SATXXH.TAXX_VATX > 0 THEN
	            nSLIP_LINE := nSLIP_LINE + 1;
	            sTITL_NAME := rPD_SATXXH.JOBN_NAME || 'VAT';
	            
	              BEGIN
	              
	              PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,					/* ●시스템언어코드*/
	                                        #UPDT_USID#,					/* ●수정작업자*/
	                                        sSLIP_NUMB,						/* ●전표번호 */
	                                        lpad(nSLIP_LINE , '4', '0'),		/* ●전표라인번호 */
	                                        '10',					/* ●회계단위 */
	                                        #ACCT_GUBN#,					/* ●회계구분_사업장 */
	                                        '3221100',							/* ●계정과목코드 OR 분개코드 */
	                                        rPD_SATXXH.PLAN_DEPT,	    /* ●부서코드 */
	                                        rPD_SATXXH.CSTC_CODE,		/* 코스트센터코드 */
	                                        'C',									/* ●차대구분 */
	                                        'KRW',								/* ●통화구분 */
	                                        1,										/* ●환율 */
	                                        rPD_SATXXH.TAXX_VATX,		/* ●외화금액 */
	                                        rPD_SATXXH.TAXX_VATX,		/* ●전표금액 */
	                                        '',										/* ◎상대전표번호 */
	                                        '',										/* ◎상대전표순번 */
	                                        '',										/* ◎예산구분 */
	                                        '',										/* ◎프로젝트코드 */
	                                        '',										/* ◎예산품의번호 */
	                                        '',										/* ◎예산부서코드 */
	                                        '',										/* ◎예산년월 */
	                                        '',										/* ◎예산과목코드 */
	                                        '',										/* ◎예산세목코드 */
	                                        sTITL_NAME,						/* ●적요 */
	                                        #DTIX_TYPE#,						/* ◎증빙종류 */
	                                        '',										/* ◎출납처리여부 */
	                                        '',										/* ◎지급일 */
	                                        '',										/* ◎출납방법 */
	                                        '',										/* ◎입출구분 */
	                                        '',										/* ◎출력순서 */
	                                        lpad(nSLIP_LINE , '4', '0'),		/* ◎정렬순서 */
	                                        '',										/* ◎미사용여분인수1 */
	                                        '',										/* ◎미사용여분인수2 */
	                                        '',										/* ◎미사용여분인수3 */
	                                        '',										/* ◎미사용여분인수4 */
	                                        '');										/* ◎미사용여분인수5 */
	                                        
 	                END;	             
 	                
 	                
                 /*==================================================================
					 2-1-3 매출세액 관리항목 0002   거래처
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0002'      								/* ◎관리항목코드1 */
					      ,rPD_SATXXH.CUST_CODE      		/* ◎관리항목값1 */
					      ,NULL      									/* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;
                
                 /*==================================================================
					 2-1-3 매출세액 관리항목 0011   사업자(주민)번호
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0011'      								/* ◎관리항목코드1 */
					      ,rPD_SATXXH.BIZR_NUMB      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	  	
                
                  /*==================================================================
					 2-1-3 매출세액 관리항목 0049   과세표준
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0049'      								/* ◎관리항목코드1 */
					      ,rPD_SATXXH.TAXX_AMTX      		/* ◎관리항목값1 */
					      ,NULL      									/* ◎관리항목값2 */
					      ,NULL      									/* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	      
                
                   /*==================================================================
					 2-1-3 매출세액 관리항목 0067   부가세유형
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0067'      								/* ◎관리항목코드1 */
					      ,rPD_SATXXH.CITY_CODE     		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	   
                
                  /*==================================================================
					 2-1-3 매출세액 관리항목 0056   관련항목
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0056'      								/* ◎관리항목코드1 */
					      ,rPD_SATXXH.ACCT_CODE      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	 
 	
	       END IF;
	       
        /*=============================================================
             2-2-1. 부가세 저장
          ===============================================================*/
         IF rPD_SATXXH.TAXX_VATX > 0 THEN
           
                  BEGIN 
             
                  PKG_FAMIFSLIP.SP_LINEVAT_SAVE(
                                   #SYST_LNCD#,   							/* ●시스템언어코드*/
                                   #UPDT_USID#,   							/* ●수정작업자*/
                                   sSLIP_NUMB,    							/* ●전표번호 */
                                   lpad(nSLIP_LINE , '4', '0'),    			/* ●전표라인번호 */
                                   '',            									/* ◎카드번호 */
                                   '',            									/* ◎카드승인번호 */
                                   sSLIP_DATE,   								/* ●전송일(계산서발행일/카드승인일) */
                                   'FA200020',    								/* ●매입매출구분[VATX_GUBN] */
                                    rPD_SATXXH.TAXX_GUBN,    			/* ●부가세종류[VATX_TYPE] */
                                    '',   											/* ◎부가세유형[PURC_GUBN] */
                                    '',         										/* ◎불공제구분[BULG_GUBN] */
                                 1,         										/* ◎전자발행여부(1.Yes,0.No) */
                                 rPD_SATXXH.CUST_CODE,        			/* ●거래처코드 */
                                 rPD_SATXXH.JOBN_NAME,         		/* ●품목명 */
                                 rPD_SATXXH.TAXX_AMTX,      			/* ●공급가액 */
                                 rPD_SATXXH.TAXX_VATX,      			/* ●부가세액 */
                                 rPD_SATXXH.SUMM_AMTX,     			/* ●합계금액 */
                                 rPD_SATXXH.MEMO_FILD,          		/* ●적요 */
                                 0,             									/* ◎타사이트발행여부(1.Yes,0.No) */
                                 '',            										/* ◎미사용여분인수1 */
                                 ''             										/* ◎미사용여분인수2 */                                      
                                     );
        
                    END;
          
          END IF;    
	       
	      
	       /*=============================================================
		       2-2-2. FINISH 
		    ===============================================================*/
		  IF rPD_SATXXH.TAXX_AMTX > 0 THEN
		     
				   BEGIN
				    
			         PKG_FAMIFSLIP.SP_FINISH(
					        #SYST_LNCD# 	/* ●시스템언어코드*/
					       ,#UPDT_USID#   	/* ●수정작업자*/
						   ,sSLIP_NUMB   		/* ●전표번호 */
					    );
					    
 	               END;
	       
	       END IF;
	       
	       /*======================================================================================
	                STEP 3. 매출 전표번호 업데이트
								 및 전표 테이블에 저장 
            ======================================================================================*/
            
           				 UPDATE PD_SATXXH 						
						SET SACH_NUMB = sSLIP_NUMB 
						WHERE TAXY_MONT = #TAXY_MONT#
						AND TAXX_NUMB = #TAXX_NUMB#
					;
					
		      EXCEPTION
	             WHEN OTHERS THEN
	                RAISE;
	
	    END;
		]]>
	</insert>
	
	
	
<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2016. 11. 10
     내      용 : 제작 매입 전표처리 
********************************************************************************/
 -->
	<insert id="PACA0030.PROC01" parameterClass="hashmap" >
		<![CDATA[
		DECLARE
	       /*PACA0030.PROC01.제작 매입 전표처리*/
			CURSOR CUR_PD_SUJUMD (
	             P_PREE_CODE  IN PD_SUJUMD.PREE_CODE%TYPE   /*견적번호*/
	            ,P_PREE_IDXX  IN PD_SUJUMD.PREE_IDXX%TYPE   /*견적ID*/
	        ) IS
	        
	            SELECT                                             /* PACA0030.PROC01.제작 매입전표처리 미완료 조회[매입전표 처리 미완료] */
				A.SUJU_DATE    AS POST_DATE            /* 전기일자 */
				,A.OUTS_CODE AS CUST_CODE            /* 거래처코드 */
				,B.CUST_NAME                                    /* 거래처명 */
				,D.CUST_CODE AS CLINT_CODE			/* 광고주명 */
				,D.JOBN_NUMB                                /* 제작번호 */
				,D.JOBN_NAME                                    /* 제작명 */
				,A.MEMO_FILD                                    /* 적요 */
				,NVL(A.SUJU_AMTX,0) AS TAXX_AMTX            /* 금액 */
				,NVL(A.SUJU_AMTX,0)*0.1 AS TAXX_VATX    /* 부가세액 */
				, DECODE(NVL(G.CSTC_CODE,''),NULL,'CC7010041',G.CSTC_CODE) AS COST_CENT /* 코스트센터*/
				, A.SUJU_DATE AS DEND_DATE                    /* 청구일자 */
				, A.SUJU_DATE AS MATU_DATE                    /* 지급기일 */
				, A.SUJU_DATE AS DOCU_DATE                    /* 증빙일자 */
				, E.PUCH_NUMB                                        /* 전표번호 */
				, E.CUST_ANID                                            /* 계좌코드 */
				, CASE F.AGCY_YSNO WHEN 'Y' THEN '5339100'
				  ELSE CASE WHEN D.MEDA_CODE = 'C' THEN '5343100' 
				  WHEN D.MEDA_CODE = 'G' THEN '5343200'
				  ELSE '5343400' END END AS DEBT_CODE /* 차변계정 */
				, CASE WHEN NVL(B.CUTY_CODE,' ') = 'TS100010' THEN '3111110' 
				  ELSE '3111120' END AS ACCT_CODE                  /* 대변계정 */
				, E.EROR_CODE                                        /* 에러코드 */
				, E.EROR_MSGE                                        /* 에러메시지 */
				, A.PREE_CODE                   						/* 견적번호 */
				, A.PREE_IDXX                     					/* 정산ID */
				, DECODE(NVL(G.CSTC_CODE,''),NULL,'000000',D.PLAN_DEPT) AS PLAN_DEPT
				, D.PLAN_DEPT AS DEPT_CODE
				, DECODE(B.BIZR_NUMB,NULL,B.RERN_NUMB,B.BIZR_NUMB) AS BIZR_NUMB
				,CASE WHEN NVL(B.CITY_CODE,' ') = '1' THEN 'A' ELSE 'B' END  AS CITY_CODE   /* 개인일반 구분 */
				FROM 
				PD_SUJUMD A 
				LEFT JOIN TA_CUSTXM  B ON A.OUTS_CODE = B.CUST_CODE
				LEFT JOIN PD_SUJUMH C ON A.PREE_CODE = C.PREE_CODE AND A.JOBN_NUMB = C.JOBN_NUMB 
				LEFT JOIN PD_JOBNXM D ON A.JOBN_NUMB = D.JOBN_NUMB
				LEFT JOIN PD_VOCHXM E ON A.PUCH_NUMB = E.PUCH_NUMB AND E.GBNX_FLAG = 'B'
				LEFT JOIN PD_CLASXM F ON B.CUST_CODE = F.CUST_CODE
				LEFT JOIN TA_CSTCXM G ON D.PLAN_DEPT  = G.DEPT_CODE AND G.COST_GUBN IN ('21','22')
				LEFT JOIN TM_OFFICE H ON H.ACCT_GUBN = '100' AND H.OFFI_GUBN ='1'
				WHERE 1=1
				AND NVL(B.BIZR_NUMB,' ') <> H.BSNS_NUMB
				AND A.PREE_CODE = P_PREE_CODE
				AND A.PREE_IDXX = P_PREE_IDXX
	        ;
	
	        rPD_SUJUMD      CUR_PD_SUJUMD%ROWTYPE;          /*[외주정산 데이터]*/
	
	        sSLIP_DATE      TA_SLIPXM.SLIP_DATE%TYPE;   /*발의일자*/
	        sEMPL_NUMB      TA_SLIPXM.EMPL_NUMB%TYPE;   /*입력자*/
	        sDEPT_CODE      TA_SLIPXM.DEPT_CODE%TYPE;   /*입력부서*/
	        sACCT_GUBN      TA_SLIPXM.ACCT_GUBN%TYPE;   /*사업장*/
	        sTITL_NAME      TA_SLIPXM.TITL_NAME%TYPE;   /*대표적요*/
	        nSLIP_LINE      TA_SLIPNT.SLIP_LINE%TYPE;   /*전표순번*/
	
	        nCURS_SEQN      TA_SLIPNT.SLIP_LINE%TYPE;   /*커서SEQ*/
	        
			sSLIP_NUMB      TA_SLIPXM.SLIP_NUMB%TYPE;   /*전표번호*/
	
	    BEGIN
	
        /*======================================================================================
            STEP 1. 전표 생성 여부 체크
        ======================================================================================*/
	        BEGIN
	            OPEN CUR_PD_SUJUMD( #PREE_CODE#     /*계산서년월*/
	                               ,#PREE_IDXX#     			  /*계산서번호*/
	                               );
	            FETCH CUR_PD_SUJUMD INTO rPD_SUJUMD;
	            CLOSE CUR_PD_SUJUMD;
	
	        END;
	
	        IF NVL(rPD_SUJUMD.PUCH_NUMB, ' ') != ' ' THEN
	            RAISE_APPLICATION_ERROR(-20000, '이미 생성 된  전표(' || rPD_SUJUMD.PUCH_NUMB || ')가 존재 합니다.');
	        END IF;
	
        /*======================================================================================
            STEP 2. 전표 생성
        ======================================================================================*/
	
	        /* 발의일자 :  전기일자*/
	        sSLIP_DATE := #POST_DATE#;
	
	        /* 사용자 정보 조회*/
	        /*
	        BEGIN
	            SELECT U.EMPL_NUMB, U.DEPT_CODE, D.ACCT_GUBN
	              INTO   sEMPL_NUMB, sDEPT_CODE, sACCT_GUBN     
	              FROM   HR_MASTXM U
	              LEFT JOIN VI_DEPTXM D
	                ON  D.DEPT_CODE = U.DEPT_CODE
	             WHERE  USER_IDXX = UPDT_USID;
	
	        END;
	        */
	
	        /* 대표적요 구성 */
	        sTITL_NAME := rPD_SUJUMD.JOBN_NAME;
	        
	         
          /* PARAM -----------------------------------------------------
	            2-0. 제작 매입 전표 > HEADER 추가
	      --------------------------------------------------------------*/
	      
	    BEGIN
	        
		PKG_FAMIFSLIP.SP_MASTER_SAVE(#SYST_LNCD#,     	/* ●시스템언어코드*/
									 #UPDT_USID#,      						/* ●수정작업자*/
									 '10',      									/* ●회계단위 */
									 #ACCT_GUBN#,      						/* ●회계구분_사업장 */
									 #POST_DATE#,       					/* ●전표일자(회계일자) */ 
									 #SLIP_GUBN#,      						/* ●전표유형구분 */
									 sTITL_NAME,       						/* ●제목 */
									 #UPDT_USID#,      						/* ●사원번호  */
									 #DEPT_CODE#,	   						/* ●부서코드 */ 						 
									 #SOUS_LNKY#,              				/* ●출처연결키 */
									 NULL,
									 NULL,
									 NULL,
									 NULL,
									 NULL,
									 sSLIP_NUMB);      /* ●전표번호(생성된 전표번호 반환) */

	        END;
	        
	        /*--------------------------------------------------------------
	            2-1.제작 매입 전표 > LINE 추가[차>대>차변 순서대로 SLIP_LINE저장요망]
	        --------------------------------------------------------------*/
	            nSLIP_LINE := 0; 
	            
            /*--------------------------------------------------------------
	            2-1-1. 제작 매입 전표 > LINE 추가 > (차변)
	        --------------------------------------------------------------*/
	        IF rPD_SUJUMD.TAXX_AMTX > 0 THEN
	            /*nSLIP_LINE := SLIP_LINE;*/        /*JAVA 에서 받아옴 nSLIP_LINE + 1;*/
	            nSLIP_LINE := nSLIP_LINE + 1;
	
	            BEGIN 
	            
	            PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,					/* ●시스템언어코드*/
	                                        #UPDT_USID#,					/* ●수정작업자*/
	                                        sSLIP_NUMB,						/* ●전표번호 */
	                                        lpad(nSLIP_LINE , '4', '0'),		/* ●전표라인번호 */
	                                        '10',									/* ●회계단위 */
	                                        #ACCT_GUBN#,					/* ●회계구분_사업장 */
	                                        rPD_SUJUMD.DEBT_CODE,		/* ●계정과목코드 OR 분개코드 */
	                                        rPD_SUJUMD.PLAN_DEPT,		/* ●사용부서 */
	                                        rPD_SUJUMD.COST_CENT,		/* ◎코스트센터코드 */
	                                        'D',									/* ●차대구분 */
	                                        'KRW',								/* ●통화구분 */
	                                        1,										/* ●환율 */
	                                        rPD_SUJUMD.TAXX_AMTX,		/* ●외화금액 */
	                                        rPD_SUJUMD.TAXX_AMTX,		/* ●전표금액 */
	                                        '',										/* ◎상대전표번호 */
	                                        '',										/* ◎상대전표순번 */
	                                        '',										/* ◎예산구분 */
	                                        '',										/* ◎프로젝트코드 */
	                                        '',										/* ◎예산품의번호 */
	                                        '',										/* ◎예산부서코드 */
	                                        '',										/* ◎예산년월 */
	                                        '',										/* ◎예산과목코드 */
	                                        '',										/* ◎예산세목코드 */
	                                        sTITL_NAME,						/* ●적요 */
	                                        '',										/* ◎증빙종류 */
	                                        '',										/* ◎출납처리여부 */
	                                        '',										/* ◎지급일 */
	                                        '',										/* ◎출납방법 */
	                                        '',										/* ◎입출구분 */
	                                        '',										/* ◎출력순서 */
	                                        lpad(nSLIP_LINE , '4', '0'),		/* ◎정렬순서 */
	                                        '',										/* ◎미사용여분인수1 */
	                                        '',										/* ◎미사용여분인수2 */
	                                        '',										/* ◎미사용여분인수3 */
	                                        '',										/* ◎미사용여분인수4 */
	                                        '');
	                                        
                END;	 
 	                
 	                
                    /*==================================================================
						 2-1-1  차변 관리항목 저장  부서
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0004'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.PLAN_DEPT      		/* ◎관리항목값1 */
					      ,NULL      									/* ◎관리항목코드2 */
					      ,NULL      									/* ◎관리항목값2 */
					      ,NULL      									/* ◎관리항목코드3 */
					      ,NULL      									/* ◎관리항목값3 */
					      ,NULL     									/* ◎관리항목코드4 */
					      ,NULL      									/* ◎관리항목값4 */
					      ,NULL      									/* ◎관리항목코드5 */
					      ,NULL      									/* ◎관리항목값5 */
					      ,NULL      									/* ◎관리항목코드6 */
					      ,NULL      									/* ◎관리항목값6 */
					      ,NULL      									/* ◎관리항목코드7 */
					      ,NULL      									/* ◎관리항목값7 */
					      ,NULL      									/* ◎관리항목코드8 */
					      ,NULL      									/* ◎관리항목값8 */
					      ,NULL      									/* ◎관리항목코드9 */
					      ,NULL      									/* ◎관리항목값9 */
		      		);       
		      		

                END;	 
                
                  /*==================================================================
						 2-1-1  차변 관리항목 저장  광고주
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'1001'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.CLINT_CODE      		/* ◎관리항목값1 */
					      ,NULL      									/* ◎관리항목코드2 */
					      ,NULL      									/* ◎관리항목값2 */
					      ,NULL      									/* ◎관리항목코드3 */
					      ,NULL      									/* ◎관리항목값3 */
					      ,NULL     									/* ◎관리항목코드4 */
					      ,NULL      									/* ◎관리항목값4 */
					      ,NULL      									/* ◎관리항목코드5 */
					      ,NULL      									/* ◎관리항목값5 */
					      ,NULL      									/* ◎관리항목코드6 */
					      ,NULL      									/* ◎관리항목값6 */
					      ,NULL      									/* ◎관리항목코드7 */
					      ,NULL      									/* ◎관리항목값7 */
					      ,NULL      									/* ◎관리항목코드8 */
					      ,NULL      									/* ◎관리항목값8 */
					      ,NULL      									/* ◎관리항목코드9 */
					      ,NULL      									/* ◎관리항목값9 */
		      		);       
		      		

                END;	 
                
                    /*==================================================================
						 2-1-2  차변  관리항목 저장  거래처 필요
					==================================================================*/ 
                 BEGIN 
                  	
                  	PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			/* ●시스템언어코드*/
						  ,#UPDT_USID#   		/* ●수정작업자*/
					      ,sSLIP_NUMB      		/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0002'      /* ◎관리항목코드1 */
					      ,rPD_SUJUMD.CUST_CODE      		/* ◎관리항목값1 */
					      ,NULL      /* ◎관리항목코드2 */
					      ,NULL      /* ◎관리항목값2 */
					      ,NULL      /* ◎관리항목코드3 */
					      ,NULL      /* ◎관리항목값3 */
					      ,NULL      /* ◎관리항목코드4 */
					      ,NULL      /* ◎관리항목값4 */
					      ,NULL      /* ◎관리항목코드5 */
					      ,NULL      /* ◎관리항목값5 */
					      ,NULL      /* ◎관리항목코드6 */
					      ,NULL      /* ◎관리항목값6 */
					      ,NULL      /* ◎관리항목코드7 */
					      ,NULL      /* ◎관리항목값7 */
					      ,NULL      /* ◎관리항목코드8 */
					      ,NULL      /* ◎관리항목값8 */
					      ,NULL      /* ◎관리항목코드9 */
					      ,NULL      /* ◎관리항목값9 */
		      		);
		      			

                END;	              
	            
          END IF;
	          
	              
	        /*=============================================================
	            2-1-2. 제작 매입 전표 > LINE 추가 > (대변)
	        ===============================================================*/
	        IF rPD_SUJUMD.TAXX_AMTX > 0 THEN		        
	            nSLIP_LINE := nSLIP_LINE + 1;
	            
	                 BEGIN
	
	                 PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,						/* ●시스템언어코드*/
	                                        #UPDT_USID#,						/* ●수정작업자*/
	                                        sSLIP_NUMB,							/* ●전표번호 */
	                                        lpad(nSLIP_LINE , '4', '0'),			/* ●전표라인번호 */
	                                        '10',										/* ●회계단위 */
	                                        #ACCT_GUBN#,	                	/* ●회계구분_사업장 */                        
	                                        rPD_SUJUMD.ACCT_CODE,			/* ●계정과목코드 OR 분개코드 */
	                                        rPD_SUJUMD.PLAN_DEPT,			/* ●사용부서 */
	                                        '',											/* ◎코스트센터코드 */
	                                        'C',										/* ●차대구분 */
	                                        'KRW',									/* ●통화구분 */
	                                        1,											/* ●환율 */
	                                        rPD_SUJUMD.TAXX_AMTX + rPD_SUJUMD.TAXX_VATX,		/* ●외화금액 */
	                                        rPD_SUJUMD.TAXX_AMTX + rPD_SUJUMD.TAXX_VATX,		/* ●전표금액 */
	                                        '',											/* ◎상대전표번호 */
	                                        '',											/* ◎상대전표순번 */
	                                        '',											/* ◎예산구분 */
	                                        '',											/* ◎프로젝트코드 */
	                                        '',											/* ◎예산품의번호 */
	                                        '',											/* ◎예산부서코드 */
	                                        '',											/* ◎예산년월 */
	                                        '',											/* ◎예산과목코드 */
	                                        '',											/* ◎예산세목코드 */
	                                        sTITL_NAME,							/* ●적요 */
	                                        '',  /*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */			
	                                        '',											/* ◎출납처리여부 */
	                                        '',											/* ◎지급일 */
	                                        '',											/* ◎출납방법 */
	                                        '',											/* ◎입출구분 */
	                                        '',											/* ◎출력순서 */
	                                       lpad(nSLIP_LINE , '4', '0'),			/* ◎정렬순서 */
	                                        '',											/* ◎미사용여분인수1 */
	                                        '',											/* ◎미사용여분인수2 */
	                                        '',											/* ◎미사용여분인수3 */
	                                        '',											/* ◎미사용여분인수4 */
	                                        '');
	                                        
 	                END;
 	                
 	                    
                   /*==================================================================
						 2-1-2  대변  관리항목 저장   0002 거래처
					==================================================================*/ 
                 BEGIN 
                  	
                  	PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0002'                                     /* ◎관리항목코드1 */
					      ,rPD_SUJUMD.CUST_CODE      		/* ◎관리항목값1 */
					      ,NULL                                      /* ◎관리항목코드2 */
					      ,NULL                                      /* ◎관리항목값2 */
					      ,NULL                                      /* ◎관리항목코드3 */
					      ,NULL                                      /* ◎관리항목값3 */
					      ,NULL                                      /* ◎관리항목코드4 */
					      ,NULL                                      /* ◎관리항목값4 */
					      ,NULL                                      /* ◎관리항목코드5 */
					      ,NULL                                      /* ◎관리항목값5 */
					      ,NULL                                      /* ◎관리항목코드6 */
					      ,NULL                                      /* ◎관리항목값6 */
					      ,NULL                                      /* ◎관리항목코드7 */
					      ,NULL                                      /* ◎관리항목값7 */
					      ,NULL                                      /* ◎관리항목코드8 */
					      ,NULL                                      /* ◎관리항목값8 */
					      ,NULL                                      /* ◎관리항목코드9 */
					      ,NULL                                      /* ◎관리항목값9 */
		      		);
		      			

                END;	 
                
                 /*==================================================================
						 2-1-2  대변  관리항목 저장   0042 발행일(승인일)
					==================================================================*/ 
                 BEGIN 
                  	
                  	PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0042'      								/* ◎관리항목코드1 */
					      ,#POST_DATE#      					/* ◎관리항목값1 */
					      ,NULL      									/* ◎관리항목코드2 */
					      ,NULL      									/* ◎관리항목값2 */
					      ,NULL     									/* ◎관리항목코드3 */
					      ,NULL      									/* ◎관리항목값3 */
					      ,NULL      									/* ◎관리항목코드4 */
					      ,NULL      									/* ◎관리항목값4 */
					      ,NULL      									/* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);
		      			

                END;	  
	
	       END IF;
	       
         /*=============================================================
            2-1-3. 제작매입 전표 > LINE 추가 > 부가가치세매입세액(차변)
        ===============================================================*/
	        IF rPD_SUJUMD.TAXX_VATX > 0 THEN
	            nSLIP_LINE := nSLIP_LINE + 1;
	            sTITL_NAME := rPD_SUJUMD.JOBN_NAME || 'VAT';
	            
	              BEGIN
	              
	              PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,					/* ●시스템언어코드*/
	                                        #UPDT_USID#,					/* ●수정작업자*/
	                                        sSLIP_NUMB,						/* ●전표번호 */
	                                        lpad(nSLIP_LINE , '4', '0'),		/* ●전표라인번호 */
	                                        '10',									/* ●회계단위 */
	                                        #ACCT_GUBN#,					/* ●회계구분_사업장 */
	                                        '3221200',							/* ●계정과목코드 OR 분개코드 */
	                                        rPD_SUJUMD.PLAN_DEPT,		/* ●사용부서 */
	                                        '',										/* ◎코스트센터코드 */
	                                        'D',									/* ●차대구분 */
	                                        'KRW',								/* ●통화구분 */
	                                        1,										/* ●환율 */
	                                        rPD_SUJUMD.TAXX_VATX,		/* ●외화금액 */
	                                        rPD_SUJUMD.TAXX_VATX,		/* ●전표금액 */
	                                        '',										/* ◎상대전표번호 */
	                                        '',										/* ◎상대전표순번 */
	                                        '',										/* ◎예산구분 */
	                                        '',										/* ◎프로젝트코드 */
	                                        '',										/* ◎예산품의번호 */	
	                                        '',										/* ◎예산부서코드 */
	                                        '',										/* ◎예산년월 */
	                                        '',										/* ◎예산과목코드 */
	                                        '',										/* ◎예산세목코드 */
	                                        sTITL_NAME,						/* ●적요 */
	                                        'FA180010',							/* ◎증빙종류 */
	                                        '',										/* ◎출납처리여부 */
	                                        '',										/* ◎지급일 */
	                                        '',										/* ◎출납방법 */
	                                        '',										/* ◎입출구분 */
	                                        '',										/* ◎출력순서 */
	                                        lpad(nSLIP_LINE , '4', '0'),		/* ◎정렬순서 */
	                                        '',										/* ◎미사용여분인수1 */
	                                        '',										/* ◎미사용여분인수2 */
	                                        '',										/* ◎미사용여분인수3 */
	                                        '',										/* ◎미사용여분인수4 */
	                                        '');
	                                        
                END;	   
 	                
 	                
                   /*==================================================================
						 2-1-3  부가가치세매입세액 관리항목 저장 0002 거래처  
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0002'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.CUST_CODE      		/* ◎관리항목값1 */
					      ,NULL                                      /* ◎관리항목값2 */
					      ,NULL                                      /* ◎관리항목코드2 */
					      ,NULL                                      /* ◎관리항목코드3 */
					      ,NULL                                      /* ◎관리항목값3 */
					      ,NULL                                      /* ◎관리항목코드4 */
					      ,NULL                                      /* ◎관리항목값4 */
					      ,NULL                                      /* ◎관리항목코드5 */
					      ,NULL                                      /* ◎관리항목값5 */
					      ,NULL                                      /* ◎관리항목코드6 */
					      ,NULL                                      /* ◎관리항목값6 */
					      ,NULL                                      /* ◎관리항목코드7 */
					      ,NULL                                      /* ◎관리항목값7 */
					      ,NULL                                      /* ◎관리항목코드8 */
					      ,NULL                                      /* ◎관리항목값8 */
					      ,NULL                                      /* ◎관리항목코드9 */
					      ,NULL                                      /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	   
 	                
 	                
 	                 /*==================================================================
						 2-1-3  부가가치세매입세액 관리항목 저장 0011 사업자 주민등록번호  
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0011'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.BIZR_NUMB      		/* ◎관리항목값1 */
					      ,NULL                                      /* ◎관리항목값2 */
					      ,NULL                                      /* ◎관리항목코드2 */
					      ,NULL                                      /* ◎관리항목코드3 */
					      ,NULL                                      /* ◎관리항목값3 */
					      ,NULL                                      /* ◎관리항목코드4 */
					      ,NULL                                      /* ◎관리항목값4 */
					      ,NULL                                      /* ◎관리항목코드5 */
					      ,NULL                                      /* ◎관리항목값5 */
					      ,NULL                                      /* ◎관리항목코드6 */
					      ,NULL                                      /* ◎관리항목값6 */
					      ,NULL                                      /* ◎관리항목코드7 */
					      ,NULL                                      /* ◎관리항목값7 */
					      ,NULL                                      /* ◎관리항목코드8 */
					      ,NULL                                      /* ◎관리항목값8 */
					      ,NULL                                      /* ◎관리항목코드9 */
					      ,NULL                                      /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	 
 	                
 	                 /*==================================================================
						 2-1-3  부가가치세매입세액 관리항목 저장 0049 과세표준  
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0049'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.TAXX_AMTX      		/* ◎관리항목값1 */
					      ,NULL                                      /* ◎관리항목값2 */
					      ,NULL                                      /* ◎관리항목코드2 */
					      ,NULL                                      /* ◎관리항목코드3 */
					      ,NULL                                      /* ◎관리항목값3 */
					      ,NULL                                      /* ◎관리항목코드4 */
					      ,NULL                                      /* ◎관리항목값4 */
					      ,NULL                                      /* ◎관리항목코드5 */
					      ,NULL                                      /* ◎관리항목값5 */
					      ,NULL                                      /* ◎관리항목코드6 */
					      ,NULL                                      /* ◎관리항목값6 */
					      ,NULL                                      /* ◎관리항목코드7 */
					      ,NULL                                      /* ◎관리항목값7 */
					      ,NULL                                      /* ◎관리항목코드8 */
					      ,NULL                                      /* ◎관리항목값8 */
					      ,NULL                                      /* ◎관리항목코드9 */
					      ,NULL                                      /* ◎관리항목값9 */
		      		);       
		      		
 	                END;
 	                
 	                  /*==================================================================
						 2-1-3  부가가치세매입세액 관리항목 저장 0067 부과서유형  
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0067'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.CITY_CODE      		/* ◎관리항목값1 */
					      ,NULL                                      /* ◎관리항목값2 */
					      ,NULL                                      /* ◎관리항목코드2 */
					      ,NULL                                      /* ◎관리항목코드3 */
					      ,NULL                                      /* ◎관리항목값3 */
					      ,NULL                                      /* ◎관리항목코드4 */
					      ,NULL                                      /* ◎관리항목값4 */
					      ,NULL                                      /* ◎관리항목코드5 */
					      ,NULL                                      /* ◎관리항목값5 */
					      ,NULL                                      /* ◎관리항목코드6 */
					      ,NULL                                      /* ◎관리항목값6 */
					      ,NULL                                      /* ◎관리항목코드7 */
					      ,NULL                                      /* ◎관리항목값7 */
					      ,NULL                                      /* ◎관리항목코드8 */
					      ,NULL                                      /* ◎관리항목값8 */
					      ,NULL                                      /* ◎관리항목코드9 */
					      ,NULL                                      /* ◎관리항목값9 */
		      		);       
		      		
 	                END;
 	                
 	                
                    /*==================================================================
						 2-1-3  부가가치세매입세액 관리항목 저장 0056 관련과목  
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,sSLIP_NUMB      						/* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0056'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.ACCT_CODE      		/* ◎관리항목값1 */
					      ,NULL                                      /* ◎관리항목값2 */
					      ,NULL                                      /* ◎관리항목코드2 */
					      ,NULL                                      /* ◎관리항목코드3 */
					      ,NULL                                      /* ◎관리항목값3 */
					      ,NULL                                      /* ◎관리항목코드4 */
					      ,NULL                                      /* ◎관리항목값4 */
					      ,NULL                                      /* ◎관리항목코드5 */
					      ,NULL                                      /* ◎관리항목값5 */
					      ,NULL                                      /* ◎관리항목코드6 */
					      ,NULL                                      /* ◎관리항목값6 */
					      ,NULL                                      /* ◎관리항목코드7 */
					      ,NULL                                      /* ◎관리항목값7 */
					      ,NULL                                      /* ◎관리항목코드8 */
					      ,NULL                                      /* ◎관리항목값8 */
					      ,NULL                                      /* ◎관리항목코드9 */
					      ,NULL                                      /* ◎관리항목값9 */
		      		);       
		      		
 	                END;
 	                
 	                
 	                BEGIN 
             
	                  PKG_FAMIFSLIP.SP_LINEVAT_SAVE(
	                                #SYST_LNCD#,   						/* ●시스템언어코드*/
	                                #UPDT_USID#,   						/* ●수정작업자*/
	                                sSLIP_NUMB,    						/* ●전표번호 */
	                                lpad(nSLIP_LINE , '4', '0'),     		/* ●전표라인번호 */
	                                '',            								/* ◎카드번호 */
	                                '',            								/* ◎카드승인번호 */
	                                #POST_DATE#,   						/* ●전송일(계산서발행일/카드승인일) */
	                                'FA200010',    							/* ●매입매출구분[VATX_GUBN] */
	                                'FA210010',    							/* ●부가세종류[VATX_TYPE] */
	                                 '',   										/* ◎부가세유형[PURC_GUBN] */
	                                 '',         								/* ◎불공제구분[BULG_GUBN] */
	                                 1,         								/* ◎전자발행여부(1.Yes,0.No) */
	                                 rPD_SUJUMD.CUST_CODE, 		/* ●거래처코드 */
	                                 sTITL_NAME,          				/* ●품목명 */
	                                 rPD_SUJUMD.TAXX_AMTX, 		/* ●공급가액 */
	                                 rPD_SUJUMD.TAXX_VATX,    		/* ●부가세액 */
	                                 rPD_SUJUMD.TAXX_AMTX + rPD_SUJUMD.TAXX_VATX,     /* ●합계금액 */
	                                 sTITL_NAME,  						/* ●적요 */
	                                 0,             							/* ◎타사이트발행여부(1.Yes,0.No) */
	                                 '',            								/* ◎미사용여분인수1 */
	                                 ''             								/* ◎미사용여분인수2 */                                      
	                                     );
                    END;                                       
	
	       END IF;
	       
	            	
         /*=============================================================
		       2-1-5. FINISH 
		    ===============================================================*/
		  IF rPD_SUJUMD.TAXX_AMTX > 0 THEN
		     
				   BEGIN
				    
			         PKG_FAMIFSLIP.SP_FINISH(
					        #SYST_LNCD# /* ●시스템언어코드*/
					       ,#UPDT_USID#   /* ●수정작업자*/
						   ,sSLIP_NUMB   /* ●전표번호 */
					    );
					    
 	               END;
	       
	       END IF;
	       
	       /*======================================================================================
	                STEP 3. 매출 전표번호 업데이트
								 및 전표 테이블에 저장 
            ======================================================================================*/
            
              UPDATE PD_SUJUMD
			  SET PUCH_NUMB = sSLIP_NUMB
			  WHERE 1=1
			  AND PREE_CODE = #PREE_CODE#
			  AND PREE_IDXX = #PREE_IDXX#
			  ;
	
	    END;
		]]>
	</insert>
	
<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2016. 12. 21
     내      용 : 제작 매입 전표 개인 모델료 처리 
********************************************************************************/
 -->
	<insert id="PACA0030.PROC02" parameterClass="hashmap" >
		<![CDATA[
		DECLARE
	       /*PACA0030.PROC02.제작 매입 전표 개인 모델료 처리*/
			CURSOR CUR_PD_SUJUMD (
	             P_PREE_CODE  IN PD_SUJUMD.PREE_CODE%TYPE   /*견적번호*/
	            ,P_PREE_IDXX  IN PD_SUJUMD.PREE_IDXX%TYPE   /*견적ID*/
	        ) IS
	        
	            SELECT                                             /* PACA0030.PROC02.제작 매입전표처리 미완료 조회[매입전표 처리 미완료] */
				A.SUJU_DATE    AS POST_DATE            /* 전기일자 */
				,A.OUTS_CODE AS CUST_CODE            /* 거래처코드 */
				,B.CUST_NAME                                    /* 거래처명 */
				,D.CUST_CODE AS CLIENT_CODE			/* 광고주코드 */
				,D.JOBN_NUMB                                /* 제작번호 */
				,D.JOBN_NAME                                    /* 제작명 */
				,A.MEMO_FILD                                    /* 적요 */
				,NVL(A.SUJU_AMTX,0) AS TAXX_AMTX            /* 금액 */
				,NVL(A.SUJU_AMTX,0)*0.1 AS TAXX_VATX    /* 부가세액 */
				, DECODE(NVL(G.CSTC_CODE,''),NULL,'CC7010041',G.CSTC_CODE) AS COST_CENT /* 코스트센터*/
				, A.SUJU_DATE AS DEND_DATE                    /* 청구일자 */
				, A.SUJU_DATE AS MATU_DATE                    /* 지급기일 */
				, A.SUJU_DATE AS DOCU_DATE                    /* 증빙일자 */
				, E.PUCH_NUMB                                        /* 전표번호 */
				, E.CUST_ANID                                            /* 계좌코드 */
				, CASE F.AGCY_YSNO WHEN 'Y' THEN '5339100'
				  ELSE CASE WHEN D.MEDA_CODE = 'C' THEN '5343100' 
				  WHEN D.MEDA_CODE = 'G' THEN '5343200'
				  ELSE '5343400' END END AS DEBT_CODE /* 차변계정 */
				, CASE WHEN NVL(B.CUTY_CODE,' ') = 'TS100010' THEN '3111110' 
				  ELSE '3111120' END AS ACCT_CODE                  /* 대변계정 */
				, A.PREE_CODE                   						/* 견적번호 */
				, A.PREE_IDXX                     					/* 정산ID */
				, D.PLAN_DEPT											/* 담당부서 */
				, NVL(A.SUJU_AMTX,0) - (ROUND(NVL(A.SUJU_AMTX,0) * 0.03) + ROUND((NVL(A.SUJU_AMTX,0) * 0.03)* 0.1)) AS ACCT_AMTX 		/* 개인 모델료 대변금액 */
				, ROUND(NVL(A.SUJU_AMTX,0) * 0.03) AS YESU_AMTX    /* 예수금(자유직업소득세) */
				, ROUND((NVL(A.SUJU_AMTX,0) * 0.03)* 0.1) AS YESU_AMTX2  /* 예수금(자유직업주민세) */
				, DECODE(B.BIZR_NUMB,NULL,B.RERN_NUMB,B.BIZR_NUMB) AS BIZR_NUMB			
				FROM 
				PD_SUJUMD A 
				LEFT JOIN TA_CUSTXM  B ON A.OUTS_CODE = B.CUST_CODE
				LEFT JOIN PD_SUJUMH C ON A.PREE_CODE = C.PREE_CODE AND A.JOBN_NUMB = C.JOBN_NUMB 
				LEFT JOIN PD_JOBNXM D ON A.JOBN_NUMB = D.JOBN_NUMB
				LEFT JOIN PD_VOCHXM E ON A.PUCH_NUMB = E.PUCH_NUMB AND E.GBNX_FLAG = 'B'
				LEFT JOIN PD_CLASXM F ON B.CUST_CODE = F.CUST_CODE
				LEFT JOIN TA_CSTCXM G ON D.PLAN_DEPT  = G.DEPT_CODE AND G.COST_GUBN IN ('21','22')
				LEFT JOIN TM_OFFICE H ON H.ACCT_GUBN = '100' AND H.OFFI_GUBN ='1'
				WHERE 1=1
				AND NVL(B.BIZR_NUMB,' ') <> H.BSNS_NUMB
				AND A.PREE_CODE = P_PREE_CODE
				AND A.PREE_IDXX = P_PREE_IDXX
	        ;
	
	        rPD_SUJUMD      CUR_PD_SUJUMD%ROWTYPE;          /*[외주정산 데이터]*/
	
	        sSLIP_DATE      TA_SLIPXM.SLIP_DATE%TYPE;   /*발의일자*/
	        sEMPL_NUMB      TA_SLIPXM.EMPL_NUMB%TYPE;   /*입력자*/
	        sDEPT_CODE      TA_SLIPXM.DEPT_CODE%TYPE;   /*입력부서*/
	        sACCT_GUBN      TA_SLIPXM.ACCT_GUBN%TYPE;   /*사업장*/
	        sTITL_NAME      TA_SLIPXM.TITL_NAME%TYPE;   /*대표적요*/
	        nSLIP_LINE      TA_SLIPNT.SLIP_LINE%TYPE;   /*전표순번*/
	
	        nCURS_SEQN      TA_SLIPNT.SLIP_LINE%TYPE;   /*커서SEQ*/
	        
			sSLIP_NUMB      TA_SLIPXM.SLIP_NUMB%TYPE;   /*전표번호*/
	
	    BEGIN
	
        /*======================================================================================
            STEP 1. 전표 생성 여부 체크
        ======================================================================================*/
	        BEGIN
	            OPEN CUR_PD_SUJUMD( #PREE_CODE#     /*계산서년월*/
	                               ,#PREE_IDXX#     			  /*계산서번호*/
	                               );
	            FETCH CUR_PD_SUJUMD INTO rPD_SUJUMD;
	            CLOSE CUR_PD_SUJUMD;
	
	            EXCEPTION
	                WHEN OTHERS THEN
	                    RAISE_APPLICATION_ERROR(-20000, '제작 매입 전표 생성 여부 체크 중 오류가 발생하였습니다.'||chr(13)||chr(10)||SQLERRM);
	        END;
	
	        IF NVL(rPD_SUJUMD.PUCH_NUMB, ' ') != ' ' THEN
	            RAISE_APPLICATION_ERROR(-20000, '이미 생성 된  전표(' || rPD_SUJUMD.PUCH_NUMB || ')가 존재 합니다.');
	        END IF;
	
        /*======================================================================================
            STEP 2. 전표 생성
        ======================================================================================*/
	
	        /* 발의일자 :  전기일자*/
	        sSLIP_DATE := #POST_DATE#;
	
	        /* 사용자 정보 조회*/
	        /*
	        BEGIN
	            SELECT U.EMPL_NUMB, U.DEPT_CODE, D.ACCT_GUBN
	              INTO   sEMPL_NUMB, sDEPT_CODE, sACCT_GUBN     
	              FROM   HR_MASTXM U
	              LEFT JOIN VI_DEPTXM D
	                ON  D.DEPT_CODE = U.DEPT_CODE
	             WHERE  USER_IDXX = UPDT_USID;
	
	            EXCEPTION
	                WHEN NO_DATA_FOUND THEN
	                    RAISE_APPLICATION_ERROR(-20000, '입력자에 대한 정보를 찾을 수 없습니다.'||chr(13)||chr(10)||SQLERRM);
	        END;
	        */
	
	        /* 대표적요 구성 */
	        sTITL_NAME := rPD_SUJUMD.JOBN_NAME;
	        
	         
          /* PARAM -----------------------------------------------------
	            2-0. 제작 매입 전표 > HEADER 추가
	      --------------------------------------------------------------*/
	      
	    BEGIN
	        
		PKG_FAMIFSLIP.SP_MASTER_SAVE(#SYST_LNCD#,     	/* ●시스템언어코드*/
									 #UPDT_USID#,      						/* ●수정작업자*/
									 '10',      									/* ●회계단위 */
									 #ACCT_GUBN#,      						/* ●회계구분_사업장 */
									 #POST_DATE#,       					/* ●전표일자(회계일자) */ 
									 #SLIP_GUBN#,      						/* ●전표유형구분 */
									 sTITL_NAME,       						/* ●제목 */
									 #UPDT_USID#,      						/* ●사원번호  */
									 #DEPT_CODE#,	   						/* ●부서코드 */ 						 
									 #SOUS_LNKY#,              				/* ●출처연결키 */
									 NULL,
									 NULL,
									 NULL,
									 NULL,
									 NULL,
									 sSLIP_NUMB);      /* ●전표번호(생성된 전표번호 반환) */

	        END;
	        
	        /*--------------------------------------------------------------
	            2-1.제작 매입 전표 > LINE 추가[차>대>차변>차변 순서대로 SLIP_LINE저장요망]
	        --------------------------------------------------------------*/
	            nSLIP_LINE := 0; 
	            
            /*--------------------------------------------------------------
	            2-1-1. 제작 매입 전표 > LINE 추가 > (차변)
	        --------------------------------------------------------------*/
	        IF rPD_SUJUMD.TAXX_AMTX > 0 THEN
	            /*nSLIP_LINE := SLIP_LINE;*/        /*JAVA 에서 받아옴 nSLIP_LINE + 1;*/
	            nSLIP_LINE := nSLIP_LINE + 1;
	
	            BEGIN 
	            
	            PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,					/* ●시스템언어코드*/
	                                        #UPDT_USID#,					/* ●수정작업자*/
	                                        sSLIP_NUMB,						/* ●전표번호 */
	                                        lpad(nSLIP_LINE , '4', '0'),		/* ●전표라인번호 */
	                                        '10',									/* ●회계단위 */
	                                        #ACCT_GUBN#,					/* ●회계구분_사업장 */
	                                        rPD_SUJUMD.DEBT_CODE,		/* ●계정과목코드 OR 분개코드 */
	                                        '000000',								/* ●사용부서 */
	                                        rPD_SUJUMD.COST_CENT,		/* ◎코스트센터코드 */
	                                        'D',									/* ●차대구분 */
	                                        'KRW',								/* ●통화구분 */
	                                        1,										/* ●환율 */
	                                        rPD_SUJUMD.TAXX_AMTX,		/* ●외화금액 */
	                                        rPD_SUJUMD.TAXX_AMTX,		/* ●전표금액 */
	                                        '',										/* ◎상대전표번호 */
	                                        '',										/* ◎상대전표순번 */
	                                        '',										/* ◎예산구분 */
	                                        '',										/* ◎프로젝트코드 */
	                                        '',										/* ◎예산품의번호 */
	                                        '',										/* ◎예산부서코드 */
	                                        '',										/* ◎예산년월 */
	                                        '',										/* ◎예산과목코드 */
	                                        '',										/* ◎예산세목코드 */
	                                        sTITL_NAME,						/* ●적요 */
	                                        '',										/* ◎증빙종류 */
	                                        '',										/* ◎출납처리여부 */
	                                        '',										/* ◎지급일 */
	                                        '',										/* ◎출납방법 */
	                                        '',										/* ◎입출구분 */
	                                        '',										/* ◎출력순서 */
	                                        lpad(nSLIP_LINE , '4', '0'),		/* ◎정렬순서 */
	                                        '',										/* ◎미사용여분인수1 */
	                                        '',										/* ◎미사용여분인수2 */
	                                        '',										/* ◎미사용여분인수3 */
	                                        '',										/* ◎미사용여분인수4 */
	                                        '');
	                                        
 	                END;	 
 	                
 	                
                    /*==================================================================
						 2-1-1  차변 관리항목 저장  - 부서
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0004'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.PLAN_DEPT      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	         
 	                
 	                
                     /*==================================================================
						 2-1-1  차변 관리항목 저장  - 광고주추가
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'1001'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.CLIENT_CODE      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	      
	            
	          END IF;
	          
	              
	        /*=============================================================
	            2-1-2. 제작 매입 전표 > LINE 추가 > (대변 외상매입금)
	        ===============================================================*/
	        IF rPD_SUJUMD.TAXX_AMTX > 0 THEN		        
	            nSLIP_LINE := nSLIP_LINE + 1;
	            
	                 BEGIN
	
	                 PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,						/* ●시스템언어코드*/
	                                        #UPDT_USID#,						/* ●수정작업자*/
	                                        sSLIP_NUMB,							/* ●전표번호 */
	                                        lpad(nSLIP_LINE , '4', '0'),			/* ●전표라인번호 */
	                                        '10',						                /* ●회계단위 */
	                                        #ACCT_GUBN#,	                	/* ●회계구분_사업장 */                        
	                                        rPD_SUJUMD.ACCT_CODE,			/* ●계정과목코드 OR 분개코드 */
	                                        '000000',									/* ●사용부서 */
	                                        '',											/* ◎코스트센터코드 */
	                                        'C',										/* ●차대구분 */
	                                        'KRW',									/* ●통화구분 */
	                                        1,											/* ●환율 */
	                                        rPD_SUJUMD.ACCT_AMTX,		    /* ●외화금액 */
	                                        rPD_SUJUMD.ACCT_AMTX,		    /* ●전표금액 */
	                                        '',											/* ◎상대전표번호 */
	                                        '',											/* ◎상대전표순번 */
	                                        '',											/* ◎예산구분 */
	                                        '',											/* ◎프로젝트코드 */
	                                        '',											/* ◎예산품의번호 */
	                                        '',											/* ◎예산부서코드 */
	                                        '',											/* ◎예산년월 */
	                                        '',											/* ◎예산과목코드 */
	                                        '',											/* ◎예산세목코드 */
	                                        sTITL_NAME,							/* ●적요 */
	                                        '',                                          /*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */			
	                                        '',											/* ◎출납처리여부 */
	                                        '',											/* ◎지급일 */
	                                        '',											/* ◎출납방법 */
	                                        '',											/* ◎입출구분 */
	                                        '',											/* ◎출력순서 */
	                                       lpad(nSLIP_LINE , '4', '0'),			/* ◎정렬순서 */
	                                        '',											/* ◎미사용여분인수1 */
	                                        '',											/* ◎미사용여분인수2 */
	                                        '',											/* ◎미사용여분인수3 */
	                                        '',											/* ◎미사용여분인수4 */
	                                        '');
	                                        
 	                END;
 	                
 	                    
                   /*==================================================================
						 2-1-2  대변  외상매입금 관리항목 저장 0002 거래처  
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0002'                                     /* ◎관리항목코드1 */
					      ,rPD_SUJUMD.CUST_CODE      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	 
 	                
 	                /*==================================================================
						 2-1-2  대변  외상매입금 관리항목 저장 0042 발행일(승인일)  
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0042'                                     /* ◎관리항목코드1 */
					      ,#POST_DATE#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;  
	
	
	       END IF;
	       
         /*=============================================================
	            2-1-2. 제작 매입 전표 > LINE 추가 > (대변)> 대변 예수금 (자유직업소득세)
	        ===============================================================*/
	        IF rPD_SUJUMD.TAXX_AMTX > 0 THEN		        
	            nSLIP_LINE := nSLIP_LINE + 1;
	            
	                 BEGIN
	
	                 PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,						/* ●시스템언어코드*/
	                                        #UPDT_USID#,						/* ●수정작업자*/
	                                        sSLIP_NUMB,							/* ●전표번호 */
	                                        lpad(nSLIP_LINE , '4', '0'),			/* ●전표라인번호 */
	                                        '10',										/* ●회계단위 */
	                                        #ACCT_GUBN#,	                	/* ●회계구분_사업장 */                        
	                                        '3171700',								/* ●계정과목코드 OR 분개코드 */
	                                        '000000',									/* ●사용부서 */
	                                        '',											/* ◎코스트센터코드 */
	                                        'C',										/* ●차대구분 */
	                                        'KRW',									/* ●통화구분 */
	                                        1,											/* ●환율 */
	                                        rPD_SUJUMD.YESU_AMTX,		    /* ●외화금액 */
	                                        rPD_SUJUMD.YESU_AMTX,		    /* ●전표금액 */
	                                        '',											/* ◎상대전표번호 */
	                                        '',											/* ◎상대전표순번 */
	                                        '',											/* ◎예산구분 */
	                                        '',											/* ◎프로젝트코드 */
	                                        '',											/* ◎예산품의번호 */
	                                        '',											/* ◎예산부서코드 */
	                                        '',											/* ◎예산년월 */
	                                        '',											/* ◎예산과목코드 */
	                                        '',											/* ◎예산세목코드 */
	                                        sTITL_NAME,							/* ●적요 */
	                                        '',  										/*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */			
	                                        '',											/* ◎출납처리여부 */
	                                        '',											/* ◎지급일 */
	                                        '',											/* ◎출납방법 */
	                                        '',											/* ◎입출구분 */
	                                        '',											/* ◎출력순서 */
	                                       lpad(nSLIP_LINE , '4', '0'),			/* ◎정렬순서 */
	                                        '',											/* ◎미사용여분인수1 */
	                                        '',											/* ◎미사용여분인수2 */
	                                        '',											/* ◎미사용여분인수3 */
	                                        '',											/* ◎미사용여분인수4 */
	                                        '');
	                                        
	                                        
 	                END;
 	                
 	                    
                   /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0004 부서   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0004'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.PLAN_DEPT      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	 
 	                
 	                
 	                /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0011 사업자(주민)번호   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0011'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.BIZR_NUMB      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;
 	                
 	                 /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0049 과세표준   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0049'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.TAXX_AMTX      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	
 	                
 	                /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0042 발행일    전기일자
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0042'      								/* ◎관리항목코드1 */
					      ,sSLIP_DATE      						/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;		    
	
	 				/*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0024 세율   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0024'      								/* ◎관리항목코드1 */
					      ,'3'      										/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	
	
	       END IF;
	       
	        /*=============================================================
	            2-1-2. 제작 매입 전표 > LINE 추가 > (대변)> 대변 예수금 (자유직업주민세)
	        ===============================================================*/
	        IF rPD_SUJUMD.TAXX_AMTX > 0 THEN		        
	            nSLIP_LINE := nSLIP_LINE + 1;
	            
	                 BEGIN
	
	                 PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,						/* ●시스템언어코드*/
	                                        #UPDT_USID#,						/* ●수정작업자*/
	                                        sSLIP_NUMB,							/* ●전표번호 */
	                                        lpad(nSLIP_LINE , '4', '0'),			/* ●전표라인번호 */
	                                        '10',						                /* ●회계단위 */
	                                        #ACCT_GUBN#,	                	/* ●회계구분_사업장 */                        
	                                        '3171800',								/* ●계정과목코드 OR 분개코드 */
	                                        '000000',									/* ●사용부서 */
	                                        '',											/* ◎코스트센터코드 */
	                                        'C',										/* ●차대구분 */
	                                        'KRW',									/* ●통화구분 */
	                                        1,											/* ●환율 */
	                                        rPD_SUJUMD.YESU_AMTX2,		/* ●외화금액 */
	                                        rPD_SUJUMD.YESU_AMTX2,		/* ●전표금액 */
	                                        '',											/* ◎상대전표번호 */
	                                        '',											/* ◎상대전표순번 */
	                                        '',											/* ◎예산구분 */
	                                        '',											/* ◎프로젝트코드 */
	                                        '',											/* ◎예산품의번호 */
	                                        '',											/* ◎예산부서코드 */
	                                        '',											/* ◎예산년월 */
	                                        '',											/* ◎예산과목코드 */
	                                        '',											/* ◎예산세목코드 */
	                                        sTITL_NAME,							/* ●적요 */
	                                        '',  										/*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */			
	                                        '',											/* ◎출납처리여부 */
	                                        '',											/* ◎지급일 */
	                                        '',											/* ◎출납방법 */
	                                        '',											/* ◎입출구분 */
	                                        '',											/* ◎출력순서 */
	                                       lpad(nSLIP_LINE , '4', '0'),			/* ◎정렬순서 */
	                                        '',											/* ◎미사용여분인수1 */
	                                        '',											/* ◎미사용여분인수2 */
	                                        '',											/* ◎미사용여분인수3 */
	                                        '',											/* ◎미사용여분인수4 */
	                                        '');
	                     
 	                END;
 	                
 	                    
                   /*==================================================================
						 2-1-2  대변 예수금 (자유직업주민세) 관리항목 저장  0004 부서 
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0004'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.PLAN_DEPT      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	  
 	                
 	                
 	                  /*==================================================================
						 2-1-2  대변 예수금 (자유직업 주민세) 관리항목 0011 사업자(주민)번호   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0011'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.BIZR_NUMB      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;
 	                
 	                 /*==================================================================
						 2-1-2  대변 예수금 (자유직업 주민세) 관리항목 0049 과세표준   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0049'      								/* ◎관리항목코드1 */
					      ,rPD_SUJUMD.YESU_AMTX      		/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	
 	                
 	                /*==================================================================
						 2-1-2  대변 예수금 (자유직업 주민세) 관리항목 0042 발행일   전기일자
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0042'      								/* ◎관리항목코드1 */
					      ,#POST_DATE#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;		    
	
	 				/*==================================================================
						 2-1-2  대변 예수금 (자유직업 주민세) 관리항목 0024 세율   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,sSLIP_NUMB      		                /* ●전표번호 */
					      ,lpad(nSLIP_LINE , '4', '0')     		/* ●전표라인번호 */
					      ,'0024'      								/* ◎관리항목코드1 */
					      ,'10'      										/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	 
	
	       END IF;
	       
	            	
         /*=============================================================
		       2-1-5. FINISH 
		    ===============================================================*/
		  IF rPD_SUJUMD.TAXX_AMTX > 0 THEN
		     
				   BEGIN
				    
			         PKG_FAMIFSLIP.SP_FINISH(
					        #SYST_LNCD# 	/* ●시스템언어코드*/
					       ,#UPDT_USID#   	/* ●수정작업자*/
						   ,sSLIP_NUMB   		/* ●전표번호 */
					    );
					    
 	               END;
	       
	       END IF;
	       
	       /*======================================================================================
	                STEP 3. 매출 전표번호 업데이트
								 및 전표 테이블에 저장 
            ======================================================================================*/
            
              UPDATE PD_SUJUMD
			  SET PUCH_NUMB = sSLIP_NUMB
			  WHERE 1=1
			  AND PREE_CODE = #PREE_CODE#
			  AND PREE_IDXX = #PREE_IDXX#
			  ;
            
		      EXCEPTION
	             WHEN OTHERS THEN
	                RAISE;
	
	    END;
		]]>
	</insert>
	
	
	
	<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 11
     내      용 : 제작 매출 전표 마스터 저장 
********************************************************************************/
 -->
	<insert id="PACA0030.MASTER_SAVE_SL" parameterClass="hashmap">
	<![CDATA[
	 
	DECLARE
	       /*PACA0030.PROC00.제작 매출 전표처리*/
			CURSOR CUR_PD_SATXXH (
	             P_TAXY_MONT  IN PD_SATXXH.TAXY_MONT%TYPE   /*계산서년월*/
	            ,P_TAXX_NUMB  IN PD_SATXXH.TAXX_NUMB%TYPE   /*계산서번호*/
	        ) IS
	        
	             SELECT
					A.CUST_CODE
					,A.SACH_NUMB
					,'100' AS ACCT_GUBN
					,B.PLAN_DEPT 
					,A.MEMO_FILD
					,B.JOBN_NAME
					,CASE A.TAXX_GUBN WHEN '01' THEN 'FA210010'
					WHEN '02' THEN 'FA210020' ELSE 'FA210010' END AS TAXX_GUBN														
					,CASE A.DTIX_TYPE WHEN '01' THEN 'FA180010'
					WHEN '02' THEN 'FA180010'
					ELSE 'FA180020' END AS DTIX_TYPE
					,NVL(A.TAXX_AMTX,0) AS TAXX_AMTX
					,NVL(A.TAXX_VATX,0) AS TAXX_VATX
					,NVL(A.SUMM_AMTX,0) AS SUMM_AMTX
					,CASE WHEN NVL(C.CUTY_CODE,' ') = 'TS100010' THEN '1111613' ELSE '1111614' END  AS DEBT_CODE   /* 차변계정 */
					,CASE WHEN NVL(C.CUTY_CODE,' ') = 'TS100010' THEN '5120010' ELSE '5120020' END  AS ACCT_CODE   /* 대변계정 */
					,NULL AS CSTC_CODE												/* 코스트센터  현재 필수값이 아니라는 에러 D.CSTC_CODE */
					,DECODE(C.BIZR_NUMB,NULL,C.RERN_NUMB,C.BIZR_NUMB) AS BIZR_NUMB			/* 사업자(주민) 번호 */
					,CASE WHEN NVL(C.CITY_CODE,' ') = '1' THEN 'A' ELSE 'B' END  AS CITY_CODE   /* 개인일반 구분 */
					FROM PD_SATXXH A
					LEFT JOIN PD_JOBNXM B ON SF_GET_TAXJOBNO(A.TAXY_MONT,A.TAXX_NUMB) = B.JOBN_NUMB
					LEFT JOIN TA_CUSTXM C ON B.CUST_CODE = C.CUST_CODE
					LEFT JOIN TA_CSTCXM D ON B.PLAN_DEPT = D.DEPT_CODE 
					LEFT JOIN PD_SEQXXM F ON A.TAXY_MONT = F.TAXY_MONT AND A.CUST_CODE = F.CUST_CODE
					LEFT JOIN PD_SEQXXM G ON A.TAXY_MONT = G.TAXY_MONT AND A.MEDA_CODE = G.CLAS_CODE
					LEFT JOIN PD_SATXXD H ON A.TAXX_NUMB = H.TAXX_NUMB AND A.TAXY_MONT = H.TAXY_MONT AND H.TAXX_IDXX = '1'
					LEFT JOIN PD_SEQXXM I ON A.TAXY_MONT = I.TAXY_MONT AND H.JOBN_NUMB = I.JOBN_NUMB
					WHERE 1=1
					AND A.TAXY_MONT = P_TAXY_MONT
					AND A.TAXX_NUMB = P_TAXX_NUMB
					ORDER BY  F.CUST_SEQX, G.CLAS_SEQX, I.JOBN_SEQX
	        ;
	
	        rPD_SATXXH      CUR_PD_SATXXH%ROWTYPE;          /*[세금계산서 정보]*/
	        sSLIP_DATE      TA_SLIPXM.SLIP_DATE%TYPE;   /*발의일자*/
	        sEMPL_NUMB      TA_SLIPXM.EMPL_NUMB%TYPE;   /*입력자*/
	        sDEPT_CODE      TA_SLIPXM.DEPT_CODE%TYPE;   /*입력부서*/
	        sACCT_GUBN      TA_SLIPXM.ACCT_GUBN%TYPE;   /*사업장*/
	        sTITL_NAME      TA_SLIPXM.TITL_NAME%TYPE;   /*대표적요*/
	        nSLIP_LINE      TA_SLIPNT.SLIP_LINE%TYPE;   /*전표순번*/
	
	        nCURS_SEQN      TA_SLIPNT.SLIP_LINE%TYPE;   /*커서SEQ*/
	        
			sSLIP_NUMB      TA_SLIPXM.SLIP_NUMB%TYPE;   /*전표번호*/
	
	    BEGIN
	
        /*======================================================================================
            STEP 1. 전표 생성 여부 체크
        ======================================================================================*/
	        BEGIN
	            OPEN CUR_PD_SATXXH( #TAXY_MONT#     /*계산서년월*/
	                               ,#TAXX_NUMB#     			  /*계산서번호*/
	                               );
	            FETCH CUR_PD_SATXXH INTO rPD_SATXXH;
	            CLOSE CUR_PD_SATXXH;
	
	        END;
	
	        IF NVL(rPD_SATXXH.SACH_NUMB,' ') != ' ' THEN
	            RAISE_APPLICATION_ERROR(-20000, '이미 생성 된  전표(' || rPD_SATXXH.SACH_NUMB || ')가 존재 합니다.');
	        END IF;
	
        /*======================================================================================
            STEP 2. 전표 생성
        ======================================================================================*/
	
	        /* 전표전기일자*/
	        sSLIP_DATE := #POST_DATE#;
	
	        /* 사용자 정보 조회*/
	        /*
	        BEGIN
	            SELECT U.EMPL_NUMB, U.DEPT_CODE, D.ACCT_GUBN
	              INTO   sEMPL_NUMB, sDEPT_CODE, sACCT_GUBN     
	              FROM   HR_MASTXM U
	              LEFT JOIN VI_DEPTXM D
	                ON  D.DEPT_CODE = U.DEPT_CODE
	             WHERE  USER_IDXX = UPDT_USID;
	
	        END;
	        */
	
	        /* 대표적요 구성 */
	        sTITL_NAME := rPD_SATXXH.JOBN_NAME;
	        
			
			 BEGIN
	        
	           	SELECT TO_CHAR(SYSDATE, 'YYYYMMDD')
	           	INTO  sSLIP_DATE
	           	FROM DUAL; 

	         END;
	         
          /* PARAM -----------------------------------------------------
	            2-0. 제작 매출 전표 > SP_MASTER 추가
	      --------------------------------------------------------------*/
		    BEGIN
		        
			PKG_FAMIFSLIP.SP_MASTER_SAVE(#SYST_LNCD#,     	/* ●시스템언어코드*/
										 #UPDT_USID#,      						/* ●수정작업자*/
										 '10',      									/* ●회계단위 */
										 #ACCT_GUBN#,      						/* ●회계구분_사업장 */
										 #POST_DATE#,       					/* ●전표일자(회계일자) */ 
										 #SLIP_GUBN#,      						/* ●전표유형구분 */
										 sTITL_NAME,       						/* ●제목 */
										 #UPDT_USID#,      						/* ●사원번호  */
										 #DEPT_CODE#,	   						/* ●부서코드 */ 						 
										 #SOUS_LNKY#,              				/* ●출처연결키 */
										 NULL,
										 NULL,
										 NULL,
										 NULL,
										 NULL,
										 sSLIP_NUMB);      /* ●전표번호(생성된 전표번호 반환) */
	        END;
	END;
	 	
	]]>
	</insert>
	
	
<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 11
     내      용 : 제작 매출  합산 차변  라인 추가  
********************************************************************************/
 -->
	<insert id="PACA0030.processSP_LINE_SAVE_SL_D" parameterClass="hashmap">
	<![CDATA[
		BEGIN
			  IF #TAXX_AMTX# > 0 THEN
	            BEGIN 
	            
		            PKG_FAMIFSLIP.SP_LINE_SAVE(
	                        #SYST_LNCD#,					/* ●시스템언어코드*/
	                        #UPDT_USID#,					/* ●수정작업자*/
	                        #SLIP_NUMB#,						/* ●전표번호 */
	                        lpad(#SLIP_LINE# , '4', '0'),		/* ●전표라인번호 */
	                        '10',									/* ●회계단위 */
	                        #ACCT_GUBN#,					/* ●회계구분_사업장 */
	                        #DEBT_CODE#,					/* ●계정과목코드 OR 분개코드 */
	                        #PLAN_DEPT#,					/* ●사용부서 */
	                        '',										/* ◎코스트센터코드 */
	                        'D',									/* ●차대구분 */
	                        'KRW',								/* ●통화구분 */
	                        1,										/* ●환율 */
	                        #SUMM_AMTX#,					/* ●외화금액 */
	                        #SUMM_AMTX#,					/* ●전표금액 */
	                        '',										/* ◎상대전표번호 */
	                        '',										/* ◎상대전표순번 */
	                        '',										/* ◎예산구분 */
	                        '',										/* ◎프로젝트코드 */
	                        '',										/* ◎예산품의번호 */
	                        '',										/* ◎예산부서코드 */
	                        '',										/* ◎예산년월 */
	                        '',										/* ◎예산과목코드 */
	                        '',										/* ◎예산세목코드 */
	                         #JOBN_NAME#,					/* ●적요 */
	                        '',										/* ◎증빙종류 */
	                        '',										/* ◎출납처리여부 */
	                        '',										/* ◎지급일 */
	                        '',										/* ◎출납방법 */
	                        '',										/* ◎입출구분 */
	                        '',										/* ◎출력순서 */
	                        lpad(#SLIP_LINE# , '4', '0'),		/* ◎정렬순서 */
	                        '',										/* ◎미사용여분인수1 */
	                        '',										/* ◎미사용여분인수2 */
	                        '',										/* ◎미사용여분인수3 */
	                        '',										/* ◎미사용여분인수4 */
	                        '');										
		                      
                END;	     
 	                
 	                
                 /*==================================================================
					 2-1-1 관리항목 저장  
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,#SLIP_NUMB#      						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0002'      								/* ◎관리항목코드1 */
			      		  ,#CUST_CODE#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	 
 	                
       	           BEGIN
 	                
 	               		UPDATE PD_SATXXH 						
						SET SACH_NUMB = #SLIP_NUMB# 
						WHERE TAXY_MONT = #TAXY_MONT#
						AND TAXX_NUMB = #TAXX_NUMB#
						;
 	                
 	                END;   
 	                
	          END IF;
	          
 	                
	 	END;
                
                
		]]>
	</insert>
	
	
	<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 11
     내      용 : 제작 매출  합산 대변  라인 추가  
********************************************************************************/
 -->
	<insert id="PACA0030.processSP_LINE_SAVE_SL_C" parameterClass="hashmap">
	<![CDATA[
		BEGIN
	        IF #TAXX_AMTX# > 0 THEN		        
	            
	                 BEGIN
	
	                 PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,					/* ●시스템언어코드*/
	                                        #UPDT_USID#,					/* ●수정작업자*/
	                                        #SLIP_NUMB#,						/* ●전표번호 */
	                                        lpad(#SLIP_LINE# , '4', '0'),	/* ●전표라인번호 */
	                                        '10',									/* ●회계단위 */
	                                        #ACCT_GUBN#,	     			/* ●회계구분_사업장 */                                   
	                                        #ACCT_CODE#,					/* 계정과목코드 */
	                                        #PLAN_DEPT#,					/* 사용부서 */
	                                        #CSTC_CODE#,					/* 코스트센터코드 */
	                                        'C',									/* 차대구분 */
	                                        'KRW',								/* 통화구분 */
	                                        1,										/* 환율 */
	                                        #TAXX_AMTX#,					/* 외화금액 */
	                                        #TAXX_AMTX#,					/* 전표금액 */
	                                        '',										/* 상대전표번호 */
	                                        '',										/* 상대전표순번 */
	                                        '',										/* 예산구분 */
	                                        '',										/* 프로젝트코드 */
	                                        '',										/* 예산품의번호 */
	                                        '',										/* 예산부서코드 */
	                                        '',										/* 예산년월 */
	                                        '',										/* 예산과목코드 */
	                                        '',										/* 예산세목코드 */
	                                        #JOBN_NAME# ,			/* 적요 */
	                                        '',  /*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */
	                                        '',										/* 출납처리여부 */
	                                        '',										 /* ◎입출구분 */
	                                        '',										/* 출납처리여부 */
	                                        '',										/* 지급일 */
	                                        '',										/* ◎출력순서 */		
	                                       lpad(#SLIP_LINE# , '4', '0'),		/* 정렬순서 */
	                                        '',
	                                        '',
	                                        '',
	                                        '',
	                                        '');	                
 	                END;

 	                 /*==================================================================
						 2-1-2 관리항목 저장  
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,#SLIP_NUMB#      						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0002'      								/* ◎관리항목코드1 */
					      ,#CUST_CODE#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	  
	
	       END IF;
 	                
	 	END;
                
                
		]]>
	</insert>
	
	
	
	
	<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 12
     내      용 : 제작 매출 합산 부가가치세액 대변 라인 추가  
     
********************************************************************************/
 -->
	<insert id="PACA0030.processSP_LINE_SAVE_VAT_SL" parameterClass="hashmap">
	<![CDATA[
		BEGIN
			IF #TAXX_VATX# > 0 THEN
						PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,						/* ●시스템언어코드*/
	                                        #UPDT_USID#,						/* ●수정작업자*/
	                                        #SLIP_NUMB#,							/* ●전표번호 */
	                                        lpad(#SLIP_LINE# , '4', '0'),		/* ●전표라인번호 */
	                                        '10',										/* ●회계단위 */
	                                        #ACCT_GUBN#,	                	/* ●회계구분_사업장 */                        
	                                        '3221100',								/* ●계정과목코드 OR 분개코드 */
	                                        #PLAN_DEPT#,						/* ●사용부서 */
	                                        '',											/* ◎코스트센터코드 */
	                                        'C',										/* ●차대구분 */
	                                        'KRW',									/* ●통화구분 */
	                                        1,											/* ●환율 */
	                                        #TAXX_VATX#,		    			/* ●외화금액 */
	                                        #TAXX_VATX#,		    			/* ●전표금액 */
	                                        '',											/* ◎상대전표번호 */
	                                        '',											/* ◎상대전표순번 */
	                                        '',											/* ◎예산구분 */
	                                        '',											/* ◎프로젝트코드 */
	                                        '',											/* ◎예산품의번호 */
	                                        '',											/* ◎예산부서코드 */
	                                        '',											/* ◎예산년월 */
	                                        '',											/* ◎예산과목코드 */
	                                        '',											/* ◎예산세목코드 */
	                                        #JOBN_NAME# || ' VAT',				/* ●적요 */
	                                        #DTIX_TYPE#,  						/*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */			
	                                        '',											/* ◎출납처리여부 */
	                                        '',											/* ◎지급일 */
	                                        '',											/* ◎출납방법 */
	                                        '',											/* ◎입출구분 */
	                                        '',											/* ◎출력순서 */
	                                       lpad(#SLIP_LINE# , '4', '0'),			/* ◎정렬순서 */
	                                        '',											/* ◎미사용여분인수1 */
	                                        '',											/* ◎미사용여분인수2 */
	                                        '',											/* ◎미사용여분인수3 */
	                                        '',											/* ◎미사용여분인수4 */
	                                        '');
	                                        
                  /*==================================================================
						 2-1-3  부가가치세매입세액 관리항목 저장  0002 거래처
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 						/* ●시스템언어코드*/
						  ,#UPDT_USID#   					/* ●수정작업자*/
					      ,#SLIP_NUMB#						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')		/* ●전표라인번호 */
					      ,'0002'      							/* ◎관리항목코드1 */
					      ,#CUST_CODE#      				/* ◎관리항목값1 */
					      ,NULL                                  /* ◎관리항목코드2 */
					      ,NULL                                  /* ◎관리항목값2 */
					      ,NULL                                  /* ◎관리항목코드3 */
					      ,NULL                                  /* ◎관리항목값3 */
					      ,NULL                                  /* ◎관리항목코드4 */
					      ,NULL                                  /* ◎관리항목값4 */
					      ,NULL                                  /* ◎관리항목코드5 */
					      ,NULL                                  /* ◎관리항목값5 */
					      ,NULL                                  /* ◎관리항목코드6 */
					      ,NULL                                  /* ◎관리항목값6 */
					      ,NULL                                  /* ◎관리항목코드7 */
					      ,NULL                                  /* ◎관리항목값7 */
					      ,NULL                                  /* ◎관리항목코드8 */
					      ,NULL                                  /* ◎관리항목값8 */
					      ,NULL                                  /* ◎관리항목코드9 */
					      ,NULL                                  /* ◎관리항목값9 */
		      		);       
		      		
		      		 
                END;
                
                 /*==================================================================
					 2-1-3 매출세액 관리항목 0011   사업자(주민)번호
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,#SLIP_NUMB#      						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0011'      								/* ◎관리항목코드1 */
					      ,#BIZR_NUMB#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	  	
                
                  /*==================================================================
					 2-1-3 매출세액 관리항목 0049   과세표준
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,#SLIP_NUMB#      						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0049'      								/* ◎관리항목코드1 */
					      ,#TAXX_AMTX#      					/* ◎관리항목값1 */
					      ,NULL      									/* ◎관리항목값2 */
					      ,NULL      									/* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	      
                
                   /*==================================================================
					 2-1-3 매출세액 관리항목 0067   부가세유형
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,#SLIP_NUMB#      						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0067'      								/* ◎관리항목코드1 */
					      ,#CITY_CODE#     						/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	   
                
                  /*==================================================================
					 2-1-3 매출세액 관리항목 0056   관련항목
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,#SLIP_NUMB#      						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0056'      								/* ◎관리항목코드1 */
					      ,#ACCT_GUBN#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	 
 	
                
	            /*=============================================================
		             2-2-1. 부가세 증빙종류 저장
		          ===============================================================*/

           
                  BEGIN 
             
                  PKG_FAMIFSLIP.SP_LINEVAT_SAVE(
                                   #SYST_LNCD#,   					/* ●시스템언어코드*/
                                   #UPDT_USID#,   					/* ●수정작업자*/
                                   #SLIP_NUMB#,    					/* ●전표번호 */
                                   lpad(#SLIP_LINE# , '4', '0'),    /* ●전표라인번호 */
                                   '',            							/* ◎카드번호 */
                                   '',            							/* ◎카드승인번호 */
                                   #POST_DATE#,   					/* ●전송일(계산서발행일/카드승인일) */
                                   'FA200020',    						/* ●매입매출구분[VATX_GUBN] */
                                   'FA210010',    						/* ●부가세종류[VATX_TYPE] */
                                    '',   									/* ◎부가세유형[PURC_GUBN] */
                                    '',         								/* ◎불공제구분[BULG_GUBN] */
                                 1,         								/* ◎전자발행여부(1.Yes,0.No) */
                                 #CUST_CODE#,        				/* ●거래처코드 */
                                 #MEMO_FILD#,          				/* ●품목명 */
                                 #TAXX_AMTX#,      				/* ●공급가액 */
                                 #TAXX_VATX#,      					/* ●부가세액 */
                                 #TAXX_AMTX# + #TAXX_VATX#,  /* ●합계금액 */
                                 #JOBN_NAME# || ' 외' || 'VAT',      	/* ●적요 */
                                 0,            								/* ◎타사이트발행여부(1.Yes,0.No) */
                                 '',            								/* ◎미사용여분인수1 */
                                 ''             								/* ◎미사용여분인수2 */                                      
                                     );
        
                    END;

			END IF;
	 	END;
	
		]]>
	</insert>
	
	
	
	
	
	<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 02
     내      용 : 제작 매입 합산 처리 마스터 저장 
********************************************************************************/
 -->
	<insert id="PACA0030.MASTER_SAVE" parameterClass="hashmap">
	<![CDATA[
	 
	DECLARE
	       /*PACA0030.MASTER_SAVE.제작 매입 전표 합산 처리*/
			CURSOR CUR_PD_SUJUMD (
	             P_PREE_CODE  IN PD_SUJUMD.PREE_CODE%TYPE   /*견적번호*/
	            ,P_PREE_IDXX  IN PD_SUJUMD.PREE_IDXX%TYPE   /*견적ID*/
	        ) IS
	        
	            SELECT                                             /* PACA0030.PROC02.제작 매입전표처리 미완료 조회[매입전표 처리 미완료] */
				A.SUJU_DATE    AS POST_DATE            /* 전기일자 */
				,A.OUTS_CODE AS CUST_CODE            /* 거래처코드 */
				,B.CUST_NAME                                    /* 거래처명 */
				,D.JOBN_NUMB                                /* 제작번호 */
				,D.JOBN_NAME                                    /* 제작명 */
				,A.MEMO_FILD                                    /* 적요 */
				,NVL(A.SUJU_AMTX,0) AS TAXX_AMTX            /* 금액 */
				,NVL(A.SUJU_AMTX,0)*0.1 AS TAXX_VATX    /* 부가세액 */
				, DECODE(NVL(G.CSTC_CODE,''),NULL,'CC7010041',G.CSTC_CODE) AS COST_CENT /* 코스트센터*/
				, A.SUJU_DATE AS DEND_DATE                    /* 청구일자 */
				, A.SUJU_DATE AS MATU_DATE                    /* 지급기일 */
				, A.SUJU_DATE AS DOCU_DATE                    /* 증빙일자 */
				, E.PUCH_NUMB                                        /* 전표번호 */
				, E.CUST_ANID                                            /* 계좌코드 */
				, CASE F.AGCY_YSNO WHEN 'Y' THEN '5339100'
				  ELSE CASE WHEN D.MEDA_CODE = 'C' THEN '5343100' 
				  WHEN D.MEDA_CODE = 'G' THEN '5343200'
				  ELSE '5343400' END END AS DEBT_CODE /* 차변계정 */
				, CASE WHEN NVL(B.CUTY_CODE,' ') = 'TS100010' THEN '3111110' 
				  ELSE '3111120' END AS ACCT_CODE                  /* 대변계정 */
				, E.EROR_CODE                                        /* 에러코드 */
				, E.EROR_MSGE                                        /* 에러메시지 */
				, A.PREE_CODE                   						/* 견적번호 */
				, A.PREE_IDXX                     					/* 정산ID */
				, D.PLAN_DEPT											/* 담당부서 */
				, NVL(A.SUJU_AMTX,0) - (ROUND(NVL(A.SUJU_AMTX,0) * 0.03) + ROUND((NVL(A.SUJU_AMTX,0) * 0.03)* 0.1)) AS ACCT_AMTX 		/* 개인 모델료 대변금액 */
				, ROUND(NVL(A.SUJU_AMTX,0) * 0.03) AS YESU_AMTX    /* 예수금(자유직업소득세) */
				, ROUND((NVL(A.SUJU_AMTX,0) * 0.03)* 0.1) AS YESU_AMTX2  /* 예수금(자유직업주민세) */
				FROM 
				PD_SUJUMD A 
				LEFT JOIN TA_CUSTXM  B ON A.OUTS_CODE = B.CUST_CODE
				LEFT JOIN PD_SUJUMH C ON A.PREE_CODE = C.PREE_CODE AND A.JOBN_NUMB = C.JOBN_NUMB 
				LEFT JOIN PD_JOBNXM D ON A.JOBN_NUMB = D.JOBN_NUMB
				LEFT JOIN PD_VOCHXM E ON A.PUCH_NUMB = E.PUCH_NUMB AND E.GBNX_FLAG = 'B'
				LEFT JOIN PD_CLASXM F ON B.CUST_CODE = F.CUST_CODE
				LEFT JOIN TA_CSTCXM G ON D.PLAN_DEPT  = G.DEPT_CODE AND G.COST_GUBN IN ('21','22')
				LEFT JOIN TM_OFFICE H ON H.ACCT_GUBN = '100' AND H.OFFI_GUBN ='1'
				WHERE 1=1
				AND NVL(B.BIZR_NUMB,' ') <> H.BSNS_NUMB
				AND A.PREE_CODE = P_PREE_CODE
				AND A.PREE_IDXX = P_PREE_IDXX
	        ;
	
	        rPD_SUJUMD      CUR_PD_SUJUMD%ROWTYPE;          /*[외주정산 데이터]*/
	
	        sSLIP_DATE      TA_SLIPXM.SLIP_DATE%TYPE;   /*발의일자*/
	        sEMPL_NUMB      TA_SLIPXM.EMPL_NUMB%TYPE;   /*입력자*/
	        sDEPT_CODE      TA_SLIPXM.DEPT_CODE%TYPE;   /*입력부서*/
	        sACCT_GUBN      TA_SLIPXM.ACCT_GUBN%TYPE;   /*사업장*/
	        sTITL_NAME      TA_SLIPXM.TITL_NAME%TYPE;   /*대표적요*/
	        nSLIP_LINE      TA_SLIPNT.SLIP_LINE%TYPE;   /*전표순번*/
	
	        nCURS_SEQN      TA_SLIPNT.SLIP_LINE%TYPE;   /*커서SEQ*/
	        
			sSLIP_NUMB      TA_SLIPXM.SLIP_NUMB%TYPE;   /*전표번호*/
	
	    BEGIN
	    
	       /*======================================================================================
            STEP 1. 전표 생성 여부 체크
        ======================================================================================*/
	        BEGIN
	            OPEN CUR_PD_SUJUMD( #PREE_CODE#     /*계산서년월*/
	                               ,#PREE_IDXX#     			  /*계산서번호*/
	                               );
	            FETCH CUR_PD_SUJUMD INTO rPD_SUJUMD;
	            CLOSE CUR_PD_SUJUMD;
	
	            EXCEPTION
	                WHEN OTHERS THEN
	                    RAISE_APPLICATION_ERROR(-20000, '제작 매입 전표 생성 여부 체크 중 오류가 발생하였습니다.'||chr(13)||chr(10)||SQLERRM);
	        END;
	
	        IF NVL(rPD_SUJUMD.PUCH_NUMB, ' ') != ' ' THEN
	            RAISE_APPLICATION_ERROR(-20000, '이미 생성 된  전표(' || rPD_SUJUMD.PUCH_NUMB || ')가 존재 합니다.');
	        END IF;
	        
         /*======================================================================================
            STEP 2. 전표 생성
        ======================================================================================*/
	
	        /* 발의일자 :  전기일자*/
	        sSLIP_DATE := #POST_DATE#;
	
	        /* 사용자 정보 조회*/
	        /*
	        BEGIN
	            SELECT U.EMPL_NUMB, U.DEPT_CODE, D.ACCT_GUBN
	              INTO   sEMPL_NUMB, sDEPT_CODE, sACCT_GUBN     
	              FROM   HR_MASTXM U
	              LEFT JOIN VI_DEPTXM D
	                ON  D.DEPT_CODE = U.DEPT_CODE
	             WHERE  USER_IDXX = UPDT_USID;
	
	            EXCEPTION
	                WHEN NO_DATA_FOUND THEN
	                    RAISE_APPLICATION_ERROR(-20000, '입력자에 대한 정보를 찾을 수 없습니다.'||chr(13)||chr(10)||SQLERRM);
	        END;
	        */
	
	        /* 대표적요 구성 */
	        sTITL_NAME :=  rPD_SUJUMD.JOBN_NAME;
	        
	        
	        
	        /* PARAM -----------------------------------------------------
	            2-0. 제작 매입 전표 > HEADER 추가
	      --------------------------------------------------------------*/
		    BEGIN
		        
			PKG_FAMIFSLIP.SP_MASTER_SAVE(#SYST_LNCD#,     	/* ●시스템언어코드*/
										 #UPDT_USID#,      						/* ●수정작업자*/
										 '10',      									/* ●회계단위 */
										 #ACCT_GUBN#,      						/* ●회계구분_사업장 */
										 #POST_DATE#,       					/* ●전표일자(회계일자) */ 
										 #SLIP_GUBN#,      						/* ●전표유형구분 */
										 sTITL_NAME,       						/* ●제목 */
										 #UPDT_USID#,      						/* ●사원번호  */
										 #DEPT_CODE#,	   						/* ●부서코드 */ 						 
										 #SOUS_LNKY#,              				/* ●출처연결키 */
										 NULL,
										 NULL,
										 NULL,
										 NULL,
										 NULL,
										 sSLIP_NUMB);      /* ●전표번호(생성된 전표번호 반환) */

		        END;
	END;
	

	 	
	]]>
	</insert>
	
	
	
		
<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 02
     내      용 : 제작 매입 합산 대변 합산 급액 라인 추가  
********************************************************************************/
 -->
	<insert id="PACA0030.processSP_LINE_SAVE_C" parameterClass="hashmap">
	<![CDATA[
		BEGIN
			IF #TAXX_AMTX# > 0 THEN
			
							PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,						/* ●시스템언어코드*/
	                                        #UPDT_USID#,						/* ●수정작업자*/
	                                        #SLIP_NUMB#,							/* ●전표번호 */
	                                        lpad(#SLIP_LINE# , '4', '0'),		/* ●전표라인번호 */
	                                        '10',										/* ●회계단위 */
	                                        #ACCT_GUBN#,	                	/* ●회계구분_사업장 */                        
	                                        #ACCT_CODE#,						/* ●계정과목코드 OR 분개코드 */
	                                        #PLAN_DEPT#,						/* ●사용부서 */
	                                        '',											/* ◎코스트센터코드 */
	                                        'C',										/* ●차대구분 */
	                                        'KRW',									/* ●통화구분 */
	                                        1,											/* ●환율 */
	                                        #TAXX_AMTX#,		    			/* ●외화금액 */
	                                        #TAXX_AMTX#,		    			/* ●전표금액 */
	                                        '',											/* ◎상대전표번호 */
	                                        '',											/* ◎상대전표순번 */
	                                        '',											/* ◎예산구분 */
	                                        '',											/* ◎프로젝트코드 */
	                                        '',											/* ◎예산품의번호 */
	                                        '',											/* ◎예산부서코드 */
	                                        '',											/* ◎예산년월 */
	                                        '',											/* ◎예산과목코드 */
	                                        '',											/* ◎예산세목코드 */
	                                        #MEMO_FILD#,						/* ●적요 */
	                                        '',  /*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */			
	                                        '',											/* ◎출납처리여부 */
	                                        '',											/* ◎지급일 */
	                                        '',											/* ◎출납방법 */
	                                        '',											/* ◎입출구분 */
	                                        '',											/* ◎출력순서 */
	                                       lpad(#SLIP_LINE# , '4', '0'),			/* ◎정렬순서 */
	                                        '',											/* ◎미사용여분인수1 */
	                                        '',											/* ◎미사용여분인수2 */
	                                        '',											/* ◎미사용여분인수3 */
	                                        '',											/* ◎미사용여분인수4 */
	                                        '');
	                                        
                     /*==================================================================
						 대변 외상매입금 관리항목 0002 거래처   
					==================================================================*/
                     BEGIN

                     				PKG_FAMIFSLIP.SP_LINERF_SAVE(
							       #SYST_LNCD# 							/* ●시스템언어코드*/
								  ,#UPDT_USID#   						/* ●수정작업자*/
							      ,#SLIP_NUMB#							/* ●전표번호 */
							      ,lpad(#SLIP_LINE# , '4', '0')			/* ●전표라인번호 */
							      ,'0002'      								/* ◎관리항목코드1 */
							      ,#CUST_CODE#      					/* ◎관리항목값1 */
							      ,NULL                                       /* ◎관리항목코드2 */
							      ,NULL                                       /* ◎관리항목값2 */
							      ,NULL                                       /* ◎관리항목코드3 */
							      ,NULL                                       /* ◎관리항목값3 */
							      ,NULL                                       /* ◎관리항목코드4 */
							      ,NULL                                       /* ◎관리항목값4 */
							      ,NULL                                       /* ◎관리항목코드5 */
							      ,NULL                                       /* ◎관리항목값5 */
							      ,NULL                                       /* ◎관리항목코드6 */
							      ,NULL                                       /* ◎관리항목값6 */
							      ,NULL                                       /* ◎관리항목코드7 */
							      ,NULL                                       /* ◎관리항목값7 */
							      ,NULL                                       /* ◎관리항목코드8 */
							      ,NULL                                       /* ◎관리항목값8 */
							      ,NULL                                       /* ◎관리항목코드9 */
							      ,NULL                                       /* ◎관리항목값9 */
				      		);
                     		

                     END;
                     
                      /*==================================================================
						 대변 외상매입금 관리항목 0042 발행일 (승인일)   
					==================================================================*/
                     
                     BEGIN

                     				PKG_FAMIFSLIP.SP_LINERF_SAVE(
							       #SYST_LNCD# 							/* ●시스템언어코드*/
								  ,#UPDT_USID#   						/* ●수정작업자*/
							      ,#SLIP_NUMB#							/* ●전표번호 */
							      ,lpad(#SLIP_LINE# , '4', '0')			/* ●전표라인번호 */
							      ,'0042'      								/* ◎관리항목코드1 */
							      ,#POST_DATE#      					/* ◎관리항목값1 */
							      ,NULL                                       /* ◎관리항목코드2 */
							      ,NULL                                       /* ◎관리항목값2 */
							      ,NULL                                       /* ◎관리항목코드3 */
							      ,NULL                                       /* ◎관리항목값3 */
							      ,NULL                                       /* ◎관리항목코드4 */
							      ,NULL                                       /* ◎관리항목값4 */
							      ,NULL                                       /* ◎관리항목코드5 */
							      ,NULL                                       /* ◎관리항목값5 */
							      ,NULL                                       /* ◎관리항목코드6 */
							      ,NULL                                       /* ◎관리항목값6 */
							      ,NULL                                       /* ◎관리항목코드7 */
							      ,NULL                                       /* ◎관리항목값7 */
							      ,NULL                                       /* ◎관리항목코드8 */
							      ,NULL                                       /* ◎관리항목값8 */
							      ,NULL                                       /* ◎관리항목코드9 */
							      ,NULL                                       /* ◎관리항목값9 */
				      		);
                     	
                     END;
	        END IF;
	 	END;
                
                
		]]>
	</insert>
	
	
	
	<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 02
     내      용 : 제작 매입 합산 차변 합산 급액 라인 추가  
********************************************************************************/
 -->
	<insert id="PACA0030.processSP_LINE_SAVE_D" parameterClass="hashmap">
	<![CDATA[
		BEGIN
				IF #TAXX_AMTX# > 0 THEN
								PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,						/* ●시스템언어코드*/
	                                        #UPDT_USID#,						/* ●수정작업자*/
	                                        #SLIP_NUMB#,							/* ●전표번호 */
	                                        lpad(#SLIP_LINE# , '4', '0'),		/* ●전표라인번호 */
	                                        '1-',						/* ●회계단위 */
	                                        #ACCT_GUBN#,	                	/* ●회계구분_사업장 */                        
	                                        #DEBT_CODE#,						/* ●계정과목코드 OR 분개코드 */
	                                        #PLAN_DEPT#,						/* ●사용부서 */
	                                        #COST_CENT#,						/* ◎코스트센터코드 */
	                                        'D',										/* ●차대구분 */
	                                        'KRW',									/* ●통화구분 */
	                                        1,											/* ●환율 */
	                                        #TAXX_AMTX#,		    			/* ●외화금액 */
	                                        #TAXX_AMTX#,		    			/* ●전표금액 */
	                                        '',											/* ◎상대전표번호 */
	                                        '',											/* ◎상대전표순번 */
	                                        '',											/* ◎예산구분 */
	                                        '',											/* ◎프로젝트코드 */
	                                        '',											/* ◎예산품의번호 */
	                                        '',											/* ◎예산부서코드 */
	                                        '',											/* ◎예산년월 */
	                                        '',											/* ◎예산과목코드 */
	                                        '',											/* ◎예산세목코드 */
	                                        #MEMO_FILD#,							/* ●적요 */
	                                        '',  /*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */			
	                                        '',											/* ◎출납처리여부 */
	                                        '',											/* ◎지급일 */
	                                        '',											/* ◎출납방법 */
	                                        '',											/* ◎입출구분 */
	                                        '',											/* ◎출력순서 */
	                                       lpad(#SLIP_LINE# , '4', '0'),			/* ◎정렬순서 */
	                                        '',											/* ◎미사용여분인수1 */
	                                        '',											/* ◎미사용여분인수2 */
	                                        '',											/* ◎미사용여분인수3 */
	                                        '',											/* ◎미사용여분인수4 */
	                                        '');
	                                        
	                                    
                    /*==================================================================
						차변 관리항목 저장  - 부서
					==================================================================*/
										    
	                   BEGIN
			                   PKG_FAMIFSLIP.SP_LINERF_SAVE(
							       #SYST_LNCD# 						/* ●시스템언어코드*/
								  ,#UPDT_USID#   					/* ●수정작업자*/
							      ,#SLIP_NUMB#      					/* ●전표번호 */
							      ,lpad(#SLIP_LINE# , '4', '0')     	/* ●전표라인번호 */
							      ,'0004'      							/* ◎관리항목코드1 */
							      ,#PLAN_DEPT#      				/* ◎관리항목값1 */
							      ,NULL                                   /* ◎관리항목코드2 */
							      ,NULL                                   /* ◎관리항목값2 */
							      ,NULL                                   /* ◎관리항목코드3 */
							      ,NULL                                   /* ◎관리항목값3 */
							      ,NULL                                   /* ◎관리항목코드4 */
							      ,NULL                                   /* ◎관리항목값4 */
							      ,NULL                                   /* ◎관리항목코드5 */
							      ,NULL                                   /* ◎관리항목값5 */
							      ,NULL                                   /* ◎관리항목코드6 */
							      ,NULL                                   /* ◎관리항목값6 */
							      ,NULL                                   /* ◎관리항목코드7 */
							      ,NULL                                   /* ◎관리항목값7 */
							      ,NULL                                   /* ◎관리항목코드8 */
							      ,NULL                                   /* ◎관리항목값8 */
							      ,NULL                                   /* ◎관리항목코드9 */
							      ,NULL                                   /* ◎관리항목값9 */
				      		);       
	                   
	                   
	                   END;
	                   
	                   
    				/*==================================================================
						차변 관리항목 저장  - 광고주
					==================================================================*/
										    
	                   BEGIN
			                   PKG_FAMIFSLIP.SP_LINERF_SAVE(
							       #SYST_LNCD# 						/* ●시스템언어코드*/
								  ,#UPDT_USID#   					/* ●수정작업자*/
							      ,#SLIP_NUMB#      					/* ●전표번호 */
							      ,lpad(#SLIP_LINE# , '4', '0')     	/* ●전표라인번호 */
							      ,'1001'      							/* ◎관리항목코드1 */
							      ,#CLIENT_CODE#      				/* ◎관리항목값1 */
							      ,NULL                                   /* ◎관리항목코드2 */
							      ,NULL                                   /* ◎관리항목값2 */
							      ,NULL                                   /* ◎관리항목코드3 */
							      ,NULL                                   /* ◎관리항목값3 */
							      ,NULL                                   /* ◎관리항목코드4 */
							      ,NULL                                   /* ◎관리항목값4 */
							      ,NULL                                   /* ◎관리항목코드5 */
							      ,NULL                                   /* ◎관리항목값5 */
							      ,NULL                                   /* ◎관리항목코드6 */
							      ,NULL                                   /* ◎관리항목값6 */
							      ,NULL                                   /* ◎관리항목코드7 */
							      ,NULL                                   /* ◎관리항목값7 */
							      ,NULL                                   /* ◎관리항목코드8 */
							      ,NULL                                   /* ◎관리항목값8 */
							      ,NULL                                   /* ◎관리항목코드9 */
							      ,NULL                                   /* ◎관리항목값9 */
				      		);       
	                   
	                   
	                   END;	                        
	                   
	                   
	                        /*==================================================================
								 2-1-2  차변  관리항목 저장  거래처 필요
							==================================================================*/ 
		                 BEGIN 
		                  	
		                  	PKG_FAMIFSLIP.SP_LINERF_SAVE(
							       #SYST_LNCD# 							/* ●시스템언어코드*/
								  ,#UPDT_USID#   						/* ●수정작업자*/
							      ,#SLIP_NUMB#      						/* ●전표번호 */
							      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
							      ,'0002'      								/* ◎관리항목코드1 */
							      ,#CUST_CODE#      					/* ◎관리항목값1 */
							      ,NULL                                       /* ◎관리항목코드2 */
							      ,NULL                                       /* ◎관리항목값2 */
							      ,NULL                                       /* ◎관리항목코드3 */
							      ,NULL                                       /* ◎관리항목값3 */
							      ,NULL                                       /* ◎관리항목코드4 */
							      ,NULL                                       /* ◎관리항목값4 */
							      ,NULL                                       /* ◎관리항목코드5 */
							      ,NULL                                       /* ◎관리항목값5 */
							      ,NULL                                       /* ◎관리항목코드6 */
							      ,NULL                                       /* ◎관리항목값6 */
							      ,NULL                                       /* ◎관리항목코드7 */
							      ,NULL                                       /* ◎관리항목값7 */
							      ,NULL                                       /* ◎관리항목코드8 */
							      ,NULL                                       /* ◎관리항목값8 */
							      ,NULL                                       /* ◎관리항목코드9 */
							      ,NULL                                       /* ◎관리항목값9 */
				      		);
				      			
		
		                END;	                     
				END IF;
				
			/*======================================================================================
	                STEP 3. 매출 전표번호 업데이트
								 및 전표 테이블에 저장 
            ======================================================================================*/
            
              UPDATE PD_SUJUMD
			  SET PUCH_NUMB = #SLIP_NUMB#
			  WHERE 1=1
			  AND PREE_CODE = #PREE_CODE#
			  AND PREE_IDXX = #PREE_IDXX#
			  ;
            
		      EXCEPTION
	             WHEN OTHERS THEN
	                RAISE;
	                
	 	END;
	 	

		]]>
	</insert>
	
	
	<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 02
     내      용 : 제작 매입 합산 부가가치세액 처리 차변  
********************************************************************************/
 -->
	<insert id="PACA0030.processSP_LINE_SAVE_VAT" parameterClass="hashmap">
	<![CDATA[
		BEGIN
			IF #TAXX_VATX# > 0 THEN
						PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,						/* ●시스템언어코드*/
	                                        #UPDT_USID#,						/* ●수정작업자*/
	                                        #SLIP_NUMB#,							/* ●전표번호 */
	                                        lpad(#SLIP_LINE# , '4', '0'),		/* ●전표라인번호 */
	                                        '10',										/* ●회계단위 */
	                                        #ACCT_GUBN#,	                	/* ●회계구분_사업장 */                        
	                                        '3221200',								/* ●계정과목코드 OR 분개코드 */
	                                        #PLAN_DEPT#,						/* ●사용부서 */
	                                        '',											/* ◎코스트센터코드 */
	                                        'D',										/* ●차대구분 */
	                                        'KRW',									/* ●통화구분 */
	                                        1,											/* ●환율 */
	                                        #TAXX_VATX#,		    			/* ●외화금액 */
	                                        #TAXX_VATX#,		    			/* ●전표금액 */
	                                        '',											/* ◎상대전표번호 */
	                                        '',											/* ◎상대전표순번 */
	                                        '',											/* ◎예산구분 */
	                                        '',											/* ◎프로젝트코드 */
	                                        '',											/* ◎예산품의번호 */
	                                        '',											/* ◎예산부서코드 */
	                                        '',											/* ◎예산년월 */
	                                        '',											/* ◎예산과목코드 */
	                                        '',											/* ◎예산세목코드 */
	                                        #MEMO_FILD# || 'VAT',				/* ●적요 */
	                                        'FA180010',  							/*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */			
	                                        '',											/* ◎출납처리여부 */
	                                        '',											/* ◎지급일 */
	                                        '',											/* ◎출납방법 */
	                                        '',											/* ◎입출구분 */
	                                        '',											/* ◎출력순서 */
	                                       lpad(#SLIP_LINE# , '4', '0'),			/* ◎정렬순서 */
	                                        '',											/* ◎미사용여분인수1 */
	                                        '',											/* ◎미사용여분인수2 */
	                                        '',											/* ◎미사용여분인수3 */
	                                        '',											/* ◎미사용여분인수4 */
	                                        '');
	                                        
                      /*==================================================================
						 2-1-3 매출세액 관리항목 0002   거래처
					==================================================================*/ 
	                 BEGIN 
	                	
						PKG_FAMIFSLIP.SP_LINERF_SAVE(
						       #SYST_LNCD# 							/* ●시스템언어코드*/
							  ,#UPDT_USID#   						/* ●수정작업자*/
						      ,#SLIP_NUMB#      						/* ●전표번호 */
						      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
						      ,'0002'      								/* ◎관리항목코드1 */
						      ,#CUST_CODE#      					/* ◎관리항목값1 */
						      ,NULL      									/* ◎관리항목코드2 */
						      ,NULL                                       /* ◎관리항목값2 */
						      ,NULL                                       /* ◎관리항목코드3 */
						      ,NULL                                       /* ◎관리항목값3 */
						      ,NULL                                       /* ◎관리항목코드4 */
						      ,NULL                                       /* ◎관리항목값4 */
						      ,NULL                                       /* ◎관리항목코드5 */
						      ,NULL                                       /* ◎관리항목값5 */
						      ,NULL                                       /* ◎관리항목코드6 */
						      ,NULL                                       /* ◎관리항목값6 */
						      ,NULL                                       /* ◎관리항목코드7 */
						      ,NULL                                       /* ◎관리항목값7 */
						      ,NULL                                       /* ◎관리항목코드8 */
						      ,NULL                                       /* ◎관리항목값8 */
						      ,NULL                                       /* ◎관리항목코드9 */
						      ,NULL                                       /* ◎관리항목값9 */
			      		);       
			      		
	                END;
                
                 /*==================================================================
					 2-1-3 매출세액 관리항목 0011   사업자(주민)번호
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,#SLIP_NUMB#      						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0011'      								/* ◎관리항목코드1 */
					      ,#BIZR_NUMB#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	  	
                
                  /*==================================================================
					 2-1-3 매출세액 관리항목 0049   과세표준
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,#SLIP_NUMB#      						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0049'      								/* ◎관리항목코드1 */
					      ,#TAXX_AMTX#      					/* ◎관리항목값1 */
					      ,NULL      									/* ◎관리항목값2 */
					      ,NULL      									/* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	      
                
                   /*==================================================================
					 2-1-3 매출세액 관리항목 0067   부가세유형
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,#SLIP_NUMB#      						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0067'      								/* ◎관리항목코드1 */
					      ,#CITY_CODE2#     					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	   
                
                  /*==================================================================
					 2-1-3 매출세액 관리항목 0056   관련항목
				==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 							/* ●시스템언어코드*/
						  ,#UPDT_USID#   						/* ●수정작업자*/
					      ,#SLIP_NUMB#      						/* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0056'      								/* ◎관리항목코드1 */
					      ,#ACCT_CODE#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
                END;	
                
	            /*=============================================================
		             2-2-1. 부가세 증빙종류 저장
		          ===============================================================*/

                  BEGIN 
             
                  PKG_FAMIFSLIP.SP_LINEVAT_SAVE(
                                   #SYST_LNCD#,   					/* ●시스템언어코드*/
                                   #UPDT_USID#,   					/* ●수정작업자*/
                                   #SLIP_NUMB#,    					/* ●전표번호 */
                                   lpad(#SLIP_LINE# , '4', '0'),    /* ●전표라인번호 */
                                   '',            							/* ◎카드번호 */
                                   '',            							/* ◎카드승인번호 */
                                   #POST_DATE#,   					/* ●전송일(계산서발행일/카드승인일) */
                                   'FA200010',    						/* ●매입매출구분[VATX_GUBN] */
                                   'FA210010',    						/* ●부가세종류[VATX_TYPE] */
                                    '',   									/* ◎부가세유형[PURC_GUBN] */
                                    '',         								/* ◎불공제구분[BULG_GUBN] */
                                 1,         								/* ◎전자발행여부(1.Yes,0.No) */
                                 #CUST_CODE#,        				/* ●거래처코드 */
                                 #JOBN_NAME#,          				/* ●품목명 */
                                 #TAXX_AMTX#,      				/* ●공급가액 */
                                 #TAXX_VATX#,      					/* ●부가세액 */
                                 #TAXX_AMTX# + #TAXX_VATX#,     /* ●합계금액 */
                                 #MEMO_FILD#,          				/* ●적요 */
                                 0,            								/* ◎타사이트발행여부(1.Yes,0.No) */
                                 '',            								/* ◎미사용여분인수1 */
                                 ''             								/* ◎미사용여분인수2 */                                      
                                     );
        
                    END;

			END IF;
	 	END;
	
		]]>
	</insert>
	
	
	
	<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 06
     내      용 : 제작 매입 합산 전표 마무리  
********************************************************************************/
 -->
	<insert id="PACA0030.processSP_FINISH" parameterClass="hashmap">
	<![CDATA[
		  BEGIN
				    
			         PKG_FAMIFSLIP.SP_FINISH(
					        #SYST_LNCD# 		/* ●시스템언어코드*/
					       ,#UPDT_USID#   		/* ●수정작업자*/
						   ,#SLIP_NUMB#			/* ●전표번호 */
					    );

            END;
	
		]]>
	</insert>
	
	
	
			
<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 16
     내      용 : 제작 매입 대변 자유직업소득세  
********************************************************************************/
 -->
	<insert id="PACA0030.processSP_LINE_SAVE_C_YESU" parameterClass="hashmap">
	<![CDATA[
	BEGIN
         /*=============================================================
	           LINE 추가 > (대변)> 대변 예수금 (자유직업소득세)
	        ===============================================================*/
	        IF #TAXX_AMTX# > 0 THEN		        
	                 BEGIN
	
	                 PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,						/* ●시스템언어코드*/
	                                        #UPDT_USID#,						/* ●수정작업자*/
	                                        #SLIP_NUMB#,							/* ●전표번호 */
	                                        lpad(#SLIP_LINE# , '4', '0'),		/* ●전표라인번호 */
	                                        '10',										/* ●회계단위 */
	                                        #ACCT_GUBN#,	                	/* ●회계구분_사업장 */                        
	                                        '3171700',								/* ●계정과목코드 OR 분개코드 */
	                                        '000000',									/* ●사용부서 */
	                                        '',											/* ◎코스트센터코드 */
	                                        'C',										/* ●차대구분 */
	                                        'KRW',									/* ●통화구분 */
	                                        1,											/* ●환율 */
	                                        #YESU_AMTX#,		    			/* ●외화금액 */
	                                        #YESU_AMTX#,		    			/* ●전표금액 */
	                                        '',											/* ◎상대전표번호 */
	                                        '',											/* ◎상대전표순번 */
	                                        '',											/* ◎예산구분 */
	                                        '',											/* ◎프로젝트코드 */
	                                        '',											/* ◎예산품의번호 */
	                                        '',											/* ◎예산부서코드 */
	                                        '',											/* ◎예산년월 */
	                                        '',											/* ◎예산과목코드 */
	                                        '',											/* ◎예산세목코드 */
	                                        #MEMO_FILD# || ' 자유직업 소득세',	 			/* ●적요 */
	                                        '',  										/*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */			
	                                        '',											/* ◎출납처리여부 */
	                                        '',											/* ◎지급일 */
	                                        '',											/* ◎출납방법 */
	                                        '',											/* ◎입출구분 */
	                                        '',											/* ◎출력순서 */
	                                       lpad(#SLIP_LINE# , '4', '0'),			/* ◎정렬순서 */
	                                        '',											/* ◎미사용여분인수1 */
	                                        '',											/* ◎미사용여분인수2 */
	                                        '',											/* ◎미사용여분인수3 */
	                                        '',											/* ◎미사용여분인수4 */
	                                        '');
	                                        
	                                        
 	                END;
 	                
 	                    
                   /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0004 부서   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,#SLIP_NUMB#      		                /* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0004'      								/* ◎관리항목코드1 */
					      ,#PLAN_DEPT#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	 
 	                
 	                
 	                /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0011 사업자(주민)번호   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,#SLIP_NUMB#      		                /* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0011'      								/* ◎관리항목코드1 */
					      ,#BIZR_NUMB#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;
 	                
 	                 /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0049 과세표준   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,#SLIP_NUMB#      		                /* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0049'      								/* ◎관리항목코드1 */
					      ,#TAXX_AMTX#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	
 	                
 	                /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0042 발행일   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,#SLIP_NUMB#      		                /* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0042'      								/* ◎관리항목코드1 */
					      ,#POST_DATE#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;		    
	
	 				/*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0024 세율   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,#SLIP_NUMB#      		                /* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0024'      								/* ◎관리항목코드1 */
					      ,'3'      										/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	
	       END IF;
	  END;	
                
		]]>
	</insert>
	
	
	
	<!-- 
/*******************************************************************************
     작  성  자 : 오세훈
     작  성  일 : 2017. 01. 16
     내      용 : 제작 매입 대변 자유직업주민세  
********************************************************************************/
 -->
	<insert id="PACA0030.processSP_LINE_SAVE_C_YESU2" parameterClass="hashmap">
	<![CDATA[
	
	BEGIN
         /*=============================================================
	           LINE 추가 > (대변)> 대변 예수금 (자유직업주민세)
	        ===============================================================*/
	        IF #TAXX_AMTX# > 0 THEN		        
	            
	                 BEGIN
	
	                 PKG_FAMIFSLIP.SP_LINE_SAVE(
	                                        #SYST_LNCD#,						/* ●시스템언어코드*/
	                                        #UPDT_USID#,						/* ●수정작업자*/
	                                        #SLIP_NUMB#,							/* ●전표번호 */
	                                        lpad(#SLIP_LINE# , '4', '0'),		/* ●전표라인번호 */
	                                        '10',										/* ●회계단위 */
	                                        #ACCT_GUBN#,	                	/* ●회계구분_사업장 */                        
	                                        '3171800',								/* ●계정과목코드 OR 분개코드 */
	                                        '000000',									/* ●사용부서 */
	                                        '',											/* ◎코스트센터코드 */
	                                        'C',										/* ●차대구분 */
	                                        'KRW',									/* ●통화구분 */
	                                        1,											/* ●환율 */
	                                        #YESU_AMTX2#,		    			/* ●외화금액 */
	                                        #YESU_AMTX2#,		    			/* ●전표금액 */
	                                        '',											/* ◎상대전표번호 */
	                                        '',											/* ◎상대전표순번 */
	                                        '',											/* ◎예산구분 */
	                                        '',											/* ◎프로젝트코드 */
	                                        '',											/* ◎예산품의번호 */
	                                        '',											/* ◎예산부서코드 */
	                                        '',											/* ◎예산년월 */
	                                        '',											/* ◎예산과목코드 */
	                                        '',											/* ◎예산세목코드 */
	                                        #MEMO_FILD# || ' 자유직업 주민세',				/* ●적요 */
	                                        '',  										/*cic 임시 증빙종류인데 부가세 라인 생성시 필요함 */			
	                                        '',											/* ◎출납처리여부 */
	                                        '',											/* ◎지급일 */
	                                        '',											/* ◎출납방법 */
	                                        '',											/* ◎입출구분 */
	                                        '',											/* ◎출력순서 */
	                                       lpad(#SLIP_LINE# , '4', '0'),			/* ◎정렬순서 */
	                                        '',											/* ◎미사용여분인수1 */
	                                        '',											/* ◎미사용여분인수2 */
	                                        '',											/* ◎미사용여분인수3 */
	                                        '',											/* ◎미사용여분인수4 */
	                                        '');
	                                        
	                                        
 	                END;
 	                
 	                    
                   /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0004 부서   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,#SLIP_NUMB#      		                /* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0004'      								/* ◎관리항목코드1 */
					      ,#PLAN_DEPT#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	 
 	                
 	                
 	                /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0011 사업자(주민)번호   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,#SLIP_NUMB#      		                /* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0011'      								/* ◎관리항목코드1 */
					      ,#BIZR_NUMB#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;
 	                
 	                 /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0049 과세표준   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,#SLIP_NUMB#      		                /* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0049'      								/* ◎관리항목코드1 */
					      ,#YESU_AMTX#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	
 	                
 	                /*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0042 발행일 
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,#SLIP_NUMB#      		                /* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0042'      								/* ◎관리항목코드1 */
					      ,#POST_DATE#      					/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;		    
	
	 				/*==================================================================
						 2-1-2  대변 예수금 (자유직업 소득세) 관리항목 0024 세율   
					==================================================================*/ 
                 BEGIN 
                	
					PKG_FAMIFSLIP.SP_LINERF_SAVE(
					       #SYST_LNCD# 			                /* ●시스템언어코드*/
						  ,#UPDT_USID#   		                /* ●수정작업자*/
					      ,#SLIP_NUMB#      		                /* ●전표번호 */
					      ,lpad(#SLIP_LINE# , '4', '0')     		/* ●전표라인번호 */
					      ,'0024'      								/* ◎관리항목코드1 */
					      ,'10'      										/* ◎관리항목값1 */
					      ,NULL                                       /* ◎관리항목코드2 */
					      ,NULL                                       /* ◎관리항목값2 */
					      ,NULL                                       /* ◎관리항목코드3 */
					      ,NULL                                       /* ◎관리항목값3 */
					      ,NULL                                       /* ◎관리항목코드4 */
					      ,NULL                                       /* ◎관리항목값4 */
					      ,NULL                                       /* ◎관리항목코드5 */
					      ,NULL                                       /* ◎관리항목값5 */
					      ,NULL                                       /* ◎관리항목코드6 */
					      ,NULL                                       /* ◎관리항목값6 */
					      ,NULL                                       /* ◎관리항목코드7 */
					      ,NULL                                       /* ◎관리항목값7 */
					      ,NULL                                       /* ◎관리항목코드8 */
					      ,NULL                                       /* ◎관리항목값8 */
					      ,NULL                                       /* ◎관리항목코드9 */
					      ,NULL                                       /* ◎관리항목값9 */
		      		);       
		      		
 	                END;	
	       END IF;
	END;	
                
		]]>
	</insert>
	
	
	<!-- 
      작  성  자 : 오세훈
    작  성  일 : 2016.11.11
    내      용 : 제작 매출 전표 삭제 
    파라미터   :  			  	
   -->
	<delete id="PACA0030.DELETE00" parameterClass="hashmap">
	<![CDATA[		
			 DECLARE
				BEGIN
				
				    
			         PKG_FAMIFSLIP.SP_DELETE(
					        #SYST_LNCD# 		/* ●시스템언어코드*/
					       ,#UPDT_USID#    		/* ●수정작업자*/
						   ,#SACH_NUMB#   		/* ●전표번호 */
						   ,''  						 	/* ◎삭제옵션 */
					    );
					    
   	                   DELETE  FROM PD_VOCHXM
						WHERE 1=1
						AND SACH_NUMB = #SACH_NUMB#
						;
	                   
	                   UPDATE  PD_SATXXH
	                   SET SACH_NUMB = ''
						WHERE 1=1
						AND SACH_NUMB = #SACH_NUMB#
						;
					    
	           END;
          
					   
	]]>		
	</delete>
	
	
<!-- 
      작  성  자 : 오세훈
    작  성  일 : 2016.11.11
    내      용 : 제작 매입 전표 삭제 
    파라미터   :  			  	
   -->
	<delete id="PACA0030.DELETE01" parameterClass="hashmap">
	<![CDATA[		
			 DECLARE
				BEGIN
				    
			         PKG_FAMIFSLIP.SP_DELETE(
					        #SYST_LNCD# 			/* ●시스템언어코드*/
					       ,#UPDT_USID#   			/* ●수정작업자*/
						   ,#PUCH_NUMB#   			/* ●전표번호 */
						   ,''  						 		/* ◎삭제옵션 */
					    );
					    
					    
				     DELETE  FROM PD_VOCHXM
						WHERE 1=1
						AND PUCH_NUMB = #PUCH_NUMB#
						;
	                   
	                   UPDATE  PD_SUJUMD
	                   SET PUCH_NUMB = ''
						WHERE 1=1
						AND PUCH_NUMB = #PUCH_NUMB#
						;
					    
	            END;
		       	
	]]>		
	</delete>

	
	
	<!-- 전표테이블 ID 채번 -->
	<select id="PACA0030.getSEQX_IDXX" resultClass="String">			
			SELECT 
			NVL(MAX(CAST(SEQX_IDXX AS NUMERIC)),0)+1  
			FROM PD_VOCHXM
			WHERE 1=1
	</select>
	
	
		<!-- 전표 번호 가져오기 -->
	<select id="PACA0030.processSLIP_NUMB" resultClass="String">			
			
			SELECT MAX(SLIP_NUMB) FROM TA_SLIPXM
			WHERE 1=1
			AND SOUS_LNKY = #sSOUS_LNKY#
			GROUP BY SOUS_LNKY
			
						
	</select>
	
	
</sqlMap>


