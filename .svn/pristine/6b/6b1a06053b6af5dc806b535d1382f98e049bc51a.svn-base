<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
		"http://ibatis.apache.org/dtd/sql-map-2.dtd">                              
                                                                                                                      
<sqlMap namespace="TXMC0160">
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(1페이지) 조회
******************************************************************************* */
-->
    <select id="TXMC0160.SEARCH00" parameterClass="hashmap" resultClass="hashmap">
    	<![CDATA[ 
            SELECT  /* TXMC0160.SEARCH00.부가가치세신고서(1페이지) 조회 */
                   A.BRANCH_CD 					    /* VAT_지점코드 */
                 , A.VAT_YYYY 						/* VAT_VAT년도 */
                 , A.VAT_QUARTER 					/* VAT_VAT분기 */
                 , A.VAT_SYMD 						/* VAT_과세기간_시작일 */
                 , A.VAT_EYMD 						/* VAT_과세기간_종료일 */
                 , A.VAT_CYMD 						/* VAT_작성일자 */
                 , A.USER_ID 						/* VAT_사용자아이디 */
                 , A.CORP_NO 						/* VAT_법인번호 */
                 , A.CORP_CELL 					    /* VAT_사업자휴대전화 */
                 , A.CORP_EMAIL 					/* VAT_전자메일주소 */
                 , A.CORP_NM 						/* VAT_법인명 */
                 , A.CORP_MASTER 					/* VAT_대표자명 */
                 , A.CORP_LOCATION 				    /* VAT_사업장소재지 */
                 , A.CORP_TEL 						/* VAT_사업장전화번호 */
                 , A.CORP_ADDR 					    /* VAT_사업자주소 */
                 , A.CORP_TYPENM 					/* VAT_업태명 */
                 , A.CORP_LINE 					    /* VAT_종목명 */
                 , A.CORP_TYPECD 					/* VAT_업종코드 */
                 , A.CORP_SYMD 					    /* VAT_개업년월일 */
                 , A.AGENT_NM 						/* VAT_세무대리인성명 */
                 , A.AGENT_NO 						/* VAT_세무대리인관리번호 */
                 , A.AGENT_TEL 					    /* VAT_세무대리인전화번호 */
                 , A.AGENT_BIZNO 					/* VAT_세무대리인사업자번호 */
                 , A.REVISION_TYPECD 				/* VAT_보정신고구분 */
                 , A.SH_TAXBIL_SAMT 				/* VAT_과표신고과세세금계산서금액 */
                 , A.SH_TAXBIL_VAMT 				/* VAT_과표신고과세세금계산서세액 */
                 , A.SH_PURPUB_SAMT 				/* VAT_과표신고과세매입자발행금액 */
                 , A.SH_PURPUB_VAMT 				/* VAT_과표신고과세매입자발행세액 */
                 , A.SH_CRECAS_SAMT 				/* VAT_과표신고신용카드현금영수증금액 */
                 , A.SH_CRECAS_VAMT 				/* VAT_과표신고신용카드현금영수증세액 */
                 , A.SH_TAXETC_SAMT 				/* VAT_과표신고과세기타금액 */
                 , A.SH_TAXETC_VAMT 				/* VAT_과표신고과세기타세액 */
                 , A.SH_ZERBIL_SAMT 				/* VAT_과표신고영세세금계산서금액 */
                 , A.SH_ZERETC_SAMT 				/* VAT_과표신고영세기타금액 */
                 , A.SH_WILMIS_SAMT 				/* VAT_과표예정신고누락분금액 */
                 , A.SH_WILMIS_VAMT 				/* VAT_과표예정신고누락분세액 */
                 , A.SH_DOUADD_SAMT 				/* VAT_대손세액가감금액 */
                 , A.SH_DOUADD_VAMT 				/* VAT_대손세액가감세액 */
                 , A.SALTOT_SAMT 					/* VAT_과세표준 */
                 , A.SALTOT_VAMT 					/* VAT_산출세액 */
                 , A.PH_TAXBIL_SAMT 				/* VAT_매입수취일반금액 */
                 , A.PH_TAXBIL_VAMT 				/* VAT_매입수취일반세액 */
                 , A.PH_ASSETS_SAMT 				/* VAT_매입수취고정자산금액 */
                 , A.PH_ASSETS_VAMT				    /* VAT_매입수취고정자산세액 */
                 , A.PH_WILTOT_SAMT				    /* VAT_매입예정신고누락금액 */
                 , A.PH_WILTOT_VAMT				    /* VAT_매입예정신고누락세액 */
                 , A.PH_PURPUB_SAMT				    /* VAT_매입매입자발행금액 */
                 , A.PH_PURPUB_VAMT				    /* VAT_매입매입자발행세액 */
                 , A.PH_ETCBIL_SAMT				    /* VAT_매입기타공제금액 */
                 , A.PH_ETCBIL_VAMT				    /* VAT_매입기타공제세액 */
                 , A.PH_PTOTAL_SAMT				    /* VAT_매입금액합계 */
                 , A.PH_PTOTAL_VAMT				    /* VAT_매입세액합계 */
                 , A.PH_UNABLE_SAMT				    /* VAT_매입공제받지못할금액 */
                 , A.PH_UNABLE_VAMT				    /* VAT_매입공제받지못할세액 */
                 , A.PH_ADDMIN_SAMT				    /* VAT_차감매입금액 */
                 , A.PH_ADDMIN_VAMT				    /* VAT_차감매입세액 */
                 , A.SP_RETURN_VAMT				    /* VAT_납부및환급세액 */
                 , A.RH_ETCMIN_VAMT				    /* VAT_기타공제_경감세액 */
                 , A.RH_CREDIT_SAMT				    /* VAT_금전신용공제금액 */
                 , A.RH_CREDIT_VAMT				    /* VAT_금전신용공제세액 */
                 , A.RH_MINTOT_VAMT				    /* VAT_경감세액계 */
                 , A.RH_WILRET_VAMT				    /* VAT_예정미환급세액 */
                 , A.RH_NOTRET_VAMT				    /* VAT_예정고지세액 */
                 , A.RH_PROHIB_VAMT				    /* VAT_금지금매입자납부특례기납부세액 */
                 , A.RH_ADDTOT_VAMT				    /* VAT_가산세계 */
                 , A.VAT_REF_VAMT					/* VAT_실차감납부할세액 */
                 , A.IH_EXCEPT_SAMT				    /* VAT_과세수입금액제외금액 */
                 , A.IH_TAXBIL_SAMT				    /* VAT_과세수입금액합계 */
                 , A.PH_EXPOST_VAMT                 /* VAT_매입수취수출기업수입분납부유예세액              */
              FROM TA_VAT101_H1 A 					/* [부가가치세_헤더_1쪽] */
             WHERE A.BRANCH_CD = #ACCT_GUBN# 		/* VAT_지점코드 */
               AND A.VAT_YYYY = #VAT_YYYY# 			/* VAT_VAT년도 */
               AND A.VAT_QUARTER = #VAT_QUARTER# 	/* VAT_VAT분기 */
    ]]> 
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(2페이지) 조회
******************************************************************************* */
-->
    <select id="TXMC0160.SEARCH01" parameterClass="hashmap" resultClass="hashmap">
		<![CDATA[
            SELECT  /* TXMC0160.SEARCH01.부가가치세신고서(2페이지) 조회 */
                   A.BRANCH_CD						/* VAT_지점코드 */
                 , A.VAT_YYYY						/* VAT_VAT년도 */
                 , A.VAT_QUARTER					/* VAT_VAT분기 */
                 , A.SW_TAXBIL_SAMT				    /* VAT_과표예정과세세금계산서금액 */
                 , A.SW_TAXBIL_VAMT				    /* VAT_과표예정과세세금계산서세액 */
                 , A.SW_TAXETC_SAMT				    /* VAT_과표예정과세기타금액 */
                 , A.SW_TAXETC_VAMT				    /* VAT_과표예정과세기타세액 */
                 , A.SW_ZERBIL_SAMT				    /* VAT_과표예정영세세금계산서금액 */
                 , A.SW_ZERETC_SAMT				    /* VAT_과표예정영세기타금액 */
                 , A.SW_SALTOT_SAMT				    /* VAT_과표예정신고누락분금액합계 */
                 , A.SW_SALTOT_VAMT				    /* VAT_과표예정신고누락분세액합계 */
                 , A.PW_TAXBIL_SAMT				    /* VAT_예정매입세금계산서누락금액 */
                 , A.PW_TAXBIL_VAMT				    /* VAT_예정매입세금계산서누락세액 */
                 , A.PW_ETCBIL_SAMT				    /* VAT_예정매입기타공제누락세액금액 */
                 , A.PW_ETCBIL_VAMT				    /* VAT_예정매입기타공제누락세액세액 */
                 , A.PW_PURTOT_SAMT				    /* VAT_예정매입누락합계금액 */
                 , A.PW_PURTOT_VAMT				    /* VAT_예정매입누락합계세액 */
                 , A.PD_CREDIT_SAMT				    /* VAT_매입금전신용금액 */
                 , A.PD_CREDIT_VAMT				    /* VAT_매입금전신용세액 */
                 , A.PD_AGENDA_SAMT				    /* VAT_매입의제매입금액 */
                 , A.PD_AGENDA_VAMT				    /* VAT_매입의제매입세액 */
                 , A.PD_RECYCL_SAMT				    /* VAT_매입재활용금액 */
                 , A.PD_RECYCL_VAMT				    /* VAT_매입재활용세액 */
                 , A.PD_CONVER_VAMT				    /* VAT_과세사업전환매입세액 */
                 , A.PD_ALAGEN_SAMT				    /* VAT_매입고금의제매입금액 */
                 , A.PD_ALAGEN_VAMT				    /* VAT_매입고금의제매입세액 */
                 , A.PD_ASSETS_SAMT				    /* VAT_매입신용고정자산금액 */
                 , A.PD_ASSETS_VAMT				    /* VAT_매입신용고정자산세액 */
                 , A.PD_STOCKP_VAMT				    /* VAT_매입재고매입세액 */
                 , A.PD_BADDEP_VAMT				    /* VAT_매입변제대손세액 */
                 , A.PD_PURTOT_SAMT				    /* VAT_기타공제매입금액합계 */
                 , A.PD_PURTOT_VAMT				    /* VAT_기타공제매입세액합계 */
                 , A.PN_UNABLE_SAMT				    /* VAT_불공제매입금액 */
                 , A.PN_UNABLE_VAMT				    /* VAT_불공제매입세액총액 */
                 , A.PN_EXCEPT_SAMT				    /* VAT_공통매입면세사업금액 */
                 , A.PN_EXCEPT_VAMT				    /* VAT_공통매입면세사업세액 */
                 , A.PN_DOUADD_SAMT				    /* VAT_대손처분금액 */
                 , A.PN_DOUADD_VAMT				    /* VAT_대손처분세액 */
                 , A.PN_PURTOT_SAMT				    /* VAT_매입공제받지못할금액합계 */
                 , A.PN_PURTOT_VAMT				    /* VAT_매입공제받지못할세액합계 */
                 , A.RD_EBIPAY_VAMT				    /* VAT_전자신고공제세액 */
                 , A.RD_EBITAX_VAMT				    /* VAT_전자세금계산서발급세액공제세액 */
                 , A.RD_TAXICO_VAMT				    /* VAT_택시사업부가가치세경감세액 */
                 , A.RD_CASBIL_VAMT				    /* VAT_현금영수증사업자공제세액 */
                 , A.RD_ETCBIL_VAMT				    /* VAT_기타경감공제세액명세기타세액 */
                 , A.AD_BIZMIS_SAMT				    /* VAT_사업자등록가산금액 */
                 , A.AD_BIZMIS_VAMT				    /* VAT_사업자등록가산세 */
                 , A.AD_EBIDEL_SAMT				    /* VAT_세금계산서지연발급등가산금액 */
                 , A.AD_EBIDEL_VAMT				    /* VAT_세금계산서지연발급등가산세액 */
                 , A.AD_NOTPUB_SAMT				    /* VAT_세금계산서미발급등가산금액 */
                 , A.AD_NOTPUB_VAMT				    /* VAT_세금계산서미발급등가산세액 */
                 , A.AD_EBIOVE_SAMT				    /* VAT_ebill전송가산금액_다음달15일후 */
                 , A.AD_EBIOVE_VAMT				    /* VAT_ebill전송가산세액_다음달15일후 */
                 , A.AD_EBIEXC_SAMT				    /* VAT_ebill전송가산금액_과세다음달15일후 */
                 , A.AD_EBIEXC_VAMT				    /* VAT_ebill전송가산세액_과세다음달15일후 */
                 , A.AD_TAXBIL_SAMT				    /* VAT_세금계산서합계표가산금액 */
                 , A.AD_TAXBIL_VAMT				    /* VAT_세금계산서합계표가산세액 */
                 , A.AD_REPORT_SAMT				    /* VAT_신고불성실가산금액 */
                 , A.AD_REPORT_VAMT				    /* VAT_신고불성실가산세액 */
                 , A.AD_NOSEND_SAMT				    /* VAT_납부불성실가산금액 */
                 , A.AD_NOSEND_VAMT				    /* VAT_납부불성실가산세액 */
                 , A.AD_ZERBIL_SAMT				    /* VAT_영세율신고가산금액 */
                 , A.AD_ZERBIL_VAMT				    /* VAT_영세율신고가산세액 */
                 , A.AD_CASNOT_SAMT				    /* VAT_현금매출명세서미제출등가산금액 */
                 , A.AD_CASNOT_VAMT				    /* VAT_현금매출명세서미제출등가산세액 */
                 , A.AD_ADDTOT_VAMT				    /* VAT_가산세세액계 */
                 , A.DF_EXCEPT_SAMT				    /* VAT_면세수입금액제외금액 */
                 , A.DF_TAXBIL_SAMT				    /* VAT_면세수입금액합계 */
                 , A.BD_SALTOT_SAMT				    /* VAT_계산서발급금액 */
                 , A.BD_PURTOT_SAMT				    /* VAT_계산서수취금액 */
                 , A.REFUND_TYPECD					/* VAT_환급구분 */
                 , A.VAT_BANKCD					    /* VAT_국세환급금은행코드 */
                 , A.VAT_BANKNO					    /* VAT_국세환급금계좌번호 */
                 , A.VAT_TOTPAYNO					/* VAT_총괄납부승인번호 */
                 , A.VAT_BANKBRANCH				    /* VAT_은행지점명 */
                 , A.CORP_EYMD						/* VAT_폐업일자 */
                 , A.CLOSING_REMARK				    /* VAT_폐업사유 */
                 , A.VAT_REF_VAMT					/* VAT_실차감납부할세액 */
                 , A.VAT_NTAX_TYPECD				/* VAT_일반과세자구분 */
                 , A.VAT_EARLY_TYPECD				/* VAT_조기환급취소구분 */
                 , A.CORP_TYPENM					/* VAT_업태명 */
                 , A.CORP_LINE						/* VAT_종목명 */
                 , A.CORP_TYPECD					/* VAT_업종코드 */
                 , A.BRANCH_APPRNO					/* VAT_사업자단위과세승인번호 */
                 , A.AD_TAXDEL_SAMT				    /* VAT_세금계산서합계표지연제출금액 */
                 , A.AD_TAXDEL_VAMT				    /* VAT_세금계산서합계표지연제출세액 */
                 , A.AD_REPOR1_SAMT				    /* VAT_신고불성실_무신고(일반)금액 */
                 , A.AD_REPOR1_VAMT				    /* VAT_신고불성실_무신고(일반)세액 */
                 , A.AD_REPOR2_SAMT				    /* VAT_신고불성실_무신고(부당)금액 */
                 , A.AD_REPOR2_VAMT				    /* VAT_신고불성실_무신고(부당)세액 */
                 , A.AD_REPOR3_SAMT				    /* VAT_과소·초과환급신고(일반)금액 */
                 , A.AD_REPOR3_VAMT				    /* VAT_과소·초과환급신고(일반)세액 */
                 , A.AD_REPOR4_SAMT				    /* VAT_과소·초과환급신고(부당)금액 */
                 , A.AD_REPOR4_VAMT				    /* VAT_과소·초과환급신고(부당)세액 */
                 , A.AD_ESTATE_SAMT				    /* VAT_부동산임대공급가액명세서 불성실금액 */
                 , A.AD_ESTATE_VAMT				    /* VAT_부동산입대공급가액명세서 불성실세액 */
                 , A.AD_EBDERV_SAMT				    /* VAT_세금계산서지연수취가산금액 */
                 , A.AD_EBDERV_VAMT				    /* VAT_세금계산서지연수취가산세액 */
                 , A.PD_FOREINER_VAMT			    /* VAT_매입외국인관광객환급세액 */
                 , A.AD_ACCNOT_SAMT				    /* VAT_거래계좌미사용가산금액 */
                 , A.AD_ACCNOT_VAMT				    /* VAT_거래계좌미사용가산세액 */
                 , A.AD_ACCDELAY_SAMT				/* VAT_거래계좌지연입금가산금액 */
                 , A.AD_ACCDELAY_VAMT				/* VAT_거래계좌지연입금가산세액 */
              FROM TA_VAT101_H2 A					/* [부가가치세_헤더_2쪽] */
             WHERE A.BRANCH_CD = #ACCT_GUBN#		/* VAT_지점코드 */
               AND A.VAT_YYYY = #VAT_YYYY#			/* VAT_VAT년도 */
               AND A.VAT_QUARTER = #VAT_QUARTER#	/* VAT_VAT분기 */
		]]>
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(과세표준 명세) 조회
******************************************************************************* */
-->
    <select id="TXMC0160.SEARCH02" parameterClass="hashmap" resultClass="hashmap">
		<![CDATA[
            SELECT /* TXMC0160.SEARCH02.부가가치세신고서(과세표준 명세) 조회 */
                   A.BRANCH_CD						/* VAT_지점코드 */
                 , A.VAT_YYYY						/* VAT_VAT년도 */
                 , A.VAT_QUARTER					/* VAT_VAT분기 */
                 , A.INCOME_SEQ					    /* VAT_수입금액라인 */
                 , A.INCOME_TYPECD					/* VAT_수입금액종류구분 */
                 , A.CORP_TYPENM					/* VAT_업태명 */
                 , A.CORP_LINE						/* VAT_종목명 */
                 , A.CORP_TYPECD					/* VAT_업종코드 */
                 , A.INCOME_SAMT					/* VAT_수입금액 */
              FROM TA_VAT101_D A					/* [부가가치세_세부_수입금액] */
             WHERE A.BRANCH_CD = #ACCT_GUBN#		/* VAT_지점코드 */
               AND A.VAT_YYYY = #VAT_YYYY#			/* VAT_VAT년도 */
               AND A.VAT_QUARTER = #VAT_QUARTER#	/* VAT_VAT분기 */
		]]> 
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(과세표준 명세 수입금액제외분) 조회 
******************************************************************************* */
-->
    <select id="TXMC0160.SEARCH06" parameterClass="hashmap" resultClass="hashmap">
		<![CDATA[
            SELECT /* TXMC0160.SEARCH06.부가가치세신고서(과세표준 명세 수입금액제외분) 조회 */
                   A.BRANCH_CD						/* VAT_지점코드 */
                 , A.VAT_YYYY						/* VAT_VAT년도 */
                 , A.VAT_QUARTER					/* VAT_VAT분기 */
                 , A.INCOME_SEQ					    /* VAT_수입금액라인 */
                 , A.INCOME_TYPECD					/* VAT_수입금액종류구분 */
                 , A.CORP_TYPENM					/* VAT_업태명 */
                 , A.CORP_LINE						/* VAT_종목명 */
                 , A.CORP_TYPECD					/* VAT_업종코드 */
                 , A.INCOME_SAMT					/* VAT_수입금액 */
              FROM TA_VAT101_D A					/* [부가가치세_세부_수입금액] */
             WHERE A.BRANCH_CD = #ACCT_GUBN#		/* VAT_지점코드 */
               AND A.VAT_YYYY = #VAT_YYYY#			/* VAT_VAT년도 */
               AND A.VAT_QUARTER = #VAT_QUARTER#	/* VAT_VAT분기 */
               AND INCOME_TYPECD = '2'
		]]>
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 인적사항 조회  
******************************************************************************* */
-->
    <select id="TXMC0160.SEARCH07" parameterClass="hashmap" resultClass="hashmap">
    <![CDATA[ 
        SELECT /* TXMC0160.SEARCH07.인적사항 조회 */
               #ACCT_GUBN# AS BRANCH_CD   /* VAT_지점코드 */
             , #VAT_YYYY# AS VAT_YYYY   /* VAT_VAT년도 */ 
             , #VAT_QUARTER# AS VAT_QUARTER   /* VAT_VAT분기 */ 
             , A.BIZ_NO              /* VAT_사업자번호 */
             , A.BRANCH_NM   /* VAT_지점명 */
             , A.CORP_NO   /* VAT_법인번호 */
             , A.CORP_NM   /* VAT_법인명 */
             , A.CORP_TYPENM   /* VAT_업태명 */
             , A.CORP_LINE   /* VAT_종목명 */
             , A.CORP_MASTER   /* VAT_대표자명 */
             , A.CORP_ADDR   /* VAT_사업자주소 */
             , A.CORP_TEL   /* VAT_사업장전화번호 */
             , A.CORP_CELL   /* VAT_사업자휴대전화 */
          FROM VA_VATBRANCH A
         WHERE A.BRANCH_CD = #ACCT_GUBN#
    ]]> 
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(1페이지) 처리
******************************************************************************* */
-->
    <select id="TXMC0160.PROC03" parameterClass="hashmap" resultClass="hashmap">
    <![CDATA[ 
    DECLARE
        /* TXMC0160.PROC03.부가가치세신고서(1페이지) 처리 */
        sSql VARCHAR2(10000);
    
        iREF1_FILD VARCHAR2(100);
        iREF2_FILD VARCHAR2(100);
        iCOMD_CDNM VARCHAR2(80);
        iVAT_SAMT  NUMBER(17);
        iVAT_VAMT  NUMBER(17);
    
        VAT_REPORT VARCHAR2(256);
    BEGIN

             /* TEMPORARY TABLE 제거됨에 따라 DELETE먼저... 
                TRANSACTION 관리되므로 중복 없음! */
             DELETE FROM TA_VAT101_D_TEMP ;
             DELETE FROM TA_VAT101_H2_TEMP ;
             DELETE FROM TA_VAT101_H1_TEMP ;
                                          
             /* 일단 임시 부가세 테이블(TA_VAT101_H1_TEMP)에 기본 정보를 INSERT 한다. */
             INSERT INTO TA_VAT101_H1_TEMP (                                               
                    BRANCH_CD                               /* 지점코드         */
                  , VAT_YYYY                                /* VAT년도          */
                  , VAT_QUARTER                             /* VAT분기          */
                  , VAT_SYMD                                /* 과세기간_시작일  */
                  , VAT_EYMD                                /* 과세기간_종료일  */
                  , VAT_CYMD                                /* 작성일자         */
                  , USER_ID                                 /* 사용자아이디     */
                  , CORP_NO                                 /* 법인번호         */
                  , CORP_CELL                               /* 사업자휴대전화   */
                  , CORP_EMAIL                              /* 전자메일주소     */
                  , CORP_NM                                 /* 법인명           */
                  , CORP_MASTER                             /* 대표자명         */
                  , CORP_LOCATION                           /* 사업장소재지     */
                  , CORP_TEL                                /* 사업장전화번호   */
                  , CORP_ADDR                               /* 사업자주소       */
                  , CORP_TYPENM                             /* 업태명           */
                  , CORP_LINE                               /* 종목명           */
                  , CORP_TYPECD                             /* 업종코드         */
                  , CORP_SYMD                               /* 개업년월일       */
                  , AGENT_NM                                /* 세무대리인성명   */
                  , AGENT_NO                                /* 세무대리인관리번호 */
                  , AGENT_TEL                               /* 세무대리인전화번호 */
                  , AGENT_BIZNO                             /* 세무대리인사업자번호 */
                  , REVISION_TYPECD                         /* 보정신고구분     */
             )                                              
             SELECT #ACCT_GUBN# AS BRANCH_CD                /* 지점코드 */
                  , #VAT_YYYY# AS VAT_YYYY                  /* VAT년도 */
                  , #VAT_QUARTER# AS VAT_QUARTER            /* VAT분기 */
                  , #VAT_YYYY# || DECODE(#VAT_QUARTER#, '1', '0101', '2', '0401', '3', '0701', '4', '1001') AS VAT_SYMD        /* 과세기간_시작일 */
                  , #VAT_YYYY# || DECODE(#VAT_QUARTER#, '1', '0331', '2', '0630', '3', '1031', '4', '1231') AS VAT_EYMD        /* 과세기간_종료일 */
                  , TO_CHAR(SYSDATE,'YYYYMMDD') AS VAT_CYMD /* 작성일자 */
                  , A.HOMETAX_ID AS USER_ID                 /* 사용자아이디       */
                  , A.BIZ_NO                                /* 법인번호 사업자번호 */
                  , A.CORP_CELL                             /* 사업자휴대전화     */
                  , A.CORP_EMAIL                            /* 전자메일주소       */
                  , A.BRANCH_NM AS CORP_NM                  /* 법인명             */
                  , A.CORP_MASTER                           /* 대표자명           */
                  , A.CORP_ADDR AS CORP_LOCATION            /* 사업장소재지       */
                  , A.CORP_TEL                              /* 사업장전화번호     */
                  , A.CORP_ADDR                             /* 사업자주소         */
                  , A.CORP_TYPENM                           /* 업태명             */
                  , A.CORP_LINE                             /* 종목명             */
                  , A.CORP_TYPECD                           /* 업종코드           */
                  , A.CORP_SYMD                             /* 개업년월일         */
                  , A.AGENT_NM                              /* 세무대리인성명     */
                  , A.AGENT_NO                              /* 세무대리인관리번호 */
                  , A.AGENT_TEL                             /* 세무대리인전화번호 */
                  , A.AGENT_BIZNO                           /* 세무대리인사업자번호 */
                  , A.REVISION_TYPECD                       /* 보정신고구분       */
               FROM VA_VATBRANCH A                          
              WHERE A.BRANCH_CD = #ACCT_GUBN#   
              ;                                              
    
             /* 해당 과세기간의 부가세 1PAGE 항목에 대한 금액을 모두 가져온다. */
             FOR VAT_REPORT IN
             (
                  SELECT A.REF1_FILD        /* 부가세 항목 순서 */
                       , A.REF2_FILD        /* 부가세 신고 항목 */
                       , A.COMD_CDNM        /* 부가세 신고서 항목명(신고서 페이지당 DS ROW가 하나이기 때문에 항목명은 그리드에 셋팅한다.) */
                       , SUM(SUB.VAT_SAMT) AS VAT_SAMT    /* 공급가액 */
                       , SUM(SUB.VAT_VAMT) AS VAT_VAMT    /* 세엑 */
                       , A.SORT_ORDR        /* 정렬순서 */
                    FROM TM_CODEXD A
                         LEFT JOIN (
                                    SELECT A.VAT_SAMT
                                         , A.VAT_VAMT
                                         , C.APPL_V101
                                      FROM TA_VATRAW A
                                           LEFT JOIN TA_VATCDH B
                                                  ON A.VATH_TYPECD = B.VATH_TYPECD
                                           LEFT JOIN TA_VATCDD C
                                                  ON A.VATH_TYPECD = C.VATH_TYPECD
                                                 AND A.VATD_TYPECD = C.VATD_TYPECD
                                     WHERE A.BRANCH_CD = #ACCT_GUBN#
                                       AND A.VAT_YYYY = #VAT_YYYY#
                                       AND A.VAT_QUARTER = #VAT_QUARTER#
                                 ) SUB
                                /* APPL_V101에는 여러항목, A.REF2_FILD 에는 한가지 항목만 있기 때문에 LIKE로 걸어준다. */
                                ON SUB.APPL_V101 LIKE CONCAT(CONCAT('%', A.REF2_FILD), '%')
                   WHERE A.COMM_CODE = 'VATX_COMM' /* 부가세신고_공통코드 */
                     AND A.REF1_FILD <= 4         /* 1페이지 항목만을 불러온다 */
                     AND A.REF2_FILD IS NOT NULL
                GROUP BY A.REF1_FILD
                       , A.REF2_FILD
                       , A.COMD_CDNM
                       , A.SORT_ORDR
                ORDER BY A.SORT_ORDR
              ) LOOP
    
                iREF1_FILD := VAT_REPORT.REF1_FILD;
                iREF2_FILD := VAT_REPORT.REF2_FILD;
                iCOMD_CDNM := VAT_REPORT.COMD_CDNM;
                iVAT_SAMT  := VAT_REPORT.VAT_SAMT;
                iVAT_VAMT  := VAT_REPORT.VAT_VAMT;
    
    
                /* ****************************************************************************
                항목이 추가되어 구분자가 추가될 경우에는 여기에 추가한다.
                SAMT 만 쓰는 경우 VAMT UPDATE 부분에 <> 추가
                VAMT 만 쓰는 경우 SAMT UPDATE 부분에 <> 추가
                **************************************************************************** */
                /* 각 항목에 대한 값을 업데이트 한다(공급가액) */
                /* 필드 존재 여부로 판단하지 말고 항목 구분자로 판단하여 구분자가 잘못 셋팅되어있을 경우 EXCEPTION 에서 확인한다. */
                /* rd_ebitax(전자세금계산서발급세액공제세액)은 기타신고서에서 바로 가져온다. */
                IF iREF2_FILD <> 'rh_wilret' AND iREF2_FILD <> 'rh_notret' AND iREF2_FILD <> 'rh_prohib'
               AND iREF2_FILD <> 'rh_etcmin' AND iREF2_FILD <> 'rd_ebitax' AND iREF2_FILD <> 'rh_proxy' THEN
	               		
						sSql :=         '  UPDATE TA_VAT101_H1_TEMP                                         ' || CHR(13);
						sSql := sSql || '     SET '||iREF2_FILD||'_SAMT = '''||iVAT_SAMT||'''               ' || CHR(13);
	                
		                IF iREF2_FILD IS NOT NULL THEN 
							EXECUTE IMMEDIATE sSql;
		                END IF;   
                  
                END IF;
    
                /* 각 항목에 대한 값을 업데이트 한다(세액) */
                /* 필드 존재 여부로 판단하지 말고 항목 구분자로 판단하여 구분자가 잘못 셋팅되어있을 경우 EXCEPTION 에서 확인한다. */
                /* rd_ebitax(전자세금계산서발급세액공제세액)은 기타신고서에서 바로 가져온다. */
                IF iREF2_FILD <> 'sh_zerbil' AND iREF2_FILD <> 'sh_zeretc'
               AND iREF2_FILD <> 'ih_except' AND iREF2_FILD <> 'rd_ebitax'  THEN
               
                  	sSql :=         '  UPDATE TA_VAT101_H1_TEMP                                         ' || CHR(13);
                  	sSql := sSql || '     SET '||iREF2_FILD||'_VAMT = '''||iVAT_VAMT||'''               ' || CHR(13);

                	IF iREF2_FILD IS NOT NULL THEN
                  		EXECUTE IMMEDIATE sSql;
               		END IF;
                
                END IF;
             END LOOP;
    
             /* 신고서 상의 합계 또는 차감 금액을 계산한다. */
    
             /* 전자세금계산서발급세액공제신고서 금액(세액)을 추가적으로 더해준다. */
             UPDATE TA_VAT101_H1_TEMP
                SET RH_ETCMIN_VAMT = NVL(RH_ETCMIN_VAMT, 0) + (SELECT NVL(EXCEPT_VAMT, 0) /* 해당공제세액 */
                                                                 FROM TA_VAT171_H
                                                                WHERE BRANCH_CD = #ACCT_GUBN#
                                                                  AND VAT_YYYY = #VAT_YYYY#
                                                                  AND VAT_QUARTER = #VAT_QUARTER#
                                                               );
    
             /* 과세표준(9), 산출세액(가) */
             UPDATE TA_VAT101_H1_TEMP
                SET SALTOT_SAMT = (SELECT NVL(SH_TAXBIL_SAMT, 0) + NVL(SH_PURPUB_SAMT, 0) + NVL(SH_CRECAS_SAMT, 0) + NVL(SH_TAXETC_SAMT, 0)
                                           + NVL(SH_ZERBIL_SAMT, 0) + NVL(SH_ZERETC_SAMT, 0) + NVL(SH_WILMIS_SAMT, 0) /* + NVL(SH_DOUADD_SAMT, 0) */
                                     FROM TA_VAT101_H1_TEMP)
                  , SALTOT_VAMT = (SELECT NVL(SH_TAXBIL_VAMT, 0) + NVL(SH_PURPUB_VAMT, 0) + NVL(SH_CRECAS_VAMT, 0) + NVL(SH_TAXETC_VAMT, 0)
                                           + NVL(SH_WILMIS_VAMT, 0) + NVL(SH_DOUADD_VAMT, 0)
                                     FROM TA_VAT101_H1_TEMP);
    
             /* 과세 수입금액 합계(30) = 과세표준 */
             UPDATE TA_VAT101_H1_TEMP
                SET IH_TAXBIL_SAMT = (SELECT NVL(saltot_samt, 0)
                                        FROM TA_VAT101_H1_TEMP);
    
             /* 매입금액합계(15), 매입세액합계(15) */
             UPDATE TA_VAT101_H1_TEMP
                SET PH_PTOTAL_SAMT = (SELECT NVL(PH_TAXBIL_SAMT, 0) + NVL(PH_ASSETS_SAMT, 0) + NVL(PH_WILTOT_SAMT, 0) + NVL(PH_PURPUB_SAMT, 0)
                                           + NVL(PH_ETCBIL_SAMT, 0)
                                        FROM TA_VAT101_H1_TEMP)
                  , PH_PTOTAL_VAMT = (SELECT NVL(PH_TAXBIL_VAMT, 0) + NVL(PH_ASSETS_VAMT, 0) + NVL(PH_WILTOT_VAMT, 0) + NVL(PH_PURPUB_VAMT, 0)
                                           + NVL(PH_ETCBIL_VAMT, 0)
                                        FROM TA_VAT101_H1_TEMP);
    
             /* 차감매입금액(17), 차감매입세액(나) */
             UPDATE TA_VAT101_H1_TEMP
                SET PH_ADDMIN_SAMT = (SELECT NVL(PH_PTOTAL_SAMT, 0) - NVL(PH_UNABLE_SAMT, 0)
                                        FROM TA_VAT101_H1_TEMP)
                  , PH_ADDMIN_VAMT = (SELECT NVL(PH_PTOTAL_VAMT, 0) - NVL(PH_UNABLE_VAMT, 0)
                                        FROM TA_VAT101_H1_TEMP);
    
             /* 납부및환급세액(다)[매출세액(가) - (매입세액(나)] */
             UPDATE TA_VAT101_H1_TEMP
                SET SP_RETURN_VAMT = (SELECT NVL(saltot_vamt, 0) - NVL(PH_ADDMIN_VAMT, 0)
                                        FROM TA_VAT101_H1_TEMP);
    
             /* 경감세액계(라) */
             UPDATE TA_VAT101_H1_TEMP
                SET RH_MINTOT_VAMT = (SELECT NVL(RH_ETCMIN_VAMT, 0) + NVL(RH_CREDIT_VAMT, 0)
                                        FROM TA_VAT101_H1_TEMP);
    
             /* 전자신고공제세액(확정일 경우) */
             IF #VAT_QUARTER# = '2' OR #VAT_QUARTER# = '4' THEN
                UPDATE TA_VAT101_H1_TEMP
                SET RH_MINTOT_VAMT = RH_MINTOT_VAMT + 10000;
    
                UPDATE TA_VAT101_H1_TEMP
                SET RH_ETCMIN_VAMT = RH_ETCMIN_VAMT + 10000;
             END IF;

             /* 전자세금계산서(매출) 지연분만 가져오자. */
             UPDATE TA_VAT101_H1_TEMP
                SET RH_ADDTOT_VAMT = (
                                      SELECT Round(SUM(OFF_SAMT) * 3 / 1000, 0)
                                        FROM TA_VAT104_D
                                       WHERE BRANCH_CD = #ACCT_GUBN#
                                         AND VAT_YYYY = #VAT_YYYY#
                                         AND VAT_QUARTER = #VAT_QUARTER#
                                         AND DELAYYN = 'Y'
                                         AND BILL_TYPECD = '1'
                                      );
    
             /* 차감납부할세액(25)[(다)-(라)-(마)-(바)-(사)+(아)] */
             UPDATE TA_VAT101_H1_TEMP
                SET VAT_REF_VAMT = (SELECT NVL(SP_RETURN_VAMT, 0) - NVL(RH_MINTOT_VAMT, 0) - NVL(RH_WILRET_VAMT, 0) - NVL(RH_NOTRET_VAMT, 0)
                                         - NVL(RH_PROXY_VAMT, 0) - NVL(RH_PROHIB_VAMT, 0) + NVL(RH_ADDTOT_VAMT, 0)
                                      FROM TA_VAT101_H1_TEMP);
           
       END;                         
    ]]> 
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(2페이지) 처리 
******************************************************************************* */
-->
    <!-- 
     작  성  자 : 한동조
     작  성  일 : 2013.08.27
     내      용 : 부가가치세신고서(2페이지) 처리
     파라미터   :                   
     -->
    <select id="TXMC0160.PROC04" parameterClass="hashmap" resultClass="hashmap">
    <![CDATA[ 
    DECLARE /* TXMC0160.PROC04 부가가치세신고서(2페이지) 처리 */
        sSql VARCHAR2(10000);
    
        iREF1_FILD VARCHAR2(100);
        iREF2_FILD VARCHAR2(100);
        iCOMD_CDNM VARCHAR2(80);
        iVAT_SAMT  NUMBER(17);
        iVAT_VAMT  NUMBER(17);
    
        VAT_REPORT VARCHAR2(256);
        
    BEGIN	
             /* TEMPORARY TABLE 제거됨에 따라 DELETE먼저... 
                TRANSACTION 관리되므로 중복 없음! */
             DELETE FROM TA_VAT101_H2_TEMP ;
             
             /* 일단 임시 부가세 테이블(TA_VAT101_H2_TEMP)에 기본 정보를 INSERT 한다. */
             INSERT INTO TA_VAT101_H2_TEMP (                                               
                    BRANCH_CD                               /* 지점코드             */
                  , VAT_YYYY                                /* VAT년도              */
                  , VAT_QUARTER                             /* VAT분기              */
                  , REFUND_TYPECD                           /* 환급구분             */
                  , VAT_BANKCD                              /* 국세환급금은행코드   */
                  , VAT_BANKNO                              /* 국세환급금계좌번호   */
                  , VAT_TOTPAYNO                            /* 총괄납부승인번호     */
                  , VAT_BANKBRANCH                          /* 은행지점명           */
                  , CORP_EYMD                               /* 폐업일자             */
                  , CLOSING_REMARK                          /* 폐업사유             */
                  , VAT_NTAX_TYPECD                         /* 일반과세자구분       */
                  , VAT_EARLY_TYPECD                        /* 조기환급취소구분     */
                  , CORP_TYPENM                             /* 업태명               */
                  , CORP_LINE                               /* 종목명               */
                  , CORP_TYPECD                             /* 업종코드             */
                  , BRANCH_APPRNO                           /* 사업자단위과세승인번호 */
             )                                                     
             SELECT #ACCT_GUBN# AS BRANCH_CD                /* 지점코드             */
                  , #VAT_YYYY# AS VAT_YYYY                  /* VAT년도              */
                  , #VAT_QUARTER# AS VAT_QUARTER            /* VAT분기              */
                  , A.REFUND_TYPECD                         /* 환급구분             */
                  , A.VAT_BANKCD                            /* 국세환급금은행코드   */
                  , A.VAT_BANKNO                            /* 국세환급금계좌번호   */
                  , A.VAT_TOTPAYNO                          /* 총괄납부승인번호     */
                  , A.VAT_BANKBRANCH                        /* 은행지점명           */
                  , A.CORP_EYMD                             /* 폐업일자             */
                  , A.CLOSING_REMARK                        /* 폐업사유             */
                  , A.VAT_NTAX_TYPECD                       /* 일반과세자구분       */
                  , A.VAT_EARLY                             /* 조기환급취소구분     */
                  , B.CORP_TYPENM                           /* 업태명               */
                  , B.CORP_LINE                             /* 종목명               */
                  , B.CORP_TYPECD                           /* 업종코드             */
                  , A.VAT_UNITTAXNO                         /* 사업자단위과세승인번호 */
               FROM VA_VATBRANCH A                    
                    INNER JOIN TA_VATUPJ   B          /* [부가업종] */      
                            ON B.BIZ_TYPE_CD = '4'                                     
              WHERE A.BRANCH_CD = #ACCT_GUBN#      
              ;                                              
    
         /* 해당 과세기간의 부가세 2PAGE 항목에 대한 금액을 모두 가져온다. */
         FOR VAT_REPORT IN (
             SELECT A.REF1_FILD        /* 부가세 항목 순서 */
                  , A.REF2_FILD        /* 부가세 신고 항목 */
                  , A.COMD_CDNM        /* 부가세 신고서 항목명(신고서 페이지당 DS ROW가 하나이기 때문에 항목명은 그리드에 셋팅한다.) */
                  , SUM(SUB.VAT_SAMT) AS VAT_SAMT    /* 공급가액 */
                  , SUM(SUB.VAT_VAMT) AS VAT_VAMT    /* 세엑 */
                  , A.SORT_ORDR        /* 정렬순서 */
               FROM TM_CODEXD A
                    LEFT JOIN (
                               SELECT A.VAT_SAMT
                                    , A.VAT_VAMT
                                    , C.APPL_V101
                                 FROM TA_VATRAW A
                                      LEFT JOIN TA_VATCDH B
                                             ON A.VATH_TYPECD = B.VATH_TYPECD
                                      LEFT JOIN TA_VATCDD C
                                             ON A.VATH_TYPECD = C.VATH_TYPECD
                                            AND A.VATD_TYPECD = C.VATD_TYPECD
                                WHERE A.BRANCH_CD = #ACCT_GUBN#
                                  AND A.VAT_YYYY = #VAT_YYYY#
                                  AND A.VAT_QUARTER = #VAT_QUARTER#
                  ) SUB
                 /* APPL_V101에는 여러항목, A.REF2_FILD 에는 한가지 항목만 있기 때문에 LIKE로 걸어준다. */
                 ON SUB.APPL_V101 LIKE CONCAT(CONCAT('%',A.REF2_FILD),'%')
              WHERE A.COMM_CODE = 'VATX_COMM'
                AND A.REF1_FILD > 4         /* 2페이지 항목만을 불러온다 */
                AND A.REF2_FILD IS NOT NULL
              GROUP BY A.REF1_FILD
                  , A.REF2_FILD
                  , A.COMD_CDNM
                  , A.SORT_ORDR
              ORDER BY A.SORT_ORDR
          ) LOOP

            iREF1_FILD := VAT_REPORT.REF1_FILD;
            iREF2_FILD := VAT_REPORT.REF2_FILD;
            iCOMD_CDNM := VAT_REPORT.COMD_CDNM;
            iVAT_SAMT  := VAT_REPORT.VAT_SAMT;
            iVAT_VAMT  := VAT_REPORT.VAT_VAMT;

            /* ****************************************************************************
            항목이 추가되어 구분자가 추가될 경우에는 여기에 추가한다.
            SAMT 만 쓰는 경우 VAMT UPDATE 부분에 <> 추가
            VAMT 만 쓰는 경우 SAMT UPDATE 부분에 <> 추가
            **************************************************************************** */
            /* 각 항목에 대한 값을 업데이트 한다(공급가액) */
            /* 필드 존재 여부로 판단하지 말고 항목 구분자로 판단하여 구분자가 잘못 셋팅되어있을 경우 EXCEPTION 에서 확인한다. */
            IF iREF2_FILD <> 'pd_conver' AND iREF2_FILD <> 'pd_stockp' AND iREF2_FILD <> 'pd_baddep'
           AND iREF2_FILD <> 'rd_ebipay' AND iREF2_FILD <> 'rd_ebitax' AND iREF2_FILD <> 'rd_taxico'
           AND iREF2_FILD <> 'rd_casbil' AND iREF2_FILD <> 'rd_etcbil' AND iREF2_FILD <> 'ad_addtot' 
           AND iREF2_FILD <> 'pd_foreiner'THEN

	             	sSql :=         '  UPDATE TA_VAT101_H2_TEMP                                         ' || CHR(13);
              		sSql := sSql || '     SET '||iREF2_FILD||'_SAMT = '''||iVAT_SAMT||'''               ' || CHR(13);
              	
              	            	
            		IF iREF2_FILD IS NOT NULL THEN
              			EXECUTE IMMEDIATE sSql;
            		END IF;
            		
            END IF;

            /* 각 항목에 대한 값을 업데이트 한다(세액) */
            /* 필드 존재 여부로 판단하지 말고 항목 구분자로 판단하여 구분자가 잘못 셋팅되어있을 경우 EXCEPTION 에서 확인한다. */
            IF iREF2_FILD <> 'sw_zeretc' AND iREF2_FILD <> 'sw_zerbil' AND iREF2_FILD <> 'df_taxbil' 
           AND iREF2_FILD <> 'df_except' AND iREF2_FILD <> 'bd_saltot' AND iREF2_FILD <> 'bd_purtot'
           AND iREF2_FILD <> 'rd_ebitax' THEN
	             
             		sSql :=         '  UPDATE TA_VAT101_H2_TEMP                                         ' || CHR(13);
            		sSql := sSql || '     SET '||iREF2_FILD||'_VAMT = '''||iVAT_VAMT||'''               ' || CHR(13);
	              
           			IF iREF2_FILD IS NOT NULL THEN  
            			EXECUTE IMMEDIATE sSql;
            		END IF;
              
            END IF;
         END LOOP;

         /* 전자신고공제세액(확정일 경우) */
         IF #VAT_QUARTER# = '2' OR #VAT_QUARTER# = '4' THEN
            UPDATE TA_VAT101_H2_TEMP
            SET RD_EBIPAY_VAMT = '10000';
         END IF;

         /* 전자세금계산서발급세액공제신고서 금액(세액) */
         FOR VAT_REPORT IN
         (
	         SELECT EXCEPT_VAMT /* 해당공제세액 */
	           FROM TA_VAT171_H
	          WHERE BRANCH_CD = #ACCT_GUBN#
	            AND VAT_YYYY = #VAT_YYYY#
	            AND VAT_QUARTER = #VAT_QUARTER#
          ) LOOP
            iVAT_VAMT  := VAT_REPORT.EXCEPT_VAMT;
            
            sSql :=         '  UPDATE TA_VAT101_H2_TEMP                                         ' || CHR(13);
            sSql := sSql || '     SET RD_EBITAX_VAMT = '''||iVAT_VAMT||'''                      ' || CHR(13);

            EXECUTE IMMEDIATE sSql;
         END LOOP;

         /* 전자세금계산서(매출) 지연분만 가져오자. */
         UPDATE TA_VAT101_H2_TEMP
            SET AD_EBIEXC_SAMT = (
                                  SELECT ALL_SAMT
                                    FROM TA_VAT104_H
                                   WHERE BRANCH_CD = #ACCT_GUBN#
                                     AND VAT_YYYY = #VAT_YYYY#
                                     AND VAT_QUARTER = #VAT_QUARTER#
                                     AND DELAYYN = 'Y'
                                  );

         UPDATE TA_VAT101_H2_TEMP
            SET AD_EBIEXC_VAMT = (
                                  SELECT Round(SUM(OFF_SAMT) * 3 / 1000, 0)
                                    FROM TA_VAT104_D
                                   WHERE BRANCH_CD = #ACCT_GUBN#
                                     AND VAT_YYYY = #VAT_YYYY#
                                     AND VAT_QUARTER = #VAT_QUARTER#
                                     AND DELAYYN = 'Y'
                                     AND BILL_TYPECD = '1'
                                  );

         /* 과표예정신고누락분금액합계, 과표예정신고누락분세액 합계 */
         UPDATE TA_VAT101_H2_TEMP
            SET SW_SALTOT_SAMT = (SELECT NVL(SW_TAXBIL_SAMT, 0) + NVL(SW_TAXETC_SAMT, 0) + NVL(SW_ZERBIL_SAMT, 0) + NVL(SW_ZERETC_SAMT, 0)
                                    FROM TA_VAT101_H2_TEMP)
              , SW_SALTOT_VAMT = (SELECT NVL(SW_TAXBIL_VAMT, 0) + NVL(SW_TAXETC_VAMT, 0)
                                    FROM TA_VAT101_H2_TEMP);


         /* 예정매입누락합계금액, 예정매입누락합계세액 */
         UPDATE TA_VAT101_H2_TEMP
            SET PW_PURTOT_SAMT = (SELECT NVL(PW_TAXBIL_SAMT, 0) + NVL(PW_ETCBIL_SAMT, 0)
                                    FROM TA_VAT101_H2_TEMP)
              , PW_PURTOT_VAMT = (SELECT NVL(PW_TAXBIL_VAMT, 0) + NVL(PW_ETCBIL_VAMT, 0)
                                    FROM TA_VAT101_H2_TEMP);

         /* 기타공제매입금액합계, 기타공제매입세액합계 */
         UPDATE TA_VAT101_H2_TEMP
            SET PD_PURTOT_SAMT = (SELECT NVL(PD_CREDIT_SAMT, 0) + NVL(PD_AGENDA_SAMT, 0) + NVL(PD_RECYCL_SAMT, 0) + NVL(PD_ASSETS_SAMT, 0)
                                    FROM TA_VAT101_H2_TEMP)
              , PD_PURTOT_VAMT = (SELECT NVL(PD_CREDIT_VAMT, 0) + NVL(PD_AGENDA_VAMT, 0) + NVL(PD_RECYCL_VAMT, 0) + NVL(PD_CONVER_VAMT, 0)
                                       + NVL(PD_ASSETS_VAMT, 0) + NVL(PD_STOCKP_VAMT, 0) + NVL(PD_BADDEP_VAMT, 0) + Nvl(PD_FOREINER_VAMT, 0)
                                    FROM TA_VAT101_H2_TEMP);

         /* 매입공제받지못할금액합계, 매입공제받지못할세액합계 */
         UPDATE TA_VAT101_H2_TEMP
            SET PN_PURTOT_SAMT = (SELECT NVL(PN_UNABLE_SAMT, 0) + NVL(PN_EXCEPT_SAMT, 0) + NVL(PN_DOUADD_SAMT, 0)
                                    FROM TA_VAT101_H2_TEMP)
              , PN_PURTOT_VAMT = (SELECT NVL(PN_UNABLE_VAMT, 0) + NVL(PN_EXCEPT_VAMT, 0) + NVL(PN_DOUADD_VAMT, 0)
                                    FROM TA_VAT101_H2_TEMP);

         /* 가산세세액계 */
         UPDATE TA_VAT101_H2_TEMP
            SET AD_ADDTOT_VAMT = (SELECT NVL(AD_BIZMIS_VAMT, 0) + NVL(AD_EBIDEL_VAMT, 0) + NVL(AD_EBDERV_VAMT, 0) + NVL(AD_NOTPUB_VAMT, 0) + NVL(AD_EBIOVE_VAMT, 0)
                                       + NVL(AD_EBIEXC_VAMT, 0) + NVL(AD_TAXBIL_VAMT, 0) + NVL(AD_NOSEND_VAMT, 0) + NVL(AD_ZERBIL_VAMT, 0) + NVL(AD_CASNOT_VAMT, 0)

                                       /* 2013 1기예정 추가 시작 */
                                       + NVL(AD_TAXDEL_VAMT, 0) + NVL(AD_REPOR1_VAMT, 0) + NVL(AD_REPOR2_VAMT, 0) + NVL(AD_REPOR3_VAMT, 0) + NVL(AD_REPOR4_VAMT, 0) + NVL(AD_ESTATE_SAMT, 0)
                                       /* 2013 1기예정 추가 종료 */
                                       /* 2016 1기예정 추가 시작 */
                                       + Nvl(AD_ACCNOT_VAMT, 0) + Nvl(AD_ACCDELAY_VAMT, 0)
                                       /* 2016 1기예정 추가 종료 */
                                    FROM TA_VAT101_H2_TEMP);

         /* 2013 1기예정 추가 시작 */
         /* 가산세 -불성실 합계 */
         UPDATE TA_VAT101_H2_TEMP
            SET AD_REPORT_SAMT = (SELECT NVL(AD_REPOR1_SAMT, 0) + NVL(AD_REPOR2_SAMT, 0) + NVL(AD_REPOR3_SAMT, 0) + NVL(AD_REPOR4_SAMT, 0)
                                    FROM TA_VAT101_H2_TEMP);

         /* 가산세 -불성실 합계 */
         UPDATE TA_VAT101_H2_TEMP
            SET AD_REPORT_VAMT = (SELECT NVL(AD_REPOR1_VAMT, 0) + NVL(AD_REPOR2_VAMT, 0) + NVL(AD_REPOR3_VAMT, 0) + NVL(AD_REPOR4_VAMT, 0)
                                    FROM TA_VAT101_H2_TEMP);
         /* 2013 1기예정 추가 종료 */
         
         /*
         SELECT  PN_UNABLE_SAMT, PN_UNABLE_VAMT
           INTO iPN_UNABLE_SAMT, iPN_UNABLE_VAMT
           FROM TA_VAT101_H2_TEMP
           ;
           
           RAISE_APPLICATION_ERROR(-20000, '[' || iPN_UNABLE_SAMT || '/' || iPN_UNABLE_VAMT || ']');
           */
    END;
    ]]> 
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(과세표준 명세) 처리
******************************************************************************* */
-->
    <select id="TXMC0160.PROC05" parameterClass="hashmap" resultClass="hashmap">
    <![CDATA[ 
    DECLARE
    
        /* TXMC0160.PROC05.부가가치세신고서(과세표준 명세) 처리 */
        sSql VARCHAR2(10000);
    
        iREF1_FILD VARCHAR2(100);
        iREF2_FILD VARCHAR2(100);
        iCOMD_CDNM VARCHAR2(80);
        iVAT_SAMT  NUMBER(17);
        iVAT_VAMT  NUMBER(17);
    
        VAT_REPORT VARCHAR2(256);
    BEGIN

         /* TEMPORARY TABLE 제거됨에 따라 DELETE먼저... 
            TRANSACTION 관리되므로 중복 없음! */
         DELETE FROM TA_VAT101_D_TEMP ;
         
         /* 기본 4개라인의 데이터를 넣어둔다. */
         /* 일단 과세표준 명세 테이블(TA_VAT101_D)에 기본 정보를 INSERT 한다. */
         /* 
         FOR i IN 1..4 LOOP
             INSERT INTO TA_VAT101_D_TEMP (                                               
                    INCOME_SEQ      
                  , BRANCH_CD       
                  , VAT_YYYY        
                  , VAT_QUARTER     
                  , INCOME_TYPECD   
                  , CORP_TYPENM     
                  , CORP_LINE       
                  , CORP_TYPECD     
                  , INCOME_SAMT     
             )                                                                           
             SELECT i AS INCOME_SEQ       
                  , ACCT_GUBN AS BRANCH_CD
                  , VAT_YYYY AS VAT_YYYY      
                  , VAT_QUARTER AS VAT_QUARTER
                  , '0' AS INCOME_TYPECD        
                  , A.CORP_TYPENM               
                  , A.CORP_LINE                 
                  , A.CORP_TYPECD AS CORP_TYPECD
                  , 0 AS INCOME_SAMT            
               FROM VA_VATBRANCH A                       
              WHERE A.BRANCH_CD = ACCT_GUBN      
              ;                                              
         END LOOP;
     	 */

         INSERT INTO TA_VAT101_D_TEMP (                                               
	            INCOME_SEQ                                     /* 수입금액라인           */
	          , BRANCH_CD                                      /* 지점코드               */
	          , VAT_YYYY                                       /* VAT년도                */
	          , VAT_QUARTER                                    /* VAT분기                */
	          , INCOME_TYPECD                                  /* 수입금액종류구분       */
	          , CORP_TYPENM                                    /* 업태명                 */
	          , CORP_LINE                                      /* 종목명                 */
	          , CORP_TYPECD                                    /* 업종코드               */
	          , INCOME_SAMT                                    /* 수입금액               */
         )                                                                           
	     SELECT A.BIZ_TYPE_CD AS INCOME_SEQ               /* 수입금액라인(수입금액) */
	          , #ACCT_GUBN# AS BRANCH_CD    /* 지점코드               */
	          , #VAT_YYYY# AS VAT_YYYY         /* VAT년도                */
	          , #VAT_QUARTER# AS VAT_QUARTER   /* VAT분기                */
	          , '0' AS INCOME_TYPECD                  /* 수입금액종류구분(수입금액) */
	          , A.CORP_TYPENM                           /* 업태명                 */
	          , A.CORP_LINE                             /* 종목명                 */
	          , A.CORP_TYPECD AS CORP_TYPECD            /* 업종코드               */
	          , 0 AS INCOME_SAMT                        /* 수입금액               */
	       FROM TA_VATUPJ    A                  /* [부가업종] */
	       ;
	         
         /* 해당 과세기간의 부가세 1PAGE(과세표준 명세) 항목에 대한 금액을 모두 가져온다. */
         FOR VAT_REPORT IN
         (
              SELECT A.REF1_FILD                     /* 부가세 항목 순서 */
                   , A.REF2_FILD                     /* 부가세 신고 항목 */
                   , A.COMD_CDNM                     /* 부가세 신고서 항목명(신고서 페이지당 DS ROW가 하나이기 때문에 항목명은 그리드에 셋팅한다.) */
                   , SUM(NVL(SUB.VAT_SAMT, 0)) AS VAT_SAMT   /* 공급가액 */
                   , A.SORT_ORDR                     /* 정렬순서 */
                FROM TM_CODEXD A
                     LEFT JOIN (
                                SELECT A.VAT_SAMT
                                     , C.APPL_V101
                                  FROM TA_VATRAW A
                                       LEFT JOIN TA_VATCDH B
                                              ON A.VATH_TYPECD = B.VATH_TYPECD
                                       LEFT JOIN TA_VATCDD C
                                              ON A.VATH_TYPECD = C.VATH_TYPECD
                                             AND A.VATD_TYPECD = C.VATD_TYPECD
                                 WHERE A.BRANCH_CD = #ACCT_GUBN#
                                   AND A.VAT_YYYY = #VAT_YYYY#
                                   AND A.VAT_QUARTER = #VAT_QUARTER#
                             ) SUB
                             /* APPL_V101에는 여러항목, A.REF2_FILD 에는 한가지 항목만 있기 때문에 LIKE로 걸어준다. */
                            ON SUB.APPL_V101 LIKE CONCAT(CONCAT('%',A.REF2_FILD),'%')
               WHERE A.COMM_CODE = 'VATX_COMM'
                 AND (A.REF1_FILD = 1 OR A.REF1_FILD = 4)    /* 1PAGE의 그리드1번의 합계와 수입금액제외의 차가 수입금액 */
                 AND A.REF2_FILD IS NOT NULL
            GROUP BY A.REF1_FILD
                   , A.REF2_FILD
                   , A.COMD_CDNM
                   , A.SORT_ORDR
            ORDER BY A.SORT_ORDR
          ) LOOP

            iREF1_FILD := VAT_REPORT.REF1_FILD;
            iREF2_FILD := VAT_REPORT.REF2_FILD;
            iCOMD_CDNM := VAT_REPORT.COMD_CDNM;
            iVAT_SAMT  := VAT_REPORT.VAT_SAMT;
			
            /* 각 항목에 대한 값을 업데이트 한다(공급가액) */
            /* 1-1)과세표준명세의 합을 업데이트 한다. */
            IF iREF1_FILD = 1 THEN
	              sSql :=         '  UPDATE TA_VAT101_D_TEMP                                          ' || CHR(13);
	              sSql := sSql || '     SET INCOME_SAMT = NVL(INCOME_SAMT, 0) + NVL('''||iVAT_SAMT||''', 0)   ' || CHR(13);
	              sSql := sSql || '       , INCOME_TYPECD = ''1''                                     ' || CHR(13);
	              sSql := sSql || '   WHERE INCOME_SEQ = ''1''                                        ' || CHR(13);
	
	              EXECUTE IMMEDIATE sSql;

            /* 1-2)과세표준명세의 합에서 수입금액제외 금액을 빼준다. */
            ELSIF iREF1_FILD <> 1 AND iREF2_FILD = 'ih_except' THEN
	              sSql :=         '  UPDATE TA_VAT101_D_TEMP                                          ' || CHR(13);
	              sSql := sSql || '     SET INCOME_SAMT = NVL(INCOME_SAMT, 0) - NVL('''||iVAT_SAMT||''', 0)   ' || CHR(13);
	              sSql := sSql || '   WHERE INCOME_SEQ = ''1''                                        ' || CHR(13);
	
	              EXECUTE IMMEDIATE sSql;

            /* 2-1)수입금액제외 금액을 업데이트 한다. */
	              sSql :=         '  UPDATE TA_VAT101_D_TEMP                                          ' || CHR(13);
	              sSql := sSql || '     SET INCOME_SAMT = '''||iVAT_SAMT||'''                         ' || CHR(13);
	              sSql := sSql || '       , INCOME_TYPECD = ''2''                                     ' || CHR(13);
	              sSql := sSql || '   WHERE INCOME_SEQ = ''4''                                        ' || CHR(13);
	
	              EXECUTE IMMEDIATE sSql;

            END IF;
         END LOOP;
    END;
    ]]> 
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(1페이지) 처리(조회)
******************************************************************************* */
-->
    <select id="TXMC0160.SEARCH03" parameterClass="hashmap" resultClass="hashmap">
    <![CDATA[ 
              SELECT /* TXMC0160.SEARCH03.부가가치세신고서(1페이지) 처리(조회) */
                     BRANCH_CD          /* 지점코드                      */
                   , VAT_YYYY           /* VAT년도                       */
                   , VAT_QUARTER        /* VAT분기                       */
                   , NVL(VAT_SYMD       , ' ') AS VAT_SYMD           /* 과세기간_시작일               */
                   , NVL(VAT_EYMD       , ' ') AS VAT_EYMD           /* 과세기간_종료일               */
                   , NVL(VAT_CYMD       , ' ') AS VAT_CYMD           /* 작성일자                      */
                   , NVL(USER_ID        , ' ') AS USER_ID            /* 사용자아이디                  */
                   , NVL(CORP_NO        , ' ') AS CORP_NO            /* 법인번호                      */
                   , NVL(CORP_CELL      , ' ') AS CORP_CELL          /* 사업자휴대전화                */
                   , NVL(CORP_EMAIL     , ' ') AS CORP_EMAIL         /* 전자메일주소                  */
                   , NVL(CORP_NM        , ' ') AS CORP_NM            /* 법인명                        */
                   , NVL(CORP_MASTER    , ' ') AS CORP_MASTER        /* 대표자명                      */
                   , NVL(CORP_LOCATION  , ' ') AS CORP_LOCATION      /* 사업장소재지                  */
                   , NVL(CORP_TEL       , ' ') AS CORP_TEL           /* 사업장전화번호                */
                   , NVL(CORP_ADDR      , ' ') AS CORP_ADDR          /* 사업자주소                    */
                   , NVL(CORP_TYPENM    , ' ') AS CORP_TYPENM        /* 업태명                        */
                   , NVL(CORP_LINE      , ' ') AS CORP_LINE          /* 종목명                        */
                   , NVL(CORP_TYPECD    , ' ') AS CORP_TYPECD        /* 업종코드                      */
                   , NVL(CORP_SYMD      , ' ') AS CORP_SYMD          /* 개업년월일                    */
                   , NVL(AGENT_NM       , ' ') AS AGENT_NM           /* 세무대리인성명                */
                   , NVL(AGENT_NO       , ' ') AS AGENT_NO           /* 세무대리인관리번호            */
                   , NVL(AGENT_TEL      , ' ') AS AGENT_TEL          /* 세무대리인전화번호            */
                   , NVL(AGENT_BIZNO    , ' ') AS AGENT_BIZNO        /* 세무대리인사업자번호          */
                   , NVL(REVISION_TYPECD, ' ') AS REVISION_TYPECD    /* 보정신고구분                  */
                   , NVL(SH_TAXBIL_SAMT, 0) AS SH_TAXBIL_SAMT    /* 과표신고과세세금계산서금액    */
                   , NVL(SH_TAXBIL_VAMT, 0) AS SH_TAXBIL_VAMT    /* 과표신고과세세금계산서세액    */
                   , NVL(SH_PURPUB_SAMT, 0) AS SH_PURPUB_SAMT    /* 과표신고과세매입자발행금액    */
                   , NVL(SH_PURPUB_VAMT, 0) AS SH_PURPUB_VAMT    /* 과표신고과세매입자발행세액    */
                   , NVL(SH_CRECAS_SAMT, 0) AS SH_CRECAS_SAMT    /* 과표신고신용카드현금영수증금액 */
                   , NVL(SH_CRECAS_VAMT, 0) AS SH_CRECAS_VAMT    /* 과표신고신용카드현금영수증세액 */
                   , NVL(SH_TAXETC_SAMT, 0) AS SH_TAXETC_SAMT    /* 과표신고과세기타금액          */
                   , NVL(SH_TAXETC_VAMT, 0) AS SH_TAXETC_VAMT    /* 과표신고과세기타세액          */
                   , NVL(SH_ZERBIL_SAMT, 0) AS SH_ZERBIL_SAMT    /* 과표신고영세세금계산서금액    */
                   , NVL(SH_ZERETC_SAMT, 0) AS SH_ZERETC_SAMT    /* 과표신고영세기타금액          */
                   , NVL(SH_WILMIS_SAMT, 0) AS SH_WILMIS_SAMT    /* 과표예정신고누락분금액        */
                   , NVL(SH_WILMIS_VAMT, 0) AS SH_WILMIS_VAMT    /* 과표예정신고누락분세액        */
                   , NVL(SH_DOUADD_SAMT, 0) AS SH_DOUADD_SAMT    /* 대손세액가감금액              */
                   , NVL(SH_DOUADD_VAMT, 0) AS SH_DOUADD_VAMT    /* 대손세액가감세액              */
                   , NVL(SALTOT_SAMT, 0) AS SALTOT_SAMT    /* 과세표준                      */
                   , NVL(SALTOT_VAMT, 0) AS SALTOT_VAMT    /* 산출세액                      */
                   , NVL(PH_TAXBIL_SAMT, 0) AS PH_TAXBIL_SAMT    /* 매입수취일반금액              */
                   , NVL(PH_TAXBIL_VAMT, 0) AS PH_TAXBIL_VAMT    /* 매입수취일반세액              */
                   , NVL(PH_ASSETS_SAMT, 0) AS PH_ASSETS_SAMT    /* 매입수취고정잔산금액          */
                   , NVL(PH_ASSETS_VAMT, 0) AS PH_ASSETS_VAMT    /* 매입수취고정자산세액          */
                   , NVL(PH_WILTOT_SAMT, 0) AS PH_WILTOT_SAMT    /* 매입예정신고누락금액          */
                   , NVL(PH_WILTOT_VAMT, 0) AS PH_WILTOT_VAMT    /* 매입예정신고누락세액          */
                   , NVL(PH_PURPUB_SAMT, 0) AS PH_PURPUB_SAMT    /* 매입매입자발행금액            */
                   , NVL(PH_PURPUB_VAMT, 0) AS PH_PURPUB_VAMT    /* 매입매입자발행세액            */
                   , NVL(PH_ETCBIL_SAMT, 0) AS PH_ETCBIL_SAMT    /* 매입기타공제금액              */
                   , NVL(PH_ETCBIL_VAMT, 0) AS PH_ETCBIL_VAMT    /* 매입기타공제세액              */
                   , NVL(PH_PTOTAL_SAMT, 0) AS PH_PTOTAL_SAMT    /* 매입금액합계                  */
                   , NVL(PH_PTOTAL_VAMT, 0) AS PH_PTOTAL_VAMT    /* 매입세액합계                  */
                   , NVL(PH_UNABLE_SAMT, 0) AS PH_UNABLE_SAMT    /* 매입공제받지못할금액          */
                   , NVL(RH_CREDIT_VAMT, 0) AS RH_CREDIT_VAMT    /* 금전신용공제세액              */
                   , NVL(RH_MINTOT_VAMT, 0) AS RH_MINTOT_VAMT    /* 경감세액계                    */
                   , NVL(RH_WILRET_VAMT, 0) AS RH_WILRET_VAMT    /* 예정미환급세액                */
                   , NVL(RH_NOTRET_VAMT, 0) AS RH_NOTRET_VAMT    /* 예정고지세액                  */
                   , NVL(RH_PROHIB_VAMT, 0) AS RH_PROHIB_VAMT    /* 금지금매입자납부특례기납부세액 */
                   , NVL(RH_ADDTOT_VAMT, 0) AS RH_ADDTOT_VAMT    /* 가산세계                      */
                   , NVL(VAT_REF_VAMT  , 0) AS VAT_REF_VAMT      /* 차감납부할세액                */
                   , NVL(IH_EXCEPT_SAMT, 0) AS IH_EXCEPT_SAMT    /* 과세수입금액제외금액          */
                   , NVL(IH_TAXBIL_SAMT, 0) AS IH_TAXBIL_SAMT    /* 과세수입금액합계              */
                   , NVL(PH_EXPOST_VAMT, 0) AS PH_EXPOST_VAMT    /* VAT_매입수취수출기업수입분납부유예세액              */
                   /* , NVL(RH_PROXY_VAMT, 0) AS RH_PROXY_VAMT */     /* 사업양수자의대리납부기납부세액 */
                FROM TA_VAT101_H1_TEMP
    ]]> 
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(2페이지) 처리(조회) 
******************************************************************************* */
-->
    <select id="TXMC0160.SEARCH04" parameterClass="hashmap" resultClass="hashmap">
    <![CDATA[ 
              SELECT /* TXMC0160.SEARCH04.부가가치세신고서(2페이지) 처리(조회) */
                     BRANCH_CD          /* 지점코드                          */
                   , VAT_YYYY           /* VAT년도                           */
                   , VAT_QUARTER        /* VAT분기                           */
                   , NVL(SW_TAXBIL_SAMT, 0) AS SW_TAXBIL_SAMT     /* 과표예정과세세금계산서금액        */
                   , NVL(SW_TAXBIL_VAMT, 0) AS SW_TAXBIL_VAMT     /* 과표예정과세세금계산서세액        */
                   , NVL(SW_TAXETC_SAMT, 0) AS SW_TAXETC_SAMT     /* 과표예정과세기타금액              */
                   , NVL(SW_TAXETC_VAMT, 0) AS SW_TAXETC_VAMT     /* 과표예정과세기타세액              */
                   , NVL(SW_ZERBIL_SAMT, 0) AS SW_ZERBIL_SAMT     /* 과표예정영세세금계산서금액        */
                   , NVL(SW_ZERETC_SAMT, 0) AS SW_ZERETC_SAMT     /* 과표예정영세기타금액              */
                   , NVL(SW_SALTOT_SAMT, 0) AS SW_SALTOT_SAMT     /* 과표예정신고누락분금액합계        */
                   , NVL(SW_SALTOT_VAMT, 0) AS SW_SALTOT_VAMT     /* 과표예정신고누락분세액합계        */
                   , NVL(PW_TAXBIL_SAMT, 0) AS PW_TAXBIL_SAMT     /* 예정매입세금계산서누락금액        */
                   , NVL(PW_TAXBIL_VAMT, 0) AS PW_TAXBIL_VAMT     /* 예정매입세금계산서누락세액        */
                   , NVL(PW_ETCBIL_SAMT, 0) AS PW_ETCBIL_SAMT     /* 예정매입기타공제누락세액금액      */
                   , NVL(PW_ETCBIL_VAMT, 0) AS PW_ETCBIL_VAMT     /* 예정매입기타공제누락세액세액      */
                   , NVL(PW_PURTOT_SAMT, 0) AS PW_PURTOT_SAMT     /* 예정매입누락합계금액              */
                   , NVL(PW_PURTOT_VAMT, 0) AS PW_PURTOT_VAMT     /* 예정매입누락합계세액              */
                   , NVL(PD_CREDIT_SAMT, 0) AS PD_CREDIT_SAMT     /* 매입금전신용금액                  */
                   , NVL(PD_CREDIT_VAMT, 0) AS PD_CREDIT_VAMT     /* 매입금전신용세액                  */
                   , NVL(PD_AGENDA_SAMT, 0) AS PD_AGENDA_SAMT     /* 매입의제매입금액                  */
                   , NVL(PD_AGENDA_VAMT, 0) AS PD_AGENDA_VAMT     /* 매입의제매입세액                  */
                   , NVL(PD_RECYCL_SAMT, 0) AS PD_RECYCL_SAMT     /* 매입재활용금액                    */
                   , NVL(PD_RECYCL_VAMT, 0) AS PD_RECYCL_VAMT     /* 매입재활용세액                    */
                   , NVL(PD_CONVER_VAMT, 0) AS PD_CONVER_VAMT     /* 과세사업전환매입세액              */
                   , NVL(PD_ASSETS_SAMT, 0) AS PD_ASSETS_SAMT     /* 매입신용고정자산금액              */
                   , NVL(PD_ASSETS_VAMT, 0) AS PD_ASSETS_VAMT     /* 매입신용고정자산세액              */
                   , NVL(PD_STOCKP_VAMT, 0) AS PD_STOCKP_VAMT     /* 매입재고매입세액                  */
                   , NVL(PD_BADDEP_VAMT, 0) AS PD_BADDEP_VAMT     /* 매입변제대손세액                  */
                   , NVL(PD_PURTOT_SAMT, 0) AS PD_PURTOT_SAMT     /* 기타공제매입금액합계              */
                   , NVL(PD_PURTOT_VAMT, 0) AS PD_PURTOT_VAMT     /* 기타공제매입세액합계              */
                   , NVL(PN_UNABLE_SAMT, 0) AS PN_UNABLE_SAMT     /* 불공제매입금액                    */
                   , NVL(PN_UNABLE_VAMT, 0) AS PN_UNABLE_VAMT     /* 불공제매입세액                    */
                   , NVL(PN_EXCEPT_SAMT, 0) AS PN_EXCEPT_SAMT     /* 공통매입면세사업금액              */
                   , NVL(PN_EXCEPT_VAMT, 0) AS PN_EXCEPT_VAMT     /* 공통매입면세사업세액              */
                   , NVL(PN_DOUADD_SAMT, 0) AS PN_DOUADD_SAMT     /* 대손처분금액                      */
                   , NVL(PN_DOUADD_VAMT, 0) AS PN_DOUADD_VAMT     /* 대손처분세액                      */
                   , NVL(PN_PURTOT_SAMT, 0) AS PN_PURTOT_SAMT     /* 매입공제받지못할금액합계          */
                   , NVL(PN_PURTOT_VAMT, 0) AS PN_PURTOT_VAMT     /* 매입공제받지못할세액합계          */
                   , NVL(RD_EBIPAY_VAMT, 0) AS RD_EBIPAY_VAMT     /* 전자신고공제세액                  */
                   , NVL(RD_EBITAX_VAMT, 0) AS RD_EBITAX_VAMT     /* 전자세금계산서발급세액공제세액    */
                   , NVL(RD_TAXICO_VAMT, 0) AS RD_TAXICO_VAMT     /* 택시사업부가가치세경감세액        */
                   , NVL(RD_CASBIL_VAMT, 0) AS RD_CASBIL_VAMT     /* 현금영수증사업자공제세액          */
                   , NVL(RD_ETCBIL_VAMT, 0) AS RD_ETCBIL_VAMT     /* 기타경감공제세액명세기타세액      */
                   , NVL(AD_BIZMIS_SAMT, 0) AS AD_BIZMIS_SAMT     /* 사업자등록가산금액                   */
                   , NVL(AD_BIZMIS_VAMT, 0) AS AD_BIZMIS_VAMT     /* 사업자등록가산세                     */
                   , NVL(AD_EBIDEL_SAMT, 0) AS AD_EBIDEL_SAMT     /* 세금계산서지연발급등가산금액         */
                   , NVL(AD_EBIDEL_VAMT, 0) AS AD_EBIDEL_VAMT     /* 세금계산서지연발급등가산세액         */
                   , NVL(AD_EBDERV_SAMT, 0) AS AD_EBDERV_SAMT     /* 세금계산서지연수취가산금액   */
                   , NVL(AD_EBDERV_VAMT, 0) AS AD_EBDERV_VAMT     /* 세금계산서지연수취가산세액   */
                   , NVL(AD_NOTPUB_SAMT, 0) AS AD_NOTPUB_SAMT     /* 세금계산서지연수취등가산금액         */
                   , NVL(AD_NOTPUB_VAMT, 0) AS AD_NOTPUB_VAMT     /* 세금계산서지연수취등가산세액         */
                   , NVL(AD_EBIOVE_SAMT, 0) AS AD_EBIOVE_SAMT     /* 전자세금계산서발급명세전송-지연전송금액 */
                   , NVL(AD_EBIOVE_VAMT, 0) AS AD_EBIOVE_VAMT     /* 전자세금계산서발급명세전송-지연전송세액 */
                   , NVL(AD_EBIEXC_SAMT, 0) AS AD_EBIEXC_SAMT     /* 전자세금계산서발급명세전송-미전송세액 */
                   , NVL(AD_EBIEXC_VAMT, 0) AS AD_EBIEXC_VAMT     /* 전자세금계산서발급명세전송-미전송세액 */
                   , NVL(AD_TAXBIL_SAMT, 0) AS AD_TAXBIL_SAMT     /* 세금계산서합계표 제출불성실금액      */
                   , NVL(AD_TAXBIL_VAMT, 0) AS AD_TAXBIL_VAMT     /* 세금계산서합계표 제출불성실세액      */
                   , NVL(AD_REPORT_SAMT, 0) AS AD_REPORT_SAMT     /* 신고불성실-합계금액                  */
                   , NVL(AD_REPORT_VAMT, 0) AS AD_REPORT_VAMT     /* 신고불성실-합계세액                  */
                   , NVL(AD_NOSEND_SAMT, 0) AS AD_NOSEND_SAMT     /* 납부불성실가산금액                   */
                   , NVL(AD_NOSEND_VAMT, 0) AS AD_NOSEND_VAMT     /* 납부불성실가산세액                   */
                   , NVL(AD_ZERBIL_SAMT, 0) AS AD_ZERBIL_SAMT     /* 영세율신고가산금액                   */
                   , NVL(AD_ZERBIL_VAMT, 0) AS AD_ZERBIL_VAMT     /* 영세율신고가산세액                   */
                   , NVL(AD_CASNOT_SAMT, 0) AS AD_CASNOT_SAMT     /* 현금매출명세서미제출등가산금액       */
                   , NVL(AD_CASNOT_VAMT, 0) AS AD_CASNOT_VAMT     /* 현금매출명세서미제출등가산세액       */
                   , NVL(AD_ADDTOT_VAMT, 0) AS AD_ADDTOT_VAMT     /* 가산세세액계                         */
                   , NVL(AD_TAXDEL_SAMT, 0) AS AD_TAXDEL_SAMT     /* 세금계산서합계표 지연제출금액        */
                   , NVL(AD_TAXDEL_VAMT, 0) AS AD_TAXDEL_VAMT     /* 세금계산서합계표 지연제출세액        */
                   , NVL(AD_REPOR1_SAMT, 0) AS AD_REPOR1_SAMT     /* 신고불성실-무신고(일반)금액          */
                   , NVL(AD_REPOR1_VAMT, 0) AS AD_REPOR1_VAMT     /* 신고불성실-무신고(일반)세액          */
                   , NVL(AD_REPOR2_SAMT, 0) AS AD_REPOR2_SAMT     /* 신고불성실-무신고(부당)금액          */
                   , NVL(AD_REPOR2_VAMT, 0) AS AD_REPOR2_VAMT     /* 신고불성실-무신고(부당)세액          */
                   , NVL(AD_REPOR3_SAMT, 0) AS AD_REPOR3_SAMT     /* 과소·초과환급신고(일반)금액         */
                   , NVL(AD_REPOR3_VAMT, 0) AS AD_REPOR3_VAMT     /* 과소·초과환급신고(일반)세액         */
                   , NVL(AD_REPOR4_SAMT, 0) AS AD_REPOR4_SAMT     /* 과소·초과환급신고(부당)금액         */
                   , NVL(AD_REPOR4_VAMT, 0) AS AD_REPOR4_VAMT     /* 과소·초과환급신고(부당)세액         */
                   , NVL(AD_ESTATE_SAMT, 0) AS AD_ESTATE_SAMT     /* 부동산임대공급가액명세서 불성실금액  */
                   , NVL(AD_ESTATE_VAMT, 0) AS AD_ESTATE_VAMT     /* 부동산임대공급가액명세서 불성실세액  */                       
                   , NVL(DF_EXCEPT_SAMT, 0) AS DF_EXCEPT_SAMT     /* 면세수입금액제외금액              */
                   , NVL(DF_TAXBIL_SAMT, 0) AS DF_TAXBIL_SAMT     /* 면세수입금액합계                  */
                   , NVL(BD_SALTOT_SAMT, 0) AS BD_SALTOT_SAMT     /* 계산서발급금액                    */
                   , NVL(BD_PURTOT_SAMT, 0) AS BD_PURTOT_SAMT     /* 계산서수취금액                    */
                   , NVL(REFUND_TYPECD   , ' ') AS REFUND_TYPECD      /* 환급구분                          */
                   , NVL(VAT_BANKCD      , ' ') AS VAT_BANKCD         /* 국세환급금은행코드                */
                   , NVL(VAT_BANKNO      , ' ') AS VAT_BANKNO         /* 국세환급금계좌번호                */
                   , NVL(VAT_TOTPAYNO    , ' ') AS VAT_TOTPAYNO       /* 총괄납부승인번호                  */
                   , NVL(VAT_BANKBRANCH  , ' ') AS VAT_BANKBRANCH     /* 은행지점명                        */
                   , NVL(CORP_EYMD       , ' ') AS CORP_EYMD          /* 폐업일자                          */
                   , NVL(CLOSING_REMARK  , ' ') AS CLOSING_REMARK     /* 폐업사유                          */
                   , NVL(VAT_REF_VAMT    , 0  ) AS VAT_REF_VAMT       /* 실차감납부할세액                  */
                   , NVL(VAT_NTAX_TYPECD , '0') AS VAT_NTAX_TYPECD    /* 일반과세자구분                    */
                   , NVL(VAT_EARLY_TYPECD, '0') AS VAT_EARLY_TYPECD   /* 조기환급취소구분                  */
                   , NVL(CORP_TYPENM     , ' ') AS CORP_TYPENM        /* 업태명                            */
                   , NVL(CORP_LINE       , ' ') AS CORP_LINE          /* 종목명                            */
                   , NVL(CORP_TYPECD     , ' ') AS CORP_TYPECD        /* 업종코드                          */
                   , NVL(BRANCH_APPRNO   , ' ') AS BRANCH_APPRNO      /* 사업자단위과세승인번호            */
                   /* , NVL(PD_FOREINER_VAMT, 0) */                         /* 외국인관광객에대한환급세액 */
                   /* , NVL(AD_ACCNOT_SAMT, 0) */                           /* 거래계좌미사용가산금액 */
                   /* , NVL(AD_ACCNOT_VAMT, 0) */                           /* 거래계좌미사용가산세액 */
                   /* , NVL(AD_ACCDELAY_SAMT, 0) */                         /* 거래계좌지연입금가산금액 */
                   /* , NVL(AD_ACCDELAY_VAMT, 0) */                        /* 거래계좌지연입금가산세액 */
                FROM TA_VAT101_H2_TEMP
    ]]> 
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(과세표준 명세) 처리(조회)
******************************************************************************* */
-->
    <select id="TXMC0160.SEARCH05" parameterClass="hashmap" resultClass="hashmap">
    <![CDATA[ 
              SELECT /* TXMC0160.SEARCH05.부가가치세신고서(과세표준 명세) 처리(조회) */
                     INCOME_SEQ         /* 수입금액라인 */
                   , BRANCH_CD          /* 지점코드 */
                   , VAT_YYYY           /* VAT년도 */
                   , VAT_QUARTER        /* VAT분기 */
                   , INCOME_TYPECD      /* 수입금액종류구분 */
                   , CASE WHEN INCOME_TYPECD = 0 THEN TO_NCHAR('') ELSE CORP_TYPENM END AS CORP_TYPENM    /* 업태명 */
                   , CASE WHEN INCOME_TYPECD = 0 THEN TO_NCHAR('') ELSE CORP_LINE END AS CORP_LINE        /* 종목명 */
                   , CASE WHEN INCOME_TYPECD = 0 THEN TO_NCHAR('') ELSE CORP_TYPECD END AS CORP_TYPECD    /* 업종코드 */
                   , INCOME_SAMT        /* 수입금액 */
                FROM TA_VAT101_D_TEMP
    ]]> 
    </select>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내      용  : 부가가치세신고서(1페이지)저장
******************************************************************************* */
-->
    <insert id="TXMC0160.SAVE00" parameterClass="hashmap">
    <![CDATA[
    DECLARE
        /* TXMC0160.SAVE00.부가가치세신고서(1페이지)저장 */
        v_ROWCNT INT;
    BEGIN
        SELECT COUNT(0) INTO v_ROWCNT
          FROM TA_VAT101_H1
         WHERE BRANCH_CD = #BRANCH_CD#
           AND VAT_YYYY = #VAT_YYYY#
           AND VAT_QUARTER = #VAT_QUARTER#;


        IF v_ROWCNT = 0 THEN
	        INSERT INTO TA_VAT101_H1 (		/* [부가가치세_헤더_1쪽] */
	               BRANCH_CD				/* VAT_지점코드 */
	             , VAT_YYYY					/* VAT_VAT년도 */
	             , VAT_QUARTER				/* VAT_VAT분기 */
	             , VAT_SYMD					/* VAT_과세기간_시작일 */
	             , VAT_EYMD					/* VAT_과세기간_종료일 */
	             , VAT_CYMD					/* VAT_작성일자 */
	             , USER_ID					/* VAT_사용자아이디 */
	             , CORP_NO					/* VAT_법인번호 */
	             , CORP_CELL				/* VAT_사업자휴대전화 */
	             , CORP_EMAIL				/* VAT_전자메일주소 */
	             , CORP_NM					/* VAT_법인명 */
	             , CORP_MASTER				/* VAT_대표자명 */
	             , CORP_LOCATION			/* VAT_사업장소재지 */
	             , CORP_TEL					/* VAT_사업장전화번호 */
	             , CORP_ADDR				/* VAT_사업자주소 */
	             , CORP_TYPENM				/* VAT_업태명 */
	             , CORP_LINE				/* VAT_종목명 */
	             , CORP_TYPECD				/* VAT_업종코드 */
	             , CORP_SYMD				/* VAT_개업년월일 */
	             , AGENT_NM					/* VAT_세무대리인성명 */
	             , AGENT_NO					/* VAT_세무대리인관리번호 */
	             , AGENT_TEL				/* VAT_세무대리인전화번호 */
	             , AGENT_BIZNO				/* VAT_세무대리인사업자번호 */
	             , REVISION_TYPECD			/* VAT_보정신고구분 */
	             , SH_TAXBIL_SAMT			/* VAT_과표신고과세세금계산서금액 */
	             , SH_TAXBIL_VAMT			/* VAT_과표신고과세세금계산서세액 */
	             , SH_PURPUB_SAMT			/* VAT_과표신고과세매입자발행금액 */
	             , SH_PURPUB_VAMT			/* VAT_과표신고과세매입자발행세액 */
	             , SH_CRECAS_SAMT			/* VAT_과표신고신용카드현금영수증금액 */
	             , SH_CRECAS_VAMT			/* VAT_과표신고신용카드현금영수증세액 */
	             , SH_TAXETC_SAMT			/* VAT_과표신고과세기타금액 */
	             , SH_TAXETC_VAMT			/* VAT_과표신고과세기타세액 */
	             , SH_ZERBIL_SAMT			/* VAT_과표신고영세세금계산서금액 */
	             , SH_ZERETC_SAMT			/* VAT_과표신고영세기타금액 */
	             , SH_WILMIS_SAMT			/* VAT_과표예정신고누락분금액 */
	             , SH_WILMIS_VAMT			/* VAT_과표예정신고누락분세액 */
	             , SH_DOUADD_SAMT			/* VAT_대손세액가감금액 */
	             , SH_DOUADD_VAMT			/* VAT_대손세액가감세액 */
	             , SALTOT_SAMT				/* VAT_과세표준 */
	             , SALTOT_VAMT				/* VAT_산출세액 */
	             , PH_TAXBIL_SAMT			/* VAT_매입수취일반금액 */
	             , PH_TAXBIL_VAMT			/* VAT_매입수취일반세액 */
	             , PH_ASSETS_SAMT			/* VAT_매입수취고정자산금액 */
	             , PH_ASSETS_VAMT			/* VAT_매입수취고정자산세액 */
	             , PH_WILTOT_SAMT			/* VAT_매입예정신고누락금액 */
	             , PH_WILTOT_VAMT			/* VAT_매입예정신고누락세액 */
	             , PH_PURPUB_SAMT			/* VAT_매입매입자발행금액 */
	             , PH_PURPUB_VAMT			/* VAT_매입매입자발행세액 */
	             , PH_ETCBIL_SAMT			/* VAT_매입기타공제금액 */
	             , PH_ETCBIL_VAMT			/* VAT_매입기타공제세액 */
	             , PH_PTOTAL_SAMT			/* VAT_매입금액합계 */
	             , PH_PTOTAL_VAMT			/* VAT_매입세액합계 */
	             , PH_UNABLE_SAMT			/* VAT_매입공제받지못할금액 */
	             , PH_UNABLE_VAMT			/* VAT_매입공제받지못할세액 */
	             , PH_ADDMIN_SAMT			/* VAT_차감매입금액 */
	             , PH_ADDMIN_VAMT			/* VAT_차감매입세액 */
	             , SP_RETURN_VAMT			/* VAT_납부및환급세액 */
	             , RH_ETCMIN_VAMT			/* VAT_기타공제_경감세액 */
	             , RH_CREDIT_SAMT			/* VAT_금전신용공제금액 */
	             , RH_CREDIT_VAMT			/* VAT_금전신용공제세액 */
	             , RH_MINTOT_VAMT			/* VAT_경감세액계 */
	             , RH_WILRET_VAMT			/* VAT_예정미환급세액 */
	             , RH_NOTRET_VAMT			/* VAT_예정고지세액 */
	             , RH_PROHIB_VAMT			/* VAT_금지금매입자납부특례기납부세액 */
	             , RH_ADDTOT_VAMT			/* VAT_가산세계 */
	             , PH_EXPOST_VAMT           /* VAT_수출기업수입분납부유예 */
	             , VAT_REF_VAMT				/* VAT_실차감납부할세액 */
	             , IH_EXCEPT_SAMT			/* VAT_과세수입금액제외금액 */
	             , IH_TAXBIL_SAMT			/* VAT_과세수입금액합계 */
	             , INST_USID				/* 입력작업자 */
	             , INST_DATE				/* 입력일시 */
	             , UPDT_USID				/* 수정작업자 */
	             , UPDT_DATE				/* 수정일시 */
	               )
	        VALUES (
	               #BRANCH_CD#				/* VAT_지점코드 */
	             , #VAT_YYYY#				/* VAT_VAT년도 */
	             , #VAT_QUARTER#			/* VAT_VAT분기 */
	             , #VAT_SYMD#				/* VAT_과세기간_시작일 */
	             , #VAT_EYMD#				/* VAT_과세기간_종료일 */
	             , #VAT_CYMD#				/* VAT_작성일자 */
	             , #USER_ID#				/* VAT_사용자아이디 */
	             , #CORP_NO#				/* VAT_법인번호 */
	             , #CORP_CELL#				/* VAT_사업자휴대전화 */
	             , #CORP_EMAIL#				/* VAT_전자메일주소 */
	             , #CORP_NM#				/* VAT_법인명 */
	             , #CORP_MASTER#			/* VAT_대표자명 */
	             , #CORP_LOCATION#			/* VAT_사업장소재지 */
	             , #CORP_TEL#				/* VAT_사업장전화번호 */
	             , #CORP_ADDR#				/* VAT_사업자주소 */
	             , #CORP_TYPENM#			/* VAT_업태명 */
	             , #CORP_LINE#				/* VAT_종목명 */
	             , #CORP_TYPECD#			/* VAT_업종코드 */
	             , #CORP_SYMD#				/* VAT_개업년월일 */
	             , #AGENT_NM#				/* VAT_세무대리인성명 */
	             , #AGENT_NO#				/* VAT_세무대리인관리번호 */
	             , #AGENT_TEL#				/* VAT_세무대리인전화번호 */
	             , #AGENT_BIZNO#			/* VAT_세무대리인사업자번호 */
	             , #REVISION_TYPECD#		/* VAT_보정신고구분 */
	             , #SH_TAXBIL_SAMT#			/* VAT_과표신고과세세금계산서금액 */
	             , #SH_TAXBIL_VAMT#			/* VAT_과표신고과세세금계산서세액 */
	             , #SH_PURPUB_SAMT#			/* VAT_과표신고과세매입자발행금액 */
	             , #SH_PURPUB_VAMT#			/* VAT_과표신고과세매입자발행세액 */
	             , #SH_CRECAS_SAMT#			/* VAT_과표신고신용카드현금영수증금액 */
	             , #SH_CRECAS_VAMT#			/* VAT_과표신고신용카드현금영수증세액 */
	             , #SH_TAXETC_SAMT#			/* VAT_과표신고과세기타금액 */
	             , #SH_TAXETC_VAMT#			/* VAT_과표신고과세기타세액 */
	             , #SH_ZERBIL_SAMT#			/* VAT_과표신고영세세금계산서금액 */
	             , #SH_ZERETC_SAMT#			/* VAT_과표신고영세기타금액 */
	             , #SH_WILMIS_SAMT#			/* VAT_과표예정신고누락분금액 */
	             , #SH_WILMIS_VAMT#			/* VAT_과표예정신고누락분세액 */
	             , #SH_DOUADD_SAMT#			/* VAT_대손세액가감금액 */
	             , #SH_DOUADD_VAMT#			/* VAT_대손세액가감세액 */
	             , #SALTOT_SAMT#			/* VAT_과세표준 */
	             , #SALTOT_VAMT#			/* VAT_산출세액 */
	             , #PH_TAXBIL_SAMT#			/* VAT_매입수취일반금액 */
	             , #PH_TAXBIL_VAMT#			/* VAT_매입수취일반세액 */
	             , #PH_ASSETS_SAMT#			/* VAT_매입수취고정자산금액 */
	             , #PH_ASSETS_VAMT#			/* VAT_매입수취고정자산세액 */
	             , #PH_WILTOT_SAMT#			/* VAT_매입예정신고누락금액 */
	             , #PH_WILTOT_VAMT#			/* VAT_매입예정신고누락세액 */
	             , #PH_PURPUB_SAMT#			/* VAT_매입매입자발행금액 */
	             , #PH_PURPUB_VAMT#			/* VAT_매입매입자발행세액 */
	             , #PH_ETCBIL_SAMT#			/* VAT_매입기타공제금액 */
	             , #PH_ETCBIL_VAMT#			/* VAT_매입기타공제세액 */
	             , #PH_PTOTAL_SAMT#			/* VAT_매입금액합계 */
	             , #PH_PTOTAL_VAMT#			/* VAT_매입세액합계 */
	             , #PH_UNABLE_SAMT#			/* VAT_매입공제받지못할금액 */
	             , #PH_UNABLE_VAMT#			/* VAT_매입공제받지못할세액 */
	             , #PH_ADDMIN_SAMT#			/* VAT_차감매입금액 */
	             , #PH_ADDMIN_VAMT#			/* VAT_차감매입세액 */
	             , #SP_RETURN_VAMT#			/* VAT_납부및환급세액 */
	             , #RH_ETCMIN_VAMT#			/* VAT_기타공제_경감세액 */
	             , #RH_CREDIT_SAMT#			/* VAT_금전신용공제금액 */
	             , #RH_CREDIT_VAMT#			/* VAT_금전신용공제세액 */
	             , #RH_MINTOT_VAMT#			/* VAT_경감세액계 */
	             , #RH_WILRET_VAMT#			/* VAT_예정미환급세액 */
	             , #RH_NOTRET_VAMT#			/* VAT_예정고지세액 */
	             , #RH_PROHIB_VAMT#			/* VAT_금지금매입자납부특례기납부세액 */
	             , #RH_ADDTOT_VAMT#			/* VAT_가산세계 */
	             , #PH_EXPOST_VAMT#         /* VAT_수출기업수입분납부유예 */
	             , #VAT_REF_VAMT#			/* VAT_실차감납부할세액 */
	             , #IH_EXCEPT_SAMT#			/* VAT_과세수입금액제외금액 */
	             , #IH_TAXBIL_SAMT#			/* VAT_과세수입금액합계 */
	             , #UPDT_USID#				/* 입력작업자 */
	             , SYSDATE					/* 입력일시 */
	             , #UPDT_USID#				/* 수정작업자 */
	             , SYSDATE					/* 수정일시 */
	               );
        ELSE
	        UPDATE TA_VAT101_H1									/* [부가가치세_헤더_1쪽] */
	           SET VAT_SYMD =  #VAT_YYYY# || DECODE(#VAT_QUARTER#, '1', '0101', '2', '0401', '3', '0701', '4', '1001')             /* VAT_과세기간_시작일 */
	             , VAT_EYMD =  #VAT_YYYY# || DECODE(#VAT_QUARTER#, '1', '0331', '2', '0630', '3', '0930', '4', '1231')             /* VAT_과세기간_종료일 */
	             , VAT_CYMD = #VAT_CYMD#						/* VAT_작성일자 */
	             , USER_ID = #USER_ID#							/* VAT_사용자아이디 */
	             , CORP_NO = #CORP_NO#							/* VAT_법인번호 */
	             , CORP_CELL = #CORP_CELL#						/* VAT_사업자휴대전화 */
	             , CORP_EMAIL = #CORP_EMAIL#					/* VAT_전자메일주소 */
	             , CORP_NM = #CORP_NM#							/* VAT_법인명 */
	             , CORP_MASTER = #CORP_MASTER#					/* VAT_대표자명 */
	             , CORP_LOCATION = #CORP_LOCATION#				/* VAT_사업장소재지 */
	             , CORP_TEL = #CORP_TEL#						/* VAT_사업장전화번호 */
	             , CORP_ADDR = #CORP_ADDR#						/* VAT_사업자주소 */
	             , CORP_TYPENM = #CORP_TYPENM#					/* VAT_업태명 */
	             , CORP_LINE = #CORP_LINE#						/* VAT_종목명 */
	             , CORP_TYPECD = #CORP_TYPECD#					/* VAT_업종코드 */
	             , CORP_SYMD = #CORP_SYMD#						/* VAT_개업년월일 */
	             , AGENT_NM = #AGENT_NM#						/* VAT_세무대리인성명 */
	             , AGENT_NO = #AGENT_NO#						/* VAT_세무대리인관리번호 */
	             , AGENT_TEL = #AGENT_TEL#						/* VAT_세무대리인전화번호 */
	             , AGENT_BIZNO = #AGENT_BIZNO#					/* VAT_세무대리인사업자번호 */
	             , REVISION_TYPECD = #REVISION_TYPECD#			/* VAT_보정신고구분 */
	             , SH_TAXBIL_SAMT = #SH_TAXBIL_SAMT#			/* VAT_과표신고과세세금계산서금액 */
	             , SH_TAXBIL_VAMT = #SH_TAXBIL_VAMT#			/* VAT_과표신고과세세금계산서세액 */
	             , SH_PURPUB_SAMT = #SH_PURPUB_SAMT#			/* VAT_과표신고과세매입자발행금액 */
	             , SH_PURPUB_VAMT = #SH_PURPUB_VAMT#			/* VAT_과표신고과세매입자발행세액 */
	             , SH_CRECAS_SAMT = #SH_CRECAS_SAMT#			/* VAT_과표신고신용카드현금영수증금액 */
	             , SH_CRECAS_VAMT = #SH_CRECAS_VAMT#			/* VAT_과표신고신용카드현금영수증세액 */
	             , SH_TAXETC_SAMT = #SH_TAXETC_SAMT#			/* VAT_과표신고과세기타금액 */
	             , SH_TAXETC_VAMT = #SH_TAXETC_VAMT#			/* VAT_과표신고과세기타세액 */
	             , SH_ZERBIL_SAMT = #SH_ZERBIL_SAMT#			/* VAT_과표신고영세세금계산서금액 */
	             , SH_ZERETC_SAMT = #SH_ZERETC_SAMT#			/* VAT_과표신고영세기타금액 */
	             , SH_WILMIS_SAMT = #SH_WILMIS_SAMT#			/* VAT_과표예정신고누락분금액 */
	             , SH_WILMIS_VAMT = #SH_WILMIS_VAMT#			/* VAT_과표예정신고누락분세액 */
	             , SH_DOUADD_SAMT = #SH_DOUADD_SAMT#			/* VAT_대손세액가감금액 */
	             , SH_DOUADD_VAMT = #SH_DOUADD_VAMT#			/* VAT_대손세액가감세액 */
	             , SALTOT_SAMT = #SALTOT_SAMT#					/* VAT_과세표준 */
	             , SALTOT_VAMT = #SALTOT_VAMT#					/* VAT_산출세액 */
	             , PH_TAXBIL_SAMT = #PH_TAXBIL_SAMT#			/* VAT_매입수취일반금액 */
	             , PH_TAXBIL_VAMT = #PH_TAXBIL_VAMT#			/* VAT_매입수취일반세액 */
	             , PH_ASSETS_SAMT = #PH_ASSETS_SAMT#			/* VAT_매입수취고정자산금액 */
	             , PH_ASSETS_VAMT = #PH_ASSETS_VAMT#			/* VAT_매입수취고정자산세액 */
	             , PH_WILTOT_SAMT = #PH_WILTOT_SAMT#			/* VAT_매입예정신고누락금액 */
	             , PH_WILTOT_VAMT = #PH_WILTOT_VAMT#			/* VAT_매입예정신고누락세액 */
	             , PH_PURPUB_SAMT = #PH_PURPUB_SAMT#			/* VAT_매입매입자발행금액 */
	             , PH_PURPUB_VAMT = #PH_PURPUB_VAMT#			/* VAT_매입매입자발행세액 */
	             , PH_ETCBIL_SAMT = #PH_ETCBIL_SAMT#			/* VAT_매입기타공제금액 */
	             , PH_ETCBIL_VAMT = #PH_ETCBIL_VAMT#			/* VAT_매입기타공제세액 */
	             , PH_PTOTAL_SAMT = #PH_PTOTAL_SAMT#			/* VAT_매입금액합계 */
	             , PH_PTOTAL_VAMT = #PH_PTOTAL_VAMT#			/* VAT_매입세액합계 */
	             , PH_UNABLE_SAMT = #PH_UNABLE_SAMT#			/* VAT_매입공제받지못할금액 */
	             , PH_UNABLE_VAMT = #PH_UNABLE_VAMT#			/* VAT_매입공제받지못할세액 */
	             , PH_ADDMIN_SAMT = #PH_ADDMIN_SAMT#			/* VAT_차감매입금액 */
	             , PH_ADDMIN_VAMT = #PH_ADDMIN_VAMT#			/* VAT_차감매입세액 */
	             , SP_RETURN_VAMT = #SP_RETURN_VAMT#			/* VAT_납부및환급세액 */
	             , RH_ETCMIN_VAMT = #RH_ETCMIN_VAMT#			/* VAT_기타공제_경감세액 */
	             , RH_CREDIT_SAMT = #RH_CREDIT_SAMT#			/* VAT_금전신용공제금액 */
	             , RH_CREDIT_VAMT = #RH_CREDIT_VAMT#			/* VAT_금전신용공제세액 */
	             , RH_MINTOT_VAMT = #RH_MINTOT_VAMT#			/* VAT_경감세액계 */
	             , RH_WILRET_VAMT = #RH_WILRET_VAMT#			/* VAT_예정미환급세액 */
	             , RH_NOTRET_VAMT = #RH_NOTRET_VAMT#			/* VAT_예정고지세액 */
	             , RH_PROHIB_VAMT = #RH_PROHIB_VAMT#			/* VAT_금지금매입자납부특례기납부세액 */
	             , RH_ADDTOT_VAMT = #RH_ADDTOT_VAMT#			/* VAT_가산세계 */	               
	             , PH_EXPOST_VAMT = #PH_EXPOST_VAMT#            /* VAT_수출기업수입분납부유예 */
	             , VAT_REF_VAMT   = #VAT_REF_VAMT#				/* VAT_실차감납부할세액 */
	             , IH_EXCEPT_SAMT = #IH_EXCEPT_SAMT#			/* VAT_과세수입금액제외금액 */
	             , IH_TAXBIL_SAMT = #IH_TAXBIL_SAMT#			/* VAT_과세수입금액합계 */
	             , UPDT_USID = #UPDT_USID#						/* 수정작업자 */
	             , UPDT_DATE = SYSDATE							/* 수정일시 */
	         WHERE BRANCH_CD  = #BRANCH_CD#						/* VAT_지점코드 */
	           AND VAT_YYYY  = #VAT_YYYY#						/* VAT_VAT년도 */
	           AND VAT_QUARTER  = #VAT_QUARTER#					/* VAT_VAT분기 */;
        END IF;
    END;
    ]]>
    </insert>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내      용  : 부가가치세신고서(2페이지) 저장
******************************************************************************* */
-->
    <insert id="TXMC0160.SAVE01" parameterClass="hashmap">
    <![CDATA[
    DECLARE
        /* TXMC0160.SAVE01.부가가치세신고서(2페이지) 저장 */
        v_ROWCNT INT;
    BEGIN
        SELECT COUNT(0) INTO v_ROWCNT
          FROM TA_VAT101_H2
         WHERE BRANCH_CD = #BRANCH_CD#
           AND VAT_YYYY = #VAT_YYYY#
           AND VAT_QUARTER = #VAT_QUARTER#;

        IF v_ROWCNT = 0 THEN
	        INSERT INTO TA_VAT101_H2 (		/* [부가가치세_헤더_2쪽] */
	               BRANCH_CD				/* VAT_지점코드 */
	             , VAT_YYYY					/* VAT_VAT년도 */
	             , VAT_QUARTER				/* VAT_VAT분기 */
	             , SW_TAXBIL_SAMT			/* VAT_과표예정과세세금계산서금액 */
	             , SW_TAXBIL_VAMT			/* VAT_과표예정과세세금계산서세액 */
	             , SW_TAXETC_SAMT			/* VAT_과표예정과세기타금액 */
	             , SW_TAXETC_VAMT			/* VAT_과표예정과세기타세액 */
	             , SW_ZERBIL_SAMT			/* VAT_과표예정영세세금계산서금액 */
	             , SW_ZERETC_SAMT			/* VAT_과표예정영세기타금액 */
	             , SW_SALTOT_SAMT			/* VAT_과표예정신고누락분금액합계 */
	             , SW_SALTOT_VAMT			/* VAT_과표예정신고누락분세액합계 */
	             , PW_TAXBIL_SAMT			/* VAT_예정매입세금계산서누락금액 */
	             , PW_TAXBIL_VAMT			/* VAT_예정매입세금계산서누락세액 */
	             , PW_ETCBIL_SAMT			/* VAT_예정매입기타공제누락세액금액 */
	             , PW_ETCBIL_VAMT			/* VAT_예정매입기타공제누락세액세액 */
	             , PW_PURTOT_SAMT			/* VAT_예정매입누락합계금액 */
	             , PW_PURTOT_VAMT			/* VAT_예정매입누락합계세액 */
	             , PD_CREDIT_SAMT			/* VAT_매입금전신용금액 */
	             , PD_CREDIT_VAMT			/* VAT_매입금전신용세액 */
	             , PD_AGENDA_SAMT			/* VAT_매입의제매입금액 */
	             , PD_AGENDA_VAMT			/* VAT_매입의제매입세액 */
	             , PD_RECYCL_SAMT			/* VAT_매입재활용금액 */
	             , PD_RECYCL_VAMT			/* VAT_매입재활용세액 */
	             , PD_CONVER_VAMT			/* VAT_과세사업전환매입세액 */
	             , PD_ALAGEN_SAMT			/* VAT_매입고금의제매입금액 */
	             , PD_ALAGEN_VAMT			/* VAT_매입고금의제매입세액 */
	             , PD_ASSETS_SAMT			/* VAT_매입신용고정자산금액 */
	             , PD_ASSETS_VAMT			/* VAT_매입신용고정자산세액 */
	             , PD_STOCKP_VAMT			/* VAT_매입재고매입세액 */
	             , PD_BADDEP_VAMT			/* VAT_매입변제대손세액 */
	             , PD_PURTOT_SAMT			/* VAT_기타공제매입금액합계 */
	             , PD_PURTOT_VAMT			/* VAT_기타공제매입세액합계 */
	             , PN_UNABLE_SAMT			/* VAT_불공제매입금액 */
	             , PN_UNABLE_VAMT			/* VAT_불공제매입세액총액 */
	             , PN_EXCEPT_SAMT			/* VAT_공통매입면세사업금액 */
	             , PN_EXCEPT_VAMT			/* VAT_공통매입면세사업세액 */
	             , PN_DOUADD_SAMT			/* VAT_대손처분금액 */
	             , PN_DOUADD_VAMT			/* VAT_대손처분세액 */
	             , PN_PURTOT_SAMT			/* VAT_매입공제받지못할금액합계 */
	             , PN_PURTOT_VAMT			/* VAT_매입공제받지못할세액합계 */
	             , RD_EBIPAY_VAMT			/* VAT_전자신고공제세액 */
	             , RD_EBITAX_VAMT			/* VAT_전자세금계산서발급세액공제세액 */
	             , RD_TAXICO_VAMT			/* VAT_택시사업부가가치세경감세액 */
	             , RD_CASBIL_VAMT			/* VAT_현금영수증사업자공제세액 */
	             , RD_ETCBIL_VAMT			/* VAT_기타경감공제세액명세기타세액 */
	             , AD_BIZMIS_SAMT			/* VAT_사업자등록가산금액 */
	             , AD_BIZMIS_VAMT			/* VAT_사업자등록가산세 */
	             , AD_EBIDEL_SAMT			/* VAT_세금계산서지연발급등가산금액 */
	             , AD_EBIDEL_VAMT			/* VAT_세금계산서지연발급등가산세액 */
	             , AD_NOTPUB_SAMT			/* VAT_세금계산서미발급등가산금액 */
	             , AD_NOTPUB_VAMT			/* VAT_세금계산서미발급등가산세액 */
	             , AD_EBIOVE_SAMT			/* VAT_ebill전송가산금액_다음달15일후 */
	             , AD_EBIOVE_VAMT			/* VAT_ebill전송가산세액_다음달15일후 */
	             , AD_EBIEXC_SAMT			/* VAT_ebill전송가산금액_과세다음달15일후 */
	             , AD_EBIEXC_VAMT			/* VAT_ebill전송가산세액_과세다음달15일후 */
	             , AD_TAXBIL_SAMT			/* VAT_세금계산서합계표가산금액 */
	             , AD_TAXBIL_VAMT			/* VAT_세금계산서합계표가산세액 */
	             , AD_REPORT_SAMT			/* VAT_신고불성실가산금액 */
	             , AD_REPORT_VAMT			/* VAT_신고불성실가산세액 */
	             , AD_NOSEND_SAMT			/* VAT_납부불성실가산금액 */
	             , AD_NOSEND_VAMT			/* VAT_납부불성실가산세액 */
	             , AD_ZERBIL_SAMT			/* VAT_영세율신고가산금액 */
	             , AD_ZERBIL_VAMT			/* VAT_영세율신고가산세액 */
	             , AD_CASNOT_SAMT			/* VAT_현금매출명세서미제출등가산금액 */
	             , AD_CASNOT_VAMT			/* VAT_현금매출명세서미제출등가산세액 */
	             , AD_ADDTOT_VAMT			/* VAT_가산세세액계 */
	             , DF_EXCEPT_SAMT			/* VAT_면세수입금액제외금액 */
	             , DF_TAXBIL_SAMT			/* VAT_면세수입금액합계 */
	             , BD_SALTOT_SAMT			/* VAT_계산서발급금액 */
	             , BD_PURTOT_SAMT			/* VAT_계산서수취금액 */
	             , REFUND_TYPECD			/* VAT_환급구분 */
	             , VAT_BANKCD				/* VAT_국세환급금은행코드 */
	             , VAT_BANKNO				/* VAT_국세환급금계좌번호 */
	             , VAT_TOTPAYNO				/* VAT_총괄납부승인번호 */
	             , VAT_BANKBRANCH			/* VAT_은행지점명 */
	             , CORP_EYMD				/* VAT_폐업일자 */
	             , CLOSING_REMARK			/* VAT_폐업사유 */
	             , VAT_REF_VAMT				/* VAT_실차감납부할세액 */
	             , VAT_NTAX_TYPECD			/* VAT_일반과세자구분 */
	             , VAT_EARLY_TYPECD			/* VAT_조기환급취소구분 */
	             , CORP_TYPENM				/* VAT_업태명 */
	             , CORP_LINE				/* VAT_종목명 */
	             , CORP_TYPECD				/* VAT_업종코드 */
	             , BRANCH_APPRNO			/* VAT_사업자단위과세승인번호 */
	             , AD_TAXDEL_SAMT			/* VAT_세금계산서합계표지연제출금액 */
	             , AD_TAXDEL_VAMT			/* VAT_세금계산서합계표지연제출세액 */
	             , AD_REPOR1_SAMT			/* VAT_신고불성실_무신고(일반)금액 */
	             , AD_REPOR1_VAMT			/* VAT_신고불성실_무신고(일반)세액 */
	             , AD_REPOR2_SAMT			/* VAT_신고불성실_무신고(부당)금액 */
	             , AD_REPOR2_VAMT			/* VAT_신고불성실_무신고(부당)세액 */
	             , AD_REPOR3_SAMT			/* VAT_과소·초과환급신고(일반)금액 */
	             , AD_REPOR3_VAMT			/* VAT_과소·초과환급신고(일반)세액 */
	             , AD_REPOR4_SAMT			/* VAT_과소·초과환급신고(부당)금액 */
	             , AD_REPOR4_VAMT			/* VAT_과소·초과환급신고(부당)세액 */
	             , AD_ESTATE_SAMT			/* VAT_부동산임대공급가액명세서 불성실금액 */
	             , AD_ESTATE_VAMT			/* VAT_부동산입대공급가액명세서 불성실세액 */
	             , AD_EBDERV_SAMT			/* VAT_세금계산서지연수취가산금액 */
	             , AD_EBDERV_VAMT			/* VAT_세금계산서지연수취가산세액 */
	             , INST_USID				/* 입력작업자 */
	             , INST_DATE				/* 입력일시 */
	             , UPDT_USID				/* 수정작업자 */
	             , UPDT_DATE				/* 수정일시 */
	             , PD_FOREINER_VAMT			/* VAT_매입외국인관광객환급세액 */
	             , AD_ACCNOT_SAMT			/* VAT_거래계좌미사용가산금액 */
	             , AD_ACCNOT_VAMT			/* VAT_거래계좌미사용가산세액 */
	             , AD_ACCDELAY_SAMT			/* VAT_거래계좌지연입금가산금액 */
	             , AD_ACCDELAY_VAMT			/* VAT_거래계좌지연입금가산세액 */
	               )
	        VALUES (
	               #BRANCH_CD#				/* VAT_지점코드 */
	             , #VAT_YYYY#				/* VAT_VAT년도 */
	             , #VAT_QUARTER#			/* VAT_VAT분기 */
	             , #SW_TAXBIL_SAMT#			/* VAT_과표예정과세세금계산서금액 */
	             , #SW_TAXBIL_VAMT#			/* VAT_과표예정과세세금계산서세액 */
	             , #SW_TAXETC_SAMT#			/* VAT_과표예정과세기타금액 */
	             , #SW_TAXETC_VAMT#			/* VAT_과표예정과세기타세액 */
	             , #SW_ZERBIL_SAMT#			/* VAT_과표예정영세세금계산서금액 */
	             , #SW_ZERETC_SAMT#			/* VAT_과표예정영세기타금액 */
	             , #SW_SALTOT_SAMT#			/* VAT_과표예정신고누락분금액합계 */
	             , #SW_SALTOT_VAMT#			/* VAT_과표예정신고누락분세액합계 */
	             , #PW_TAXBIL_SAMT#			/* VAT_예정매입세금계산서누락금액 */
	             , #PW_TAXBIL_VAMT#			/* VAT_예정매입세금계산서누락세액 */
	             , #PW_ETCBIL_SAMT#			/* VAT_예정매입기타공제누락세액금액 */
	             , #PW_ETCBIL_VAMT#			/* VAT_예정매입기타공제누락세액세액 */
	             , #PW_PURTOT_SAMT#			/* VAT_예정매입누락합계금액 */
	             , #PW_PURTOT_VAMT#			/* VAT_예정매입누락합계세액 */
	             , #PD_CREDIT_SAMT#			/* VAT_매입금전신용금액 */
	             , #PD_CREDIT_VAMT#			/* VAT_매입금전신용세액 */
	             , #PD_AGENDA_SAMT#			/* VAT_매입의제매입금액 */
	             , #PD_AGENDA_VAMT#			/* VAT_매입의제매입세액 */
	             , #PD_RECYCL_SAMT#			/* VAT_매입재활용금액 */
	             , #PD_RECYCL_VAMT#			/* VAT_매입재활용세액 */
	             , #PD_CONVER_VAMT#			/* VAT_과세사업전환매입세액 */
	             , #PD_ALAGEN_SAMT#			/* VAT_매입고금의제매입금액 */
	             , #PD_ALAGEN_VAMT#			/* VAT_매입고금의제매입세액 */
	             , #PD_ASSETS_SAMT#			/* VAT_매입신용고정자산금액 */
	             , #PD_ASSETS_VAMT#			/* VAT_매입신용고정자산세액 */
	             , #PD_STOCKP_VAMT#			/* VAT_매입재고매입세액 */
	             , #PD_BADDEP_VAMT#			/* VAT_매입변제대손세액 */
	             , #PD_PURTOT_SAMT#			/* VAT_기타공제매입금액합계 */
	             , #PD_PURTOT_VAMT#			/* VAT_기타공제매입세액합계 */
	             , #PN_UNABLE_SAMT#			/* VAT_불공제매입금액 */
	             , #PN_UNABLE_VAMT#			/* VAT_불공제매입세액총액 */
	             , #PN_EXCEPT_SAMT#			/* VAT_공통매입면세사업금액 */
	             , #PN_EXCEPT_VAMT#			/* VAT_공통매입면세사업세액 */
	             , #PN_DOUADD_SAMT#			/* VAT_대손처분금액 */
	             , #PN_DOUADD_VAMT#			/* VAT_대손처분세액 */
	             , #PN_PURTOT_SAMT#			/* VAT_매입공제받지못할금액합계 */
	             , #PN_PURTOT_VAMT#			/* VAT_매입공제받지못할세액합계 */
	             , #RD_EBIPAY_VAMT#			/* VAT_전자신고공제세액 */
	             , #RD_EBITAX_VAMT#			/* VAT_전자세금계산서발급세액공제세액 */
	             , #RD_TAXICO_VAMT#			/* VAT_택시사업부가가치세경감세액 */
	             , #RD_CASBIL_VAMT#			/* VAT_현금영수증사업자공제세액 */
	             , #RD_ETCBIL_VAMT#			/* VAT_기타경감공제세액명세기타세액 */
	             , #AD_BIZMIS_SAMT#			/* VAT_사업자등록가산금액 */
	             , #AD_BIZMIS_VAMT#			/* VAT_사업자등록가산세 */
	             , #AD_EBIDEL_SAMT#			/* VAT_세금계산서지연발급등가산금액 */
	             , #AD_EBIDEL_VAMT#			/* VAT_세금계산서지연발급등가산세액 */
	             , #AD_NOTPUB_SAMT#			/* VAT_세금계산서미발급등가산금액 */
	             , #AD_NOTPUB_VAMT#			/* VAT_세금계산서미발급등가산세액 */
	             , #AD_EBIOVE_SAMT#			/* VAT_ebill전송가산금액_다음달15일후 */
	             , #AD_EBIOVE_VAMT#			/* VAT_ebill전송가산세액_다음달15일후 */
	             , #AD_EBIEXC_SAMT#			/* VAT_ebill전송가산금액_과세다음달15일후 */
	             , #AD_EBIEXC_VAMT#			/* VAT_ebill전송가산세액_과세다음달15일후 */
	             , #AD_TAXBIL_SAMT#			/* VAT_세금계산서합계표가산금액 */
	             , #AD_TAXBIL_VAMT#			/* VAT_세금계산서합계표가산세액 */
	             , #AD_REPORT_SAMT#			/* VAT_신고불성실가산금액 */
	             , #AD_REPORT_VAMT#			/* VAT_신고불성실가산세액 */
	             , #AD_NOSEND_SAMT#			/* VAT_납부불성실가산금액 */
	             , #AD_NOSEND_VAMT#			/* VAT_납부불성실가산세액 */
	             , #AD_ZERBIL_SAMT#			/* VAT_영세율신고가산금액 */
	             , #AD_ZERBIL_VAMT#			/* VAT_영세율신고가산세액 */
	             , #AD_CASNOT_SAMT#			/* VAT_현금매출명세서미제출등가산금액 */
	             , #AD_CASNOT_VAMT#			/* VAT_현금매출명세서미제출등가산세액 */
	             , #AD_ADDTOT_VAMT#			/* VAT_가산세세액계 */
	             , #DF_EXCEPT_SAMT#			/* VAT_면세수입금액제외금액 */
	             , #DF_TAXBIL_SAMT#			/* VAT_면세수입금액합계 */
	             , #BD_SALTOT_SAMT#			/* VAT_계산서발급금액 */
	             , #BD_PURTOT_SAMT#			/* VAT_계산서수취금액 */
	             , #REFUND_TYPECD#			/* VAT_환급구분 */
	             , #VAT_BANKCD#				/* VAT_국세환급금은행코드 */
	             , #VAT_BANKNO#				/* VAT_국세환급금계좌번호 */
	             , #VAT_TOTPAYNO#			/* VAT_총괄납부승인번호 */
	             , #VAT_BANKBRANCH#			/* VAT_은행지점명 */
	             , #CORP_EYMD#				/* VAT_폐업일자 */
	             , #CLOSING_REMARK#			/* VAT_폐업사유 */
	             , #VAT_REF_VAMT#			/* VAT_실차감납부할세액 */
	             , #VAT_NTAX_TYPECD#		/* VAT_일반과세자구분 */
	             , #VAT_EARLY_TYPECD#		/* VAT_조기환급취소구분 */
	             , #CORP_TYPENM#			/* VAT_업태명 */
	             , #CORP_LINE#				/* VAT_종목명 */
	             , #CORP_TYPECD#			/* VAT_업종코드 */
	             , #BRANCH_APPRNO#			/* VAT_사업자단위과세승인번호 */
	             , #AD_TAXDEL_SAMT#			/* VAT_세금계산서합계표지연제출금액 */
	             , #AD_TAXDEL_VAMT#			/* VAT_세금계산서합계표지연제출세액 */
	             , #AD_REPOR1_SAMT#			/* VAT_신고불성실_무신고(일반)금액 */
	             , #AD_REPOR1_VAMT#			/* VAT_신고불성실_무신고(일반)세액 */
	             , #AD_REPOR2_SAMT#			/* VAT_신고불성실_무신고(부당)금액 */
	             , #AD_REPOR2_VAMT#			/* VAT_신고불성실_무신고(부당)세액 */
	             , #AD_REPOR3_SAMT#			/* VAT_과소·초과환급신고(일반)금액 */
	             , #AD_REPOR3_VAMT#			/* VAT_과소·초과환급신고(일반)세액 */
	             , #AD_REPOR4_SAMT#			/* VAT_과소·초과환급신고(부당)금액 */
	             , #AD_REPOR4_VAMT#			/* VAT_과소·초과환급신고(부당)세액 */
	             , #AD_ESTATE_SAMT#			/* VAT_부동산임대공급가액명세서 불성실금액 */
	             , #AD_ESTATE_VAMT#			/* VAT_부동산입대공급가액명세서 불성실세액 */
	             , #AD_EBDERV_SAMT#			/* VAT_세금계산서지연수취가산금액 */
	             , #AD_EBDERV_VAMT#			/* VAT_세금계산서지연수취가산세액 */
	             , #UPDT_USID#				/* 입력작업자 */
	             , SYSDATE					/* 입력일시 */
	             , #UPDT_USID#				/* 수정작업자 */
	             , SYSDATE					/* 수정일시 */
	             , #PD_FOREINER_VAMT#		/* VAT_매입외국인관광객환급세액 */
	             , #AD_ACCNOT_SAMT#			/* VAT_거래계좌미사용가산금액 */
	             , #AD_ACCNOT_VAMT#			/* VAT_거래계좌미사용가산세액 */
	             , #AD_ACCDELAY_SAMT#		/* VAT_거래계좌지연입금가산금액 */
	             , #AD_ACCDELAY_VAMT#		/* VAT_거래계좌지연입금가산세액 */
	             );
        ELSE
			UPDATE TA_VAT101_H2									/* [부가가치세_헤더_2쪽] */
			   SET SW_TAXBIL_SAMT = #SW_TAXBIL_SAMT#			/* VAT_과표예정과세세금계산서금액 */
				 , SW_TAXBIL_VAMT = #SW_TAXBIL_VAMT#			/* VAT_과표예정과세세금계산서세액 */
				 , SW_TAXETC_SAMT = #SW_TAXETC_SAMT#			/* VAT_과표예정과세기타금액 */
				 , SW_TAXETC_VAMT = #SW_TAXETC_VAMT#			/* VAT_과표예정과세기타세액 */
				 , SW_ZERBIL_SAMT = #SW_ZERBIL_SAMT#			/* VAT_과표예정영세세금계산서금액 */
				 , SW_ZERETC_SAMT = #SW_ZERETC_SAMT#			/* VAT_과표예정영세기타금액 */
				 , SW_SALTOT_SAMT = #SW_SALTOT_SAMT#			/* VAT_과표예정신고누락분금액합계 */
				 , SW_SALTOT_VAMT = #SW_SALTOT_VAMT#			/* VAT_과표예정신고누락분세액합계 */
				 , PW_TAXBIL_SAMT = #PW_TAXBIL_SAMT#			/* VAT_예정매입세금계산서누락금액 */
				 , PW_TAXBIL_VAMT = #PW_TAXBIL_VAMT#			/* VAT_예정매입세금계산서누락세액 */
				 , PW_ETCBIL_SAMT = #PW_ETCBIL_SAMT#			/* VAT_예정매입기타공제누락세액금액 */
				 , PW_ETCBIL_VAMT = #PW_ETCBIL_VAMT#			/* VAT_예정매입기타공제누락세액세액 */
				 , PW_PURTOT_SAMT = #PW_PURTOT_SAMT#			/* VAT_예정매입누락합계금액 */
				 , PW_PURTOT_VAMT = #PW_PURTOT_VAMT#			/* VAT_예정매입누락합계세액 */
				 , PD_CREDIT_SAMT = #PD_CREDIT_SAMT#			/* VAT_매입금전신용금액 */
				 , PD_CREDIT_VAMT = #PD_CREDIT_VAMT#			/* VAT_매입금전신용세액 */
				 , PD_AGENDA_SAMT = #PD_AGENDA_SAMT#			/* VAT_매입의제매입금액 */
				 , PD_AGENDA_VAMT = #PD_AGENDA_VAMT#			/* VAT_매입의제매입세액 */
				 , PD_RECYCL_SAMT = #PD_RECYCL_SAMT#			/* VAT_매입재활용금액 */
				 , PD_RECYCL_VAMT = #PD_RECYCL_VAMT#			/* VAT_매입재활용세액 */
				 , PD_CONVER_VAMT = #PD_CONVER_VAMT#			/* VAT_과세사업전환매입세액 */
				 , PD_ALAGEN_SAMT = #PD_ALAGEN_SAMT#			/* VAT_매입고금의제매입금액 */
				 , PD_ALAGEN_VAMT = #PD_ALAGEN_VAMT#			/* VAT_매입고금의제매입세액 */
				 , PD_ASSETS_SAMT = #PD_ASSETS_SAMT#			/* VAT_매입신용고정자산금액 */
				 , PD_ASSETS_VAMT = #PD_ASSETS_VAMT#			/* VAT_매입신용고정자산세액 */
				 , PD_STOCKP_VAMT = #PD_STOCKP_VAMT#			/* VAT_매입재고매입세액 */
				 , PD_BADDEP_VAMT = #PD_BADDEP_VAMT#			/* VAT_매입변제대손세액 */
				 , PD_PURTOT_SAMT = #PD_PURTOT_SAMT#			/* VAT_기타공제매입금액합계 */
				 , PD_PURTOT_VAMT = #PD_PURTOT_VAMT#			/* VAT_기타공제매입세액합계 */
				 , PN_UNABLE_SAMT = #PN_UNABLE_SAMT#			/* VAT_불공제매입금액 */
				 , PN_UNABLE_VAMT = #PN_UNABLE_VAMT#			/* VAT_불공제매입세액총액 */
				 , PN_EXCEPT_SAMT = #PN_EXCEPT_SAMT#			/* VAT_공통매입면세사업금액 */
				 , PN_EXCEPT_VAMT = #PN_EXCEPT_VAMT#			/* VAT_공통매입면세사업세액 */
				 , PN_DOUADD_SAMT = #PN_DOUADD_SAMT#			/* VAT_대손처분금액 */
				 , PN_DOUADD_VAMT = #PN_DOUADD_VAMT#			/* VAT_대손처분세액 */
				 , PN_PURTOT_SAMT = #PN_PURTOT_SAMT#			/* VAT_매입공제받지못할금액합계 */
				 , PN_PURTOT_VAMT = #PN_PURTOT_VAMT#			/* VAT_매입공제받지못할세액합계 */
				 , RD_EBIPAY_VAMT = #RD_EBIPAY_VAMT#			/* VAT_전자신고공제세액 */
				 , RD_EBITAX_VAMT = #RD_EBITAX_VAMT#			/* VAT_전자세금계산서발급세액공제세액 */
				 , RD_TAXICO_VAMT = #RD_TAXICO_VAMT#			/* VAT_택시사업부가가치세경감세액 */
				 , RD_CASBIL_VAMT = #RD_CASBIL_VAMT#			/* VAT_현금영수증사업자공제세액 */
				 , RD_ETCBIL_VAMT = #RD_ETCBIL_VAMT#			/* VAT_기타경감공제세액명세기타세액 */
				 , AD_BIZMIS_SAMT = #AD_BIZMIS_SAMT#			/* VAT_사업자등록가산금액 */
				 , AD_BIZMIS_VAMT = #AD_BIZMIS_VAMT#			/* VAT_사업자등록가산세 */
				 , AD_EBIDEL_SAMT = #AD_EBIDEL_SAMT#			/* VAT_세금계산서지연발급등가산금액 */
				 , AD_EBIDEL_VAMT = #AD_EBIDEL_VAMT#			/* VAT_세금계산서지연발급등가산세액 */
				 , AD_NOTPUB_SAMT = #AD_NOTPUB_SAMT#			/* VAT_세금계산서미발급등가산금액 */
				 , AD_NOTPUB_VAMT = #AD_NOTPUB_VAMT#			/* VAT_세금계산서미발급등가산세액 */
				 , AD_EBIOVE_SAMT = #AD_EBIOVE_SAMT#			/* VAT_ebill전송가산금액_다음달15일후 */
				 , AD_EBIOVE_VAMT = #AD_EBIOVE_VAMT#			/* VAT_ebill전송가산세액_다음달15일후 */
				 , AD_EBIEXC_SAMT = #AD_EBIEXC_SAMT#			/* VAT_ebill전송가산금액_과세다음달15일후 */
				 , AD_EBIEXC_VAMT = #AD_EBIEXC_VAMT#			/* VAT_ebill전송가산세액_과세다음달15일후 */
				 , AD_TAXBIL_SAMT = #AD_TAXBIL_SAMT#			/* VAT_세금계산서합계표가산금액 */
				 , AD_TAXBIL_VAMT = #AD_TAXBIL_VAMT#			/* VAT_세금계산서합계표가산세액 */
				 , AD_REPORT_SAMT = #AD_REPORT_SAMT#			/* VAT_신고불성실가산금액 */
				 , AD_REPORT_VAMT = #AD_REPORT_VAMT#			/* VAT_신고불성실가산세액 */
				 , AD_NOSEND_SAMT = #AD_NOSEND_SAMT#			/* VAT_납부불성실가산금액 */
				 , AD_NOSEND_VAMT = #AD_NOSEND_VAMT#			/* VAT_납부불성실가산세액 */
				 , AD_ZERBIL_SAMT = #AD_ZERBIL_SAMT#			/* VAT_영세율신고가산금액 */
				 , AD_ZERBIL_VAMT = #AD_ZERBIL_VAMT#			/* VAT_영세율신고가산세액 */
				 , AD_CASNOT_SAMT = #AD_CASNOT_SAMT#			/* VAT_현금매출명세서미제출등가산금액 */
				 , AD_CASNOT_VAMT = #AD_CASNOT_VAMT#			/* VAT_현금매출명세서미제출등가산세액 */
				 , AD_ADDTOT_VAMT = #AD_ADDTOT_VAMT#			/* VAT_가산세세액계 */
				 , DF_EXCEPT_SAMT = #DF_EXCEPT_SAMT#			/* VAT_면세수입금액제외금액 */
				 , DF_TAXBIL_SAMT = #DF_TAXBIL_SAMT#			/* VAT_면세수입금액합계 */
				 , BD_SALTOT_SAMT = #BD_SALTOT_SAMT#			/* VAT_계산서발급금액 */
				 , BD_PURTOT_SAMT = #BD_PURTOT_SAMT#			/* VAT_계산서수취금액 */
				 , REFUND_TYPECD = #REFUND_TYPECD#				/* VAT_환급구분 */
				 , VAT_BANKCD = #VAT_BANKCD#					/* VAT_국세환급금은행코드 */
				 , VAT_BANKNO = #VAT_BANKNO#					/* VAT_국세환급금계좌번호 */
				 , VAT_TOTPAYNO = #VAT_TOTPAYNO#				/* VAT_총괄납부승인번호 */
				 , VAT_BANKBRANCH = #VAT_BANKBRANCH#			/* VAT_은행지점명 */
				 , CORP_EYMD = #CORP_EYMD#						/* VAT_폐업일자 */
				 , CLOSING_REMARK = #CLOSING_REMARK#			/* VAT_폐업사유 */
				 , VAT_REF_VAMT = #VAT_REF_VAMT#				/* VAT_실차감납부할세액 */
				 , VAT_NTAX_TYPECD = #VAT_NTAX_TYPECD#			/* VAT_일반과세자구분 */
				 , VAT_EARLY_TYPECD = #VAT_EARLY_TYPECD#		/* VAT_조기환급취소구분 */
				 , CORP_TYPENM = #CORP_TYPENM#					/* VAT_업태명 */
				 , CORP_LINE = #CORP_LINE#						/* VAT_종목명 */
				 , CORP_TYPECD = #CORP_TYPECD#					/* VAT_업종코드 */
				 , BRANCH_APPRNO = #BRANCH_APPRNO#				/* VAT_사업자단위과세승인번호 */
				 , AD_TAXDEL_SAMT = #AD_TAXDEL_SAMT#			/* VAT_세금계산서합계표지연제출금액 */
				 , AD_TAXDEL_VAMT = #AD_TAXDEL_VAMT#			/* VAT_세금계산서합계표지연제출세액 */
				 , AD_REPOR1_SAMT = #AD_REPOR1_SAMT#			/* VAT_신고불성실_무신고(일반)금액 */
				 , AD_REPOR1_VAMT = #AD_REPOR1_VAMT#			/* VAT_신고불성실_무신고(일반)세액 */
				 , AD_REPOR2_SAMT = #AD_REPOR2_SAMT#			/* VAT_신고불성실_무신고(부당)금액 */
				 , AD_REPOR2_VAMT = #AD_REPOR2_VAMT#			/* VAT_신고불성실_무신고(부당)세액 */
				 , AD_REPOR3_SAMT = #AD_REPOR3_SAMT#			/* VAT_과소·초과환급신고(일반)금액 */
				 , AD_REPOR3_VAMT = #AD_REPOR3_VAMT#			/* VAT_과소·초과환급신고(일반)세액 */
				 , AD_REPOR4_SAMT = #AD_REPOR4_SAMT#			/* VAT_과소·초과환급신고(부당)금액 */
				 , AD_REPOR4_VAMT = #AD_REPOR4_VAMT#			/* VAT_과소·초과환급신고(부당)세액 */
				 , AD_ESTATE_SAMT = #AD_ESTATE_SAMT#			/* VAT_부동산임대공급가액명세서 불성실금액 */
				 , AD_ESTATE_VAMT = #AD_ESTATE_VAMT#			/* VAT_부동산입대공급가액명세서 불성실세액 */
				 , AD_EBDERV_SAMT = #AD_EBDERV_SAMT#			/* VAT_세금계산서지연수취가산금액 */
				 , AD_EBDERV_VAMT = #AD_EBDERV_VAMT#			/* VAT_세금계산서지연수취가산세액 */
				 , UPDT_USID = #UPDT_USID#						/* 수정작업자 */
				 , UPDT_DATE = SYSDATE							/* 수정일시 */
				 , PD_FOREINER_VAMT = #PD_FOREINER_VAMT#		/* VAT_매입외국인관광객환급세액 */
				 , AD_ACCNOT_SAMT = #AD_ACCNOT_SAMT#			/* VAT_거래계좌미사용가산금액 */
				 , AD_ACCNOT_VAMT = #AD_ACCNOT_VAMT#			/* VAT_거래계좌미사용가산세액 */
				 , AD_ACCDELAY_SAMT = #AD_ACCDELAY_SAMT#		/* VAT_거래계좌지연입금가산금액 */
				 , AD_ACCDELAY_VAMT = #AD_ACCDELAY_VAMT#		/* VAT_거래계좌지연입금가산세액 */
			 WHERE BRANCH_CD  = #BRANCH_CD#						/* VAT_지점코드 */
			   AND VAT_YYYY  = #VAT_YYYY#						/* VAT_VAT년도 */
			   AND VAT_QUARTER  = #VAT_QUARTER#					/* VAT_VAT분기 */
	           ;
        END IF;
    END;
    ]]>
    </insert>
<!-- 
/* ******************************************************************************
    작  성  자 : 황치웅
    작  성  일 : 2016.08.05
    내       용 : 부가가치세신고서(과세표준명세) 저장
******************************************************************************* */
-->
    <insert id="TXMC0160.SAVE02" parameterClass="hashmap">
    <![CDATA[
    DECLARE
        /* TXMC0160.SAVE02.부가가치세신고서(과세표준명세) 저장 */
        v_ROWCNT INT;
    BEGIN
        SELECT COUNT(0) 
          INTO v_ROWCNT
          FROM TA_VAT101_D
         WHERE BRANCH_CD   = #BRANCH_CD#
           AND VAT_YYYY    = #VAT_YYYY#
           AND VAT_QUARTER = #VAT_QUARTER#
           AND INCOME_SEQ  = #INCOME_SEQ#;

        IF v_ROWCNT = 0 THEN
	        INSERT INTO TA_VAT101_D (	/* [부가가치세_세부_수입금액] */
	               BRANCH_CD			/* VAT_지점코드 */
	             , VAT_YYYY				/* VAT_VAT년도 */
	             , VAT_QUARTER			/* VAT_VAT분기 */
	             , INCOME_SEQ			/* VAT_수입금액라인 */
	             , INCOME_TYPECD		/* VAT_수입금액종류구분 */
	             , CORP_TYPENM			/* VAT_업태명 */
	             , CORP_LINE			/* VAT_종목명 */
	             , CORP_TYPECD			/* VAT_업종코드 */
	             , INCOME_SAMT			/* VAT_수입금액 */
	             , INST_USID			/* 입력작업자 */
	             , INST_DATE			/* 입력일시 */
	             , UPDT_USID			/* 수정작업자 */
	             , UPDT_DATE			/* 수정일시 */
	               )
	        VALUES (
	               #BRANCH_CD#			/* VAT_지점코드 */
	             , #VAT_YYYY#			/* VAT_VAT년도 */
	             , #VAT_QUARTER#		/* VAT_VAT분기 */
	             , #INCOME_SEQ#			/* VAT_수입금액라인 */
	             , #INCOME_TYPECD#		/* VAT_수입금액종류구분 */
	             , #CORP_TYPENM#		/* VAT_업태명 */
	             , #CORP_LINE#			/* VAT_종목명 */
	             , #CORP_TYPECD#		/* VAT_업종코드 */
	             , #INCOME_SAMT#		/* VAT_수입금액 */
	             , #UPDT_USID#			/* 입력작업자 */
	             , SYSDATE				/* 입력일시 */
	             , #UPDT_USID#			/* 수정작업자 */
	             , SYSDATE				/* 수정일시 */
	             );
        ELSE
			UPDATE TA_VAT101_D							/* [부가가치세_세부_수입금액] */
			   SET INCOME_TYPECD	= #INCOME_TYPECD#	/* VAT_수입금액종류구분 */
				 , CORP_TYPENM		= #CORP_TYPENM#		/* VAT_업태명 */
				 , CORP_LINE		= #CORP_LINE#		/* VAT_종목명 */
				 , CORP_TYPECD		= #CORP_TYPECD#		/* VAT_업종코드 */
				 , INCOME_SAMT		= #INCOME_SAMT#		/* VAT_수입금액 */
				 , UPDT_USID		= #UPDT_USID#		/* 수정작업자 */
				 , UPDT_DATE		= SYSDATE			/* 수정일시 */
			 WHERE BRANCH_CD		= #BRANCH_CD#		/* VAT_지점코드 */
			   AND VAT_YYYY			= #VAT_YYYY#		/* VAT_VAT년도 */
			   AND VAT_QUARTER		= #VAT_QUARTER#		/* VAT_VAT분기 */
			   AND INCOME_SEQ		= #INCOME_SEQ#		/* VAT_수입금액라인 */
			   ;
        END IF;
    END;
    ]]>
    </insert>
</sqlMap>