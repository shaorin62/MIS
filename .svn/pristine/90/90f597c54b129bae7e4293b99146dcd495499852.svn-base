<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
		"http://ibatis.apache.org/dtd/sql-map-2.dtd">                              
                            
<sqlMap namespace="FAMB0030">
<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표마스터
********************************************************************************/
-->
	<select id="FAMB0030.SEARCH00" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
        SELECT /* FAMB0030.SEARCH00 전표등록 */  
               M.SLIP_NUMB    /* 전표번호 */
             , M.ACCT_UNIT    /* 회계단위 */
             , M.ACCT_GUBN    /* 회계구분_사업장 */
             , M.SLIP_DATE    /* 전표일자 */
			 , SUBSTR(M.SLIP_NUMB,9) AS DISP_NUMB  /* 전표일련번호*/
             , M.SLIP_GUBN    /* 전표구분 */
             , M.REQU_NUMB    /* 품의번호 */
             , M.TITL_NAME    /* 제목 */
             , M.EMPL_NUMB    /* 사원번호 */
             , SF_GET_EMPLNAME(M.EMPL_NUMB) AS EMPL_NAME  /* 기표자명*/
             , M.DEPT_CODE    /* 부서코드 */
             , SF_GET_DEPTNAME(M.DEPT_CODE) AS DEPT_NAME  /* 기표부서명*/
             , M.ACCT_DATE    /* 회계일자 */
             , M.SLAP_NUMB    /* 전표승인번호 */
             , M.APPR_EMPL    /* 승인자 */
             , SF_GET_EMPLNAME(M.APPR_EMPL) AS APPR_EMNM  /* 회계처리자명*/
             , M.APPR_DEPT    /* 승인부서 */
             , M.APPR_DOCN    /* 결재문서번호 */
             , M.APPS_CODE    /* 결재상태코드 */
             , M.APCP_YEAR    /* 결재완료년도 */
             , M.APPR_DTCD    /* 결재부서코드 */
             , M.PROC_DATE    /* 처리일 */
             , M.AUTO_YSNO    /* 자동전표여부 */
             , M.RECE_DATE    /* 수신일 */
             , M.RECE_EMPL    /* 수신자 */
             , M.RECE_DEPT    /* 수신부서 */
             , M.EVID_ACPT    /* 증빙제출구분 */
             , M.MEMO_REMK    /* 메모비고 */
             , M.SOUS_LNKY	  /* 출처연결키 */
             , #DOCU_IDXX#	AS DOCU_IDXX	/* 결재문서양식 */
             , SF_GET_REFXFILD('APPS_CODE', M.APPS_CODE, 3) AS APPR_STAT	/* 전자결재상태 */
             , X.APPR_STAT	AS GWAP_STAT	/* GW의 전자결재상태 */
             , SF_GET_USERNAME(M.UPDT_USID) || TO_CHAR(M.UPDT_DATE, ' YYYY-MM-DD HH24:MI:SS') AS UPDT_INFO	/* 최종수정정보 */
          FROM TA_SLIPXM M
               LEFT JOIN TM_APPRXH X 	/* [전자결재연동] */
                      ON X.DOCU_IDXX = #DOCU_IDXX#
                     AND M.APPR_DOCN = X.APPR_SEQN	/* 결재문서번호 */
		 WHERE M.SLIP_NUMB = #SLIP_NUMB#
		   AND M.DEPT_CODE = (CASE WHEN #USERLAVEL# <> '1' THEN TO_NCHAR(#DEPT_CODE#) ELSE M.DEPT_CODE END)
	]]>
	</select>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표라인
 ********************************************************************************/
-->	
	<select id="FAMB0030.SEARCH01" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
        SELECT /* FAMB0030.SEARCH01 전표 분개 세부내역조회  */
               A.SLIP_NUMB    /* 전표번호 */
             , A.SLIP_LINE    /* 전표라인번호 */
             , A.ACCT_UNIT    /* 회계단위 */
             , A.ACCT_GUBN    /* 회계구분_사업장 */
             , A.ACCT_INTL    /* 계정코드 */
             , SF_GET_ACCTNAME(A.ACCT_INTL) AS ACCT_NAME  /* 계정명*/
             , A.USEX_DEPT    /* 사용부서 */
             , SF_GET_DEPTNAME(A.USEX_DEPT) AS DEPT_NAME  /* 사용부서명 */
             , A.CSTC_CODE    /* 코스트센터코드 */
             , SF_GET_CSTCNAME(A.CSTC_CODE, NVL(A.ACCT_DATE, B.SLIP_DATE)) AS CSTC_NAME
             , A.DRCR_GUBN    /* 차대구분 */
             , A.CURR_GUBN    /* 통화구분 */
             , A.EXCH_RATE    /* 환율 */
             , A.FORI_AMNT    /* 외화금액 */
             , A.SLIP_AMNT    /* 전표금액 */
             , A.OSLI_DATE    /* 상대전표일자 */
             , A.OSLI_NUMB    /* 상대전표번호 */
             , A.OSLI_LINE    /* 상대전표순번 */
             , A.OSLI_NUMB ||'-'|| A.OSLI_LINE AS OSLI_DISP /*발생번호*/ 
             , A.UNMC_YSNO    /* 미불완료여부 */
             , A.BUDG_GUBN    /* 예산구분 */
             , A.PROJ_CODE    /* 프로젝트코드 */
             , A.BGRQ_NUMB    /* 예산품의번호 */
             , A.BUDG_DEPT    /* 예산부서코드 */
             , A.BUDG_YYMM    /* 예산년월 */
             , A.BDSB_CODE    /* 예산과목코드 */
             , C.BDSB_NAME	  /* 예산과목명 */
             , A.BDSP_CODE    /* 예산세목코드 */
             , A.REMK_NAME    /* 적요 */
             , A.REMK_NAM2    /* 적요2 */
             , A.REMK_NAM3    /* 적요3 */
             , A.EVID_DOCU    /* 증빙종류 */
             , A.PAYX_YSNO    /* 출납처리여부 */
             , A.PAYX_DATE    /* 지급일 */
             , A.LEDG_GUBN    /* 출납방법 */
             , A.BANK_INOU    /* 입출구분 */
             , A.PRIN_ORDR    /* 출력순서 */
             , A.SORT_ORDR    /* 정렬순서 */
             , A.SEND_KEY1    /* 전송키1 */
             , A.SEND_KEY2    /* 전송키2 */
             , A.ACCT_DATE    /* 회계일자 */
             , A.SLCT_CODE	  /* 전표통제유형코드 */
          FROM TA_SLIPNT A
        	   INNER JOIN TA_SLIPXM B
        	   	       ON A.SLIP_NUMB = B.SLIP_NUMB
        	   LEFT  JOIN TB_BDSBXM C
        		       ON A.BDSB_CODE = C.BDSB_CODE
		 WHERE A.SLIP_NUMB = #SLIP_NUMB#
		 ORDER BY A.SORT_ORDR
		     , A.SLIP_LINE
	]]>
	</select>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표라인 관리항목
	    수      정 : 2014-10-29 : jyh : 쿼리변경, 차대변필터링을 위한 정보 추가
 ********************************************************************************/
-->
	<select id="FAMB0030.SEARCH02" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
        SELECT /* FAMB0030.SEARCH02 관리항목 차대변필터링*/
               A.SLIP_NUMB    /* 전표번호 */
             , A.SLIP_LINE    /* 전표라인번호 */
             , A.ACCT_UNIT    /* 회계단위 */
             , A.ACCT_GUBN    /* 회계구분_사업장 */
             , A.ACCT_INTL    /* 계정코드 */
             , A.DRCR_GUBN    /* 차대구분 */
             , C.COND_CODE    /* 관리항목코드 */
        	 , D.COND_NAME    /* 관리항목명 */
             , B.COND_VACD    /* 관리항목값 */
             , B.COND_VANM    /* 관리항목값명 */
             , C.CODE_SEQN    /* 코드순번 */
             , C.DRCR_YSNO    /* 차대필수여부 */
             , C.UNUS_YSNO    /* 미불사용여부 */
             , C.USEX_YSNO    /* 사용여부 */
             , D.COND_KIND    /* 관리항목입력형태[COND_KIND] */
             , D.INPT_GUBN    /* 입력구분 */
             , D.COMB_IDXX    /* 관리항목팝업콤보ID */
             , D.COND_COLM    /* 관리항목컬럼 */
             , D.COMM_CODE    /* 공통코드 */
             , D.COND_YSNO    /* 관리항목사용여부 */
             , D.HELP_TEXT    /* 도움말 */
			 , CD.REF1_FILD	AS DRCR_TYPE	/* 관리헝목차대구분*/
			 , CD.REF2_FILD	AS MUST_YSNO	/* 관리헝목차대필수*/
          FROM TA_SLIPNT A	/* [전표 분개라인]*/
			   LEFT JOIN TA_SLIPXM E	/* [전표 해더]*/
					  ON A.SLIP_NUMB = E.SLIP_NUMB
			   LEFT JOIN TA_ACCTXD C /* [계정별 관리항목]*/
					  ON C.ACCT_INTL = A.ACCT_INTL
			   LEFT JOIN TA_ACCTXF D /* [관리항목정보]*/
					  ON D.COND_CODE = C.COND_CODE
			   LEFT JOIN TA_SLIPRF B   /* [전표관리항목정보]*/
					  ON B.SLIP_NUMB = A.SLIP_NUMB
					 AND B.SLIP_LINE = A.SLIP_LINE
					 AND B.COND_CODE = C.COND_CODE
			   LEFT JOIN TM_CODEXD CD /* [관리항목필수여부]*/
					  ON CD.COMM_CODE = 'DRCR_YSNO'
					 AND CD.COMD_CODE = C.DRCR_YSNO /* 차대필수여부*/
		 WHERE A.SLIP_NUMB = #SLIP_NUMB#
		 ORDER BY A.SLIP_NUMB
		 	 , A.SLIP_LINE
		 	 , C.CODE_SEQN
	]]>	
	</select>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표라인 부가세
********************************************************************************/
-->
	<select id="FAMB0030.SEARCH03" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[	
        SELECT /* FAMB0030.SEARCH21 */			
			   VATX_SEQN    		/* 부가세일련번호 */                       
			 , SLIP_NUMB    		/* 전표번호 */
			 , SLIP_LINE    		/* 전표라인번호 */
			 , SLIP_INPU    		/* 전표등록구분 */
			 , ACCT_GUBN    		/* 회계구분_사업장  */
			 , EVID_DOCU    		/* 증빙종류 */
			 , CARD_NUMB    		/* 카드번호 */
			 , CARD_APPR    		/* 카드승인번호 */
			 , TRNS_DATE    		/* 전송일 */
			 , VATX_GUBN    		/* 매입매출구분 */
			 , VATX_TYPE    		/* 부가세종류 */
			 , BULG_GUBN    		/* 불공제구분 */
			 , PURC_GUBN    		/* 매입구분 */
			 , EBIL_GUBN    		/* 전자발행여부 */
			 , CUST_CODE    		/* 거래처코드 */
			 , SF_GET_CUSTNAME(CUST_CODE)	AS CUST_NAME /* 거래처명*/
			 , BSNS_NUMB    		/* 사업자등록번호 */
			 , ITEM_NAME    		/* 품목명 */
			 , SUPP_AMNT    		/* 공급가액 */
			 , VATX_AMNT    		/* 부가세액 */
			 , NVL(SUPP_AMNT, 0) + NVL(VATX_AMNT, 0) AS SUMX_AMNT /* 합계*/
			 , REMK_NAME    		/* 적요 */
			 , ETIS_YSNO    		/* 타사이트발행여부 */
			 , DEET_YSNO    		/* 신고제외여부 */
			 , INST_USID    		/* 입력작업자 */
			 , INST_DATE    		/* 입력일시 */
			 , UPDT_USID    		/* 수정작업자 */
			 , UPDT_DATE    		/* 수정일시 */
	     FROM TA_VATXXM				
	    WHERE SLIP_NUMB = #SLIP_NUMB#
	]]>

	</select>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.08.24
	    내      용 : 계정과목
********************************************************************************/
-->	
	<select id="FAMB0030.SEARCH10" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
        SELECT /* FAMB0030.SEARCH10 */
               ACCT_INTL      /* 계정과목코드 */
             , ACCT_NAME      /* 계정명 */
             , ACCT_BFNM      /* 계정약어명 */
             , UPPR_ACCT      /* 상위계정코드 */
             , PRNT_LEVL      /* 계정레벨 */
             , SORT_ORDR      /* 정렬순서 */
             , DRCR_GUBN      /* 차대구분 */
             , SLIP_YSNO      /* 전표등록여부 */
             , ACCT_YSNO      /* 회계사용여부 */
             , BUDG_YSNO      /* 예산사용여부 */
             , REMK_YSNO      /* 표준적요사용여부 */
             , GUNB_YSNO      /* 건별반제관리항목 */
             , CHUL_YSNO      /* 출납전표사용여부 */
             , CSUS_YSNO	  /* 코스트센터사용 */
             , CHUN_YSNO      /* 충당금계정 */
             , ZERO_YSNO      /* 금액0허용 */
             , FNCR_YSNO      /* 외화필수여부 */
             , EVID_YSNO      /* 증빙사용여부 */
             , FUND_YSNO      /* 자금사용여부 */
             , ACCT_GUBN      /* 회계구분_사업장 */
             , INOU_GUBN      /* 수입지출구분코드 */
             , ACCT_TYPE      /* 계정종류 */
             , SPSA_GUBN      /* 특수관계자거래구분 */
             , OVER_GUBN      /* 간접비배부구분 */
             , COST_GUBN      /* 원가구분 */
             , ACCT_REMK      /* 계정설명 */
             , BEFO_ACCT      /* 이전계정과목 */
             , DECODE(SF_GET_COMMNAME('RTMT_ACCT', ACCT_INTL), NULL, '0', '1') AS RTMT_ACCT /* 퇴직금계정여부 - 퇴직자 선택가능여부 */
          FROM TA_ACCTXM 
    	 WHERE SLIP_YSNO = '1'   /* 기표계정만 */
		   AND ACCT_YSNO = '1'
		 ORDER BY ACCT_INTL
	]]>
	</select>
	
<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 계정과목별 관리항목 조회
 ********************************************************************************/
-->
	<select id="FAMB0030.SEARCH11" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
        SELECT /*+ ORDERED */
        	   /* FAMB0030.SEARCH11 관리항목 */
               C.ACCT_INTL    /* 계정코드 */
             , C.COND_CODE    /* 관리항목코드 */
        	 , D.COND_NAME    /* 관리항목명 */
             , ''	AS COND_VACD    /* 관리항목값 */
             , '' AS COND_VANM    /* 관리항목값명 */
             , C.CODE_SEQN    /* 코드순번 */
             , C.DRCR_YSNO    /* 차대필수여부 */
             , C.UNUS_YSNO    /* 미불사용여부 */
             , C.USEX_YSNO    /* 사용여부 */
             , D.COND_KIND    /* 관리항목입력형태[COND_KIND] */
             , D.INPT_GUBN    /* 입력구분 */
             , D.COMB_IDXX    /* 관리항목팝업콤보ID */
             , D.COND_COLM    /* 관리항목컬럼 */
             , D.COMM_CODE    /* 공통코드 */
             , D.COND_YSNO    /* 관리항목사용여부 */
             , D.HELP_TEXT    /* 도움말 */
			 , CD.REF1_FILD	AS DRCR_TYPE	/* 관리헝목차대구분*/
			 , CD.REF2_FILD	AS MUST_YSNO	/* 관리헝목차대필수*/
          FROM TA_ACCTXD C /* [계정별 관리항목]*/
			   LEFT JOIN TA_ACCTXF D /* [관리항목정보]*/
					  ON D.COND_CODE = C.COND_CODE
			   LEFT JOIN TM_CODEXD CD /* [관리항목필수여부]*/
					  ON CD.COMM_CODE = 'DRCR_YSNO'
					 AND CD.COMD_CODE = C.DRCR_YSNO /* 차대필수여부*/
		 ORDER BY C.ACCT_INTL
		     , C.CODE_SEQN
	]]>
	</select>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 발생전표라인 관리항목
 ********************************************************************************/
-->
	<select id="FAMB0030.SEARCH13" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
        SELECT /* FAMB0030.SEARCH13 차대변필터링*/
                #SLIP_NUMB#	AS SLIP_NUMB    /* 전표번호 */
              , #SLIP_LINE#	AS SLIP_LINE    /* 전표라인번호 */
              , A.ACCT_UNIT    /* 회계단위 */
              , A.ACCT_GUBN    /* 회계구분_사업장 */
              , A.ACCT_INTL    /* 계정코드 */
              , A.DRCR_GUBN    /* 차대구분 */
              , C.COND_CODE    /* 관리항목코드 */
        	  , D.COND_NAME    /* 관리항목명 */
              , B.COND_VACD    /* 관리항목값 */
              , B.COND_VANM    /* 관리항목값명 */
              , C.CODE_SEQN    /* 코드순번 */
              , C.DRCR_YSNO    /* 차대필수여부 */
              , C.UNUS_YSNO    /* 미불사용여부 */
              , C.USEX_YSNO    /* 사용여부 */
              , D.COND_KIND    /* 관리항목입력형태[COND_KIND] */
              , D.INPT_GUBN    /* 입력구분 */
              , D.COMB_IDXX    /* 관리항목팝업콤보ID */
              , D.COND_COLM    /* 관리항목컬럼 */
              , D.COMM_CODE    /* 공통코드 */
              , D.COND_YSNO    /* 관리항목사용여부 */
              , D.HELP_TEXT    /* 도움말 */
			  , CD.REF1_FILD	AS DRCR_TYPE	/* 관리헝목차대구분*/
			  , CD.REF2_FILD	AS MUST_YSNO	/* 관리헝목차대필수*/
          FROM TA_SLIPNT A	/* [전표 분개라인]*/
			   LEFT JOIN TA_SLIPXM E	/* [전표 해더]*/
					  ON A.SLIP_NUMB = E.SLIP_NUMB
			   LEFT JOIN TA_ACCTXD C /* [계정별 관리항목]*/
					  ON C.ACCT_INTL = A.ACCT_INTL
			   LEFT JOIN TA_ACCTXF D /* [관리항목정보]*/
					  ON D.COND_CODE = C.COND_CODE
			   LEFT JOIN TA_SLIPRF B   /* [전표관리항목정보]*/
					  ON B.SLIP_NUMB = A.SLIP_NUMB
					 AND B.SLIP_LINE = A.SLIP_LINE
					 AND B.COND_CODE = C.COND_CODE
			   LEFT JOIN TM_CODEXD CD /* [관리항목필수여부]*/
					  ON CD.COMM_CODE = 'DRCR_YSNO'
					 AND CD.COMD_CODE = C.DRCR_YSNO /* 차대필수여부*/
		 WHERE A.SLIP_NUMB = #OSLI_NUMB#
		   AND A.SLIP_LINE = #OSLI_LINE#
		 ORDER BY A.SLIP_NUMB
		 	 , A.SLIP_LINE
		 	 , C.CODE_SEQN
	]]>	
	</select>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 기준환율 조회
 ********************************************************************************/
-->
	<select id="FAMB0030.SEARCH14" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
		SELECT /* FAMB0030.SEARCH14 기준환율 */
			   A.STDS_DATE  	/* 기준일자 */
			 , A.CURR_GUBN   	/* 화폐단위코드 */
			 , A.STND_RATE   	/* 기준환율 */
			, A.USDS_RATE   	/* USD환산율 */
			, A.NOTI_RATE   	/* 고시환율 */
			, A.VALU_RATE   	/* 평가환율 */
		  FROM TA_EXRTXM A     /* [환율정보] */
			   INNER JOIN (SELECT MAX(STDS_DATE) AS STDS_DATE
			   					, CURR_GUBN
							 FROM TA_EXRTXM
							WHERE STDS_DATE <= #SLIP_DATE#	/* 기준일자 */
							GROUP BY CURR_GUBN
						) B
					   ON A.STDS_DATE = B.STDS_DATE AND A.CURR_GUBN = B.CURR_GUBN
	]]>	
	</select>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.08.29
	    내      용 : 예산금액 조회
	    수      정 : 
 ********************************************************************************/
-->
	<select id="FAMB0030.SEARCH15" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
		SELECT /* FAMB0030.SEARCH15 */
               SF_GET_BUDG_AMNT(#ACCT_UNIT#, #CSTC_CODE#, #BDSB_CODE#, SUBSTR(#SLIP_DATE#, 0, 6), #BUDG_GUBN#)
               - SF_GET_BUDG_EXEC_AMNT(#ACCT_UNIT#, #CSTC_CODE#, #BDSB_CODE#, #BUDG_YMST#, #BUDG_YMED#, #BUDG_GUBN#, #SLIP_NUMB#, #SLIP_LINE# ) AS BUDG_AMNT /*예산잔액*/
       	  FROM DUAL A
	]]>	
	</select>
	
<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.08
	    내      용 : 전표일자별 마감여부 조회
	    수      정 : 
 ********************************************************************************/
-->

	<select id="FAMB0030.SEARCH16" parameterClass="hashmap">
	<![CDATA[
		BEGIN /* FAMB0030.SEARCH16 전표일자별 마감여부 조회 */
			PKG_FAMB0030.SP_SLIP_CLOSE_CHK (
				 #SLIP_GUBN#	 /* 전표유형구분*/
				,#SLIP_DATE#	 /* 마감확인일자*/
		        ,'1'     /* 마감확인구분 1=전표일자 2=회계일자 */
		   	);
		   	
		   	PKG_FAMB0030.SP_SLIP_CLOSE_CHK (
				 #SLIP_GUBN#	 /* 전표유형구분*/
				,#SLIP_DATE#	 /* 마감확인일자*/
		        ,'2'     /* 마감확인구분 1=전표일자 2=회계일자 */
		   	);	 
		END;
	]]>
	</select>
	
<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.12.08
	    내      용 : 귀속부서별, 계정별 코스트센터 조회
	    수      정 : 
 ********************************************************************************/
-->

	<select id="FAMB0030.SEARCH17" parameterClass="hashmap" resultClass="String">
	<![CDATA[
		WITH WT_CSTC AS (
			SELECT /* FAMB0030.SEARCH17 귀속부서별, 계정별 코스트센터 조회 */
				    CSTC_CODE
				   ,CSTC_NAME 
			  FROM TA_CSTCXM
			 WHERE #SLIP_DATE# BETWEEN BGIN_DATE AND ENDX_DATE	/* 회계일자 */
			   AND DEPT_CODE = #DEPT_CODE#	/* 부서 */
	]]>
	
	<isEqual prepend="AND" property="COST_GUBN" compareValue="10">
	<![CDATA[
			   COST_GUBN = '10'		/* 원가구분이 판관비 */
	]]>
	</isEqual>
	<isNotEqual prepend="AND" property="COST_GUBN" compareValue="10">
	<![CDATA[
			   COST_GUBN <> '10'	/* 원가구분이 판관비가 아닌경우 */
	]]>
	</isNotEqual>

	<![CDATA[
		)
		SELECT CSTC_CODE || ',' || CSTC_NAME AS CSTC_CDNE	/* 코스트센터코드,코스트센터명 배열로 리턴 */
		  FROM WT_CSTC
		 WHERE (SELECT COUNT(1) FROM WT_CSTC) = 1	/* 코스트센터가 한개인 경우만 리턴한다. */ 
	]]>
	
	</select>
<!-- 
/*******************************************************************************
	    작  성  자 : 황치웅
	    작  성  일 : 2016.12.20
	    내       용 : 전표인쇄 - 마스터 조회
 ********************************************************************************/
-->
	<select id="FAMB0030.PRINT00" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
		SELECT /* FAMB0030.PRINT00.전표인쇄 - 마스터 조회 */
        	   M.ACCT_GUBN                                                 /* 회계구분_사업장 */
             , SF_GET_OFFINAME(M.ACCT_GUBN) AS ACCT_GBNM	               /* 회계구분_사업장명 */
             , M.DEPT_CODE				                                   /* 발행부서 */
             , D.DEPT_NAME   			                                   /* 발행부서 */
             , M.SLIP_NUMB        		                                   /* 전표번호 */
             , M.SLIP_DATE       		                                   /* 전표일자 */
             , DECODE(M.APPS_CODE, 'FA1', M.ACCT_DATE, '') AS ACCT_DATE    /* 회계일자 */
             , M.EMPL_NUMB                                                 /* 발행자 */
             , SF_GET_EMPLNAME(M.EMPL_NUMB) AS EMPL_NAME                   /* 발행자 */
             , M.TITL_NAME                                                 /* 제목 */
             , M.APPR_EMPL                                                 /* 회계처리자 */
             , SF_GET_EMPLNAME(APPR_EMPL) AS APPR_EMNM                     /* 회계처리자 */
             , N.SLIP_AMNT				                                   /* 전표금액 */
             , SF_GET_NUMBERTOKOREAN(N.SLIP_AMNT) AS HANG_AMNT	           /* 한글금액 */
          FROM TA_SLIPXM M
               LEFT JOIN VI_DEPTXM D
                	  ON D.DEPT_CODE = M.DEPT_CODE
               LEFT JOIN (
		             	SELECT SLIP_NUMB
		             		 , SUM(SLIP_AMNT) AS SLIP_AMNT
		                  FROM TA_SLIPNT
		                 WHERE SLIP_NUMB IN ($SLIP_LIST$)
		                   AND DRCR_GUBN = 'D' 
		                 GROUP BY SLIP_NUMB
		               ) N
		              ON M.SLIP_NUMB = N.SLIP_NUMB
		 WHERE M.SLIP_NUMB IN ($SLIP_LIST$)
		 ORDER BY M.SLIP_NUMB
	]]>
	</select>

<!-- 
/*******************************************************************************
	    작  성  자 : 황치웅
	    작  성  일 : 2016.12.20
	    내       용 : 전표인쇄 - 분개정보 조회
 ********************************************************************************/
-->
	<select id="FAMB0030.PRINT01" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
          SELECT /* FAMB0030.PRINT01.전표인쇄 - 분개정보 조회  */
               NVL(D.SLIP_NUMB, C.SLIP_NUMB) AS SLIP_NUMB   	/* 전표번호 */
             , TO_NUMBER(NVL(D.DISP_NUMB, C.DISP_NUMB)) AS SORT_NUMB
             , LPAD(NVL(D.DISP_NUMB, C.DISP_NUMB), 3, '0') AS DISP_NUMB
             , D.ACCT_INTL AS ACCT_INTLD   /* 차변 계정코드 */
             , SF_GET_ACCTBFNM(D.ACCT_INTL) AS ACCT_BFNMD    	/* 계정명 */
             , SF_GET_ACCTBFNM_UP(D.ACCT_INTL) AS ACCT_UPNMD 	/* 상위계정명 */
             , NVL(D.REMK_NAME, ' ') AS REMK_NAMED           	/* 적요1 */
             , D.SLIP_AMNT AS SLIP_AMNTD                       	/* 전표금액 */
             , D.CSTC_CODE AS CSTC_CODED						/* 코스트센터 */
             , D.CSTC_NAME AS CSTC_NAMED						/* 코스트센터명 */
             , D.BDSB_CODE AS BDSB_CODED						/* 예산과목 */
             , D.BDSB_NAME AS BDSB_NAMED						/* 예산과목명 */
             , SF_GET_CONDNAME(D.COND_CD01) AS COND_CDNMD1  	/* 관리항목명 */
             , SF_GET_CONDPRINT(D.COND_CD01, D.COND_VA01) AS COND_VANMD1	/* 관리코드명 */
             , D.INPT_GB01 AS INPT_GUBND1						/* 입력구분 */
             , SF_GET_CONDNAME(D.COND_CD02) AS COND_CDNMD2
             , SF_GET_CONDPRINT(D.COND_CD02, D.COND_VA02) AS COND_VANMD2
             , D.INPT_GB02 AS INPT_GUBND2
             , SF_GET_CONDNAME(D.COND_CD03) AS COND_CDNMD3
             , SF_GET_CONDPRINT(D.COND_CD03, D.COND_VA03) AS COND_VANMD3
             , D.INPT_GB03 AS INPT_GUBND3
             , SF_GET_CONDNAME(D.COND_CD04) AS COND_CDNMD4
             , SF_GET_CONDPRINT(D.COND_CD04, D.COND_VA04) AS COND_VANMD4
             , D.INPT_GB04 AS INPT_GUBND4
             , SF_GET_CONDNAME(D.COND_CD05) AS COND_CDNMD5
             , SF_GET_CONDPRINT(D.COND_CD05, D.COND_VA05) AS COND_VANMD5
             , D.INPT_GB05 AS INPT_GUBND5
             , SF_GET_CONDNAME(D.COND_CD06) AS COND_CDNMD6
             , SF_GET_CONDPRINT(D.COND_CD06, D.COND_VA06) AS COND_VANMD6
             , D.INPT_GB06 AS INPT_GUBND6
             , D.OSLI_NUMB AS OSLI_NUMBD
             , D.VATX_INFO AS VATX_INFOD
             
             , C.ACCT_INTL AS ACCT_INTLC   /* 대변 계정코드 */
             , SF_GET_ACCTBFNM(C.ACCT_INTL) AS ACCT_BFNMC    	/* 계정명 */
             , SF_GET_ACCTBFNM_UP(C.ACCT_INTL) AS ACCT_UPNMC 	/* 상위계정명 */
             , NVL(C.REMK_NAME, ' ') AS REMK_NAMEC   			/* 적요1 */
             , C.SLIP_AMNT AS SLIP_AMNTC   						/* 전표금액 */
             , C.CSTC_CODE AS CSTC_CODEC						/* 코스트센터 */
             , C.CSTC_NAME AS CSTC_NAMEC						/* 코스트센터명 */
             , C.BDSB_CODE AS BDSB_CODEC						/* 예산과목 */
             , C.BDSB_NAME AS BDSB_NAMEC						/* 예산과목명 */
             , SF_GET_CONDNAME(C.COND_CD01) AS COND_CDNMC1  	/* 관리항목명 */
             , SF_GET_CONDPRINT(C.COND_CD01, C.COND_VA01) AS COND_VANMC1	/* 관리코드명 */
             , C.INPT_GB01 AS INPT_GUBNC1		/* 입력구분 */
             , SF_GET_CONDNAME(C.COND_CD02) AS COND_CDNMC2
             , SF_GET_CONDPRINT(C.COND_CD02, C.COND_VA02) AS COND_VANMC2
             , C.INPT_GB02 AS INPT_GUBNC2
             , SF_GET_CONDNAME(C.COND_CD03) AS COND_CDNMC3
             , SF_GET_CONDPRINT(C.COND_CD03, C.COND_VA03) AS COND_VANMC3
             , C.INPT_GB03 AS INPT_GUBNC3
             , SF_GET_CONDNAME(C.COND_CD04) AS COND_CDNMC4
             , SF_GET_CONDPRINT(C.COND_CD04, C.COND_VA04) AS COND_VANMC4
             , C.INPT_GB04 AS INPT_GUBNC4
             , SF_GET_CONDNAME(C.COND_CD05) AS COND_CDNMC5
             , SF_GET_CONDPRINT(C.COND_CD05, C.COND_VA05) AS COND_VANMC5
             , C.INPT_GB05 AS INPT_GUBNC5
             , SF_GET_CONDNAME(C.COND_CD06) AS COND_CDNMC6
             , SF_GET_CONDPRINT(C.COND_CD06, C.COND_VA06) AS COND_VANMC6
             , C.INPT_GB06 AS INPT_GUBNC6
             , C.OSLI_NUMB AS OSLI_NUMBC
             , C.VATX_INFO AS VATX_INFOC
          FROM ( 
          		SELECT A.SLIP_NUMB   /* 전표번호 */
                     , A.SLIP_LINE   /* 전표순번 */
                     , SUBSTR(A.PRIN_ORDR, 0, LENGTH(A.PRIN_ORDR)-2) AS DISP_NUMB 
                     , A.ACCT_INTL   /* 계정코드 */
                     , A.REMK_NAME   /* 적요1 */
                     , A.SLIP_AMNT   /* 전표금액 */
                     , A.CSTC_CODE	 /* 코스트센터 */
                     , SF_GET_CSTCNAME(A.CSTC_CODE, NVL(A.ACCT_DATE, B.SLIP_DATE)) AS CSTC_NAME
                     , A.BDSB_CODE	 /* 예산과목 */
                     , SF_GET_BDSBNAME(A.BDSB_CODE) AS BDSB_NAME
                     , D.COND_CD01, D.COND_VA01, D.INPT_GB01
                     , D.COND_CD02, D.COND_VA02, D.INPT_GB02
                     , D.COND_CD03, D.COND_VA03, D.INPT_GB03
                     , D.COND_CD04, D.COND_VA04, D.INPT_GB04
                     , D.COND_CD05, D.COND_VA05, D.INPT_GB05
                     , D.COND_CD06, D.COND_VA06, D.INPT_GB06
                     , A.OSLI_NUMB || A.OSLI_LINE AS OSLI_NUMB
                     , A.USEX_DEPT    /* 귀속부서 : 20150115 : 첫번째 항목이 비어있는 경우 부서를 뿌리기 위해 추가 */
                     , D.VATX_INFO
          		  FROM TA_SLIPNT A
                       INNER JOIN TA_SLIPXM B
                        	   ON A.SLIP_NUMB = B.SLIP_NUMB
                       LEFT  JOIN (
		                            SELECT X.SLIP_NUMB, X.SLIP_LINE   /* 전표번호, 전표순번 */
		                            	 , SF_GET_FORMATBIZRNUMB(NVL(C.BIZR_NUMB, C.RERN_NUMB)) || ' ' || SF_GET_FORMATDATE(V.TRNS_DATE, '-')
		                                   || ' ' || SF_GET_COMMNAME('VATX_TYPE', V.VATX_TYPE) || ' ' || SF_GET_COMMNAME('PURC_GUBN', V.PURC_GUBN)
		                                   || ' ' || TO_CHAR(V.SUPP_AMNT , 'Fm999,999,999,990')
		                                   AS VATX_INFO /* 부가세 증빙정보 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '1' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD01   /* 관리항목코드 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '1' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA01   /* 항목값 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '1' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB01   /* 입력구분 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '2' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD02   /* 관리항목코드 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '2' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA02   /* 항목값 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '2' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB02   /* 입력구분 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '3' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD03   /* 관리항목코드 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '3' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA03   /* 항목값 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '3' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB03   /* 입력구분 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '4' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD04   /* 관리항목코드 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '4' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA04   /* 항목값 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '4' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB04   /* 입력구분 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '5' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD05   /* 관리항목코드 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '5' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA05   /* 항목값 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '5' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB05   /* 입력구분 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '6' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD06   /* 관리항목코드 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '6' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA06   /* 항목값 */
		                                 , MAX(CASE WHEN Z.CODE_SEQN = '6' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB06   /* 입력구분 */
		                              FROM TA_SLIPRF X
			                               INNER JOIN TA_SLIPNT Y 
			                               		   ON Y.SLIP_NUMB = X.SLIP_NUMB 
			                               		  AND Y.SLIP_LINE = X.SLIP_LINE
			                               INNER JOIN TA_ACCTXD Z  /* [계정 관리항목] */
		                                    	   ON X.COND_CODE = Z.COND_CODE 
		                                    	  AND Y.ACCT_INTL = Z.ACCT_INTL
		                                    	  /* 같은 순번으로 셋팅하는 경우 차/대변 구분에 따라 재 분류한다. */
			                                      AND Y.DRCR_GUBN = 'D'
			                                      AND Z.DRCR_YSNO <> '3'
			                                      AND Z.DRCR_YSNO <> '5'
			                               LEFT  JOIN TA_ACCTXF F	/* [관리항목코드] */
							                       ON X.COND_CODE = F.COND_CODE
							               LEFT  JOIN TA_VATXXM V	/* [전표부가세] */
							                       ON Y.SLIP_NUMB = V.SLIP_NUMB
							                      AND Y.SLIP_LINE = V.SLIP_LINE
							               LEFT  JOIN TA_CUSTXM C	/* [거래처정보] */
							                       ON V.CUST_CODE = C.CUST_CODE
		                             WHERE X.COND_VACD IS NOT NULL
                            		   AND X.SLIP_NUMB IN ($SLIP_LIST$)
                            		 GROUP BY X.SLIP_NUMB, X.SLIP_LINE   /* 전표번호, 전표순번 */
                            		     , NVL(C.BIZR_NUMB, C.RERN_NUMB), V.TRNS_DATE, V.VATX_TYPE, V.PURC_GUBN, V.SUPP_AMNT
                        		) D
                        	   ON A.SLIP_NUMB = D.SLIP_NUMB
                    		  AND A.SLIP_LINE = D.SLIP_LINE
          		 WHERE A.SLIP_NUMB IN ($SLIP_LIST$)
          		   AND A.DRCR_GUBN = 'D'      /* 차변 */
             ) D 
               FULL JOIN ( 
               			   SELECT A.SLIP_NUMB   /* 전표번호 */
			                    , A.SLIP_LINE   /* 전표순번 */
			                    , SUBSTR(A.PRIN_ORDR, 0, LENGTH(A.PRIN_ORDR)-2) AS DISP_NUMB 
			                    , A.ACCT_INTL   /* 계정코드 */
			                    , A.REMK_NAME   /* 적요1 */
			                    , A.SLIP_AMNT   /* 전표금액 */
			                    , A.CSTC_CODE	 /* 코스트센터 */
			                    , SF_GET_CSTCNAME(A.CSTC_CODE, NVL(A.ACCT_DATE, B.SLIP_DATE)) AS CSTC_NAME
			                    , A.BDSB_CODE	 /* 예산과목 */
			                    , SF_GET_BDSBNAME(A.BDSB_CODE) AS BDSB_NAME
			                    , D.COND_CD01, D.COND_VA01, D.INPT_GB01
			                    , D.COND_CD02, D.COND_VA02, D.INPT_GB02
			                    , D.COND_CD03, D.COND_VA03, D.INPT_GB03
			                    , D.COND_CD04, D.COND_VA04, D.INPT_GB04
			                    , D.COND_CD05, D.COND_VA05, D.INPT_GB05
			                    , D.COND_CD06, D.COND_VA06, D.INPT_GB06
			                    , A.OSLI_NUMB || A.OSLI_LINE AS OSLI_NUMB
			                    , A.USEX_DEPT    /* 귀속부서 */
			                    , D.VATX_INFO
			                 FROM TA_SLIPNT A
			                      INNER JOIN TA_SLIPXM B
			                       		  ON A.SLIP_NUMB = B.SLIP_NUMB
			                      LEFT  JOIN (
					                            SELECT X.SLIP_NUMB, X.SLIP_LINE   /* 전표번호, 전표순번 */
					                                 , SF_GET_FORMATBIZRNUMB(NVL(C.BIZR_NUMB, C.RERN_NUMB)) || ' ' || SF_GET_FORMATDATE(V.TRNS_DATE, '-')
					                                   || ' ' || SF_GET_COMMNAME('VATX_TYPE', V.VATX_TYPE) || ' ' || SF_GET_COMMNAME('PURC_GUBN', V.PURC_GUBN)
					                                   || ' ' || TO_CHAR(V.SUPP_AMNT , 'Fm999,999,999,990')
					                                   AS VATX_INFO /* 부가세 증빙정보 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '1' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD01   /* 관리항목코드 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '1' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA01   /* 항목값 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '1' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB01   /* 입력구분 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '2' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD02   /* 관리항목코드 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '2' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA02   /* 항목값 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '2' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB02   /* 입력구분 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '3' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD03   /* 관리항목코드 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '3' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA03   /* 항목값 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '3' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB03   /* 입력구분 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '4' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD04   /* 관리항목코드 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '4' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA04   /* 항목값 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '4' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB04   /* 입력구분 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '5' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD05   /* 관리항목코드 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '5' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA05   /* 항목값 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '5' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB05   /* 입력구분 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '6' THEN X.COND_CODE ELSE TO_NCHAR('') END) AS COND_CD06   /* 관리항목코드 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '6' THEN X.COND_VACD ELSE TO_NCHAR('') END) AS COND_VA06   /* 항목값 */
					                                 , MAX(CASE WHEN Z.CODE_SEQN = '6' THEN F.INPT_GUBN ELSE TO_NCHAR('') END) AS INPT_GB06   /* 입력구분 */
					                              FROM TA_SLIPRF X
					                                   INNER JOIN TA_SLIPNT Y 
					                                   		   ON Y.SLIP_NUMB = X.SLIP_NUMB 
					                                   		  AND Y.SLIP_LINE = X.SLIP_LINE
					                                   INNER JOIN TA_ACCTXD Z
							                                   ON X.COND_CODE = Z.COND_CODE 
							                                  AND Y.ACCT_INTL = Z.ACCT_INTL
							                                  AND Y.DRCR_GUBN = 'C' 
							                                  AND Z.DRCR_YSNO <> '2' 
							                                  AND Z.DRCR_YSNO <> '4'
					                                   LEFT  JOIN TA_ACCTXF F	/* [관리항목코드] */
							                       			   ON X.COND_CODE = F.COND_CODE
										               LEFT  JOIN TA_VATXXM V	/* [전표부가세] */
										                       ON Y.SLIP_NUMB = V.SLIP_NUMB
										                      AND Y.SLIP_LINE = V.SLIP_LINE
										               LEFT  JOIN TA_CUSTXM C	/* [거래처정보] */
										                       ON V.CUST_CODE = C.CUST_CODE
					                             WHERE X.COND_VACD IS NOT NULL
					                               AND X.SLIP_NUMB IN ($SLIP_LIST$)
			                            		 GROUP BY X.SLIP_NUMB, X.SLIP_LINE   /* 전표번호, 전표순번 */
                            		     			 , NVL(C.BIZR_NUMB, C.RERN_NUMB), V.TRNS_DATE, V.VATX_TYPE, V.PURC_GUBN, V.SUPP_AMNT
				                           ) D
			                       		  ON A.SLIP_NUMB = D.SLIP_NUMB
			                       		 AND A.SLIP_LINE = D.SLIP_LINE
               			    WHERE A.SLIP_NUMB IN ($SLIP_LIST$)
               			      AND A.DRCR_GUBN = 'C'      /* 대변 */
             		   ) C
                      ON D.SLIP_NUMB = C.SLIP_NUMB
            		 AND D.DISP_NUMB = C.DISP_NUMB
         ORDER BY NVL(D.SLIP_NUMB, C.SLIP_NUMB)
             , TO_NUMBER(NVL(D.DISP_NUMB, C.DISP_NUMB))
	]]>
	</select>
 <!-- 
 /*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.26
	    내      용 : 전표인쇄 - 인쇄용 순번 재산출
********************************************************************************/ 
-->
	<update id="FAMB0030.UPDATE00" parameterClass="hashmap" >
	<![CDATA[
	BEGIN
		/* FAMB0030.UPDATE00 전표인쇄 - 인쇄용 순번 재산출 */
		PKG_FAMB0030.SP_SET_PRINT_ORDER (
	        #SLIP_NUMB#     /* 전표번호 */
	   	);
	   			
	END;
	]]>
	</update>
	
<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표마스터 저장 
********************************************************************************/
-->
	<parameterMap id="SAVE00MAP" class="hashmap">
	    <parameter property="SYST_LNCD" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="UPDT_USID" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="CRUD_TYPE" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="SLIP_NUMB" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="ACCT_UNIT" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="ACCT_GUBN" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="SLIP_DATE" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="SLIP_GUBN" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="REQU_NUMB" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="TITL_NAME" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="EMPL_NUMB" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="DEPT_CODE" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="ACCT_DATE" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="SOUS_LNKY" javaType="java.lang.String" jdbcType="VARCHAR" mode="IN" />
	    <parameter property="oSLIP_NUMB" javaType="java.lang.String" jdbcType="VARCHAR" mode="OUT" />
	</parameterMap>

 	<procedure id="FAMB0030.SAVE00" parameterMap="SAVE00MAP">
	<![CDATA[
		{call PKG_FAMB0030.SP_SLIP_MASTER_SAVE(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
	]]>
	</procedure>

 <!-- 
 /*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표마스터 삭제
	********************************************************************************/ 
-->
	<insert id="FAMB0030.DELETE00" parameterClass="hashmap" >
	<![CDATA[
	BEGIN
		/* FAMB0030.DELETE00 전표마스터 삭제 */
		PKG_FAMB0030.SP_SLIP_DELETE (
			 #SYST_LNCD#	 /* 시스템언어코드*/
			,#UPDT_USID#	 /* 수정작업자*/
	        ,#SLIP_NUMB#     /* 전표번호 */
	        ,#DELE_OPTN#     /* 삭제옵션 */
	   	);	
		
	END;
	]]>
	</insert>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표라인 저장
 ********************************************************************************/
-->
	<insert id="FAMB0030.SAVE01" parameterClass="hashmap" >
	<![CDATA[
	BEGIN
		/* FAMB0030.SAVE01 전표라인 */
		PKG_FAMB0030.SP_SLIP_LINE_SAVE (
			 #SYST_LNCD#	 /* 시스템언어코드*/
			,#UPDT_USID#	 /* 수정작업자*/
			,#CRUD_TYPE#	 /* CRUD TYPE(INS UPD)*/
	        ,#SLIP_NUMB#     /* 전표번호 */
	        ,#SLIP_LINE#     /* 전표라인번호 */
	        ,#ACCT_UNIT#     /* 회계단위 */
	        ,#ACCT_GUBN#     /* 회계구분_사업장 */
	        ,#ACCT_INTL#     /* 계정과목코드 */
	        ,#USEX_DEPT#     /* 사용부서 */
	        ,#CSTC_CODE#     /* 코스트센터코드 */
	        ,#DRCR_GUBN#     /* 차대구분 */
	        ,#CURR_GUBN#     /* 통화구분 */
	        ,#EXCH_RATE#     /* 환율 */
	        ,#FORI_AMNT#     /* 외화금액 */
	        ,#SLIP_AMNT#     /* 전표금액 */
	        ,#OSLI_NUMB#     /* 상대전표번호 */
	        ,#OSLI_LINE#     /* 상대전표순번 */
	        ,#BUDG_GUBN#     /* 예산구분 */
	        ,#PROJ_CODE#     /* 프로젝트코드 */
	        ,#BGRQ_NUMB#     /* 예산품의번호 */
	        ,#BUDG_DEPT#     /* 예산부서코드 */
	        ,#BUDG_YYMM#     /* 예산년월 */
	        ,#BDSB_CODE#     /* 예산과목코드 */
	        ,#BDSP_CODE#     /* 예산세목코드 */
	        ,#REMK_NAME#     /* 적요 */
	        ,#REMK_NAM2#     /* 적요2 */
	        ,#REMK_NAM3#     /* 적요3 */
	        ,#EVID_DOCU#     /* 증빙종류 */
	        ,#PAYX_YSNO#     /* 출납처리여부 */
	        ,#PAYX_DATE#     /* 지급일 */
	        ,#LEDG_GUBN#     /* 출납방법 */
	        ,#BANK_INOU#     /* 입출구분 */
	        ,#PRIN_ORDR#     /* 출력순서 */
	        ,#SORT_ORDR#     /* 정렬순서 */
	        ,#SLCT_CODE#	 /* 전표통제유형코드 */
	   	);
	
	END;
	]]>
	</insert>	

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표라인 삭제
 ********************************************************************************/
-->
	<insert id="FAMB0030.DELETE01" parameterClass="hashmap" >
	<![CDATA[
	BEGIN
		/* FAMB0030.DELETE01 전표라인 삭제*/
		PKG_FAMB0030.SP_SLIP_LINE_DELETE (
			 #SYST_LNCD#	 /* 시스템언어코드*/
			,#UPDT_USID#	 /* 수정작업자*/
	        ,#SLIP_NUMB#     /* 전표번호 */
	        ,#SLIP_LINE#     /* 전표라인번호 */
	        ,#DELE_OPTN#     /* 삭제옵션 */
	   	);	
	
	END;
	]]>
	</insert>

	
<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표라인 관리항목 저장
 ********************************************************************************/
-->
	<insert id="FAMB0030.SAVE02" parameterClass="hashmap" >
	<![CDATA[
	BEGIN
		/* FAMB0030.SAVE02  전표라인 관리항목 저장 */
		PKG_FAMB0030.SP_SLIP_LINERF_SAVE (
			 #SYST_LNCD#	 /* 시스템언어코드*/
			,#UPDT_USID#	 /* 수정작업자*/
	        ,#SLIP_NUMB#     /* 전표번호 */
	        ,#SLIP_LINE#     /* 전표라인번호 */
	        ,#COND_CODE#     /* 관리항목코드 */
	        ,#COND_VACD#     /* 관리항목값 */
	        ,#COND_VANM#     /* 관리항목값명 */
	   	);
	
	END;

	]]>
	</insert>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표라인 관리항목  삭제
 ********************************************************************************/
-->
	<insert id="FAMB0030.DELETE02" parameterClass="hashmap" >
	<![CDATA[
	BEGIN
		/* FAMB0030.DELETE02  전표라인 관리항목 삭제 */
		PKG_FAMB0030.SP_SLIP_LINERF_DELETE (
			 #SYST_LNCD#	 /* 시스템언어코드*/
			,#UPDT_USID#	 /* 수정작업자*/
	        ,#SLIP_NUMB#     /* 전표번호 */
	        ,#SLIP_LINE#     /* 전표라인번호 */
	        ,#COND_CODE#     /* 관리항목코드 */
	   	);
	   		
	END;
	
	]]>
	</insert>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표라인 부가세 저장
 ********************************************************************************/
-->
	<insert id="FAMB0030.SAVE03" parameterClass="hashmap" >
	<![CDATA[
	BEGIN
		/* FAMB0030.SAVE03 전표라인 부가세 저장 */
		PKG_FAMB0030.SP_SLIP_LINEVAT_SAVE (
			 #SYST_LNCD#	 /* 시스템언어코드*/
			,#UPDT_USID#	 /* 수정작업자*/
			,#CRUD_TYPE#	 /* CRUD TYPE(INS UPD)*/
	        ,#SLIP_NUMB#     /* 전표번호 */
	        ,#SLIP_LINE#     /* 전표라인번호 */
	        ,#CARD_NUMB#     /* 카드번호 */
	        ,#CARD_APPR#     /* 카드승인번호 */
	        ,#TRNS_DATE#     /* 전송일 */
	        ,#VATX_GUBN#     /* 매입매출구분 */
	        ,#VATX_TYPE#     /* 부가세종류 */
	        ,#BULG_GUBN#     /* 불공제구분 */
	        ,#PURC_GUBN#     /* 매입구분 */
	        ,#EBIL_GUBN#     /* 전자발행여부 */
	        ,#CUST_CODE#     /* 거래처코드 */
	        ,#BSNS_NUMB#     /* 사업자등록번호 */
	        ,#ITEM_NAME#     /* 품목명 */
	        ,#SUPP_AMNT#     /* 공급가액 */
	        ,#VATX_AMNT#     /* 부가세액 */
	        ,#REMK_NAME#     /* 적요 */
	        ,#ETIS_YSNO#     /* 타사이트발행여부 */
	   	);

	END;   	
	]]>
	</insert>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표라인 부가세  삭제
 ********************************************************************************/
-->
	<insert id="FAMB0030.DELETE03" parameterClass="hashmap" >
	<![CDATA[
	BEGIN
		/* FAMB0030.DELETE03 전표라인 부가세 삭제 */
		PKG_FAMB0030.SP_SLIP_LINEVAT_DELETE (
			 #SYST_LNCD#	 /* 시스템언어코드*/
			,#UPDT_USID#	 /* 수정작업자*/
	        ,#SLIP_NUMB#     /* 전표번호 */
	        ,#SLIP_LINE#     /* 전표라인번호 */
	   	);

	END;   	
	
	]]>
	</insert>

<!-- 
/*******************************************************************************
	    작  성  자 : 권미영
	    작  성  일 : 2016.09.02
	    내      용 : 전표작성종료
 ********************************************************************************/
-->
	<insert id="FAMB0030.FINISH" parameterClass="hashmap" >
	<![CDATA[
	BEGIN
		/* FAMB0030.FINISH 전표작성종료*/
		PKG_FAMB0030.SP_SLIP_FINISH (
			 #SYST_LNCD#	 /* 시스템언어코드*/
			,#UPDT_USID#	 /* 수정작업자*/
	        ,#SLIP_NUMB#     /* 전표번호 */
   		);
		
	END;
	]]>
	</insert>
	
<!-- 
/*******************************************************************************
	 작 성 자 : 권미영
	 작 성 일 : 2016.10.06
	 내    용 : 전자결재 연동 자료 삭제
 ********************************************************************************/
-->
	<delete id="FAMB0030.DELETE99" parameterClass="hashmap">
	<![CDATA[
		BEGIN
	    	/* FAMB0030.DELETE99 전자결재 연동 자료 삭제 */
	    	PKG_IFGWAPPROVAL.SP_GWAP_DELETE (
	    		 #UPDT_USID#	/* 작업자ID*/
		        ,#DOCU_IDXX#    /* 결재문서양식ID */
		        ,#APPR_DOCN#    /* 전자결재일련번호 */
	    	);
	    	
    	END;
    ]]>
	</delete>
	
<!-- 
/*******************************************************************************
	 작 성 자 : 권미영
	 작 성 일 : 2016.10.06
	 내    용 : 결재일련번호 채번 반환
 ********************************************************************************/
-->
	<select id="FAMB0030.SEARCH99" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[ 
    	SELECT /* FAMB0030.SEARCH99 전자결재일련번호 채번 반환 */ 
    		   PKG_IFGWAPPROVAL.SP_GET_APPRSEQN_NEW (#DOCU_IDXX#) AS APPR_SEQN 
    	  FROM DUAL 
	]]>
	</select>	
	
<!-- 
/*******************************************************************************
	 작 성 자 : 권미영
	 작 성 일 : 2016.10.06
	 내    용 : 전자결재 연동자료 저장
 ********************************************************************************/
-->
	<insert id="FAMB0030.SAVE99" parameterClass="hashmap">
	<![CDATA[
		BEGIN
	    	
	    	/* FAMB0030.SAVE99 전자결재 연동자료 저장 */
	    		
	    	/*==================================================================
				1. 전표마스터 전자결재일련번호 UPDATE 
			==================================================================*/
	    	PKG_FAMB0030.SP_GWAP_APPRSEQN_UPDATE (
	    		 #SYST_LNCD#	/* 시스템언어코드*/
	    		,#UPDT_USID#	/* 수정작업자*/
		        ,#SLIP_NUMB#    /* 전표번호 */
		        ,#APPR_DOCN#    /* 결재문서번호 */
	    	);
	    	
	    	
	    	/*==================================================================
				2. 전자결재 연동자료 헤더 저장 
			==================================================================*/
			PKG_IFGWAPPROVAL.SP_GWAP_SAVE (
			     #UPDT_USID#    /* 작업자ID */
			    ,#DOCU_IDXX#   	/* 결재문서양식ID */
			    ,#APPR_DOCN#    /* 전자결재일련번호 */
			    ,#GWAP_EMPL#    /* 사원번호(결재요청자) */
			    ,#GWAP_SUBJ#    /* 전자결재제목 */
			    ,#GWAP_DEPT#    /* 부서코드(신청자) */
      		);
			
		END;	
    ]]>
	</insert>
</sqlMap>
