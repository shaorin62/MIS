<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\default_typedef.xml"/>
  <Form id="FAMA0060" onkeydown="fn_HotKey" onload="fn_FormLoadSetting" titletext="계정과목등록" position="absolute" scrollbars="none" onclose="fn_FormUnloadProcess" left="0" width="1187" top="0" height="717" onbeforeclose="fn_FormUnloadCheckProcess">
    <Layouts>
      <Layout>
        <Static id="st_FormTitle" text="계정과목등록" position="absolute" style="align:left middle;" left="8" top="0" height="29" cssclass="styFormTitle" right="8" taborder="64"/>
        <Static id="st_FormLocation" text="재무관리 &gt; 재무기준정보 &gt; 계정과목등록" style="align: right middle;" position="absolute" right="25" top="0" height="29" cssclass="styFormLocation" width="555" taborder="63"/>
        <Div id="Div0" taborder="65" position="absolute" scrollbars="none" style="color:black;" left="8" width="573" top="31" height="27">
          <Layouts>
            <Layout/>
          </Layouts>
        </Div>
        <Div id="div_ButtonList" taborder="6" url="common::comButtonType01.xfdl" scrollbars="none" position="absolute" right="25" width="510" top="33" height="23" cssclass="styFormButtonList" tabstop="false"/>
        <Static id="stInformation" text="&lt;b v='true'&gt;00&lt;/b&gt; 건이 조회 되었습니다." visible="true" position="absolute" left="8" width="240" top="116" height="21" cssclass="styFormSearchInfo" taborder="62" usedecorate="true"/>
        <Grid autoenter="TRUE" autofittype="none" binddataset="dsTA_ACCTXD" cellsizingtype="both" enable="true" id="grdTA_ACCTXD" useinputpanel="false" autofitminwidth="100" selecttype="row" taborder="55" tabstop="false" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute" left="585" right="25" onexpandup="fn_HelpDialoge" bottom="15" height="352">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="80"/>
                <Column size="157"/>
                <Column size="110"/>
                <Column size="54"/>
                <Column size="55"/>
                <Column size="55"/>
                <Column size="55"/>
              </Columns>
              <Rows>
                <Row size="29" band="head"/>
                <Row size="26"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="관리코드"/>
                <Cell col="1" displaytype="text" style="background: ;" cssclass="Cellgrd_WF_essential" text="관리코드명"/>
                <Cell col="2" displaytype="text" style="background: ;" cssclass="Cellgrd_WF_essential" text="필수구분"/>
                <Cell col="3" displaytype="text" style="background: ;" cssclass="Cellgrd_WF_essential" text="순번"/>
                <Cell col="4" displaytype="text" style="background: ;" cssclass="Cellgrd_WF_edit" text="미결사용"/>
                <Cell col="5" displaytype="text" style="background: ;" cssclass="Cellgrd_WF_edit" text="이월사용"/>
                <Cell col="6" displaytype="text" style="background: ;" cssclass="Cellgrd_WF_edit" text="사용여부"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;background: ;" text="bind:COND_CODE" editlimit="4"/>
                <Cell col="1" displaytype="text" edittype="text" style="align:left;background: ;" text="bind:COND_NAME" editlimit="100" expandshow="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_INSERT? 'show' : 'hide'" expandsize="20" expandimage="URL('theme://images/btn_WF_Search.png')"/>
                <Cell col="2" displaytype="combo" edittype="combo" style="align:left;background: ;" text="bind:DRCR_YSNO" combodisplayrowcount="6"/>
                <Cell col="3" displaytype="number" edittype="normal" style="align:center;background: ;" text="bind:CODE_SEQN" editlimit="5" editautoselect="true" combodisplayrowcount="7"/>
                <Cell col="4" displaytype="checkbox" edittype="checkbox" style="align:center;background: ;" text="bind:UNUS_YSNO"/>
                <Cell col="5" displaytype="checkbox" edittype="checkbox" style="align:center;background: ;" text="bind:OVER_YSNO" editlimit="1"/>
                <Cell col="6" displaytype="checkbox" edittype="checkbox" style="align:center;background: ;" text="bind:USEX_YSNO" editlimit="1"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_RowAdd" onclick="btn_RowAdd_OnClick" style="imagealign:left;" position="absolute" right="90" width="62" height="21" bottom="371" taborder="61" tabstop="false" cssclass="btn_WF_Module" text="행추가"/>
        <Button id="btn_RowDel" onclick="btn_RowDel_OnClick" style="imagealign:left;" position="absolute" right="25" width="62" bottom="371" height="21" taborder="60" tabstop="false" cssclass="btn_WF_Module" text="행삭제"/>
        <Grid autoenter="TRUE" binddataset="dsTA_ACCTXM" cellsizingtype="both" enable="true" id="grdTA_ACCTXM" useinputpanel="false" taborder="8" tabstop="false" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="2" selecttype="row" position="absolute" left="8" right="25" top="137" autofittype="none" scrollpixel="none" autosizebandtype="body" bottom="402" treeinitstatus="expand,null" treeusecheckbox="false" treeuseexpandkey="true" treeuseimage="false">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="40"/>
                <Column size="70"/>
                <Column size="250"/>
                <Column size="130"/>
                <Column size="80"/>
                <Column size="170"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="92"/>
                <Column size="200"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="39" band="head"/>
                <Row size="26"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="계정&#13;&#10;레벨"/>
                <Cell col="1" displaytype="text" text="계정과목"/>
                <Cell col="2" displaytype="text" text="계정명"/>
                <Cell col="3" displaytype="text" text="계정약어명"/>
                <Cell col="4" displaytype="text" text="상위코드"/>
                <Cell col="5" displaytype="text" text="상위코드명"/>
                <Cell col="6" displaytype="text" text="전표등록&#13;&#10;여부"/>
                <Cell col="7" displaytype="text" text="사용&#13;&#10;여부"/>
                <Cell col="8" displaytype="text" text="잔액차대&#13;&#10;구분"/>
                <Cell col="9" displaytype="text" text="예산&#13;&#10;사용"/>
                <Cell col="10" displaytype="text" text="건별미결&#13;&#10;관리항목"/>
                <Cell col="11" displaytype="text" text="충당금&#13;&#10;계정"/>
                <Cell col="12" displaytype="text" text="금액0&#13;&#10;허용"/>
                <Cell col="13" displaytype="text" text="외화필수&#13;&#10;여부"/>
                <Cell col="14" displaytype="text" text="출납전표&#13;&#10;사용"/>
                <Cell col="15" displaytype="text" text="증빙&#13;&#10;사용"/>
                <Cell col="16" displaytype="text" text="계정종류" combodataset="dsACCT_TYPE" combocodecol="SUBCODE" combodatacol="SUBNAME"/>
                <Cell col="17" displaytype="text" text="계정설명"/>
                <Cell col="18" text="구계정과목"/>
                <Cell col="19" displaytype="text" text="관리항목1"/>
                <Cell col="20" displaytype="text" text="관리항목2"/>
                <Cell col="21" displaytype="text" text="관리항목3"/>
                <Cell col="22" displaytype="text" text="관리항목4"/>
                <Cell col="23" displaytype="text" text="관리항목5"/>
                <Cell col="24" displaytype="text" text="관리항목6"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;background2: ;" text="bind:PRNT_LEVL"/>
                <Cell col="1" displaytype="text" style="align:left;background2: ;" text="bind:ACCT_INTL"/>
                <Cell col="2" displaytype="tree" edittype="tree" style="align:left;background2: ;" text="bind:ACCT_NAME" treestartlevel="1" treelevel="bind:PRNT_LEVL"/>
                <Cell col="3" displaytype="text" style="align:left;background2: ;" text="bind:ACCT_BFNM"/>
                <Cell col="4" displaytype="text" style="align:center;background2: ;" text="bind:UPPR_ACCT"/>
                <Cell col="5" displaytype="text" style="align:left;background2: ;" text="bind:UPPR_NAME"/>
                <Cell col="6" displaytype="checkbox" style="align:center middle;background2: ;" text="bind:SLIP_YSNO"/>
                <Cell col="7" displaytype="checkbox" style="align:center middle;background2: ;" text="bind:ACCT_YSNO"/>
                <Cell col="8" displaytype="combo" style="align:center;background2: ;" text="bind:DRCR_GUBN"/>
                <Cell col="9" displaytype="checkbox" style="align:center middle;background2: ;" text="bind:BUDG_YSNO"/>
                <Cell col="10" displaytype="checkbox" style="align:center middle;background2: ;" text="bind:GUNB_YSNO"/>
                <Cell col="11" displaytype="checkbox" style="align:center middle;background2: ;" text="bind:CHUN_YSNO"/>
                <Cell col="12" displaytype="checkbox" style="align:center middle;background2: ;" text="bind:ZERO_YSNO"/>
                <Cell col="13" displaytype="checkbox" style="align:center middle;background2: ;" text="bind:FNCR_YSNO"/>
                <Cell col="14" displaytype="checkbox" style="align:center middle;background2: ;" text="bind:CHUL_YSNO"/>
                <Cell col="15" displaytype="checkbox" style="align:center middle;background2: ;" text="bind:EVID_YSNO"/>
                <Cell col="16" displaytype="combo" style="align:left;background2: ;" text="bind:ACCT_TYPE"/>
                <Cell col="17" displaytype="text" style="align:left;background2: ;" text="bind:ACCT_REMK"/>
                <Cell col="18" text="bind:BEFO_ACCT"/>
                <Cell col="19" displaytype="text" style="align: left;" text="bind:CODE_SEQ1"/>
                <Cell col="20" displaytype="text" style="align: left;" text="bind:CODE_SEQ2"/>
                <Cell col="21" displaytype="text" style="align: left;" text="bind:CODE_SEQ3"/>
                <Cell col="22" displaytype="text" style="align: left;" text="bind:CODE_SEQ4"/>
                <Cell col="23" displaytype="text" style="align: left;" text="bind:CODE_SEQ5"/>
                <Cell col="24" displaytype="text" style="align: left;" text="bind:CODE_SEQ6"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_CopyRow" onclick="btn_CopyRow_OnClick" style="imagealign:left;" position="absolute" right="25" width="62" top="112" height="21" text="행복사" taborder="59" cssclass="btn_WF_Module"/>
        <Static id="spSearchBox0" cssclass="styFormSearchBox" left="8" top="60" right="25" height="43" taborder="5"/>
        <Combo id="cmbSHRACCT_TYPE" taborder="1" displayrowcount="20" onsetfocus="fn_EditFocus" left="414" top="71" width="140" height="21" autoselect="true"/>
        <Static id="Static11" text="계정종류" cssclass="styFormSearchCap" left="345" top="71" width="68" height="21" taborder="58" style="border:0 none #808080ff ;"/>
        <Edit id="edtSHRACCT_NAME" taborder="0" imemode="hangul" maxlength="200" autoselect="true" onsetfocus="fn_EditFocus" left="115" top="71" width="201" height="21" onkeydown="edtSHRACCT_NAME_onkeydown"/>
        <Static id="Static10" text="계정과목/명" cssclass="styFormSearchCap" left="27" top="71" width="90" height="21" taborder="57" style="border:0 none #808080ff ;"/>
        <Static id="Shape1" cssclass="styFormItemBoxOut" left="8" bottom="15" width="557" height="377" taborder="56"/>
        <Static id="Static0" text="계정과목" cssclass="styFormItemCapBE" bottom="362" width="106" height="21" taborder="48" left="28"/>
        <Static id="Static13" text="계정약어명" cssclass="styFormItemCapBE" bottom="310" width="106" height="21" taborder="45" left="28"/>
        <Edit id="edtACCT_BFNM" taborder="19" imemode="hangul" maxlength="200" autoselect="true" onsetfocus="fn_EditFocus" left="135" bottom="310" height="21" width="409"/>
        <Static id="Static2" text="전표등록여부" cssclass="styFormItemCapBE" left="28" bottom="258" width="106" height="21" taborder="43"/>
        <Static id="Static3" text="잔액차대구분" cssclass="styFormItemCapBE" left="28" bottom="232" width="106" height="21" taborder="41"/>
        <Static id="Static5" text="사용여부" cssclass="styFormItemCapBE" left="295" bottom="258" width="125" height="21" taborder="39"/>
        <Static id="staCHUL_YSNO" text="출납전표사용" cssclass="styFormItemCapBE" left="28" bottom="128" width="106" height="21" taborder="37"/>
        <Edit id="edtPRNT_LEVL" taborder="15" inputtype="number" maxlength="1" autoselect="true" onsetfocus="fn_EditFocus" left="438" bottom="362" height="21" style="align:center middle;" width="106"/>
        <Static id="Static14" text="상위코드" cssclass="styFormItemCapBE" left="28" bottom="284" width="106" height="21" taborder="36"/>
        <Static id="staBUDG_YSNO" text="예산사용" cssclass="styFormItemCapBE" left="295" bottom="232" width="125" height="21" taborder="34"/>
        <Edit id="edtUPPR_NAME" taborder="22" imemode="hangul" maxlength="200" autoselect="true" onsetfocus="fn_EditFocus" left="268" bottom="284" height="21" width="276"/>
        <Static id="Static15" text="계정명" cssclass="styFormItemCapBE" bottom="336" width="106" height="21" taborder="29" left="28"/>
        <Edit id="edtACCT_NAME" taborder="17" imemode="hangul" maxlength="200" autoselect="true" onsetfocus="fn_EditFocus" left="135" bottom="336" height="21" width="409"/>
        <Combo id="cmbSLIP_YSNO" taborder="28" onsetfocus="fn_EditFocus" left="135" bottom="258" width="131" height="21" index="-1"/>
        <Combo id="cmbCHUL_YSNO" taborder="44" onsetfocus="fn_EditFocus" left="135" bottom="128" width="131" height="21" index="-1"/>
        <Combo id="cmbACCT_YSNO" taborder="30" onsetfocus="fn_EditFocus" bottom="258" height="21" width="115" index="-1" left="429"/>
        <Static id="staGUNB_YSNO" text="건별미결관리" cssclass="styFormItemCapBE" left="28" bottom="206" width="106" height="21" taborder="27"/>
        <Combo id="cmbZERO_YSNO" taborder="38" onsetfocus="fn_EditFocus" left="135" bottom="180" width="131" height="21" index="-1"/>
        <Static id="staZERO_YSNO" text="금액0허용" cssclass="styFormItemCapBE" left="28" bottom="180" width="106" height="21" taborder="26"/>
        <Static id="staCHUN_YSNO" text="충당금계정" cssclass="styFormItemCapBE" left="295" bottom="206" width="125" height="21" taborder="24"/>
        <Static id="staFNCR_YSNO" text="외화필수" cssclass="styFormItemCapBE" left="295" bottom="180" width="125" height="21" taborder="23"/>
        <Combo id="cmbGUNB_YSNO" taborder="35" onsetfocus="fn_EditFocus" left="135" bottom="206" width="131" height="21" index="-1"/>
        <Combo id="cmbFNCR_YSNO" taborder="40" onsetfocus="fn_EditFocus" bottom="180" height="21" width="115" index="-1" left="429"/>
        <Static id="staEVID_YSNO" text="증빙사용" cssclass="styFormItemCapBE" left="28" bottom="154" width="106" height="21" taborder="21"/>
        <Combo id="cmbEVID_YSNO" taborder="42" onsetfocus="fn_EditFocus" left="135" bottom="154" width="131" height="21" index="-1"/>
        <Static id="Static21" text="간접비구분" cssclass="styFormItemCap" left="28" bottom="76" width="106" height="21" taborder="20"/>
        <Combo id="cmbOVER_GUBN" taborder="49" onsetfocus="fn_EditFocus" left="135" bottom="76" width="131" height="21" index="-1"/>
        <Combo id="cmbCUST_YSNO" taborder="66" innerdataset="dsUSEX_YSNO" codecolumn="SUBCODE" datacolumn="SUBNAME" onsetfocus="fn_EditFocus" cssclass="styFormItemText" visible="false" left="117" top="738" width="129" height="23" binddataset="dsTA_ACCTXM"/>
        <Static id="Static23" cssclass="styFormItemCapBE" visible="false" left="251" top="738" width="80" height="17" style="align: right middle;" taborder="18"/>
        <Combo id="cmbBANK_YSNO" taborder="67" innerdataset="dsUSEX_YSNO" codecolumn="SUBCODE" datacolumn="SUBNAME" onsetfocus="fn_EditFocus" cssclass="styFormItemText" visible="false" left="317" top="738" width="167" height="23" binddataset="dsTA_ACCTXM"/>
        <Static id="Static26" text="계정종류" cssclass="styFormItemCap" left="295" bottom="154" width="125" height="21" taborder="16"/>
        <Static id="Static27" text="자금사용" cssclass="styFormItemCap" left="295" bottom="102" width="125" height="21" taborder="13"/>
        <Combo id="cmbFUND_YSNO" taborder="54" onsetfocus="fn_EditFocus" bottom="102" height="21" width="115" index="-1" left="429"/>
        <Static id="Static04" text="특수관계자거래구분" cssclass="styFormItemCap" left="295" bottom="128" width="129" height="21" taborder="12"/>
        <Combo id="cmbSPSA_GUBN" taborder="46" onsetfocus="fn_EditFocus" bottom="128" height="21" width="115" index="-1" left="429"/>
        <Static id="Static06" text="정렬순서" cssclass="styFormItemCap" left="295" bottom="76" width="125" height="21" taborder="11"/>
        <Static id="Static12" text="계정설명" cssclass="styFormItemCap" left="28" bottom="24" width="106" height="21" taborder="10"/>
        <TextArea id="txaACCT_REMK" taborder="53" scrollbars="autovert" imemode="hangul" maxlength="500" left="135" bottom="24" width="409" height="21"/>
        <Combo id="cmbBUDG_YSNO" taborder="33" onsetfocus="fn_EditFocus" bottom="232" height="21" width="115" index="-1" left="429"/>
        <Edit id="edtUPPR_ACCT" inputtype="number" maxlength="10" autoselect="true" onsetfocus="fn_EditFocus" left="135" bottom="284" height="21" style="align:center middle; :disabled {align:left middle;}" width="108" enable="true" taborder="25" readonly="true" cssclass="edt_WF_Readonly"/>
        <Edit id="edtACCT_INTL" taborder="14" autoselect="true" onsetfocus="fn_EditFocus" left="135" bottom="362" height="21" style="align:center middle;" width="131" maxlength="10"/>
        <Static id="stInformation1" text="&lt;b v='true'&gt;00&lt;/b&gt; 건이 조회 되었습니다." cssclass="styFormSearchInfo" left="709" right="318" bottom="367" height="21" taborder="7" usedecorate="true"/>
        <Combo id="cmbDRCR_GUBN" taborder="31" onsetfocus="fn_EditFocus" left="135" bottom="232" height="21" width="131" index="-1"/>
        <Edit id="edtSORT_ORDR" taborder="50" maxlength="5" autoselect="true" onsetfocus="fn_EditFocus" bottom="76" height="21" style="align:center middle;" width="115" inputtype="number" left="429"/>
        <Static id="Static8" text="원가구분" cssclass="styFormItemCap" left="28" bottom="50" width="106" height="21" taborder="32"/>
        <Combo id="cmbCOST_GUBN" onsetfocus="fn_EditFocus" left="135" bottom="50" width="131" height="21" index="-1" taborder="51"/>
        <Static id="staCSUS_YSNO" taborder="68" text="코스트센터사용" cssclass="styFormItemCapBE" bottom="102" height="21" width="106" left="28"/>
        <Combo id="cmbCSUS_YSNO" taborder="47" onsetfocus="fn_EditFocus" bottom="102" height="21" width="131" left="135"/>
        <Static id="Static32" taborder="69" text="w&#13;&#10;8" cssclass="sta_GID_box" visible="false" top="0" height="717" width="8" left="0"/>
        <Static id="Static05" taborder="70" text="h 60" visible="false" top="0" height="60" style="background:#fb7b7b7a;" width="36" left="608"/>
        <Static id="Static35" taborder="71" text="h 6" visible="false" top="23" height="10" style="background:#fb7b7b7a;" width="264" left="898"/>
        <Static id="Static07" taborder="72" text="w&#13;&#10;25" cssclass="sta_GID_box" visible="false" top="0" height="717" width="25" left="1162"/>
        <Static id="Static30" taborder="73" text="h 4" visible="false" top="56" height="4" style="background:#fb7b7b7a;" width="145" left="736"/>
        <Static id="Static34" taborder="74" text="w30" visible="false" top="61" height="41" style="background:#fb7b7b7a;" width="30" left="9"/>
        <Static id="Static36" taborder="75" visible="false" top="61" height="41" style="background:#fb7b7b7a;" width="8" left="107"/>
        <Static id="Static01" taborder="76" text="h 15" visible="false" bottom="0" height="15" style="background:#fb7b7b7a;" width="1154" left="8"/>
        <Button id="btn_favorite" taborder="77" onclick="btn_favorite_onclick" cssclass="btn_WF_Bookmark" top="0" height="29" width="20" left="8"/>
        <Static id="Static31" taborder="78" text="w 40" visible="false" top="61" height="41" style="background:#fb7b7b7a;" width="40" left="316"/>
        <Static id="Static09" taborder="79" text="h 6" visible="false" top="131" height="6" style="background:#fb7b7b7a;" width="264" left="8"/>
        <Static id="Static00" taborder="80" text="h 35" visible="false" top="103" height="35" style="background:#fb7b7b7a;" width="80" left="485"/>
        <Static id="Static1" taborder="82" text="계정레벨" cssclass="styFormItemCapBE" bottom="362" height="21" width="100" left="295"/>
        <Combo id="cmbACCT_TYPE" taborder="83" onsetfocus="fn_EditFocus" bottom="154" height="21" width="115" left="429"/>
        <Combo id="cmbCHUN_YSNO" taborder="84" onsetfocus="fn_EditFocus" bottom="206" height="21" width="115" left="429"/>
        <Static id="Static17" taborder="85" text="h8" visible="false" bottom="383" height="8" style="background:#fb7b7b7a;" width="38" left="151"/>
        <Static id="Static24" taborder="86" text="h5" visible="false" bottom="331" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static18" taborder="87" text="h8" visible="false" bottom="16" height="8" style="background:#fb7b7b7a;" width="38" left="151"/>
        <Static id="Static19" taborder="88" text="h5" visible="false" bottom="71" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static20" taborder="89" text="w30" visible="false" top="328" height="33" style="background:#fb7b7b7a;" width="30" left="9"/>
        <Static id="Static22" taborder="90" text="h 10" visible="false" height="10" style="background:#fb7b7b7a;" left="399" bottom="392" right="25"/>
        <Static id="Static25" taborder="91" text="h5" visible="false" bottom="45" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static28" taborder="92" text="h5" visible="false" bottom="97" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static29" taborder="93" text="h5" visible="false" bottom="123" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static33" taborder="94" text="h5" visible="false" bottom="175" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static37" taborder="95" text="h5" visible="false" bottom="149" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static38" taborder="96" text="h5" visible="false" bottom="201" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static39" taborder="97" text="h5" visible="false" bottom="227" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static40" taborder="98" text="h5" visible="false" bottom="253" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static41" taborder="99" text="h5" visible="false" bottom="305" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static42" taborder="100" text="h5" visible="false" bottom="279" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="imgHelpUPPR_ACCT" onclick="fn_HelpDialoge" cssclass="sytHelpPopup" bottom="284" width="21" height="21" taborder="9" left="245"/>
        <Static id="Static43" taborder="101" text="h5" visible="false" bottom="357" height="5" style="background:#fb7b7b7a;" width="102" left="151"/>
        <Static id="Static44" taborder="102" text="w40" visible="false" top="326" height="33" style="background:#fb7b7b7a;" width="40" left="267"/>
        <Static id="Static45" taborder="103" text="관리코드 등록" cssclass="sta_WF_Subtitle" width="114" left="585" bottom="367" height="21"/>
        <Static id="Static46" taborder="104" text="h 6" visible="false" left="49.62%" top="344" right="28.14%" height="6" style="background:#fb7b7b7a;"/>
        <Static id="Static47" taborder="105" text="h 35" visible="false" left="72.96%" top="315" right="20.3%" height="35" style="background:#fb7b7b7a;"/>
        <Static id="Static48" taborder="106" text="계정레벨" cssclass="styFormSearchCap" left="583" top="71" width="68" height="21" style="border:0 none #808080ff ;"/>
        <Edit id="edtSHRPRNT_LEVL" taborder="2" inputtype="number" maxlength="1" autoselect="true" onsetfocus="fn_EditFocus" left="651" style="align:right middle;" binddataset="dsTA_ACCTXM" top="71" height="21" width="50"/>
        <Static id="Static50" taborder="107" text="전표등록여부" cssclass="styFormItemCap" left="730" top="71" width="90" height="21"/>
        <Combo id="cmbSHRSLIP_YSNO" taborder="3" onsetfocus="fn_EditFocus" left="825" width="95" height="21" binddataset="dsTA_ACCTXM" top="71" autoselect="true"/>
        <Static id="Static51" taborder="108" text="사용여부" cssclass="styFormItemCap" left="949" width="69" height="21" top="71"/>
        <Combo id="cmbSHRACCT_YSNO" taborder="4" onsetfocus="fn_EditFocus" left="1018" width="95" height="21" binddataset="dsTA_ACCTXM" top="71" autoselect="true"/>
        <Static id="Static49" taborder="109" text="w20" visible="false" left="544" top="328" width="20" height="337" style="background:#fb7b7b7a;"/>
        <Static id="Static52" taborder="110" text="w 40" visible="false" left="554" top="61" width="40" height="41" style="background:#fb7b7b7a;"/>
        <Static id="Static53" taborder="111" text="w 40" visible="false" left="701" top="61" width="40" height="41" style="background:#fb7b7b7a;"/>
        <Static id="Static54" taborder="112" text="w 40" visible="false" left="920" top="61" width="40" height="41" style="background:#fb7b7b7a;"/>
        <Static id="stInformation05" taborder="113" cssclass="sta_WF_line" left="696" width="10" height="13" bottom="371"/>
        <Static id="Static55" taborder="114" text="구계정과목" cssclass="styFormItemCap" left="295" bottom="50" width="106" height="21"/>
        <Edit id="edtBEFO_ACCT" taborder="52" maxlength="10" autoselect="true" onsetfocus="fn_EditFocus" left="429" bottom="50" width="115" height="21" style="align:center middle;"/>
        <Static id="Static16" taborder="115" text="w20" visible="false" left="565" top="336" width="20" height="337" style="background:#fb7b7b7a;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="dsTA_ACCTXM" onrowposchanged="fn_KeyFieldDisible" useclientlayout="true" canrowposchange="dsTA_ACCTXM_canrowposchange" oncolumnchanged="dsTA_ACCTXM_oncolumnchanged">
        <ColumnInfo>
          <Column id="ACCT_INTL" size="10" prop="default" type="STRING"/>
          <Column id="ACCT_BFNM" size="200" prop="default" type="STRING"/>
          <Column id="ACCT_NAME" size="200" prop="default" type="STRING"/>
          <Column id="SLIP_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="DRCR_GUBN" size="1" prop="default" type="STRING"/>
          <Column id="REMK_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="ACCT_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="BUDG_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="PRNT_LEVL" size="1" prop="default" type="BIGDECIMAL"/>
          <Column id="UPPR_ACCT" size="10" prop="default" type="STRING"/>
          <Column id="UPPR_NAME" size="200" prop="default" type="STRING"/>
          <Column id="CHUL_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="INOU_GUBN" size="1" prop="default" type="STRING"/>
          <Column id="CONT_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="PREX_INTL" size="20" prop="default" type="STRING"/>
          <Column id="GUNB_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="CHUN_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="ZERO_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="FNCR_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="EVID_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="OVER_GUBN" type="STRING" size="10" sumtext="간접비구분" prop="default"/>
          <Column id="CUST_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="BANK_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="ACNT_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="ACCT_TYPE" size="10" prop="default" type="STRING"/>
          <Column id="SPSA_GUBN" type="STRING" size="10" sumtext="거래구분" prop="default"/>
          <Column id="FUND_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="CODE_SEQ1" type="STRING" size="100" prop="default"/>
          <Column id="CODE_SEQ2" type="STRING" size="100" prop="default"/>
          <Column id="CODE_SEQ3" type="STRING" size="100" prop="default"/>
          <Column id="CODE_SEQ4" type="STRING" size="100" prop="default"/>
          <Column id="CODE_SEQ5" type="STRING" size="100" prop="default"/>
          <Column id="CODE_SEQ6" type="STRING" size="100" prop="default"/>
          <Column id="ACCT_REMK" size="500" prop="default" type="STRING"/>
          <Column id="COST_GUBN" size="10" prop="default" type="STRING"/>
          <Column id="SORT_ORDR" type="STRING" size="10" sumtext="정렬순서" prop="default"/>
          <Column id="CSUS_YSNO" type="STRING" size="1"/>
          <Column id="BEFO_ACCT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsCombo" useclientlayout="true">
        <ColumnInfo>
          <Column id="DSNAME" size="256" prop="default" type="STRING"/>
          <Column id="CODEID" size="256" prop="default" type="STRING"/>
          <Column id="HEADFLAG" size="256" prop="default" type="STRING"/>
          <Column id="MEMO" size="256" prop="default" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODEID">COST_GUBN</Col>
            <Col id="DSNAME">dsCOST_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="MEMO">원가구분</Col>
          </Row>
          <Row>
            <Col id="CODEID">OVER_GUBN</Col>
            <Col id="DSNAME">dsOVER_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="MEMO"/>
          </Row>
          <Row>
            <Col id="CODEID">ACCT_TYPE</Col>
            <Col id="DSNAME">dsACCT_TYPE</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="MEMO">계정종류</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsDRCR_YSNO</Col>
            <Col id="CODEID">DRCR_YSNO</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="MEMO">관리코드 필수구분</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsSPSA_GUBN</Col>
            <Col id="CODEID">SPSA_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="MEMO">특수관계자 거래구분</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsSHRACCT_TYPE</Col>
            <Col id="CODEID">ACCT_TYPE</Col>
            <Col id="HEADFLAG">ALL</Col>
            <Col id="MEMO">계정종류</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsUSEX_YSNO</Col>
            <Col id="CODEID">USEX_YSNO</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="MEMO">사용여부</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsDRCR_GUBN</Col>
            <Col id="CODEID">DRCR_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="MEMO">차대구분</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsSHRUSEX_YSNO</Col>
            <Col id="CODEID">USEX_YSNO</Col>
            <Col id="HEADFLAG">ALL</Col>
            <Col id="MEMO">사용여부</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsTA_ACCTXD" useclientlayout="true" oncolumnchanged="dsTA_ACCTXD_oncolumnchanged" onrowposchanged="fn_KeyFieldDisible1">
        <ColumnInfo>
          <Column id="ACCT_INTL" size="10" prop="default" type="STRING"/>
          <Column id="COND_CODE" size="4" prop="default" type="STRING"/>
          <Column id="COND_NAME" size="100" prop="default" type="STRING"/>
          <Column id="DRCR_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="UNUS_YSNO" type="STRING" prop="default" size="1"/>
          <Column id="USEX_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="CODE_SEQN" size="5" prop="default" type="STRING"/>
          <Column id="OVER_YSNO" size="1" prop="default" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTA_ACCTXD_TEMP" useclientlayout="true">
        <ColumnInfo>
          <Column id="ACCT_INTL" size="10" prop="default" type="STRING"/>
          <Column id="COND_CODE" size="4" prop="default" type="STRING"/>
          <Column id="COND_NAME" size="100" prop="default" type="STRING"/>
          <Column id="DRCR_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="USEX_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="CODE_SEQN" size="5" prop="default" type="STRING"/>
          <Column id="OVER_YSNO" size="1" prop="default" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="cmbCHUN_YSNO_value" compid="cmbCHUN_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="CHUN_YSNO"/>
      <BindItem id="cmbACCT_TYPE_value" compid="cmbACCT_TYPE" propid="value" datasetid="dsTA_ACCTXM" columnid="ACCT_TYPE"/>
      <BindItem id="cmbDRCR_GUBN_value" compid="cmbDRCR_GUBN" propid="value" datasetid="dsTA_ACCTXM" columnid="DRCR_GUBN"/>
      <BindItem id="cmbBUDG_YSNO_value" compid="cmbBUDG_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="BUDG_YSNO"/>
      <BindItem id="txaACCT_REMK_value" compid="txaACCT_REMK" propid="value" datasetid="dsTA_ACCTXM" columnid="ACCT_REMK"/>
      <BindItem id="item1" compid="cmbSPSA_GUBN" propid="value" datasetid="dsTA_ACCTXM" columnid="SPSA_GUBN"/>
      <BindItem id="cmbFUND_YSNO_value" compid="cmbFUND_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="FUND_YSNO"/>
      <BindItem id="cmbBANK_YSNO_value" compid="cmbBANK_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="BANK_YSNO"/>
      <BindItem id="cmbCUST_YSNO_value" compid="cmbCUST_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="CUST_YSNO"/>
      <BindItem id="cmbOVER_GUBN_value" compid="cmbOVER_GUBN" propid="value" datasetid="dsTA_ACCTXM" columnid="OVER_GUBN"/>
      <BindItem id="cmbEVID_YSNO_value" compid="cmbEVID_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="EVID_YSNO"/>
      <BindItem id="cmbFNCR_YSNO_value" compid="cmbFNCR_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="FNCR_YSNO"/>
      <BindItem id="cmbGUNB_YSNO_value" compid="cmbGUNB_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="GUNB_YSNO"/>
      <BindItem id="cmbZERO_YSNO_value" compid="cmbZERO_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="ZERO_YSNO"/>
      <BindItem id="cmbACCT_YSNO_value" compid="cmbACCT_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="ACCT_YSNO"/>
      <BindItem id="cmbCHUL_YSNO_value" compid="cmbCHUL_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="CHUL_YSNO"/>
      <BindItem id="cmbSLIP_YSNO_value" compid="cmbSLIP_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="SLIP_YSNO"/>
      <BindItem id="edtACCT_NAME_value" compid="edtACCT_NAME" propid="value" datasetid="dsTA_ACCTXM" columnid="ACCT_NAME"/>
      <BindItem id="edtUPPR_NAME_value" compid="edtUPPR_NAME" propid="value" datasetid="dsTA_ACCTXM" columnid="UPPR_NAME"/>
      <BindItem id="cmbCOST_GUBN_value" compid="cmbCOST_GUBN" propid="value" datasetid="dsTA_ACCTXM" columnid="COST_GUBN"/>
      <BindItem id="edtPRNT_LEVL_value" compid="edtPRNT_LEVL" propid="value" datasetid="dsTA_ACCTXM" columnid="PRNT_LEVL"/>
      <BindItem id="edtACCT_BFNM_value" compid="edtACCT_BFNM" propid="value" datasetid="dsTA_ACCTXM" columnid="ACCT_BFNM"/>
      <BindItem id="item17" compid="edtUPPR_ACCT" propid="value" datasetid="dsTA_ACCTXM" columnid="UPPR_ACCT"/>
      <BindItem id="item0" compid="edtACCT_BFNM" propid="binddataset" datasetid="dsTA_ACCTXM" columnid="ACCT_BFNM"/>
      <BindItem id="item18" compid="edtACCT_INTL" propid="value" datasetid="dsTA_ACCTXM" columnid="ACCT_INTL"/>
      <BindItem id="item16" compid="edtSORT_ORDR" propid="value" datasetid="dsTA_ACCTXM" columnid="SORT_ORDR"/>
      <BindItem id="item19" compid="cmbCSUS_YSNO" propid="value" datasetid="dsTA_ACCTXM" columnid="CSUS_YSNO"/>
      <BindItem id="item2" compid="edtBEFO_ACCT" propid="value" datasetid="dsTA_ACCTXM" columnid="BEFO_ACCT"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***************************************************************************************************
 * # Program:	FAMA0060 계정과목등록
 * 
 * # Modification Information
 * -------------------------------------------------------------------------------------------------
 *   Date			Modifier	Comment
 * -------------------------------------------------------------------------------------------------
 *   2016.07.26		양현덕		Initial Created.
 *	 2016.08.29		권미영
 *   
 * -------------------------------------------------------------------------------------------------
 * Copyright 1998-2016 By INBUS Co,Ltd. All rights reserved.
 ****************************************************************************************************
 *   Form Common Script                                                                            *
 *      1) 공통 스크립트 위치 및 명칭은 수정 불가 입니다.                                     *
 *      2) 각 함수에서 필요한 부분의 소스를 수정 하세요.                                      *
 *      3) 해당 프로그램의 기능이 없는 경우 해당 함수의 이름만 놓고 공백 처리              *
 *                                                                                                 *
 *  ★ 위 사항의 변경이 있거나 추가 사항이 있을 경우 반드시 개발 PL과 상의 후 수정 요망   *
 *     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                                *
 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
 ***************************************************************************************************/

/**************************
 *  공통 Script Include  *
 **************************/
include "script::lib_script_common.xjs"

/***********************
 *  화면 변수 선언부 *
 ***********************/
this.sBUTTONLIST  = "TTTTTTTF"; // 종료, 조회, 입력, 삭제, 취소, 저장, 엑셀, 인쇄
this.sPACKAGENAME = "FAMA0060";

if (this.getOwnerFrame()["sUSERAUTH"] == undefined) {

	 this.sUSERAUTH     = "";
	 this.sFORMCAPTION  = "";
	 this.sFORMLOCATION = "";
	 this.sUSERLAVEL    = "";
	 
} else {

	 this.sUSERAUTH     = this.getOwnerFrame()["sUSERAUTH"];
	 this.sFORMCAPTION  = this.getOwnerFrame()["sFORMCAPTION"];
	 this.sFORMLOCATION = this.getOwnerFrame()["sFORMLOCATION"];
	 this.sUSERLAVEL    = this.getOwnerFrame()["sUSERLAVEL"];
	 
}

/**************************************************************************************************
 *                                         공통 Event 처리 부분                                    *
 ***************************************************************************************************/
/*---------------------------------------+
 |  01.최초 화면 Load時 처리 할 사항  |
 +---------------------------------------*/
this.fn_FormLoadSetting = function (obj:Form, e:LoadEventInfo) {
	
	this.fnc_FormLoadSetting(obj, this.sFORMCAPTION, this.sFORMLOCATION, this.sBUTTONLIST, this.sUSERAUTH);
	this.fnc_GridSetting(this);
	this.fnc_GetComboDs(this.dsCombo);
	this.edtSHRACCT_NAME.setFocus();

}

/*--------------------------------------+
 |  02.화면 종료(닫기) 버튼 클릭 時  |
 ---------------------------------------*/
this.fn_End = function (obj) {
	this.close();
}

/*--------------------------+
 |  03.조회 버튼 클릭 時  |
 +--------------------------*/
this.fn_Search = function (obj) {
	
	if (!this.fn_SearchItemCheck()) return;
	
	this.fnc_DatasetClear("dsTA_ACCTXM,dsTA_ACCTXD"); 
	
	var sMethodName = "SEARCH00";
	var sInDataSet  = "";
	var sOutDataSet = "dsTA_ACCTXM=dsTA_ACCTXM";
	var sArgument   = this.fn_CreateArgument(sMethodName);
	this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");
	this.grdTA_ACCTXM.setFocus();
	
}

/*---------------------------------+
 |  04.입력(신규) 버튼 클릭 時  |
 +---------------------------------*/
this.fn_Input = function (obj) {

	var uRow      = this.dsTA_ACCTXM.rowposition;
	var uPrntLevl = this.dsTA_ACCTXM.getColumn(uRow, "PRNT_LEVL");
	var uUpprAcct = this.dsTA_ACCTXM.getColumn(uRow, "ACCT_INTL");

	if (uPrntLevl == "5") {
		this.fnc_Message("TMM125", "최하위 레벨에는 등록할 수 없습니다");
		return;
	}

	var iRow = this.dsTA_ACCTXM.insertRow(uRow + 1);

	this.dsTA_ACCTXM.setColumn(iRow, "PRNT_LEVL", uPrntLevl + 1);
	this.dsTA_ACCTXM.setColumn(iRow, "ACCT_INTL", this.fnc_SubStr(this.dsTA_ACCTXM.getColumn(uRow, "ACCT_INTL"), 0, uPrntLevl));
	this.dsTA_ACCTXM.setColumn(iRow, "UPPR_ACCT", this.dsTA_ACCTXM.getColumn(uRow, "ACCT_INTL"));
	this.dsTA_ACCTXM.setColumn(iRow, "UPPR_NAME", this.dsTA_ACCTXM.getColumn(uRow, "ACCT_BFNM"));

	if (uPrntLevl == "4") {		
			
		this.dsTA_ACCTXM.setColumn(iRow, "SLIP_YSNO", "1");
		
		if (this.fnc_SubStr(uUpprAcct, 0, 1) == "5" || this.fnc_SubStr(uUpprAcct, 0, 1) == "6") {
			this.dsTA_ACCTXM.setColumn(iRow, "BUDG_YSNO", "1");	
		} else {
			this.dsTA_ACCTXM.setColumn(iRow, "BUDG_YSNO", "0");
		}
		
	} else {
	
		this.dsTA_ACCTXM.setColumn(iRow, "SLIP_YSNO", "0");
		this.dsTA_ACCTXM.setColumn(iRow, "BUDG_YSNO", "0");
		
	}

	this.dsTA_ACCTXM.setColumn(iRow, "ACCT_YSNO", "1"); //사용여부
	this.dsTA_ACCTXM.setColumn(iRow, "DRCR_GUBN", this.dsTA_ACCTXM.getColumn(uRow, "DRCR_GUBN")); //차대구분
	this.dsTA_ACCTXM.setColumn(iRow, "GUNB_YSNO", "0"); //건별미결여부
	this.dsTA_ACCTXM.setColumn(iRow, "CHUN_YSNO", "0"); //충당금계정여부
	this.dsTA_ACCTXM.setColumn(iRow, "ZERO_YSNO", "0"); //금액허용
	this.dsTA_ACCTXM.setColumn(iRow, "FNCR_YSNO", "0");
	this.dsTA_ACCTXM.setColumn(iRow, "EVID_YSNO", "0");
	this.dsTA_ACCTXM.setColumn(iRow, "CHUL_YSNO", "0");
	this.edtACCT_INTL.setFocus();
	
}

/*--------------------------------+
 |  05.삭제(제거) 버튼 클릭 時  |
 +--------------------------------*/
this.fn_Delete = function (obj) {
	if (this.fn_DeleteCheck()) {
		//this.dsTA_ACCTXD.deleteAll();
		this.dsTA_ACCTXM.deleteRow(this.dsTA_ACCTXM.rowposition);
	}
	this.grdTA_ACCTXM.setFocus();
}

/*--------------------------+
 |  06.취소 버튼 클릭 時  |
 ---------------------------*/
this.fn_Cancel = function (obj) {
	
	this.fnc_DataSetCancel("dsTA_ACCTXM,dsTA_ACCTXD");
// 	if (this.dsTA_ACCTXM.rowposition == 0) {
// 		this.dsTA_ACCTXM.set_rowposition(0);
// 	} else {
// 		this.dsTA_ACCTXM.set_rowposition((this.dsTA_ACCTXM.rowposition - 1));
// 	}
	this.grdTA_ACCTXM.setFocus();
	
}

/*--------------------------+
 |  07.저장 버튼 클릭 時  |
 ---------------------------*/
this.fn_Save = function (obj) {
	
	if (!this.fn_SaveItemCheck()) return;

	var sMethodName = "SAVE00";
	var sInDataSet  = "dsTA_ACCTXM=dsTA_ACCTXM:U dsTA_ACCTXD=dsTA_ACCTXD:U";
	var sOutDataSet = "";
	var sArgument 	= this.fn_CreateArgument(sMethodName);
	this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");
	this.grdTA_ACCTXM.setFocus();

}

/*--------------------------+
 |  08.엑셀 버튼 클릭 時  |
 ---------------------------*/
this.fn_ToExcel = function (obj) {
	this.fnc_ToExcel(this);
}

/*--------------------------+
 |  09.인쇄 버튼 클릭 時  |
 +--------------------------*/
this.fn_Print = function (obj) {
	//기능없음
}

/*-----------------------------------+
 |  10. 화면 종료時 처리 할 사항  |
 +-----------------------------------*/
this.fn_FormUnloadCheckProcess =  function(obj:Form, e:nexacro.CloseEventInfo) {
	
	if(e.fromobject instanceof Div) return;
	var sMessage = this.fnc_FormUnloadCheck("dsTA_ACCTXM", this);
		
	if(!this.fnc_IsEmpty(sMessage)) return sMessage;
	
}

this.fn_FormUnloadProcess = function (obj:Form, e:CloseEventInfo){
	this.fnc_FormUnload(obj,e);
}

/*-------------------------------------+
 |  11.단축키 처리(Form KeyDown)      |
 +-------------------------------------*/
this.fn_HotKey = function (obj:Form, e:KeyEventInfo) {	
	this.fnc_HotKey(this, e.fromreferenceobject, e);
}

/*--------------------------------------+
 |  12.Text Box가 Focus를 받을 때     |
 +--------------------------------------*/
this.fn_EditFocus = function (obj) {
	this.fnc_EditFocus(obj);
}

/**************************************************************************************************
 *                                      공통 Function 처리 부분                                    *
 ***************************************************************************************************/
/*--------------------------+
 |  조회 필수 조건 체크!  |
 +--------------------------*/
this.fn_SearchItemCheck = function () {

	if (this.fnc_DatasetChangeCheck("dsTA_ACCTXM")) return this.fnc_Message("TMM023");
	return true;
	
}

/*---------------------+
 |  삭제 여부 체크!  |
 +---------------------*/
this.fn_DeleteCheck = function () {
	
	if ( this.dsTA_ACCTXM.getRowCount() < 1) {
		this.fnc_Message("TMM007");
		return false;
	}
	
	var sQuestionText  = "계정과목 : (" + this.dsTA_ACCTXM.getColumn(this.dsTA_ACCTXM.rowposition, "ACCT_INTL") + "), 계정명 : (";
		sQuestionText += this.fnc_Trim(this.dsTA_ACCTXM.getColumn(this.dsTA_ACCTXM.rowposition, "ACCT_BFNM"))+")";
	return this.fnc_Message("TMM002", sQuestionText);

}

/*---------------------+
 |  저장 여부 체크!  |
 +---------------------*/
this.fn_SaveItemCheck = function () {
	
	if (!this.fnc_DatasetChangeCheck("dsTA_ACCTXM,dsTA_ACCTXD")) {	
		this.fnc_Message("TMM003");
		return false;
	}
	
	for (var i = 0; i < this.dsTA_ACCTXM.getRowCount(); i++) {

		if (this.dsTA_ACCTXM.getRowType(i) == Dataset.ROWTYPE_NORMAL) continue;
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "PRNT_LEVL"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "계정레벨", this.dsTA_ACCTXM, i, this.edtPRNT_LEVL, "");
		}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "ACCT_INTL"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "계정과목", this.dsTA_ACCTXM, i, this.edtACCT_INTL, "");
		}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "ACCT_NAME"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "계정명", this.dsTA_ACCTXM, i, this.edtACCT_NAME, "");
		}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "ACCT_BFNM"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "계정약어명", this.dsTA_ACCTXM, i, this.edtACCT_BFNM, "");
		}
		
		if (this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "PRNT_LEVL")) != 1) {
			if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "UPPR_ACCT"))) < 1) {
				return this.fnc_CheckPostAction("TMM072", "상위코드", this.dsTA_ACCTXM, i, this.edtUPPR_NAME, "");
			}
		}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "SLIP_YSNO"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "전표등록여부", this.dsTA_ACCTXM, i, this.cmbSLIP_YSNO, "");
		}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "DRCR_GUBN"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "잔액차대구분", this.dsTA_ACCTXM, i, this.cmbDRCR_GUBN, "");
		}
		
		
		if (this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "SLIP_YSNO")) == 1) {
			if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "BUDG_YSNO"))) < 1) {
				return this.fnc_CheckPostAction("TMM072", "예산사용", this.dsTA_ACCTXM, i, this.cmbBUDG_YSNO, "");
			}
		
			if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "GUNB_YSNO"))) < 1) {
				return this.fnc_CheckPostAction("TMM072", "건별미결관리항목여부", this.dsTA_ACCTXM, i, this.cmbGUNB_YSNO, "");
			}
		
			if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "EVID_YSNO"))) < 1) {
				return this.fnc_CheckPostAction("TMM072", "증빙여부", this.dsTA_ACCTXM, i, this.cmbEVID_YSNO, "");
			}
		
			if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "CHUN_YSNO"))) < 1) {
				return this.fnc_CheckPostAction("TMM072", "충당금계정여부", this.dsTA_ACCTXM, i, this.cmbCHUN_YSNO, "");
			}

			if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "ZERO_YSNO"))) < 1) {
				return this.fnc_CheckPostAction("TMM072", "금액0허용여부", this.dsTA_ACCTXM, i, this.cmbZERO_YSNO, "");
			}
		
			if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "FNCR_YSNO"))) < 1) {
				return this.fnc_CheckPostAction("TMM072", "외화필수여부", this.dsTA_ACCTXM, i, this.cmbFNCR_YSNO, "");
			}
		
			if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "CHUL_YSNO"))) < 1) {
				return this.fnc_CheckPostAction("TMM072", "출납전표사용", this.dsTA_ACCTXM, i, this.cmbCHUL_YSNO, "");
			}
			
			if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(i, "CSUS_YSNO"))) < 1) {
				return this.fnc_CheckPostAction("TMM072", "코스트센터사용", this.dsTA_ACCTXM, i, this.cmbCSUS_YSNO, "");
			}
		}

	}
	
	this.dsTA_ACCTXD.set_keystring("S:CODE_SEQN");

	for (var i = 0; i < this.dsTA_ACCTXD.getRowCount(); i++) {
		
		//if (this.dsTA_ACCTXD.getRowType(i) == Dataset.ROWTYPE_NORMAL) continue;
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXD.getColumn(i, "COND_CODE"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "관리코드", this.dsTA_ACCTXD, i, this.grdTA_ACCTXD, "COND_NAME");
		}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXD.getColumn(i, "DRCR_YSNO"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "필수구분", this.dsTA_ACCTXD, i, this.grdTA_ACCTXD, "DRCR_YSNO");
		}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_ACCTXD.getColumn(i, "CODE_SEQN"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "순번", this.dsTA_ACCTXD, i, this.grdTA_ACCTXD, "CODE_SEQN");
		}
		
		if (this.dsTA_ACCTXD.getCaseCount("CODE_SEQN = " + this.dsTA_ACCTXD.getColumn(i, "CODE_SEQN")) > 1) {
			return this.fnc_CheckPostAction("TMM300", "순번이 중복됩니다.", this.dsTA_ACCTXD, i, this.grdTA_ACCTXD, "CODE_SEQN");
		}
		
		if (this.fnc_Trim(this.dsTA_ACCTXD.getColumn(i, "UNUS_YSNO")) == "1") {
			if (this.fnc_Trim(this.dsTA_ACCTXD.getColumn(i, "DRCR_YSNO")) != "1") {
				return this.fnc_CheckPostAction("TMM300", "미결사용시 차대필수 입니다.", this.dsTA_ACCTXD, i, this.grdTA_ACCTXD, "DRCR_YSNO");
			}
		}
		
		this.dsTA_ACCTXD.setColumn(i, "ACCT_INTL", this.dsTA_ACCTXM.getColumn(this.dsTA_ACCTXM.rowposition, "ACCT_INTL"));
		
		//순번 재계산
		this.dsTA_ACCTXD.setColumn(i, "CODE_SEQN", nexacro.toNumber(i + 1));
		
	}
	
	//this.dsTA_ACCTXD.set_keystring("");
		
	return true;
	
}

/*---------------------------------------------+
 |  Service 호출 시 넘어 갈 Argument 생성!  |
 +-----------------------------------***-------*/
this.fn_CreateArgument = function (sKind) {

	var sReturnString;

	if (sKind == "SEARCH00") {
		
		sReturnString  = " pgm="       + this.fnc_Quote(this.sPACKAGENAME); 
		sReturnString += " action="    + this.fnc_Quote(sKind);
		sReturnString += " ACCT_NAME=" + this.fnc_Quote(this.fnc_Trim(this.edtSHRACCT_NAME.value));
		sReturnString += " ACCT_TYPE=" + this.fnc_Quote(this.fnc_Trim(this.cmbSHRACCT_TYPE.value));
		sReturnString += " PRNT_LEVL=" + this.fnc_Quote(this.fnc_Trim(this.edtSHRPRNT_LEVL.value));
		sReturnString += " SLIP_YSNO=" + this.fnc_Quote(this.fnc_Trim(this.cmbSHRSLIP_YSNO.value));
		sReturnString += " ACCT_YSNO=" + this.fnc_Quote(this.fnc_Trim(this.cmbSHRACCT_YSNO.value));

	} else if (sKind == "SEARCH01") {
		
		sReturnString  = " pgm="       + this.fnc_Quote(this.sPACKAGENAME);
		sReturnString += " action="    + this.fnc_Quote(sKind);
		sReturnString += " ACCT_INTL=" + this.fnc_Quote(this.fnc_Trim(this.dsTA_ACCTXM.getColumn(this.dsTA_ACCTXM.rowposition, "ACCT_INTL")));

	} else if (sKind == "SAVE00") {
		
		sReturnString  = " pgm="    + this.fnc_Quote(this.sPACKAGENAME);
		sReturnString += " action=" + this.fnc_Quote(sKind);
	
	}
	
	return sReturnString;
	
}

/*---------------------------------------+
 |  Transaction 후 처리 해야 할 내용!  |
 +---------------------------------------*/
this.fn_CallBack = function (sMethodName, ErrorCode, ErrorMSG) {

	if (ErrorCode < 0) {
		
		if (application.GBL_SESSONCHK == "E0001") {
			this.fnc_ErrorProcess(ErrorCode, ErrorMSG);
		} else {
			this.fnc_Message("SERVERMSG", ErrorMSG);
		}
		
	} else {

		this.fn_PostProcess(sMethodName);

	}
}

/*--------------------------------------+
 |  Transaction 후 Post Process!       |
 +--------------------------------------*/
this.fn_PostProcess = function (sMethodName) {
	
	if (sMethodName == "SEARCH00") {
		
		this.fnc_Information(this.stInformation, this.dsTA_ACCTXM.getCaseCount("dataset.getRowLevel(currow)==0"), "SHR");
		this.fnc_Message("TMM018", this.dsTA_ACCTXM.getCaseCount("dataset.getRowLevel(currow)==0"));
	
	} else if (sMethodName == "SEARCH01") {

		this.fnc_Information(this.stInformation1, this.dsTA_ACCTXD.getCaseCount("dataset.getRowLevel(currow)==0"), "SHR");
		
	} else if (sMethodName == "SAVE00") {
		
		this.fnc_Information(this.stInformation, 0, "SAVE");
        this.fnc_Information(this.stInformation1, 0, "SAVE");
		this.fnc_Message("TMM103");

	} else if (sMethodName == "GetCommCode") {
	
		var arrParam = new Array();
			arrParam[0]  = "COMBO,cmbSHRACCT_TYPE,dsSHRACCT_TYPE,0";      //계정종류
			arrParam[1]  = "COMBO,cmbACCT_TYPE,dsACCT_TYPE,0";            //계정종류
			arrParam[2]  = "COMBO,cmbSPSA_GUBN,dsSPSA_GUBN,0";            //특수관게자거래구분
			arrParam[3]  = "COMBO,cmbOVER_GUBN,dsOVER_GUBN,0";            //간접비구분
			arrParam[4]  = "COMBO,cmbSLIP_YSNO,dsUSEX_YSNO,0";            //전표등록여부
			arrParam[5]  = "COMBO,cmbACCT_YSNO,dsUSEX_YSNO,0";            //사용여부
			arrParam[6]  = "COMBO,cmbBUDG_YSNO,dsUSEX_YSNO,0";            //예산사용
			arrParam[7]  = "COMBO,cmbGUNB_YSNO,dsUSEX_YSNO,0";            //간별미결관리
			arrParam[8]  = "COMBO,cmbCHUN_YSNO,dsUSEX_YSNO,0";            //충당급계정
			arrParam[9]  = "COMBO,cmbZERO_YSNO,dsUSEX_YSNO,0";            //금액허용
			arrParam[10] = "COMBO,cmbFNCR_YSNO,dsUSEX_YSNO,0";            //외화필수	
			arrParam[11] = "COMBO,cmbEVID_YSNO,dsUSEX_YSNO,0";            //증빙사용
			arrParam[12] = "COMBO,cmbACCT_TYPE,dsACCT_TYPE,0";            //계정종류	
			arrParam[13] = "COMBO,cmbCHUL_YSNO,dsUSEX_YSNO,0";            //출납전표사용
			arrParam[14] = "COMBO,cmbCSUS_YSNO,dsUSEX_YSNO,0";            //코스트센터사용
			arrParam[15] = "COMBO,cmbEVID_YSNO,dsUSEX_YSNO,0";            //증빙사용
			arrParam[16] = "COMBO,cmbFUND_YSNO,dsUSEX_YSNO,0";            //자금사용
			arrParam[17] = "COMBO,cmbCOST_GUBN,dsCOST_GUBN,0";            //원가구분
			arrParam[18] = "GRID,grdTA_ACCTXD,dsDRCR_YSNO,DRCR_YSNO";	  //필수구분
			arrParam[19] = "GRID,grdTA_ACCTXM,dsDRCR_GUBN,DRCR_GUBN";     //그리드 차대구분
			arrParam[20] = "GRID,grdTA_ACCTXM,dsACCT_TYPE,ACCT_TYPE";     //그리드 계정종류
			arrParam[21] = "COMBO,cmbDRCR_GUBN,dsDRCR_GUBN,0";            //입력항목 차대구분
			arrParam[22] = "COMBO,cmbSHRSLIP_YSNO,dsSHRUSEX_YSNO,0";
			arrParam[23] = "COMBO,cmbSHRACCT_YSNO,dsSHRUSEX_YSNO,0";

		this.fnc_CommonCodeInnerBind(arrParam);	
	
	} 
	
}

/*------------------------------------+
 |  수정 시 Key Field Disibled 처리  |
 +------------------------------------*/
this.fn_KeyFieldDisible = function (obj:Dataset, e:nexacro.DSRowsetChangeEventInfo) {

	if (e.newrow == -1) return;

	if (this.fnc_ToUpper(obj.getRowType(obj.rowposition)) == Dataset.ROWTYPE_INSERT) {
		this.fnc_SetReadonly(this.edtACCT_INTL, false);
	} else {
		this.fnc_SetReadonly(this.edtACCT_INTL, true);
	}

	this.fn_SetFieldEnable(obj.getColumn(obj.rowposition, "SLIP_YSNO"));

	// 관리항목 조회
	var sMethodName = "SEARCH01";
	var sInDataSet = "";
	var sOutDataSet = "dsTA_ACCTXD=dsTA_ACCTXD";
	var sArgument = this.fn_CreateArgument(sMethodName);
	this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack", false);
	
}

/*----------------------------------------------------+
 |  관리코드 등록 수정 시 Key Field Disibled 처리  |
 +----------------------------------------------------*/
this.fn_KeyFieldDisible1 = function (obj:Dataset, e:nexacro.DSRowsetChangeEventInfo) {

	if (e.newrow == -1) return;

	if (obj.getRowType(obj.rowposition) == Dataset.ROWTYPE_INSERT) {
		this.grdTA_ACCTXD.setCellProperty("Body",this.fnc_GridColumnIndex(this.grdTA_ACCTXD, "COND_NAME"), "edittype", "text");
	} else {
		this.grdTA_ACCTXD.setCellProperty("Body",this.fnc_GridColumnIndex(this.grdTA_ACCTXD, "COND_NAME"), "edittype", "none");
	}
	
}
/*----------------+
 |  팝업 Setting  |
 +----------------*/
this.fn_HelpDialoge = function (obj, sFromDs, sOldValue, sColumnID) {

    var arrParam = new Array();
		
    // 입력 - 상위 코드(Popup)
    if ((obj.name == "imgHelpUPPR_ACCT") || (sColumnID == "UPPR_NAME")) {
	
		if (nexacro.toNumber(this.fnc_Trim(this.edtPRNT_LEVL.value), 0) <= 0) {
			return this.fnc_CheckPostAction("TMM072", "계정레벨", this.dsTA_ACCTXM, this.dsTA_ACCTXM.rowposition, this.edtPRNT_LEVL, "");
		}
		
        arrParam[0] = "FAM0033";
        arrParam[1] = this.edtPRNT_LEVL.value;
        arrParam[2] = this.fnc_Trim(this.edtUPPR_NAME.value);
        arrParam[3] = "N";
        arrParam[4] = "edtUPPR_NAME";
        arrParam[5] = "edtUPPR_ACCT,edtUPPR_NAME";
        arrParam[6] = "0,1";
        arrParam[7] = sFromDs;
		arrParam[8] = sOldValue;
        this.fnc_HelpDialogeAction(this, obj, arrParam);
        
	// 입력(관리코드등록) - 관리코드(Popup)
    } else if(obj.name == "grdTA_ACCTXD") {
   
			if (sColumnID == "COND_NAME" || this.fnc_getGridHelpColName(obj, sFromDs) == "COND_NAME") {
			
				arrParam[0] = "FAM0036";
				arrParam[1] = "";
				arrParam[2] = "COND_NAME";
				arrParam[3] = "N";
				arrParam[4] = "grdTA_ACCTXD";
				arrParam[5] = "COND_CODE,COND_NAME";
				arrParam[6] = "0,1";
				arrParam[7] = sFromDs;
				arrParam[8] = sOldValue;
				this.fnc_HelpDialogeAction(this, obj, arrParam);

			}
			
       }
       
 }
 
/**************************************************************************************************
 *                                사용자 정의  Function 처리 부분                                  *
 ***************************************************************************************************/
/**************************************************************************************************
 *                                  사용자 정의  Event 처리 부분                                   *
 ***************************************************************************************************/

/*------------+
 |  행 복사  |
 +------------*/
this.btn_CopyRow_OnClick = function (obj:Button, e:nexacro.ClickEventInfo) {
	
	if (this.dsTA_ACCTXM.getRowCount() < 1) {
		this.fnc_Message("FAM004");
		return;
	}
	
	var uRow = this.dsTA_ACCTXM.rowposition;

	// 관리코드 데이터셋 복사
	this.dsTA_ACCTXD_TEMP.copyData(this.dsTA_ACCTXD);

	// 계정과목 행추가, 복사
	var iRow = this.dsTA_ACCTXM.insertRow(uRow + 1);
	this.dsTA_ACCTXM.copyRow(iRow, this.dsTA_ACCTXM, uRow);

	this.dsTA_ACCTXM.setColumn(iRow, "ACCT_INTL", ""); //계정과목
	this.dsTA_ACCTXM.setColumn(iRow, "SORT_ORDR", ""); //정렬순서

	this.fn_SetFieldEnable(this.dsTA_ACCTXM.getColumn(iRow, "SLIP_YSNO"));

	// 관리코드 행추가 후 데이터 복사
	var dCount = this.dsTA_ACCTXD_TEMP.getRowCount();

	for (var dRow = 0; dRow < dCount; dRow++) {
		this.dsTA_ACCTXD_TEMP.setColumn(dRow, "ACCT_INTL", "");
		this.dsTA_ACCTXD.insertRow(dRow);
		this.dsTA_ACCTXD.copyRow(dRow, this.dsTA_ACCTXD_TEMP, dRow);
	}

	this.dsTA_ACCTXD_TEMP.clearData();
	this.edtACCT_INTL.setFocus();

}

/*------------------+
 |  관리코드추가  |
 +------------------*/
this.btn_RowAdd_OnClick = function (obj:Button, e:nexacro.ClickEventInfo) {
	
	if (this.dsTA_ACCTXM.getRowCount() < 1) {
		this.fnc_Message("TMM032");
		return;
	}

	if (this.fnc_Length(this.fnc_Trim(this.edtACCT_INTL.value)) < 1) {
		this.fnc_Message("TMM072", "계정과목");
		this.edtACCT_INTL.setFocus();
		return;
	}
	
	if (this.cmbSLIP_YSNO.value == "0") {
		this.fnc_Message("FAM001");
		this.cmbSLIP_YSNO.setFocus();
		return;
	}	
	
	this.fnc_SetReadonly(this.edtACCT_INTL, true);
	var iRow = this.dsTA_ACCTXD.addRow();
	this.dsTA_ACCTXD.setColumn(iRow, "ACCT_INTL", this.dsTA_ACCTXM.getColumn(this.dsTA_ACCTXM.rowposition, "ACCT_INTL"));
	this.dsTA_ACCTXD.setColumn(iRow, "DRCR_YSNO", "0");
    this.dsTA_ACCTXD.setColumn(iRow, "CODE_SEQN", "0"); //순번 
	this.dsTA_ACCTXD.setColumn(iRow, "CODE_SEQN", nexacro.toNumber(this.dsTA_ACCTXD.getMax("CODE_SEQN")) + 1);
	this.dsTA_ACCTXD.setColumn(iRow, "UNUS_YSNO", "0");  //미결사용
	this.dsTA_ACCTXD.setColumn(iRow, "OVER_YSNO", "0");  //이월사용
	this.dsTA_ACCTXD.setColumn(iRow, "USEX_YSNO", "1");  //사용여부

	this.fnc_GridSetCellFocus(this.grdTA_ACCTXD, "COND_NAME");

}

/*-----------------+
 |  관리코드삭제 |
 +-----------------*/
this.btn_RowDel_OnClick = function (obj:Button, e:nexacro.ClickEventInfo){

	if(this.fn_DetailDeleteCheck()) {
		this.dsTA_ACCTXD.deleteRow(this.dsTA_ACCTXD.rowposition);
		this.dsTA_ACCTXD.set_keystring("S:CODE_SEQN");
		for (var i = 0; i < this.dsTA_ACCTXD.getRowCount(); i++) {

			//순번 재계산
			this.dsTA_ACCTXD.setColumn(i, "CODE_SEQN", nexacro.toNumber(i + 1));
			
		}
		
	}

	if (this.dsTA_ACCTXD.getRowCount() < 1) {

		if (this.dsTA_ACCTXM.getRowType(this.dsTA_ACCTXM.rowposition) == Dataset.ROWTYPE_INSERT) {
			this.fnc_SetReadonly(this.edtACCT_INTL, false);
		} else {
			this.fnc_SetReadonly(this.edtACCT_INTL, true);
		}

	}

}

/*-----------------------+
 |  관리코드 삭제 여부 |
 +-----------------------*/
this.fn_DetailDeleteCheck = function (){
	
	if (this.dsTA_ACCTXM.getRowCount() < 1) {
		this.fnc_Message("TMM032");
		return;
	}
	
	if (this.dsTA_ACCTXD.getRowCount() < 1) {
		this.fnc_Message("TMM007");
		return;
	}
	
	var sQuestionText  = "관리코드 : (" + this.fnc_Trim(this.dsTA_ACCTXD.getColumn(this.dsTA_ACCTXD.rowposition, "COND_CODE")) + "), ";
		sQuestionText += "관리코드명 : (" + this.fnc_Trim(this.dsTA_ACCTXD.getColumn(this.dsTA_ACCTXD.rowposition, "COND_NAME")) + ")";
	return this.fnc_Message("TMM002", sQuestionText);

}

/*-------------------------------------+
 |  계정과목정보 행 이동시 체크 이벤트 |
 +-------------------------------------*/
this.dsTA_ACCTXM_canrowposchange = function (obj:Dataset, e:nexacro.DSRowPosChangeEventInfo) {
	
	if (this.fnc_DatasetChangeCheck("dsTA_ACCTXD")) {
		if (this.fnc_Message("TMM023") == false) return false;
	}

}

this.dsTA_ACCTXM_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo) {

	if (e.columnid == "SLIP_YSNO") {
	
		this.fn_SetFieldEnable(e.newvalue);
		
	} else if (e.columnid == "UPPR_NAME") {
	
		this.fn_HelpDialoge(this.edtUPPR_NAME, "YES", e.oldvalue, e.columnid);
		
	}
	
}

this.fn_SetFieldEnable = function (sVal) {

	if (sVal == "1") {
	
		this.staBUDG_YSNO.set_cssclass("styFormItemCapBE");
		this.staGUNB_YSNO.set_cssclass("styFormItemCapBE");
		this.staCHUN_YSNO.set_cssclass("styFormItemCapBE");
		this.staZERO_YSNO.set_cssclass("styFormItemCapBE");
		this.staFNCR_YSNO.set_cssclass("styFormItemCapBE");
		this.staEVID_YSNO.set_cssclass("styFormItemCapBE");
		this.staCHUL_YSNO.set_cssclass("styFormItemCapBE");
		this.staCSUS_YSNO.set_cssclass("styFormItemCapBE");

		this.fnc_SetReadonly(this.cmbBUDG_YSNO, false);
		this.fnc_SetReadonly(this.cmbGUNB_YSNO, false);
		this.fnc_SetReadonly(this.cmbCHUN_YSNO, false);
		this.fnc_SetReadonly(this.cmbZERO_YSNO, false);
		this.fnc_SetReadonly(this.cmbFNCR_YSNO, false);
		this.fnc_SetReadonly(this.cmbEVID_YSNO, false);
		this.fnc_SetReadonly(this.cmbACCT_TYPE, false);
		this.fnc_SetReadonly(this.cmbSPSA_GUBN, false);
		this.fnc_SetReadonly(this.cmbCHUL_YSNO, false);
		this.fnc_SetReadonly(this.cmbCSUS_YSNO, false);
		this.fnc_SetReadonly(this.cmbFUND_YSNO, false);
		this.fnc_SetReadonly(this.cmbOVER_GUBN, false);
		this.fnc_SetReadonly(this.cmbCOST_GUBN, false);
	
	} else {

		this.staBUDG_YSNO.set_cssclass("styFormItemCap");
		this.staGUNB_YSNO.set_cssclass("styFormItemCap");
		this.staCHUN_YSNO.set_cssclass("styFormItemCap");
		this.staZERO_YSNO.set_cssclass("styFormItemCap");
		this.staFNCR_YSNO.set_cssclass("styFormItemCap");
		this.staEVID_YSNO.set_cssclass("styFormItemCap");
		this.staCHUL_YSNO.set_cssclass("styFormItemCap");
		this.staCSUS_YSNO.set_cssclass("styFormItemCap");

		this.fnc_SetReadonly(this.cmbBUDG_YSNO, true);
		this.fnc_SetReadonly(this.cmbGUNB_YSNO, true);
		this.fnc_SetReadonly(this.cmbCHUN_YSNO, true);
		this.fnc_SetReadonly(this.cmbZERO_YSNO, true);
		this.fnc_SetReadonly(this.cmbFNCR_YSNO, true);
		this.fnc_SetReadonly(this.cmbEVID_YSNO, true);
		this.fnc_SetReadonly(this.cmbACCT_TYPE, true);
		this.fnc_SetReadonly(this.cmbSPSA_GUBN, false);
		this.fnc_SetReadonly(this.cmbCHUL_YSNO, true);
		this.fnc_SetReadonly(this.cmbCSUS_YSNO, true);
		this.fnc_SetReadonly(this.cmbFUND_YSNO, true);
		this.fnc_SetReadonly(this.cmbOVER_GUBN, true);
		this.fnc_SetReadonly(this.cmbCOST_GUBN, true);
		
	}
}

/*-----------------------+
 |  그리드 팝업 이벤트 |
 +-----------------------*/
//그리드 팝업 시 필요한 이벤트(dsTA_ACCTXD oncolumnchanged 이벤트 추가)
this.dsTA_ACCTXD_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo) {

	//관리코드팝업
	if (e.columnid == "COND_NAME") this.fn_HelpDialoge(this.grdTA_ACCTXD, "YES" ,e.oldvalue, e.columnid);

}

this.edtSHRACCT_NAME_onkeydown = function(obj:Edit, e:nexacro.KeyEventInfo) {
	
	if (e.keycode != 13) return;
	if (this.fnc_Length(this.fnc_Trim(obj.value)) > 0) this.fn_Search();
	
}
]]></Script>
  </Form>
</FDL>
