<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="../../default_typedef.xml"/>
  <Form id="TXMA0990" onkeydown="fn_HotKey" onload="fn_FormLoadSetting" titletext="부가세코드등록" position="absolute" scrollbars="none" onbeforeclose="fn_FormUnloadCheckProcess" left="0" width="1187" top="0" height="717" onclose="fn_FormUnloadProcess">
    <Layouts>
      <Layout>
        <Grid selecttype="row" autoenter="TRUE" autofittype="none" binddataset="dsTA_VATCDD" cellsizingtype="both" enable="true" id="grdTA_VATCDD" useinputpanel="false" autofitminwidth="100" taborder="2" tabstop="false" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute" left="300" right="25" top="138" bottom="15" cssclass="styGrid01">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="118" band="left"/>
                <Column size="85" band="left"/>
                <Column size="80" band="left"/>
                <Column size="160" band="left"/>
                <Column size="297"/>
                <Column size="35"/>
                <Column size="226"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="188"/>
                <Column size="202"/>
                <Column size="194"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="39" band="head"/>
                <Row size="26"/>
              </Rows>
              <Band id="head">
                <Cell cssclass="Cellgrd_WF_edit" text="증빙구분"/>
                <Cell col="1" cssclass="Cellgrd_WF_essential" text="부가세종류"/>
                <Cell col="2" cssclass="Cellgrd_WF_edit" text="부가세유형"/>
                <Cell col="3" cssclass="Cellgrd_WF_edit" text="불공제세부"/>
                <Cell col="4" cssclass="Cellgrd_WF_essential" text="세부유형명"/>
                <Cell col="5" displaytype="text" cssclass="Cellgrd_WF_edit" text="사용"/>
                <Cell col="6" cssclass="Cellgrd_WF_edit" text="부가신고서"/>
                <Cell col="7" cssclass="Cellgrd_WF_edit" text="매출처별&#13;&#10;세금계산서"/>
                <Cell col="8" cssclass="Cellgrd_WF_edit" text="매출처별&#13;&#10;계산서"/>
                <Cell col="9" cssclass="Cellgrd_WF_edit" text="매입처별&#13;&#10;세금계산서"/>
                <Cell col="10" cssclass="Cellgrd_WF_edit" text="매입처별&#13;&#10;계산서"/>
                <Cell col="11" cssclass="Cellgrd_WF_edit" text="공제받지못할매입세액명세서"/>
                <Cell col="12" cssclass="Cellgrd_WF_edit" text="건물등감가상각자산취득명세서" combodataset="dsUSEYN_V149" combocodecol="SUBCODE" combodatacol="SUBNAME"/>
                <Cell col="13" cssclass="Cellgrd_WF_edit" text="신용카드매출전표등수취명세서"/>
                <Cell col="14" cssclass="Cellgrd_WF_edit" text="영세율첨부서류&#13;&#10;제출명세서"/>
                <Cell col="15" cssclass="Cellgrd_WF_edit" text="신용카드&#13;&#10;매출전표"/>
                <Cell col="16" cssclass="Cellgrd_WF_edit" text="부동산임대&#13;&#10;공급가액명세서"/>
                <Cell col="17" cssclass="Cellgrd_WF_edit" text="대손세액공제&#13;&#10;(변제)신고서"/>
                <Cell col="18" cssclass="Cellgrd_WF_edit" text="수출실적&#13;&#10;명세서"/>
                <Cell col="19" cssclass="Cellgrd_WF_edit" text="사업장별&#13;&#10;부가가치세"/>
                <Cell col="20" cssclass="Cellgrd_WF_edit" text="사업자단위과세"/>
              </Band>
              <Band id="body">
                <Cell displaytype="combo" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_INSERT ? &quot;combo&quot; : &quot;none&quot;" style="align:left;" text="bind:VAT_LINKCD1"/>
                <Cell col="1" displaytype="combo" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_INSERT ? &quot;combo&quot; : &quot;none&quot;" style="align:left;" text="bind:VAT_LINKCD2"/>
                <Cell col="2" displaytype="combo" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_INSERT ? &quot;combo&quot; : &quot;none&quot;" style="align:left;" text="bind:VAT_LINKCD3"/>
                <Cell col="3" displaytype="combo" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_INSERT ? &quot;combo&quot; : &quot;none&quot;" style="align:left;" text="bind:VAT_LINKCD4"/>
                <Cell col="4" style="align:left;" text="bind:VATD_TYPENM"/>
                <Cell col="5" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:IS_USED"/>
                <Cell col="6" edittype="text" style="align:left;" text="bind:APPL_V101" editlimit="64"/>
                <Cell col="7" displaytype="checkbox" edittype="checkbox" text="bind:APPL_V104" editlimit="1"/>
                <Cell col="8" displaytype="checkbox" edittype="checkbox" text="bind:APPL_V110" editlimit="1"/>
                <Cell col="9" displaytype="checkbox" edittype="checkbox" text="bind:APPL_V105" editlimit="1"/>
                <Cell col="10" displaytype="checkbox" edittype="checkbox" text="bind:APPL_V109" editlimit="1"/>
                <Cell col="11" displaytype="combo" edittype="combo" style="align:left;" text="bind:APPL_V153"/>
                <Cell col="12" displaytype="combo" edittype="combo" style="align:left;" text="bind:APPL_V149"/>
                <Cell col="13" displaytype="combo" edittype="combo" style="align:left;" text="bind:APPL_V164" combodataset="dsUSEYN_V164" combocodecol="SUBCODE" combodatacol="SUBNAME"/>
                <Cell col="14" displaytype="checkbox" edittype="checkbox" text="bind:APPL_V106" editlimit="1"/>
                <Cell col="15" displaytype="combo" edittype="combo" text="bind:APPL_V117" editlimit="2" combodataset="dsUSEYN_V117" combocodecol="SUBCODE" combodatacol="SUBNAME"/>
                <Cell col="16" displaytype="checkbox" edittype="checkbox" text="bind:APPL_V120" editlimit="1"/>
                <Cell col="17" displaytype="combo" edittype="combo" text="bind:APPL_V112" editlimit="1" combodataset="dsUSEYN_V112" combocodecol="SUBCODE" combodatacol="SUBNAME"/>
                <Cell col="18" displaytype="checkbox" edittype="checkbox" text="bind:APPL_V141" editlimit="1"/>
                <Cell col="19" displaytype="checkbox" edittype="checkbox" text="bind:APPL_V115" editlimit="1"/>
                <Cell col="20" displaytype="combo" edittype="combo" style="align:left;" text="bind:APPL_V166" combodataset="dsUSEYN_V166" combocodecol="SUBCODE" combodatacol="SUBNAME"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid selecttype="row" autoenter="TRUE" autofittype="col" binddataset="dsTA_VATCDH" cellsizingtype="both" enable="true" id="grdTA_VATCDH" useinputpanel="false" autofitminwidth="100" taborder="1" tabstop="false" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute" left="8" width="272" top="138" bottom="15" cssclass="styGrid01">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="70"/>
                <Column size="80"/>
                <Column size="70"/>
                <Column size="30"/>
              </Columns>
              <Rows>
                <Row size="29" band="head"/>
                <Row size="26"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" cssclass="Cellgrd_WF_essential" text="과세유형"/>
                <Cell col="1" displaytype="text" cssclass="Cellgrd_WF_essential" text="과세유형명"/>
                <Cell col="2" displaytype="text" cssclass="Cellgrd_WF_essential" text="매입/매출"/>
                <Cell col="3" displaytype="text" cssclass="Cellgrd_WF_edit" text="사용"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" edittype="expr:dataset.getRowType(currow) == Dataset.ROWTYPE_INSERT ? &quot;normal&quot; : &quot;none&quot;" style="align: center;background: EXPR(gfn_Decode(getRowLevel(currow), 0, gfn_Decode(expr_GetRowType(),&quot;insert&quot;,&quot;#c3d5fdff&quot;,&quot;update&quot;,&quot;#fdd9c3ff&quot;,&quot;default&quot;), 1, '#d7f1eeff', 2, '#d9f9aeff',3,'#e6e6e6ff'));" text="bind:VATH_TYPECD" editlimit="10"/>
                <Cell col="1" displaytype="text" edittype="normal" style="align: left;background: EXPR(gfn_Decode(getRowLevel(currow), 0, gfn_Decode(expr_GetRowType(),&quot;insert&quot;,&quot;#c3d5fdff&quot;,&quot;update&quot;,&quot;#fdd9c3ff&quot;,&quot;default&quot;), 1, '#d7f1eeff', 2, '#d9f9aeff',3,'#e6e6e6ff'));" text="bind:VATH_TYPENM" editlimit="256" editimemode="hangul"/>
                <Cell col="2" displaytype="combo" edittype="combo" style="align:center;background:EXPR(gfn_Decode(getRowLevel(currow), 0, gfn_Decode(expr_GetRowType(),&quot;insert&quot;,&quot;#c3d5fdff&quot;,&quot;update&quot;,&quot;#fdd9c3ff&quot;,&quot;default&quot;), 1, '#d7f1eeff', 2, '#d9f9aeff',3,'#e6e6e6ff'));" text="bind:SALE_TYPECD" editlimit="10"/>
                <Cell col="3" displaytype="checkbox" edittype="checkbox" style="align:center;background:EXPR(gfn_Decode(getRowLevel(currow), 0, gfn_Decode(expr_GetRowType(),&quot;insert&quot;,&quot;#c3d5fdff&quot;,&quot;update&quot;,&quot;#fdd9c3ff&quot;,&quot;default&quot;), 1, '#d7f1eeff', 2, '#d9f9aeff',3,'#e6e6e6ff'));" text="bind:IS_USED"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="stInformation1" text="&lt;b v='true'&gt;00&lt;/b&gt; 건이 조회 되었습니다." position="absolute" left="8" width="180" top="117" height="21" cssclass="styFormSearchInfo" taborder="7" usedecorate="true"/>
        <Static id="stInformation2" text="&lt;b v='true'&gt;00&lt;/b&gt; 건이 조회 되었습니다." left="417" width="240" top="117" height="21" cssclass="styFormSearchInfo" taborder="3" usedecorate="true"/>
        <Button id="btnAddRow1" onclick="btnAddRow1_OnClick" taborder="10" tabstop="false" position="absolute" left="153" width="62" top="113" height="21" cssclass="btn_WF_Module" text="행추가"/>
        <Button id="btnAddRow2" onclick="btnAddRow2_OnClick" taborder="11" tabstop="false" position="absolute" right="90" width="62" top="113" height="21" cssclass="btn_WF_Module" text="행추가"/>
        <Button id="btnDelRow2" onclick="btnDelRow2_OnClick" taborder="12" tabstop="false" position="absolute" right="25" width="62" top="113" height="21" cssclass="btn_WF_Module" text="행삭제"/>
        <Button id="btnDelRow1" onclick="btnDelRow1_OnClick" taborder="13" tabstop="false" left="218" width="62" top="113" height="21" cssclass="btn_WF_Module" text="행삭제"/>
        <Static id="Static1" radiusy="10" radiusx="10" type="roundrectangle" position="absolute" left="8" right="25" top="60" height="43" cssclass="styFormSearchBox" taborder="5"/>
        <Static id="Static4" text="증빙구분" position="absolute" style="align:left middle;" left="28" width="62" top="72" height="22" cssclass="styFormSearchCap" taborder="4"/>
        <Combo id="cmbVAT_LINKCD1" taborder="16" onsetfocus="fn_EditFocus" cssclass="styFormItemCombo" left="96" top="71" height="22" width="140"/>
        <Static id="Static21" taborder="17" text="증빙세부내역" cssclass="sta_WF_Subtitle" left="300" height="21" width="127" top="117"/>
        <Static id="st_FormTitle" taborder="18" text="부가세코드등록" cssclass="styFormTitle" left="8" top="0" width="576" height="29"/>
        <Static id="st_FormLocation" taborder="19" text="홈 &gt; 재무관리 &gt; 세무회계 &gt; 부가세신고자료관리 &gt; 부가세코드등록" cssclass="styFormLocation" top="0" right="25" width="640" height="29"/>
        <Div id="div_ButtonList" taborder="20" tabstop="false" url="common::comButtonType01.xfdl" top="33" right="25" width="510" height="23" scrollbars="none" cssclass="styFormButtonList"/>
        <Button id="btn_favorite" taborder="21" onclick="btn_favorite_onclick" cssclass="btn_WF_Bookmark" left="8" top="0" width="18" height="29"/>
        <Static id="Static04" taborder="24" text="h 10" visible="false" left="898" top="23" width="264" height="10" style="background:#fb7b7b7a;"/>
        <Static id="Static05" taborder="25" text="h 60" visible="false" left="538" top="0" width="32" height="60" style="background:#fb7b7b7a;"/>
        <Static id="Static07" taborder="26" text="h 4" visible="false" left="637" top="56" width="128" height="4" style="background:#fb7b7b7a;"/>
        <Static id="Static00" taborder="27" visible="false" left="509" top="103" width="80" height="35" style="background:#fb7b7b7a;" text="h 35"/>
        <Static id="Static02" taborder="28" text="w&#13;&#10;8" cssclass="sta_GID_box" visible="false" left="0" top="0" width="8" height="717"/>
        <Static id="Static06" taborder="29" text="w&#13;&#10;25" cssclass="sta_GID_box" visible="false" top="0" right="0" width="25" height="717"/>
        <Static id="Static01" taborder="30" text="h 15" visible="false" left="14" right="31" bottom="0" height="15" style="background:#fb7b7b7a;"/>
        <Static id="Static34" taborder="31" text="w30" visible="false" left="9" top="61" width="30" height="41" style="background:#fb7b7b7a;"/>
        <Static id="Static36" taborder="32" visible="false" left="88" top="61" width="8" height="41" style="background:#fb7b7b7a;"/>
        <Static id="Static37" taborder="33" text="w 40" visible="false" left="236" top="61" width="40" height="41" style="background:#fb7b7b7a;"/>
        <Static id="Static03" taborder="34" text="w20" visible="false" left="280" top="237" width="20" height="41" style="background:#fb7b7b7a;"/>
        <Static id="Static11" taborder="35" text="h 7" visible="false" left="300" top="132" width="48" height="6" style="background:#fb7b7b7a;"/>
        <Static id="Static14" taborder="36" text="w&#13;&#10;12" visible="false" left="393" top="99" width="12" height="23" style="background:#fb7b7b7a;"/>
        <Static id="Static15" taborder="37" text="w&#13;&#10;12" visible="false" left="406" top="99" width="12" height="23" style="background:#fb7b7b7a;"/>
        <Static id="stInformation01" taborder="38" cssclass="sta_WF_line" left="405" top="120" width="10" height="13"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="dsTA_VATCDH" canrowposchange="dsTA_VATCDH_CanRowPosChange" onrowposchanged="dsTA_VATCDH_OnRowPosChanged" useclientlayout="true">
        <ColumnInfo>
          <Column id="VATH_TYPECD" size="10" type="STRING"/>
          <Column id="VATH_TYPENM" size="256" type="STRING"/>
          <Column id="SALE_TYPECD" size="10" type="STRING"/>
          <Column id="IS_USED" size="1" type="STRING"/>
          <Column id="IS_SHOWED" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTA_VATCDD" useclientlayout="true" oncolumnchanged="dsTA_VATCDD_oncolumnchanged">
        <ColumnInfo>
          <Column id="VATH_TYPECD" size="10" type="STRING"/>
          <Column id="VATD_TYPECD" size="24" type="STRING"/>
          <Column id="VATD_TYPENM" size="256" type="STRING"/>
          <Column id="VAT_LINKCD1" size="6" type="STRING"/>
          <Column id="VAT_LINKCD2" size="6" type="STRING"/>
          <Column id="VAT_LINKCD3" size="6" type="STRING"/>
          <Column id="VAT_LINKCD4" size="6" type="STRING"/>
          <Column id="VAT_LINKCD5" size="6" type="STRING"/>
          <Column id="IS_USED" size="1" type="STRING"/>
          <Column id="IS_SHOWED" size="1" type="STRING"/>
          <Column id="APPL_V101" size="64" type="STRING"/>
          <Column id="APPL_V102" size="1" type="STRING"/>
          <Column id="APPL_V142" size="1" type="STRING"/>
          <Column id="APPL_V117" size="2" type="STRING"/>
          <Column id="APPL_V106" size="1" type="STRING"/>
          <Column id="APPL_V111" size="1" type="STRING"/>
          <Column id="APPL_V120" size="1" type="STRING"/>
          <Column id="APPL_V112" size="1" type="STRING"/>
          <Column id="APPL_V115" size="1" type="STRING"/>
          <Column id="APPL_V104" size="1" type="STRING"/>
          <Column id="APPL_V105" size="1" type="STRING"/>
          <Column id="APPL_V109" size="1" type="STRING"/>
          <Column id="APPL_V110" size="1" type="STRING"/>
          <Column id="APPL_V141" size="1" type="STRING"/>
          <Column id="APPL_V144" size="1" type="STRING"/>
          <Column id="APPL_V146" size="1" type="STRING"/>
          <Column id="APPL_V147" size="1" type="STRING"/>
          <Column id="APPL_V148" size="1" type="STRING"/>
          <Column id="APPL_V149" size="1" type="STRING"/>
          <Column id="APPL_V153" size="3" type="STRING"/>
          <Column id="APPL_V154" size="1" type="STRING"/>
          <Column id="APPL_V155" size="1" type="STRING"/>
          <Column id="APPL_V164" size="1" type="STRING"/>
          <Column id="APPL_V165" size="1" type="STRING"/>
          <Column id="APPL_V166" size="3" type="STRING"/>
          <Column id="APPL_V167" size="1" type="STRING"/>
          <Column id="APPL_V168" size="1" type="STRING"/>
          <Column id="APPL_V169" size="1" type="STRING"/>
          <Column id="APPL_V170" size="1" type="STRING"/>
          <Column id="APPL_V171" size="1" type="STRING"/>
          <Column id="APPL_V172" size="1" type="STRING"/>
          <Column id="APPL_V173" size="1" type="STRING"/>
          <Column id="APPL_V174" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsCombo" useclientlayout="true">
        <ColumnInfo>
          <Column id="DSNAME" size="256" prop="default" type="STRING"/>
          <Column id="CODEID" size="256" prop="default" type="STRING"/>
          <Column id="HEADFLAG" size="256" prop="default" type="STRING"/>
          <Column id="REMK" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODEID">VATX_GUBN</Col>
            <Col id="DSNAME">dsVATX_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="REMK">매출/매입</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsEVID_DOCU</Col>
            <Col id="CODEID">EVID_DOCU</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="REMK">증빙구분그리드</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsVATX_TYPE</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="REMK">부가세종류</Col>
            <Col id="CODEID">VATX_TYPE</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsPURC_GUBN</Col>
            <Col id="CODEID">PURC_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="REMK">부가세유형</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsBULG_GUBN</Col>
            <Col id="CODEID">BULG_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="REMK">불공제세부</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsCOMX_YSNO</Col>
            <Col id="CODEID">COMX_YSNO</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="REMK">매출처별세금계산서</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsEVID_EDOCU</Col>
            <Col id="CODEID">EVID_DOCU</Col>
            <Col id="HEADFLAG">ALL</Col>
            <Col id="REMK">증빙구분</Col>
          </Row>
          <Row>
            <Col id="DSNAME">dsAPPL_V149</Col>
            <Col id="CODEID">APPL_V149</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="REMK">건물등감가상각</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsUSEYN_V117" useclientlayout="true">
        <ColumnInfo>
          <Column id="COMCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBNAME" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF1" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF2" size="256" prop="default" type="INT"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">0</Col>
            <Col id="SUBNAME">미사용</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">1</Col>
            <Col id="SUBNAME">과세-카드</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">3</Col>
            <Col id="SUBNAME">과세-현금영수증</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">5</Col>
            <Col id="SUBNAME">면세-카드</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">7</Col>
            <Col id="SUBNAME">면세-현금영수증</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">9</Col>
            <Col id="SUBNAME">봉사료-카드</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">11</Col>
            <Col id="SUBNAME">봉사료-현금영수증</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">13</Col>
            <Col id="SUBNAME">세금계산서교부금액</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">15</Col>
            <Col id="SUBNAME">계산서교부금액</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsUSEYN_V112" useclientlayout="true">
        <ColumnInfo>
          <Column id="COMCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBNAME" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF1" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF2" size="256" prop="default" type="INT"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">0</Col>
            <Col id="SUBNAME">미사용</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">1</Col>
            <Col id="SUBNAME">대손</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">2</Col>
            <Col id="SUBNAME">변제</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsUSEYN_V166" useclientlayout="true">
        <ColumnInfo>
          <Column id="COMCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBNAME" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF1" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF2" size="256" prop="default" type="INT"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">0</Col>
            <Col id="SUBNAME">미사용</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A01</Col>
            <Col id="SUBNAME">매출과세세금계산서</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A02</Col>
            <Col id="SUBNAME">매출과세기타</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A03</Col>
            <Col id="SUBNAME">매출영세세금계산서</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A04</Col>
            <Col id="SUBNAME">매출영세기타</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">B01</Col>
            <Col id="SUBNAME">매입과세</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsUSEYN_V153" useclientlayout="true">
        <ColumnInfo>
          <Column id="COMCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBNAME" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF1" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF2" size="256" prop="default" type="INT"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">0</Col>
            <Col id="SUBNAME">미사용</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A01</Col>
            <Col id="SUBNAME">불공제-필요적기재사항누락</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A02</Col>
            <Col id="SUBNAME">불공제-사업과직접관련없는지출</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A03</Col>
            <Col id="SUBNAME">불공제-비영업용소형승용차구입,유지및임차</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A04</Col>
            <Col id="SUBNAME">불공제-접대비및이와유사한비용관련</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A05</Col>
            <Col id="SUBNAME">불공제-면세사업관련</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A06</Col>
            <Col id="SUBNAME">불공제-토지의자본적지출관련</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A07</Col>
            <Col id="SUBNAME">불공제-사업자등록전매입세액</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">A08</Col>
            <Col id="SUBNAME">불공제-금거래계좌미사용관련매입세액</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">B01</Col>
            <Col id="SUBNAME">공통매입세액안분계산내역</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsUSEYN_V164" useclientlayout="true">
        <ColumnInfo>
          <Column id="COMCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBNAME" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF1" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF2" size="256" prop="default" type="INT"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">0</Col>
            <Col id="SUBNAME">미사용</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">1</Col>
            <Col id="SUBNAME">신용카드및직불카드</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">2</Col>
            <Col id="SUBNAME">현금영수증</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">3</Col>
            <Col id="SUBNAME">화물운송복지카드</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">4</Col>
            <Col id="SUBNAME">사업용신용카드</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsUSEYN_V149" useclientlayout="true">
        <ColumnInfo>
          <Column id="COMCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBCODE" size="256" prop="default" type="STRING"/>
          <Column id="SUBNAME" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF1" size="256" prop="default" type="STRING"/>
          <Column id="SUBREF2" size="256" prop="default" type="INT"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">0</Col>
            <Col id="SUBNAME">미사용</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">6</Col>
            <Col id="SUBNAME">건물,구축물</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">7</Col>
            <Col id="SUBNAME">기계장치</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">8</Col>
            <Col id="SUBNAME">차량운반구</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
          <Row>
            <Col id="COMCODE"/>
            <Col id="SUBCODE">9</Col>
            <Col id="SUBNAME">그밖의감가상각자산</Col>
            <Col id="SUBREF1"/>
            <Col id="SUBREF2"/>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[/***************************************************************************************************
 * # Program: 	TXMA0990 부가세코드등록
 *
 * # Modification Information
 * -------------------------------------------------------------------------------------------------
 *   Date			Modifier	Comment
 * -------------------------------------------------------------------------------------------------
 *   2016.08.03		신민규		Initial Created.
 *   2016.08.03		안윤준		수정
 *   2016.08.11		강창선		수정
 * -------------------------------------------------------------------------------------------------
 * Copyright 1998-2016 By INBUS Co,Ltd. All rights reserved.
 ****************************************************************************************************
 *   Form Common Script
 *      1) 공통 스크립트 위치 및 명칭은 수정 불가 입니다.
 *      2) 각 함수에서 필요한 부분의 소스를 수정 하세요.
 *      3) 해당 프로그램의 기능이 없는 경우 해당 함수의 이름만 놓고 공백 처리
 *
 *  ★ 위 사항의 변경이 있거나 추가 사항이 있을 경우 반드시 개발 PL과 상의 후 수정 요망
 *     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요
 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
 ********************************************************************************INBUS*CO*KR********/
 /************************
 *  공통 Script Include  *
 ************************/
include "script::lib_script_common.xjs"

/*********************
 *  화면 변수 선언부  *
 *********************/
this.sBUTTONLIST 	= "TTFFTTTF";
this.sPACKAGENAME 	= "TXMA0990";

if (this.getOwnerFrame()["sUSERAUTH"] == undefined) {

	this.sUSERAUTH     = "";
	this.sFORMCAPTION  = "";
	this.sFORMLOCATION = "";
	this.sUSERLAVEL    = "";

} else {

	this.sUSERAUTH     = this.getOwnerFrame()["sUSERAUTH"];
	this.sFORMCAPTION  = this.getOwnerFrame()["sFORMCAPTION"];
	this.sFORMLOCATION = this.getOwnerFrame()["sFORMLOCATION"];
	this.sUSERLAVEL    = this.getOwnerFrame()["sUSERLAVEL"];

}

/**************************************************************************************************
 *                                         공통 Event 처리 부분                                    *
 ***************************************************************************************************/
/*-----------------------------------+
 |  01.최초 화면 Load時 처리 할 사항  |
 +------------------------------------*/
this.fn_FormLoadSetting = function (obj:Form, e:LoadEventInfo) {
	this.fnc_FormLoadSetting(obj, this.sFORMCAPTION, this.sFORMLOCATION, this.sBUTTONLIST, this.sUSERAUTH);
	this.fnc_GridSetting(this);
	this.fnc_GetComboDs(this.dsCombo);

	this.fn_Search();
}

/*----------------------------------+
 |  02.화면 종료(닫기) 버튼 클릭 時  |
 ------------------------------------*/
this.fn_End = function (obj) {
	this.close();
}

/*-----------------------+
 |  03.조회 버튼 클릭 時  |
 +------------------------*/
this.fn_Search = function (obj) {

	if (!this.fn_SearchItemCheck()) return;
	
	this.fnc_DatasetClear("dsTA_VATCDH,dsTA_VATCDD");

	var sMethodName = "SEARCH00";
	var sInDataSet 	= "";
	var sOutDataSet = "dsTA_VATCDH=dsTA_VATCDH dsTA_VATCDD=dsTA_VATCDD";
	var sArgument 	= this.fn_CreateArgument(sMethodName);
	this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");
	this.grdTA_VATCDH.setFocus();

}

/*-----------------------------+
 |  04.입력(신규) 버튼 클릭 時  |
 +------------------------------*/
this.fn_Input = function (obj) {
   //기능없음
}

/*-----------------------------+
 |  05.삭제(제거) 버튼 클릭 時  |
 +------------------------------*/
this.fn_Delete = function (obj) {
   //기능없음
}

/*-----------------------+
 |  06.취소 버튼 클릭 時  |
 -------------------------*/
this.fn_Cancel = function (obj) {
	this.fnc_DataSetCancel("dsTA_VATCDH,dsTA_VATCDD");
	this.grdTA_VATCDH.setFocus();
}

/*-----------------------+
 |  07.저장 버튼 클릭 時  |
 -------------------------*/
this.fn_Save = function (obj) {

	if (!this.fn_SaveItemCheck()) return;
    
	var sMethodName = "SAVE00";
	var sInDataSet 	= "dsTA_VATCDH=dsTA_VATCDH:U dsTA_VATCDD=dsTA_VATCDD:U";
	var sOutDataSet = "";
	var sArgument 	= this.fn_CreateArgument(sMethodName);
	this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");

}

/*-----------------------+
 |  08.엑셀 버튼 클릭 時  |
 -------------------------*/
this.fn_ToExcel = function (obj) {
	this.fnc_ToExcel(this.name);

}

/*-----------------------+
 |  09.인쇄 버튼 클릭 時  |
 +------------------------*/
this.fn_Print = function (obj) {
  //기능없음
}

/*-----------------------------------+
 |  10.최초 화면 Load時 처리 할 사항  |
 +------------------------------------*/
this.fn_FormUnloadCheckProcess = function(obj:Form, e:nexacro.CloseEventInfo) {

	if (e.fromobject instanceof Div) return;
	var sMessage = this.fnc_FormUnloadCheck("dsTA_VATCDH,dsTA_VATCDD", this);
	if (!this.fnc_IsEmpty(sMessage)) return sMessage;

}

this.fn_FormUnloadProcess = function (obj:Form, e:CloseEventInfo) {
	this.fnc_FormUnload(obj,e);

}

/*-----------------------------------+
 |  11.단축키 처리(Form KeyDown)      |
 +------------------------------------*/
this.fn_HotKey = function (obj:Form, e:KeyEventInfo) {

	this.fnc_HotKey(this, e.fromreferenceobject, e);

}

/*-----------------------------------+
 |  12.Text Box가 Focus를 받을 때     |
 +------------------------------------*/
this.fn_EditFocus = function (obj) {

	this.fnc_EditFocus(obj);

}
/**************************************************************************************************
 *                                      공통 Function 처리 부분                                    *
 ***************************************************************************************************/
/*-----------------------+
 |  조회 필수 조건 체크!  |
 +------------------------*/
this.fn_SearchItemCheck = function () {

	if (this.fnc_DatasetChangeCheck("dsTA_VATCDH,dsTA_VATCDD")) {
		if (!this.fnc_Message("TMM023")) return false;
	}
	return true;
}


/*------------------+
 |  삭제 여부 체크!  |
 +-------------------*/
this.fn_DeleteCheck = function (dsobj) {

	if ( dsobj == "dsTA_VATCDH") {
		if (this.dsTA_VATCDD.getRowCount() > 0) {
			this.fnc_Message("TMM125", "증빙세부내역이 존재하는 과세유형은 삭제 할수 없습니다.");
			return false;
			
		}
		
		var sQuestionText = "(" + this.fnc_Trim(this.dsTA_VATCDH.getColumn(this.dsTA_VATCDH.rowposition, "VATH_TYPECD")) + ") 과세유형";
		return this.fnc_Message("TMM002", sQuestionText);

	} else if ( dsobj == "dsTA_VATCDD") {
	
		if (this.dsTA_VATCDD.getRowCount() < 1) {
		    this.fnc_Message("TMM007");
		    return;
	    }

		var sQuestionText = "(" + this.fnc_Trim(this.dsTA_VATCDH.getColumn(this.dsTA_VATCDH.rowposition, "VATH_TYPECD")) + ") 과세유형의";
			sQuestionText += " (" + this.fnc_Trim(this.dsTA_VATCDD.getColumn(this.dsTA_VATCDD.rowposition, "VATD_TYPENM")) + ") 세부유형명 ";
		
		return this.fnc_Message("TMM002", sQuestionText);

	}
}

/*------------------+
 |  저장 여부 체크!  |
 +-------------------*/
this.fn_SaveItemCheck = function () {
	
	//변경된 데이터가 없습니다.
	if (!this.fnc_DatasetChangeCheck("dsTA_VATCDH,dsTA_VATCDD")) {
		this.fnc_Message("TMM003");
		return false;
	}
	
	for (var i = 0; i < this.dsTA_VATCDH.getRowCount(); i++) {
	
		if (this.fnc_ToUpper(this.dsTA_VATCDH.getRowType(i)) == Dataset.ROWTYPE_NORMAL) continue;
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATCDH.getColumn(i, "VATH_TYPECD"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "과세유형", this.dsTA_VATCDH, i, this.grdTA_VATCDH, "VATH_TYPECD");
		}

		if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATCDH.getColumn(i, "VATH_TYPENM"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "과세유형명", this.dsTA_VATCDH, i, this.grdTA_VATCDH, "VATH_TYPENM");
		}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATCDH.getColumn(i, "SALE_TYPECD"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "매입/매출", this.dsTA_VATCDH, i, this.grdTA_VATCDH, "SALE_TYPECD");
		}
		
	}

	for (var i = 0; i < this.dsTA_VATCDD.getRowCount(); i++) {
	
		if (this.fnc_ToUpper(this.dsTA_VATCDD.getRowType(i)) == Dataset.ROWTYPE_NORMAL) continue;
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATCDD.getColumn(i, "VATD_TYPECD"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "세부유형", this.dsTA_VATCDD, i, this.grdTA_VATCDD, "VATD_TYPECD");
		}

		if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATCDD.getColumn(i, "VATD_TYPENM"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "세부유형명", this.dsTA_VATCDD, i, this.grdTA_VATCDD, "VATD_TYPENM");
		}
		
// 			if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATCDD.getColumn(i, "VAT_LINKCD1"))) < 1) {
// 				return this.fnc_CheckPostAction("TMM072", "증빙구분", this.dsTA_VATCDD, i, this.grdTA_VATCDD, "VAT_LINKCD1");
// 			}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATCDD.getColumn(i, "VAT_LINKCD2"))) < 1) {
			return this.fnc_CheckPostAction("TMM072", "부가세종류", this.dsTA_VATCDD, i, this.grdTA_VATCDD, "VAT_LINKCD2");
		}
		
		var sVATD_TYPECD3 = this.dsTA_VATCDD.getColumn(this.dsTA_VATCDD.rowposition, "VAT_LINKCD3");
		var sREF1_FILD  = this.dsPURC_GUBN.getColumn(this.dsPURC_GUBN.findRow("COMD_CODE", sVATD_TYPECD3), "REF1_FILD");

		if (sREF1_FILD == 1) {
			if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATCDD.getColumn(i, "VAT_LINKCD4"))) < 1) {
				return this.fnc_CheckPostAction("TMM072", "불공제세부", this.dsTA_VATCDD, i, this.grdTA_VATCDD, "VAT_LINKCD4");
			}
		}
		
	}

	return true;
	
}
/*-----------------------------------------+
 |  Service 호출 시 넘어 갈 Argument 생성!  |
 +------------------------------------------*/
this.fn_CreateArgument = function (sKind) {

	var sReturnString;
	var sTAVATCDH = this.dsTA_VATCDH.getColumn(this.dsTA_VATCDH.rowposition, "VATH_TYPECD"); // 코드가 길어져서 축약
	
	if (sKind == "SEARCH00") {
		sReturnString  = " pgm=" 			+ this.fnc_Quote(this.sPACKAGENAME);
		sReturnString += " action=" 		+ this.fnc_Quote(sKind);
		//sReturnString += " VAT_LINKCD1=" 	+ this.fnc_Quote(this.cmbVAT_LINKCD1.value);
		
	} else if (sKind == "SEARCH01") {
		sReturnString  = " pgm=" 			+ this.fnc_Quote(this.sPACKAGENAME);
		sReturnString += " action=" 		+ this.fnc_Quote(sKind);
		sReturnString += " VATH_TYPECD=" 	+ this.fnc_Quote(sTAVATCDH);
		sReturnString += " VAT_LINKCD1=" 	+ this.fnc_Quote(this.cmbVAT_LINKCD1.value);
		
	} else if (sKind == "SAVE00") {
		sReturnString  = " pgm=" 			+ this.fnc_Quote(this.sPACKAGENAME);
		sReturnString += " action=" 		+ this.fnc_Quote(sKind);
		
	}
	
	return sReturnString;
	
}

/*------------------------------------+
 |  Transaction 후 처리 해야 할 내용!  |
 +-------------------------------------*/
this.fn_CallBack = function (sMethodName, ErrorCode, ErrorMSG) {

	if (ErrorCode < 0) {
		if (application.GBL_SESSONCHK == "E0001") {
			this.fnc_ErrorProcess(ErrorCode, ErrorMSG);
		} else {
			this.fnc_Message("SERVERMSG", ErrorMSG);
		}
	} else {
		this.fn_PostProcess(sMethodName);
	}
}

/*------------------------------------+
 |  Transaction 후 Post Process!       |
 +-------------------------------------*/
this.fn_PostProcess = function (sMethodName) {

	if (sMethodName == "SEARCH00") {
		this.fnc_Information(this.stInformation1, this.dsTA_VATCDH.getCaseCount("dataset.getRowLevel(currow)==0"), "SHR"); //조회 결과 Display

	} else if (sMethodName == "SEARCH01") {

		this.fnc_Information(this.stInformation2, this.dsTA_VATCDD.getCaseCount("dataset.getRowLevel(currow)==0"), "SHR"); //조회 결과 Display

	} else if (sMethodName == "SAVE00") {
		
		this.fnc_Message("TMM103");
		this.fn_Search();

	} else if (sMethodName == "GetCommCode") {
	
	        this.dsEVID_DOCU.filter("REF2_FILD == '1'");	//EVID_DOCU.증빙종류 <REF2_FILD.증빙자료생성여부>
	        this.dsAPPL_V149.filter("REF1_FILD == '1'");	//APPL_V149.건물등감가상각취득명세서 <REF1_FILD.항목사용여부>
	        
	        //trace(this.dsAPPL_V149.saveXML())
			    
		var arrParam = new Array();
		    arrParam[0]  = "COMBO,cmbVAT_LINKCD1,dsEVID_EDOCU,0";
			arrParam[1]  = "GRID,grdTA_VATCDH,dsVATX_GUBN,SALE_TYPECD";
			arrParam[2]  = "GRID,grdTA_VATCDD,dsEVID_DOCU,VAT_LINKCD1";
			arrParam[3]  = "GRID,grdTA_VATCDD,dsVATX_TYPE,VAT_LINKCD2";
			arrParam[4]  = "GRID,grdTA_VATCDD,dsPURC_GUBN,VAT_LINKCD3";
			arrParam[5]  = "GRID,grdTA_VATCDD,dsBULG_GUBN,VAT_LINKCD4";
			arrParam[6]  = "GRID,grdTA_VATCDD,dsCOMX_YSNO,APPL_V104";
			arrParam[7]  = "GRID,grdTA_VATCDD,dsBULG_GUBN,APPL_V153";
			arrParam[8]  = "GRID,grdTA_VATCDD,dsCOMX_YSNO,APPL_V110";
			arrParam[9]  = "GRID,grdTA_VATCDD,dsCOMX_YSNO,APPL_V105";
			arrParam[10] = "GRID,grdTA_VATCDD,dsCOMX_YSNO,APPL_V109";
			arrParam[11] = "GRID,grdTA_VATCDD,dsCOMX_YSNO,APPL_V106";
			arrParam[12] = "GRID,grdTA_VATCDD,dsCOMX_YSNO,APPL_V141";
			arrParam[13] = "GRID,grdTA_VATCDD,dsCOMX_YSNO,APPL_V120";
			arrParam[14] = "GRID,grdTA_VATCDD,dsCOMX_YSNO,APPL_V115";
			arrParam[15] = "GRID,grdTA_VATCDD,dsAPPL_V149,APPL_V149";
		this.fnc_CommonCodeInnerBind(arrParam);
	}
} 

/*------------------------------------+
 |  수정 시 Key Field Disibled 처리     |
 +-------------------------------------*/
this.fn_KeyFieldDisible = function (obj:Dataset, e:nexacro.DSRowPosChangeEventInfo) {

}

/**************************************************************************************************
 *                                사용자 정의  Function 처리 부분                                  *
 ***************************************************************************************************/
/**************************************************************************************************
 *                                  사용자 정의  Event 처리 부분                                   *
 ***************************************************************************************************/
/*-----------------------+
 |  과세유형에서 추가하기.  |
 +------------------------*/
this.btnAddRow1_OnClick = function (obj:Button, e:nexacro.ClickEventInfo) {

	if (this.fnc_DatasetChangeCheck("dsTA_VATCDD")) { 
		if (this.fnc_Message("TMM140", "증빙세부내역에 변경내역이 있습니다. 계속진행하게 되면 증빙세부내역은 초기화 됩니다. 계속진행하시겠습니까") == false) {
		   return false;
		} 
	}
	   
	var iRow = this.dsTA_VATCDH.addRow();
	this.dsTA_VATCDH.setColumn(iRow, "IS_USED", "1");
	
	this.dsTA_VATCDD.clearData();
			
}
/*-----------------------+
 |  세부유형에서 추가하기.  |
 +------------------------*/
this.btnAddRow2_OnClick = function (obj:Button, e:nexacro.ClickEventInfo) {
     
	var iRow = this.dsTA_VATCDD.insertRow(this.dsTA_VATCDD.rowposition + 1);

	this.dsTA_VATCDD.setColumn(iRow, "VATH_TYPECD", this.dsTA_VATCDH.getColumn(this.dsTA_VATCDH.rowposition, "VATH_TYPECD"));
	this.dsTA_VATCDD.setColumn(iRow, "IS_USED", "1"); 	//디폴트를 "사용"으로

	this.dsTA_VATCDD.setColumn(iRow, "APPL_V101", ""); 	//디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V117", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V106", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V112", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V104", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V105", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V109", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V110", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V141", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V149", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V153", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V164", "0"); //디폴트를 "미사용"으로
	this.dsTA_VATCDD.setColumn(iRow, "APPL_V166", "0"); //디폴트를 "미사용"으로

	this.fnc_GridSetCellFocus(this.grdTA_VATCDD, "VAT_LINKCD1");
	
}

/*-----------------------+
 |  과세유형에서 삭제하기.  |
 +------------------------*/
this.btnDelRow1_OnClick = function (obj:Button, e:nexacro.ClickEventInfo) {
	
	if (this.fnc_DatasetChangeCheck("dsTA_VATCDD")) { 
		if (this.fnc_Message("TMM140", "증빙세부내역에 변경내역이 있습니다. 계속진행하게 되면 증빙세부내역은 초기화 됩니다. 계속진행하시겠습니까") == false) {
			return false;
		} 
	}

	if (!this.fn_DeleteCheck("dsTA_VATCDH")) return;

	//디테일을 원복한다.
	this.fnc_DataSetCancel("dsTA_VATCDD");
	
	this.dsTA_VATCDH.deleteRow(this.dsTA_VATCDH.rowposition);

	this.grdTA_VATCDH.setFocus();
	
}

/*-----------------------+
 |  세부유형에서 삭제하기.  |
 +------------------------*/
this.btnDelRow2_OnClick = function (obj:Button, e:nexacro.ClickEventInfo) {

	if (!this.fn_DeleteCheck("dsTA_VATCDD")) return;

	this.dsTA_VATCDD.deleteRow(this.dsTA_VATCDD.rowposition);
	
	this.grdTA_VATCDD.setFocus();
	
}

/*---------------------------------------------------------+
 |  Key Field Enabled & Detail 조회.                        |
 +---------------------------------------------------------*/

this.dsTA_VATCDH_CanRowPosChange = function (obj:Dataset, e:nexacro.DSRowPosChangeEventInfo) {
    
	if (this.fnc_DatasetChangeCheck("dsTA_VATCDD")) { 
		if (this.fnc_Message("TMM140", "증빙세부내역에 변경내역이 있습니다. 계속진행하게 되면 증빙세부내역은 초기화 됩니다. 계속진행하시겠습니까") == false) {
			return false;
		} 
	}

	//디테일을 원복한다.
	this.fnc_DataSetCancel("dsTA_VATCDD");

	return true;   
}

/*-------------------------------+
 |  데이터셋 ROW 변경 시 팝업호출  |
 +-------------------------------*/
this.dsTA_VATCDH_OnRowPosChanged = function (obj:Dataset, e:nexacro.DSRowPosChangeEventInfo) {

	if (this.dsTA_VATCDH.getRowCount() < 1) return;

	if (this.fnc_ToUpper(obj.getRowType(e.newrow)) == Dataset.ROWTYPE_INSERT) {
		 
	    this.btnAddRow2.set_visible(false);
	    this.btnDelRow2.set_visible(false);

		this.dsTA_VATCDD.clearData();
		
	} else {
	
   	    this.btnAddRow2.set_visible(true);
	    this.btnDelRow2.set_visible(true);

		this.dsTA_VATCDD.clearData();

		var sMethodName = "SEARCH01";
		var sInDataSet 	= "";
		var sOutDataSet = "dsTA_VATCDD=dsTA_VATCDD";
		var sArgument 	= this.fn_CreateArgument(sMethodName);
		this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");
		this.grdTA_VATCDH.setFocus();
    }
}
/*-------------------------------+
 |  콤보리스트 값 셋팅  |
 +-------------------------------*/
this.dsTA_VATCDD_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo) {

	if (e.columnid == "VAT_LINKCD1" || e.columnid == "VAT_LINKCD2" || e.columnid == "VAT_LINKCD3" || e.columnid == "VAT_LINKCD4") {
	
		var sVATD_TYPECD1 = this.fnc_Trim(this.dsTA_VATCDD.getColumn(this.dsTA_VATCDD.rowposition, "VAT_LINKCD1"));
		var sVATD_TYPECD2 = this.fnc_Trim(this.dsTA_VATCDD.getColumn(this.dsTA_VATCDD.rowposition, "VAT_LINKCD2"));
		var sVATD_TYPECD3 = this.fnc_Trim(this.dsTA_VATCDD.getColumn(this.dsTA_VATCDD.rowposition, "VAT_LINKCD3"));
		var sVATD_TYPECD4 = this.fnc_Trim(this.dsTA_VATCDD.getColumn(this.dsTA_VATCDD.rowposition, "VAT_LINKCD4"));

		var sVATD_TYPENM1 = this.fnc_Trim(this.dsEVID_DOCU.getColumn(this.dsEVID_DOCU.findRow("COMD_CODE", sVATD_TYPECD1), "COMD_CDNM"));
		var sVATD_TYPENM2 = this.fnc_Trim(this.dsVATX_TYPE.getColumn(this.dsVATX_TYPE.findRow("COMD_CODE", sVATD_TYPECD2), "COMD_CDNM"));
		var sVATD_TYPENM3 = this.fnc_Trim(this.dsPURC_GUBN.getColumn(this.dsPURC_GUBN.findRow("COMD_CODE", sVATD_TYPECD3), "COMD_CDNM"));
		var sVATD_TYPENM4 = this.fnc_Trim(this.dsBULG_GUBN.getColumn(this.dsBULG_GUBN.findRow("COMD_CODE", sVATD_TYPECD4), "COMD_CDNM"));

		this.dsTA_VATCDD.setColumn(e.row, "VATD_TYPECD", sVATD_TYPECD1 + "/" + sVATD_TYPECD2 + "/" + sVATD_TYPECD3 + "/" + sVATD_TYPECD4);
		this.dsTA_VATCDD.setColumn(e.row, "VATD_TYPENM", sVATD_TYPENM1 + "/" + sVATD_TYPENM2 + "/" + sVATD_TYPENM3 + "/" + sVATD_TYPENM4);
	
	}
	
	if (e.columnid == "VAT_LINKCD4") {

	    this.dsTA_VATCDD.setColumn(e.row, "APPL_V153", this.dsTA_VATCDD.getColumn(this.dsTA_VATCDD.rowposition, "VAT_LINKCD4"));
	  
	}

}]]></Script>
  </Form>
</FDL>
