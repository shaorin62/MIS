<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="../../default_typedef.xml"/>
  <Form id="FAMB0030" onkeydown="fn_HotKey" onload="fn_FormLoadSetting" titletext="회계전표등록" position="absolute" scrollbars="none" left="0" width="1187" top="0" height="717" onclose="fn_FormUnloadProcess" onbeforeclose="fn_FormUnloadCheckProcess">
    <Layouts>
      <Layout>
        <Static id="Shape02" taborder="91" cssclass="styFormItemBoxOut" left="8" right="25" height="129" bottom="214"/>
        <Static id="Static19" text="적요" position="absolute" left="28" width="78" height="21" cssclass="styFormItemCapBE" taborder="54" style="background:transparent URL('theme://images/sta_WF_Label_P.png') left middle;" bottom="244"/>
        <Static id="staOSLI_DISP" text="발생번호" position="absolute" left="607" width="71" height="21" cssclass="styFormItemCap" taborder="57" bottom="244"/>
        <Edit autoselect="true" binddataset="dsTA_SLIPNT" lengthunit="asciii" id="edtREMK_NAME" imemode="hangul" maxlength="100" onsetfocus="fn_EditFocus" taborder="23" position="absolute" left="109" width="469" height="21" bottom="244"/>
        <CheckBox binddataset="dsTA_SLIPNT" falsevalue="0" id="chkPAYX_YSNO" taborder="24" truevalue="1" value="true" position="absolute" left="109" width="15" height="23" cssclass="chk_WF_Readonly" readonly="true" bottom="219" onsetfocus="fn_EditFocus"/>
        <Static id="Static27" text="출납처리" position="absolute" left="28" width="70" height="21" cssclass="styFormItemCap" taborder="76" bottom="220"/>
        <Combo binddataset="dsTA_SLIPNT" id="cmbBANK_INOU" imemode="none" taborder="50" visible="false" position="absolute" left="1014" width="137" height="21" cssclass="cmb_WF_Readonly" index="-1" onitemchanged="cmbBANK_INOU_onitemchanged" readonly="true" bottom="220" onsetfocus="fn_EditFocus"/>
        <Static id="staBANK_INOU" text="입출구분" visible="false" position="absolute" left="946" width="71" height="21" cssclass="styFormItemCap" taborder="78" bottom="220"/>
        <Combo binddataset="dsTA_SLIPNT" id="cmbLEDG_GUBN" imemode="none" taborder="26" position="absolute" left="676" width="242" height="21" cssclass="cmb_WF_Readonly" index="-1" readonly="true" style=":disabled {border:1 solid #bbbbbbff ;}" bottom="220" onsetfocus="fn_EditFocus"/>
        <Static id="staLEDG_GUBN" text="출납방법" position="absolute" left="607" width="71" height="21" cssclass="styFormItemCap" taborder="80" bottom="220"/>
        <Calendar binddataset="dsTA_SLIPNT" id="calPAYX_DATE" onsetfocus="fn_EditFocus" taborder="25" dateformat="yyyy-MM-dd" position="absolute" left="322" width="100" height="21" cssclass="cal_WF_Readonly" readonly="true" bottom="220"/>
        <Static id="staPAYX_DATE" text="출납예정일" position="absolute" left="241" width="78" height="21" cssclass="styFormItemCap" onclick="staPAYX_DATE_onclick" taborder="53" bottom="220"/>
        <Button id="btnOSLI_NUMB" taborder="87" text="발생전표선택" visible="false" position="absolute" left="920" width="98" height="21" cssclass="btn_WF_Module" onclick="btnOSLI_NUMB_onclick" bottom="244"/>
        <Static id="Shape1" taborder="90" cssclass="styFormItemBoxOut" left="8" right="25" top="98" height="81"/>
        <Static id="st_FormTitle" taborder="88" text="회계전표등록" cssclass="styFormTitle" left="8" top="0" right="8" height="29" style="align:left;"/>
        <Static id="st_FormLocation" taborder="89" text="회계관리&gt;전표관리" cssclass="styFormLocation" top="0" right="25" height="29" style="align:right middle;" width="640"/>
        <Static id="Shape0" type="rectangle" position="absolute" left="8" right="8" top="37" height="6" cssclass="Rectangle" taborder="63"/>
        <Div id="DivExcel" taborder="82" position="absolute" scrollbars="none" left="80" width="200" top="33" height="23">
          <Layouts>
            <Layout/>
          </Layouts>
        </Div>
        <Static id="staSLIP_DATE" text="전표일자" position="absolute" left="250" width="71" cssclass="styFormItemCapBE" height="21" top="104" taborder="65"/>
        <Static id="Static11" text="작성부서" position="absolute" left="873" width="93" top="104" height="21" cssclass="styFormItemCap" taborder="66"/>
        <Static id="Static5" text="회계단위" position="absolute" left="449" width="71" top="104" height="21" cssclass="styFormItemCapBE" taborder="67"/>
        <Static id="Static0" text="제목" position="absolute" left="28" width="71" top="152" height="21" cssclass="styFormItemCapBE" taborder="68"/>
        <Static id="Static21" text="작성자" position="absolute" left="660" width="71" top="104" height="21" cssclass="styFormItemCap" taborder="69"/>
        <Static id="Static6" text="전표유형" position="absolute" left="28" width="71" top="128" height="21" cssclass="styFormItemCap" taborder="71"/>
        <Edit autoselect="true" binddataset="dsTA_SLIPXM" lengthunit="asciii" id="edtTITL_NAME" imemode="hangul" maxlength="200" onsetfocus="fn_EditFocus" taborder="6" position="absolute" left="97" top="152" height="21" width="534"/>
        <Calendar binddataset="dsTA_SLIPXM" id="calSLIP_DATE" onsetfocus="fn_EditFocus" taborder="3" position="absolute" dateformat="yyyy-MM-dd" left="320" width="100" top="104" height="21" readonly="true" cssclass="cal_WF_Readonly" onchanged="calSLIP_DATE_onchanged" tabstop="false"/>
        <Static id="Static1" text="결재상태" position="absolute" left="250" width="71" top="128" height="21" cssclass="styFormItemCap" taborder="72"/>
        <Edit autoselect="true" binddataset="dsTA_SLIPXM" lengthunit="asciii" id="edtEMPL_NAME" imemode="native" onsetfocus="fn_EditFocus" taborder="38" position="absolute" left="791" width="53" top="104" height="21" cssclass="edt_WF_Readonly" readonly="true" tabstop="false" visible="true"/>
        <Edit autoselect="true" binddataset="dsTA_SLIPXM" lengthunit="asciii" enable="true" id="edtDEPT_NAME" imemode="native" onsetfocus="fn_EditFocus" taborder="39" position="absolute" left="1034" right="34" top="104" height="21" cssclass="edt_WF_Readonly" readonly="true" tabstop="false"/>
        <Grid autofittype="col" binddataset="dsTA_SLIPNT" cellsizingtype="both" enable="true" id="grdTA_SLIPNT" useinputpanel="false" autofitminwidth="100" tabstop="false" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" selecttype="row" position="absolute" left="8" right="25" top="209" taborder="29" bottom="374">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="50"/>
                <Column size="70"/>
                <Column size="250"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="350"/>
                <Column size="50"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" cssclass="Cellgrd_WF_edit" text="순번"/>
                <Cell col="1" displaytype="text" text="계정코드"/>
                <Cell col="2" displaytype="text" text="계정명"/>
                <Cell col="3" displaytype="text" text="귀속부서명"/>
                <Cell col="4" displaytype="text" text="차변금액"/>
                <Cell col="5" displaytype="text" text="대변금액"/>
                <Cell col="6" displaytype="text" text="적  요"/>
                <Cell col="7" text="행번호"/>
              </Band>
              <Band id="body">
                <Cell displaytype="number" edittype="normal" style="align: center;" text="bind:SORT_ORDR" editautoselect="true"/>
                <Cell col="1" displaytype="text" style="align: center;" text="bind:ACCT_INTL"/>
                <Cell col="2" displaytype="text" style="align: left;" text="bind:ACCT_NAME"/>
                <Cell col="3" displaytype="text" style="align: left;" text="bind:DEPT_NAME"/>
                <Cell col="4" displaytype="number" style="align:right;" text="bind:SLIP_AMNT" expr="expr:Eco.decode(DRCR_GUBN, 'D', SLIP_AMNT, 0)"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:SLIP_AMNT" expr="expr:Eco.decode(DRCR_GUBN, 'C', SLIP_AMNT, 0)"/>
                <Cell col="6" displaytype="text" style="align: left;" text="bind:REMK_NAME"/>
                <Cell col="7" displaytype="text" style="align:center;" text="bind:SLIP_LINE"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Combo binddataset="dsTA_SLIPXM" enable="true" id="cmbAPPS_CODE" onsetfocus="fn_EditFocus" taborder="40" position="absolute" left="320" width="100" top="128" height="21" cssclass="cmb_WF_Readonly" tabstop="false" readonly="true"/>
        <Combo binddataset="dsTA_SLIPXM" id="cmbACCT_UNIT" onsetfocus="fn_EditFocus" taborder="4" position="absolute" left="517" width="114" top="104" height="21" cssclass="cmb_WF_Readonly" readonly="true"/>
        <Edit autoselect="true" binddataset="dsTA_SLIPXM" lengthunit="asciii" id="edtEMPL_NUMB" imemode="native" onsetfocus="fn_EditFocus" taborder="83" visible="true" position="absolute" left="730" width="59" top="104" height="21" cssclass="edt_WF_Readonly" readonly="true" tabstop="false" style="align:center middle;"/>
        <Edit autoselect="true" binddataset="dsTA_SLIPXM" lengthunit="asciii" enable="true" id="edtDEPT_CODE" imemode="native" onsetfocus="fn_EditFocus" taborder="84" visible="true" position="absolute" left="967" width="65" top="104" height="21" cssclass="edt_WF_Readonly" readonly="true" tabstop="false" style="align:center middle;"/>
        <Static id="Static13" text="계정과목" position="absolute" left="607" width="71" height="21" cssclass="styFormItemCapBE" taborder="51" bottom="316"/>
        <Edit autoselect="true" binddataset="dsTA_SLIPNT" lengthunit="asciii" enable="true" id="edtACCT_INTL" onsetfocus="fn_EditFocus" taborder="46" style="align:center middle; :disabled {align:center middle;}" position="absolute" left="676" width="68" height="21" cssclass="edt_WF_Readonly" readonly="true" tabstop="false" bottom="316"/>
        <Static id="Static20" text="차대구분" position="absolute" left="946" width="71" height="21" cssclass="styFormItemCapBE" taborder="55" bottom="316"/>
        <Static id="Static26" text="귀속부서" position="absolute" left="241" width="71" height="21" cssclass="styFormItemCapBE" taborder="58" bottom="316"/>
        <Edit autoselect="true" binddataset="dsTA_SLIPNT" lengthunit="asciii" enable="true" id="edtUSEX_DEPT" onsetfocus="fn_EditFocus" taborder="45" style="align:center middle; :disabled {align:center middle;}" position="absolute" left="322" width="77" height="21" cssclass="edt_WF_Readonly" readonly="true" tabstop="false" bottom="316"/>
        <Radio binddataset="dsTA_SLIPNT" id="rdoDRCR_GUBN" index="-1" taborder="14" codecolumn="codecolumn" datacolumn="datacolumn" direction="vertical" position="absolute" left="1014" width="94" height="21" cssclass="rdo_WF_Readonly" readonly="true" bottom="316">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">D</Col>
                <Col id="datacolumn">차변</Col>
              </Row>
              <Row>
                <Col id="codecolumn">C</Col>
                <Col id="datacolumn">대변</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Static id="Static14" text="차변합계 " position="absolute" right="473" width="70" height="23" cssclass="styFormItemCap" taborder="59" bottom="346"/>
        <Static id="Static16" text="대변합계 " position="absolute" right="290" width="70" height="23" cssclass="styFormItemCap" taborder="60" bottom="346"/>
        <MaskEdit id="mskCHAX_AMNT" onsetfocus="fn_EditFocus" taborder="43" style="align:right middle;" mask="#,###" position="absolute" right="365" width="110" height="21" tabstop="false" bottom="347" readonly="true" cssclass="msk_WF_Readonly"/>
        <MPFileDialog id="FileDialog1" taborder="85" position="absolute" left="304" width="24" top="12" height="24"/>
        <MPFileDialog id="FileDialog2" taborder="86" Type="Save" position="absolute" left="330" width="24" top="12" height="24"/>
        <Static id="stInformation" text="&lt;b v='true'&gt;00&lt;/b&gt; 건이 조회 되었습니다." position="absolute" style="align: middle left;" left="100" width="343" top="185" height="21" cssclass="styFormSearchInfo" taborder="75" usedecorate="true"/>
        <Button id="btnCopy" onclick="btnCopy_onclick" taborder="28" text="전표복사" position="absolute" visible="false" left="8" width="74" top="34" height="21" cssclass="btn_WF_Module" tabstop="false"/>
        <Static id="Static9" text="회계일자" position="absolute" left="660" width="71" top="128" height="21" cssclass="styFormItemCap" taborder="81"/>
        <Calendar binddataset="dsTA_SLIPXM" enable="true" id="calACCT_DATE" onsetfocus="fn_EditFocus" taborder="42" dateformat="yyyy-MM-dd" position="absolute" left="730" top="128" height="21" cssclass="cal_WF_Readonly" width="114" readonly="true" tabstop="false"/>
        <Static id="Static17" text="차액 " position="absolute" right="131" width="46" height="23" cssclass="styFormItemCap" taborder="77" bottom="346"/>
        <MaskEdit enable="true" id="mskCHAX_DAEX" onsetfocus="fn_EditFocus" taborder="44" style="align:right middle;" mask="#,###" position="absolute" right="25" width="110" height="21" cssclass="msk_WF_Readonly" readonly="true" tabstop="false" bottom="347"/>
        <Button id="btn_AddRow" onclick="btn_AddRow_onclick" taborder="7" style="imagealign:left;" position="absolute" right="220" width="62" top="184" height="21" tabstop="true" cssclass="btn_WF_Module" text="행추가"/>
        <Button id="btn_DelRow" onclick="btn_DelRow_onclick" taborder="32" position="absolute" right="155" width="62" top="184" height="21" tabstop="false" cssclass="btn_WF_Module" text="행삭제"/>
        <Static id="Static18" text="승인자" position="absolute" left="449" width="71" top="128" height="21" cssclass="styFormItemCap" taborder="73"/>
        <Edit autoselect="true" binddataset="dsTA_SLIPXM" lengthunit="asciii" enable="true" id="edtAPPR_EMNM" imemode="native" onsetfocus="fn_EditFocus" taborder="41" position="absolute" left="578" width="53" top="128" height="21" cssclass="edt_WF_Readonly" readonly="true" tabstop="false"/>
        <Button id="btn_APPRCANCEL" onclick="btn_APPRCANCEL_onclick" taborder="9" text="승인취소" visible="false" position="absolute" left="457" width="74" top="32" height="21" cssclass="btn_WF_Module" tabstop="false"/>
        <Static id="staACCT_DATE1" text="회계일자" visible="false" position="absolute" style="align: right middle;" left="286" width="69" top="31" height="23" cssclass="styFormItemCapBE" taborder="79"/>
        <Calendar id="calACCT_DATE1" onsetfocus="fn_EditFocus" taborder="11" visible="false" position="absolute" dateformat="yyyy-MM-dd" left="357" width="98" top="32" height="21" tabstop="false"/>
        <Static id="staBUDG_GUBN00" text="순번" position="absolute" left="28" width="70" height="21" cssclass="styFormItemCap" taborder="64" style="background:transparent;" bottom="316"/>
        <MaskEdit id="mskSORT_ORDR" taborder="10" onsetfocus="fn_EditFocus" style="align:center middle;" binddataset="dsTA_SLIPNT" type="number" enable="true" position="absolute" left="109" width="113" height="21" cssclass="msk_WF_Readonly" tabstop="false" readonly="true" bottom="316"/>
        <Button id="btn_InsertRow" taborder="31" onclick="btn_InsertRow_onclick" position="absolute" right="90" width="62" top="184" height="21" tabstop="false" cssclass="btn_WF_Module" text="행삽입"/>
        <Edit id="edtACCT_NAME" taborder="13" imemode="hangul" autoselect="true" onsetfocus="fn_EditFocus" onkillfocus="fn_HelpDialoge" left="769" height="21" binddataset="dsTA_SLIPNT" width="149" style=":disabled {align:left middle;}" bottom="316"/>
        <Div id="div_ButtonList" taborder="92" tabstop="false" url="common::comButtonType01.xfdl" top="33" right="25" height="23" scrollbars="none" cssclass="styFormButtonList" width="510"/>
        <Static id="spSearchBox0" taborder="8" cssclass="styFormSearchBox" left="8" top="60" right="25" height="33"/>
        <Calendar id="calSHRSLIP_DATE" taborder="1" dateformat="yyyy-MM-dd" left="320" top="66" height="21" width="100" enable="true" autoselect="true"/>
        <Button id="btnSendGW" taborder="36" text="결재상신" onclick="btnSendGW_onclick" cssclass="btn_WF_Module" visible="true" top="66" height="21" width="74" tabstop="false" right="186"/>
        <Button id="btnSearchDoc" taborder="35" text="문서보기" cssclass="btn_WF_Module" visible="true" top="66" height="21" width="74" tabstop="true" onclick="btnSearchDoc_onclick" right="34"/>
        <Button id="btnPrint02" taborder="34" text="증빙인쇄" onclick="btnPrint02_onclick" cssclass="btn_WF_Module" visible="false" left="636" top="66" width="74" height="21" tabstop="false"/>
        <Button id="btnCHG" taborder="33" text="변경내역 " onclick="btnCHG_onclick" cssclass="btn_WF_Module" visible="false" top="66" height="21" width="74" left="713" tabstop="false"/>
        <Button id="btnBUDG_LIST" taborder="18" text="잔액조회" onclick="btnBUDG_LIST_onclick" cssclass="btn_WF_Module" visible="true" height="21" width="74" tabstop="true" bottom="292" left="844" enable="true"/>
        <Static id="imgHelpSHRSLIP_NUMB" taborder="2" onclick="fn_SlipDialoge" cssclass="sytHelpPopup" left="421" top="66" height="21" width="21"/>
        <Static id="imgHelpDEPT_COD1" taborder="93" onclick="fn_HelpDialoge" cssclass="sytHelpPopup" left="401" height="21" width="21" bottom="316"/>
        <Static id="imgHelpACCT_INTL" taborder="94" onclick="fn_HelpDialoge" cssclass="sytHelpPopup" left="746" height="21" width="21" bottom="316"/>
        <Static id="Static15" taborder="95" text="전표번호" cssclass="styFormSearchCapBe" left="28" top="66" height="21" style="align:left middle;" width="70"/>
        <Tab id="Tab0" taborder="27" left="8" right="25" tabindex="0" height="194" bottom="15">
          <Tabpages>
            <Tabpage id="TabD1" text="관리항목 " scrollbars="autoboth">
              <Layouts>
                <Layout>
                  <Grid id="grdTA_SLIPRF" taborder="0" binddataset="dsTA_SLIPRF" wheelscrollrow="1" useinputpanel="false" cellsizingtype="both" left="8" top="8" right="8" bottom="8" onexpandup="fn_HelpDialoge" autofittype="col">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="120"/>
                          <Column size="90"/>
                          <Column size="90"/>
                          <Column size="150"/>
                          <Column size="280"/>
                          <Column size="79"/>
                          <Column size="280"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" text="관리항목명"/>
                          <Cell col="1" displaytype="text" text="입력구분"/>
                          <Cell col="2" displaytype="text" text="필수구분"/>
                          <Cell col="3" displaytype="text" text="항목값"/>
                          <Cell col="4" displaytype="text" cssclass="Cellgrd_WF_edit" text="항목명"/>
                          <Cell col="5" text="팝업"/>
                          <Cell col="6" displaytype="text" text="도움말"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="text" style="align:left;color:EXPR(DRCR_YSNO == 1 ?'crimson': DRCR_YSNO==2 &amp;&amp; DRCR_GUBN=='D'? 'crimson': DRCR_YSNO==3 &amp;&amp; DRCR_GUBN=='C'? 'crimson': 'black');color2:EXPR(DRCR_YSNO == 1 ?'crimson': DRCR_YSNO==2 &amp;&amp; DRCR_GUBN=='D'? 'crimson': DRCR_YSNO==3 &amp;&amp; DRCR_GUBN=='C'? 'crimson': 'black');" text="bind:COND_NAME"/>
                          <Cell col="1" displaytype="combo" style="align:left;" text="bind:INPT_GUBN"/>
                          <Cell col="2" displaytype="combo" style="align:left;" text="bind:DRCR_YSNO"/>
                          <Cell col="3" displaytype="expr:dataset.getColumn(currow, 'INPT_GUBN') == 'CALE' ? 'text' : (dataset.getColumn(currow, 'INPT_GUBN') == 'CALM' ? 'text' : (dataset.getColumn(currow, 'INPT_GUBN') == 'NUMB' ? 'number' : 'normal'))" edittype="none" style="align:EXPR(dataset.getColumn(currow, 'INPT_GUBN') == 'NUMB' ? 'right' : 'left' );" text="bind:COND_VACD" mask="expr:dataset.getColumn(currow, 'INPT_GUBN') == 'CALE' ? '####-##-##' : (dataset.getColumn(currow, 'INPT_GUBN') == 'CALM' ? '####-##' : (dataset.getColumn(currow, 'INPT_GUBN') == 'NUMB' ? '#,##0.#####' : ''))"/>
                          <Cell col="4" displaytype="expr:dataset.getColumn(currow, 'INPT_GUBN') == 'CALE' ? 'date' : (dataset.getColumn(currow, 'INPT_GUBN') == 'CALM' ? 'text' : (dataset.getColumn(currow, 'INPT_GUBN') == 'NUMB' ? 'number' : 'normal'))" edittype="expr:dataset.getColumn(currow, 'INPT_GUBN') == 'CALE' ? 'date' : (dataset.getColumn(currow, 'INPT_GUBN') == 'CALM' ? 'mask' : (dataset.getColumn(currow, 'INPT_GUBN') == 'NUMB' ? 'masknumber' : 'normal'))" style="align:EXPR(dataset.getColumn(currow, 'INPT_GUBN') == 'NUMB' ? 'right' : 'left' );background:#ffff95ff;background2:#ffff95ff;controlalign:left;" text="bind:COND_VANM" mask="expr:dataset.getColumn(currow, 'INPT_GUBN') == 'CALM' ? '####-##' : dataset.getColumn(currow, 'INPT_GUBN') == 'NUMB' ? '#,##0.#####' : ''" editimemode="hangul" editautoselect="true" editdisplay="edit" expandshow="expr:dataset.getColumn(currow, 'INPT_GUBN') == 'HELP' ? 'show' : 'hide'" expandsize="20" expandimage="URL('theme://images/btn_WF_Search.png')" calendardisplaynulltype="none"/>
                          <Cell col="5" text="bind:COMB_IDXX"/>
                          <Cell col="6" displaytype="text" style="align:left;" text="bind:HELP_TEXT"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="TabD2" text="증빙항목 ">
              <Layouts>
                <Layout width="1152" height="114">
                  <Static id="spSearchBox03" taborder="38" cssclass="styFormItemBoxOut" left="8" top="8" right="8" height="149" radiusy="10" radiusx="10" type="roundrectangle"/>
                  <Static id="staBULG_GUBN" taborder="18" text="불공제세부" cssclass="styFormItemCap" left="773" top="45" height="21" width="94"/>
                  <Static id="staSUPP_AMNT" taborder="19" text="공급가액" cssclass="styFormItemCapBE" left="28" top="71" height="21" width="78"/>
                  <Static id="staVATX_GUBN" taborder="20" text="매입매출" cssclass="styFormItemCapBE" left="28" top="45" height="21" width="78"/>
                  <Static id="staPURC_GUBN" taborder="21" text="부가세유형" cssclass="styFormItemCap" left="491" top="45" height="21" width="85"/>
                  <Static id="staTRNS_DATE" taborder="22" text="발행일자" cssclass="styFormItemCapBE" left="28" top="19" height="21" style=":disabled {color:#aaaaaaff;}" width="78"/>
                  <Static id="staVATX_AMNT" taborder="23" text="세액" cssclass="styFormItemCapBE" left="255" top="71" height="21" width="86"/>
                  <Static id="staVATX_TYPE" taborder="24" text="부가세종류" cssclass="styFormItemCapBE" left="255" top="45" height="21" width="86"/>
                  <Combo id="cmbVATX_TYPE" taborder="5" onitemchanged="Tab0_TabD2_cmbVATX_TYPE_OnChanged" onsetfocus="fn_EditFocus" cssclass="cmb_WF_Readonly" left="337" top="45" height="21" binddataset="" width="124" enable="true" tabstop="false" readonly="true"/>
                  <MaskEdit id="mskVATX_AMNT" taborder="9" mask="###,###" onsetfocus="fn_EditFocus" cssclass="styFormItemText" left="337" top="71" height="21" style="align:right; :disabled {align:right middle;}" binddataset="" width="124"/>
                  <Calendar id="calTRNS_DATE" taborder="0" dateformat="yyyy-MM-dd" onsetfocus="fn_EditFocus" oneditclick="Tab0_TabD2_calTRNS_DATE_oneditclick" left="99" top="19" height="21" binddataset="" width="126"/>
                  <Combo id="cmbVATX_GUBN" taborder="3" onitemchanged="Tab0_TabD2_cmbVATX_GUBN_OnChanged" onsetfocus="fn_EditFocus" cssclass="cmb_WF_Readonly" left="99" top="45" height="21" binddataset="" width="103" enable="true" tabstop="false" readonly="true"/>
                  <Combo id="cmbPURC_GUBN" taborder="6" onitemchanged="Tab0_TabD2_cmbPURC_GUBN_OnChanged" onsetfocus="fn_EditFocus" cssclass="cmb_WF_Readonly" left="573" top="45" height="21" binddataset="" width="171" enable="true" tabstop="false" readonly="true"/>
                  <MaskEdit id="mskSUPP_AMNT" taborder="8" mask="###,###" onsetfocus="fn_EditFocus" cssclass="styFormItemText" left="99" top="71" height="21" style="align:right; :disabled {align:right middle;}" binddataset="" width="126"/>
                  <Static id="staEBIL_GUBN" taborder="25" text="전자발행여부" cssclass="styFormItemCap" left="773" top="71" height="21" width="94"/>
                  <Static id="staSUMX_AMNT" taborder="26" text="합계" cssclass="styFormItemCap" left="491" top="71" height="21" width="85"/>
                  <MaskEdit id="mskSUMX_AMNT" taborder="10" mask="###,###" onsetfocus="fn_EditFocus" cssclass="msk_WF_Readonly" left="573" top="71" height="21" width="171" readonly="true"/>
                  <Static id="staITEM_NAME" taborder="27" text="품목" cssclass="styFormItemCap" left="491" top="97" height="21" width="78"/>
                  <Edit id="edtITEM_NAME" taborder="14" maxlength="50" autoselect="true" onsetfocus="fn_EditFocus" left="573" top="97" height="21" binddataset="" width="171"/>
                  <Static id="staVATX_REMK" taborder="28" text="적요" cssclass="styFormItemCap" left="773" top="97" height="21" width="85"/>
                  <Static id="staCARD_NUMB" taborder="30" text="카드번호" onclick="Tab0_TabD2_Static3_onclick" cssclass="styFormItemCap" left="491" top="19" height="21" width="85"/>
                  <Static id="staCARD_APPR" taborder="31" text="카드승인번호" cssclass="styFormItemCap" left="773" top="19" height="21" width="94"/>
                  <MaskEdit id="mskCARD_NUMB" taborder="1" type="string" mask="####-####-####-####" onsetfocus="fn_EditFocus" cssclass="styFormItemText" left="573" top="19" height="21" style="align:center; :disabled {align:center;}" binddataset="" width="171"/>
                  <Static id="staETIS_YSNO" taborder="32" text="타사이트발행여부" cssclass="styFormItemCap" left="989" top="71" height="21" width="118"/>
                  <Static id="imgHelpVATX_GUBN" taborder="4" onclick="fn_VatDialoge" cssclass="sytHelpPopup" left="204" height="21" width="21" top="45"/>
                  <Edit id="edtCARD_APPR00" taborder="34" maxlength="50" autoselect="true" onsetfocus="fn_EditFocus" cssclass="styFormItemText" left="29.95%" top="126" right="59.29%" height="21" style="align: center;" binddataset="" visible="false"/>
                  <Edit id="edtCARD_APPR01" taborder="35" maxlength="50" autoselect="true" onsetfocus="fn_EditFocus" cssclass="styFormItemText" left="41.58%" top="126" right="47.66%" height="21" style="align: center;" binddataset="" visible="false"/>
                  <Edit id="edtCARD_APPR02" taborder="36" maxlength="50" autoselect="true" onsetfocus="fn_EditFocus" cssclass="styFormItemText" left="608" top="126" height="21" style="align: center;" binddataset="" width="160" visible="false"/>
                  <Static id="staCUST_CODE" taborder="29" text="거래처" cssclass="styFormItemCapBE" left="28" top="97" height="21" width="85"/>
                  <Edit id="edtCUST_CODE" taborder="17" autoselect="true" onsetfocus="fn_EditFocus" enable="true" left="99" top="97" height="21" binddataset="" width="103" readonly="true" tabstop="false" cssclass="edt_WF_Readonly" style="align:center middle;"/>
                  <Static id="imgHelpCUST_CODE" taborder="33" onclick="fn_HelpDialoge" cssclass="sytHelpPopup" left="204" top="97" height="21" width="21"/>
                  <Combo id="cmbEBIL_GUBN" taborder="11" onitemchanged="Tab0_TabD2_cmbPURC_GUBN_OnChanged" onsetfocus="fn_EditFocus" cssclass="styFormItemText" left="870" top="71" height="21" binddataset="" index="-1" width="120"/>
                  <Edit id="edtCUST_NAME" taborder="13" autoselect="true" onsetfocus="fn_EditFocus" left="227" top="97" height="21" binddataset="" onkillfocus="fn_HelpDialoge" width="234"/>
                  <Combo id="cmbBULG_GUBN" taborder="7" onsetfocus="fn_EditFocus" cssclass="msk_WF_Readonly" left="870" top="45" height="21" binddataset="" width="256" enable="true" readonly="true"/>
                  <Edit id="edtVATX_REMK" taborder="15" maxlength="100" autoselect="true" onsetfocus="fn_EditFocus" left="870" top="97" height="21" binddataset="" width="256"/>
                  <Edit id="edtCARD_APPR" taborder="2" maxlength="50" autoselect="true" onsetfocus="fn_EditFocus" left="870" top="19" height="21" style="align: center;" binddataset="" width="256"/>
                  <CheckBox id="chkETIS_YSNO" taborder="12" value="0" truevalue="1" falsevalue="0" left="1111" top="71" height="21" binddataset="" width="21"/>
                  <Static id="Static59" taborder="37" text="w30" visible="false" left="9" top="21" width="30" height="133" style="background:#fb7b7b7a;"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Edit id="edtAPPR_EMPL" taborder="96" autoselect="true" onsetfocus="fn_EditFocus" cssclass="edt_WF_Readonly" top="128" height="21" binddataset="dsTA_SLIPXM" visible="true" tabstop="false" style="align:center middle;" width="59" left="517"/>
        <MaskEdit id="mskSLIP_NUMB" taborder="97" type="string" mask="##-########-####" onsetfocus="fn_EditFocus" cssclass="msk_WF_Readonly" enable="true" left="97" style="align:center; :readonly {border:1 solid #bbbbbbff ;}" binddataset="dsTA_SLIPNT" top="104" width="123" height="21" tabstop="false" readonly="true"/>
        <MaskEdit id="mskSHRSLIP_NUMB" taborder="0" type="string" onsetfocus="fn_EditFocus" cssclass="styFormItemText" enable="true" left="97" top="66" height="21" style="align: center;" binddataset="dsTA_SLIPNT" autoselect="true" width="123" mask="##-########-####"/>
        <Static id="Static02" taborder="98" text="출처연결정보" cssclass="styFormItemCap" top="128" height="21" width="93" left="873"/>
        <Edit id="edtSOUS_LNKY" taborder="99" autoselect="true" onsetfocus="fn_EditFocus" cssclass="edt_WF_Readonly" top="128" height="21" binddataset="dsTA_SLIPXM" left="967" right="34" readonly="true" tabstop="false"/>
        <Static id="staEVID_DOCU" text="증빙서류" position="absolute" left="28" width="71" height="21" cssclass="styFormItemCap" taborder="61" bottom="268"/>
        <Combo id="cmbEVID_DOCU" taborder="19" binddataset="dsTA_SLIPNT" position="absolute" left="109" width="113" height="21" cssclass="styFormItemText" index="-1" bottom="268"/>
        <Combo binddataset="dsTA_SLIPNT" id="cmbCURR_GUBN" taborder="20" style=":disabled {align:center middle;}" position="absolute" left="322" width="100" height="21" cssclass="cmb_WF_Readonly" index="-1" onitemchanged="cmbCURR_GUBN_onitemchanged" readonly="true" bottom="268" onsetfocus="fn_EditFocus"/>
        <Static id="staEXCH_RATE" text="환율" position="absolute" left="429" width="68" cssclass="styFormItemCap" height="21" taborder="52" bottom="268"/>
        <MaskEdit binddataset="dsTA_SLIPNT" id="mskEXCH_RATE" onsetfocus="fn_EditFocus" taborder="21" mask="###,###.#####" style="align:right middle;" enable="true" position="absolute" left="498" width="80" height="21" readonly="true" cssclass="msk_WF_Readonly" bottom="268"/>
        <Static id="staFORI_AMNT" text="통화금액" position="absolute" left="607" width="71" height="21" cssclass="styFormItemCapBE" taborder="74" bottom="268"/>
        <MaskEdit id="mskSLIP_AMNT" taborder="48" mask="###,###" onsetfocus="fn_EditFocus" style="align:right middle;" binddataset="dsTA_SLIPNT" position="absolute" left="1014" width="137" height="21" cssclass="msk_WF_Readonly" enable="true" tabstop="false" readonly="true" bottom="268"/>
        <MaskEdit binddataset="dsTA_SLIPNT" id="mskFORI_AMNT" onsetfocus="fn_EditFocus" taborder="22" mask="###,###" style="align:right middle;" enable="true" position="absolute" left="676" width="242" height="21" cssclass="msk_WF_Readonly" readonly="true" bottom="268"/>
        <Static id="Static22" text="전표금액" position="absolute" left="946" width="71" height="21" cssclass="styFormItemCap" taborder="56" bottom="268"/>
        <Static id="staCURR_GUBN" text="통화" position="absolute" left="241" width="46" height="21" cssclass="styFormItemCap" taborder="62" bottom="268"/>
        <Static id="staBDSB_CODE" taborder="100" text="예산과목" cssclass="styFormItemCap" height="21" width="71" left="607" bottom="292"/>
        <Edit id="edtBDSB_CODE" taborder="101" autoselect="true" onsetfocus="fn_EditFocus" cssclass="edt_WF_Readonly" enable="true" height="21" style="align:center middle; :disabled {align:center middle;}" binddataset="dsTA_SLIPNT" width="68" left="676" readonly="true" tabstop="false" bottom="292"/>
        <Static id="imgHelpBDSB_CODE" taborder="102" onclick="fn_HelpDialoge" cssclass="sytHelpPopup" height="21" width="21" left="746" bottom="292"/>
        <Edit id="edtBDSB_NAME" taborder="17" imemode="hangul" autoselect="true" onsetfocus="fn_EditFocus" onkillfocus="fn_HelpDialoge" height="21" style=":disabled {align:left middle;}" binddataset="dsTA_SLIPNT" width="73" left="769" bottom="292"/>
        <Static id="staCSTC_CODE" taborder="103" text="코스트센터" cssclass="styFormItemCap" height="21" width="78" left="28" bottom="292"/>
        <Edit id="edtCSTC_CODE" taborder="104" autoselect="true" onsetfocus="fn_EditFocus" cssclass="edt_WF_Readonly" height="21" style="align:center middle; :disabled {align:center middle;}" binddataset="dsTA_SLIPNT" width="90" left="109" tabstop="false" readonly="true" bottom="292"/>
        <Static id="imgHelpCSTC_CODE" taborder="105" onclick="fn_HelpDialoge" cssclass="sytHelpPopup" height="21" width="21" left="201" bottom="292"/>
        <Edit id="edtCSTC_NAME" taborder="15" imemode="hangul" autoselect="true" onsetfocus="fn_EditFocus" onkillfocus="fn_HelpDialoge" height="21" style=":disabled {align:left middle;}" binddataset="dsTA_SLIPNT" width="198" left="224" bottom="292"/>
        <Static id="Static33" taborder="106" text="예산잔액" cssclass="styFormItemCap" height="21" width="71" left="946" bottom="292"/>
        <MaskEdit id="mskBUDG_AMNT" taborder="47" mask="###,###" onsetfocus="fn_EditFocus" cssclass="msk_WF_Readonly" enable="true" height="21" style="align:right middle;" binddataset="dsTA_SLIPNT" width="137" left="1014" tabstop="false" readonly="true" bottom="292"/>
        <MaskEdit id="mskDAEX_AMNT" taborder="107" readonly="true" mask="#,###" onsetfocus="fn_EditFocus" cssclass="msk_WF_Readonly" height="21" style="align:right middle;" width="110" right="182" tabstop="false" bottom="347"/>
        <Combo id="cmbSLIP_GUBN" taborder="5" onsetfocus="fn_EditFocus" enable="true" top="128" height="21" binddataset="dsTA_SLIPXM" width="123" left="97" readonly="true" cssclass="cmb_WF_Readonly" index="-1"/>
        <Static id="Static30" taborder="108" text="h 4" visible="false" top="56" height="4" style="background:#fb7b7b7a;" width="150" right="388"/>
        <Static id="Static32" taborder="109" text="w&#13;&#10;8" cssclass="sta_GID_box" visible="false" top="0" width="8" left="0" bottom="0"/>
        <Button id="btn_favorite" taborder="110" onclick="btn_favorite_onclick" cssclass="btn_WF_Bookmark" top="0" height="29" width="20" left="8"/>
        <Static id="Static06" taborder="111" text="w&#13;&#10;25" cssclass="sta_GID_box" visible="false" top="0" width="25" right="0" height="717"/>
        <Static id="Static35" taborder="112" text="h 10" visible="false" top="23" height="10" style="background:#fb7b7b7a;" width="200" right="25"/>
        <Static id="staSHRSLIP_DATE" taborder="113" text="전표일자" cssclass="styFormSearchCap" top="66" height="21" width="70" left="250"/>
        <Static id="Static00" taborder="114" text="h 30" visible="false" top="179" height="30" style="background:#fb7b7b7a;" width="80" left="485"/>
        <Static id="Static09" taborder="115" text="h 7" visible="false" top="202" height="7" style="background:#fb7b7b7a;" width="264" left="8"/>
        <Static id="Static38" taborder="116" text="h5" visible="false" top="93" height="5" style="background:#fb7b7b7a;" width="80" left="573"/>
        <Static id="Static01" taborder="117" text="h 15" visible="false" bottom="0" height="15" style="background:#fb7b7b7a;" left="8" right="25"/>
        <Static id="Static95" taborder="118" text="분개상세내역" cssclass="sta_WF_Subtitle" height="21" width="205" left="8" bottom="344"/>
        <Static id="Static03" taborder="119" text="분개목록" cssclass="sta_WF_Subtitle" top="187" height="21" width="73" left="8"/>
        <Static id="staBUDG_GUBN" text="예산구분" position="absolute" left="429" width="68" height="21" cssclass="styFormItemCap" taborder="70" bottom="292"/>
        <Combo binddataset="dsTA_SLIPNT" id="cmbBUDG_GUBN" onsetfocus="fn_EditFocus" taborder="16" position="absolute" left="498" width="80" height="21" index="-1" bottom="292"/>
        <Static id="Static64" taborder="120" text="전표번호" cssclass="styFormItemCap" height="21" width="71" left="28" top="104"/>
        <Static id="Static48" taborder="121" text="h5" visible="false" left="10.53%" top="99" right="86.27%" height="5" style="background:#fb7b7b7a;"/>
        <Static id="Static46" taborder="122" text="h3" visible="false" left="10.53%" top="125" right="82.22%" height="3" style="background:#fb7b7b7a;"/>
        <Static id="Static57" taborder="123" text="h3" visible="false" left="10.53%" top="149" right="82.22%" height="3" style="background:#fb7b7b7a;"/>
        <Static id="Static49" taborder="124" text="h5" visible="false" left="10.53%" top="173" right="86.27%" height="5" style="background:#fb7b7b7a;"/>
        <Static id="Static04" taborder="125" text="w30" visible="false" top="390" height="47" style="background:#fb7b7b7a;" width="30" left="9"/>
        <Static id="Static24" taborder="126" text="h3" visible="false" height="3" style="background:#fb7b7b7a;" width="102" right="960" bottom="313"/>
        <Static id="Static25" taborder="127" text="h3" visible="false" left="10.53%" right="80.88%" height="3" style="background:#fb7b7b7a;" bottom="289"/>
        <Static id="Static28" taborder="128" text="h3" visible="false" left="10.53%" right="80.88%" height="3" style="background:#fb7b7b7a;" bottom="265"/>
        <Static id="Static45" taborder="129" text="h3" visible="false" left="10.53%" right="80.88%" height="3" style="background:#fb7b7b7a;" bottom="241"/>
        <Static id="Static07" taborder="130" text="h5" visible="false" top="179" height="5" style="background:#fb7b7b7a;" width="80" left="928"/>
        <Static id="Static08" taborder="131" text="h5" visible="false" top="344" height="5" style="background:#fb7b7b7a;" width="80" left="887"/>
        <Edit id="edtDEPT_NAM1" taborder="12" imemode="hangul" autoselect="true" onsetfocus="fn_EditFocus" onkillfocus="fn_HelpDialoge" height="21" style=":disabled {align:left middle;}" binddataset="dsTA_SLIPNT" width="154" left="424" bottom="316"/>
        <Static id="Static10" taborder="132" text="h5" visible="false" left="10.7%" top="503" height="5" style="background:#fb7b7b7a;" right="82.56%"/>
        <Static id="stInformation05" taborder="133" cssclass="sta_WF_line" left="87" width="10" height="13" top="191"/>
        <MaskEdit id="mskOSLI_DISP" taborder="49" left="676" width="242" height="21" readonly="true" cssclass="msk_WF_Readonly" mask="##-########-####-####" type="string" style="align:center middle;cursor:hand;" tabstop="false" bottom="244" oneditclick="mskOSLI_DISP_oneditclick" onsetfocus="fn_EditFocus"/>
        <PopupDiv id="popSlip_Copy" left="8" top="731" width="238" height="90" scrollbars="none" cssclass="pdiv_WF_insert" visible="true">
          <Layouts>
            <Layout>
              <Static id="Shape0" taborder="25" cssclass="styFormItemBoxOut" left="9" top="9" width="220" height="39"/>
              <Static id="Static68" taborder="26" text="전표일자" cssclass="styFormItemCapBE" left="29" top="18" width="75" height="21"/>
              <Calendar id="calCopy_SLIP_DATE" taborder="30" dateformat="yyyy-MM-dd" onsetfocus="fn_EditFocus" left="99" top="18" width="98" height="21"/>
              <Button id="btnCopyPROC" taborder="31" text="복사처리" onclick="popSlip_Copy_btnCopyPROC_onclick" cssclass="btn_POP_CRUD" left="78" top="56" width="74" height="24"/>
              <Button id="btn_CopyCancel" taborder="32" text="복사취소" onclick="popSlip_Copy_btn_CopyCancel_onclick" cssclass="btn_POP_CRUD" left="155" top="56" width="74" height="24"/>
            </Layout>
          </Layouts>
        </PopupDiv>
        <Button id="btnCancGW" taborder="37" text="상신취소" cssclass="btn_WF_Module" enable="true" top="66" width="74" height="21" visible="true" onclick="btnCancGW_onclick" right="110"/>
        <Button id="btn_CopyRow" taborder="135" tabstop="false" text="행복사" onclick="btn_CopyRow_onclick" cssclass="btn_WF_Module" top="184" right="26" width="62" height="21"/>
        <Static id="Static12" taborder="136" text="h5" visible="false" left="11.2%" top="61" right="85.59%" height="5" style="background:#fb7b7b7a;"/>
        <Static id="Static23" taborder="137" text="h5" visible="false" left="11.88%" top="87" right="84.92%" height="5" style="background:#fb7b7b7a;"/>
        <Button id="btnBanje" onclick="btnBanje_onclick" taborder="86" text="정산내역조회" visible="false" position="absolute" left="1014" width="137" height="21" cssclass="btn_WF_Module" bottom="244"/>
        <Button id="btnOSLI_DELE" onclick="btnOSLI_DEL_onclick" taborder="85" text="발생번호취소" visible="false" position="absolute" left="1020" width="98" height="21" cssclass="btn_WF_Module" bottom="244"/>
        <Button id="btnAttachDoc" taborder="138" text="문서파일첨부" cssclass="btn_WF_Module" top="66" right="262" width="98" height="21" onclick="btnAttachDoc_onclick" visible="false"/>
        <Static id="Static29" taborder="139" text="최종수정정보" cssclass="styFormItemCap" left="873" top="152" width="93" height="21"/>
        <Static id="Static31" taborder="140" text="결재문서" cssclass="styFormItemCap" left="660" top="152" width="71" height="21"/>
        <Edit id="edtAPPR_DOCN" taborder="141" tabstop="false" readonly="true" autoselect="true" onsetfocus="fn_EditFocus" cssclass="edt_WF_Readonly" left="730" top="152" height="21" binddataset="dsTA_SLIPXM" style="align:center middle;" width="114"/>
        <Edit id="edtUPDT_INFO" taborder="142" tabstop="false" readonly="true" autoselect="true" onsetfocus="fn_EditFocus" cssclass="edt_WF_Readonly" left="967" top="152" height="21" style="align:center middle;" binddataset="dsTA_SLIPXM" right="34"/>
        <Edit id="edtGWAP_STAT" taborder="143" tabstop="false" readonly="true" autoselect="true" onsetfocus="fn_EditFocus" cssclass="edt_WF_Readonly" left="769" top="66" width="50" height="21" style="align:center middle;" binddataset="dsTA_SLIPXM" visible="false"/>
        <Static id="Static34" taborder="144" text="w 40" visible="false" left="220" top="106" width="40" height="30" style="background:#fb7b7b7a;"/>
        <Static id="Static36" taborder="145" text="w 40" visible="false" left="420" top="106" width="40" height="30" style="background:#fb7b7b7a;"/>
        <Static id="Static37" taborder="146" text="w 40" visible="false" left="631" top="106" width="40" height="30" style="background:#fb7b7b7a;"/>
        <Static id="Static39" taborder="147" text="w 40" visible="false" left="844" top="106" width="40" height="30" style="background:#fb7b7b7a;"/>
        <Edit id="edtURL" taborder="150" tabstop="false" readonly="true" autoselect="true" onsetfocus="fn_EditFocus" cssclass="edt_WF_Readonly" left="91" top="45" width="1005" height="21" style="align:center middle;" binddataset="dsTA_SLIPXM" visible="false"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="dsCombo" useclientlayout="true">
        <ColumnInfo>
          <Column id="DSNAME" size="256" prop="default" type="STRING"/>
          <Column id="CODEID" size="256" prop="default" type="STRING"/>
          <Column id="HEADFLAG" size="256" prop="default" type="STRING"/>
          <Column id="USEDFLAG" type="STRING" size="1"/>
          <Column id="REMK" size="256" prop="default" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="REMK">회계단위</Col>
            <Col id="CODEID">ACCT_UNIT</Col>
            <Col id="DSNAME">dsACCT_UNIT</Col>
            <Col id="HEADFLAG">EMPTY</Col>
          </Row>
          <Row>
            <Col id="CODEID">APPS_CODE</Col>
            <Col id="DSNAME">dsAPPS_CODE</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="REMK">결재상태</Col>
          </Row>
          <Row>
            <Col id="REMK">전표종류</Col>
            <Col id="DSNAME">dsSLIP_GUBN</Col>
            <Col id="CODEID">SLIP_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
          </Row>
          <Row>
            <Col id="REMK">예산구분</Col>
            <Col id="CODEID">BUDG_GUBN</Col>
            <Col id="DSNAME">dsBUDG_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
          </Row>
          <Row>
            <Col id="REMK">화폐</Col>
            <Col id="CODEID">CURR_GUBN</Col>
            <Col id="DSNAME">dsCURR_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
          </Row>
          <Row>
            <Col id="REMK">증빙서류</Col>
            <Col id="DSNAME">dsEVID_DOCU</Col>
            <Col id="CODEID">EVID_DOCU</Col>
            <Col id="HEADFLAG">EMPTY</Col>
          </Row>
          <Row>
            <Col id="REMK">입출구분</Col>
            <Col id="DSNAME">dsBANK_INOU</Col>
            <Col id="CODEID">BANK_INOU</Col>
            <Col id="HEADFLAG">EMPTY</Col>
          </Row>
          <Row>
            <Col id="REMK">매입매출</Col>
            <Col id="CODEID">VATX_GUBN</Col>
            <Col id="DSNAME">dsVATX_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
          </Row>
          <Row>
            <Col id="REMK">부가세종류</Col>
            <Col id="CODEID">VATX_TYPE</Col>
            <Col id="DSNAME">dsVATX_TYPE</Col>
            <Col id="HEADFLAG">EMPTY</Col>
          </Row>
          <Row>
            <Col id="REMK">부가세유형</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="CODEID">PURC_GUBN</Col>
            <Col id="DSNAME">dsPURC_GUBN</Col>
          </Row>
          <Row>
            <Col id="REMK">불공제세부</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="CODEID">BULG_GUBN</Col>
            <Col id="DSNAME">dsBULG_GUBN</Col>
          </Row>
          <Row>
            <Col id="REMK">입력구분</Col>
            <Col id="DSNAME">dsINPT_GUBN</Col>
            <Col id="CODEID">INPT_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
          </Row>
          <Row>
            <Col id="CODEID">DRCR_YSNO</Col>
            <Col id="DSNAME">dsDRCR_YSNO</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="REMK">필수구분</Col>
          </Row>
          <Row>
            <Col id="REMK">전자발행여부</Col>
            <Col id="DSNAME">dsEBIL_GUBN</Col>
            <Col id="CODEID">EBIL_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
          </Row>
          <Row>
            <Col id="CODEID">LEDG_GUBN</Col>
            <Col id="DSNAME">dsLEDG_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="REMK">출납방법</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsTA_SLIPNT" onrowposchanged="dsTA_SLIPNT_onrowposchanged" useclientlayout="true" oncolumnchanged="dsTA_SLIPNT_oncolumnchanged">
        <ColumnInfo>
          <Column id="CRUD_TYPE" type="STRING" size="256"/>
          <Column id="SLIP_NUMB" type="STRING" size="256"/>
          <Column id="SLIP_LINE" type="STRING" size="256"/>
          <Column id="ACCT_UNIT" type="STRING" size="256"/>
          <Column id="ACCT_GUBN" type="STRING" size="256"/>
          <Column id="ACCT_INTL" type="STRING" size="256"/>
          <Column id="ACCT_NAME" type="STRING" size="256"/>
          <Column id="USEX_DEPT" type="STRING" size="256"/>
          <Column id="DEPT_NAME" type="STRING" size="256"/>
          <Column id="CSTC_CODE" type="STRING" size="256"/>
          <Column id="CSTC_NAME" type="STRING" size="256"/>
          <Column id="DRCR_GUBN" type="STRING" size="256"/>
          <Column id="CURR_GUBN" type="STRING" size="256"/>
          <Column id="EXCH_RATE" type="BIGDECIMAL" size="256"/>
          <Column id="FORI_AMNT" type="BIGDECIMAL" size="256"/>
          <Column id="SLIP_AMNT" type="BIGDECIMAL" size="256"/>
          <Column id="OSLI_DATE" type="STRING" size="256"/>
          <Column id="OSLI_NUMB" type="STRING" size="256"/>
          <Column id="OSLI_LINE" type="STRING" size="256"/>
          <Column id="OSLI_DISP" type="STRING" size="256"/>
          <Column id="UNMC_YSNO" type="STRING" size="256"/>
          <Column id="BUDG_GUBN" type="STRING" size="256"/>
          <Column id="PROJ_CODE" type="STRING" size="256"/>
          <Column id="BGRQ_NUMB" type="STRING" size="256"/>
          <Column id="BUDG_DEPT" type="STRING" size="256"/>
          <Column id="BUDG_YYMM" type="STRING" size="256"/>
          <Column id="BDSB_CODE" type="STRING" size="256"/>
          <Column id="BDSB_NAME" type="STRING" size="256"/>
          <Column id="BDSP_CODE" type="STRING" size="256"/>
          <Column id="BUDG_AMNT" type="BIGDECIMAL" size="256"/>
          <Column id="REMK_NAME" type="STRING" size="256"/>
          <Column id="REMK_NAM2" type="STRING" size="256"/>
          <Column id="REMK_NAM3" type="STRING" size="256"/>
          <Column id="EVID_DOCU" type="STRING" size="256"/>
          <Column id="PAYX_YSNO" type="STRING" size="256"/>
          <Column id="PAYX_DATE" type="STRING" size="256"/>
          <Column id="LEDG_GUBN" type="STRING" size="256"/>
          <Column id="BANK_INOU" type="STRING" size="256"/>
          <Column id="PRIN_ORDR" type="STRING" size="256"/>
          <Column id="SORT_ORDR" type="STRING" size="256"/>
          <Column id="SEND_KEY1" type="STRING" size="256"/>
          <Column id="SEND_KEY2" type="STRING" size="256"/>
          <Column id="ACCT_DATE" type="STRING" size="256"/>
          <Column id="SLCT_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTA_SLIPXM" onrowposchanged="fn_KeyFieldDisible" useclientlayout="true">
        <ColumnInfo>
          <Column id="CRUD_TYPE" type="STRING" size="256"/>
          <Column id="SLIP_NUMB" type="STRING" size="256"/>
          <Column id="ACCT_UNIT" type="STRING" size="256"/>
          <Column id="ACCT_GUBN" type="STRING" size="256"/>
          <Column id="SLIP_DATE" type="STRING" size="256"/>
          <Column id="DISP_NUMB" type="STRING" size="256"/>
          <Column id="SLIP_GUBN" type="STRING" size="256"/>
          <Column id="REQU_NUMB" type="STRING" size="256"/>
          <Column id="TITL_NAME" type="STRING" size="256"/>
          <Column id="EMPL_NUMB" type="STRING" size="256"/>
          <Column id="EMPL_NAME" type="STRING" size="256"/>
          <Column id="DEPT_CODE" type="STRING" size="256"/>
          <Column id="DEPT_NAME" type="STRING" size="256"/>
          <Column id="ACCT_DATE" type="STRING" size="256"/>
          <Column id="SLAP_NUMB" type="STRING" size="256"/>
          <Column id="APPR_EMPL" type="STRING" size="256"/>
          <Column id="APPR_EMNM" type="STRING" size="256"/>
          <Column id="APPR_DEPT" type="STRING" size="256"/>
          <Column id="APPR_DOCN" type="STRING" size="256"/>
          <Column id="APPS_CODE" type="STRING" size="256"/>
          <Column id="APCP_YEAR" type="STRING" size="256"/>
          <Column id="APPR_DTCD" type="STRING" size="256"/>
          <Column id="PROC_DATE" type="STRING" size="256"/>
          <Column id="AUTO_YSNO" type="STRING" size="256"/>
          <Column id="RECE_DATE" type="STRING" size="256"/>
          <Column id="RECE_EMPL" type="STRING" size="256"/>
          <Column id="RECE_DEPT" type="STRING" size="256"/>
          <Column id="EVID_ACPT" type="STRING" size="256"/>
          <Column id="MEMO_REMK" type="STRING" size="256"/>
          <Column id="SOUS_LNKY" type="STRING" size="256"/>
          <Column id="DOCU_IDXX" type="STRING" size="256"/>
          <Column id="APPR_STAT" type="STRING" size="256"/>
          <Column id="GWAP_STAT" type="STRING" size="256"/>
          <Column id="UPDT_INFO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTA_SLIPRF" oncolumnchanged="dsTA_SLIPRF_oncolumnchanged" onrowposchanged="dsTA_SLIPRF_onrowposchanged" useclientlayout="true">
        <ColumnInfo>
          <Column id="ACCT_GUBN" size="1" prop="default" type="STRING"/>
          <Column id="SLIP_NUMB" size="15" prop="default" type="STRING"/>
          <Column id="SLIP_LINE" size="4" prop="default" type="STRING"/>
          <Column id="COND_VACD" size="20" prop="default" type="STRING"/>
          <Column id="COND_VANM" size="30" prop="default" type="STRING"/>
          <Column id="ACCT_INTL" size="10" prop="default" type="STRING"/>
          <Column id="COND_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="CODE_SEQN" size="256" prop="default" type="STRING"/>
          <Column id="COND_KIND" size="4" prop="default" type="STRING"/>
          <Column id="INPT_GUBN" size="256" prop="default" type="STRING"/>
          <Column id="COMB_IDXX" size="15" prop="default" type="STRING"/>
          <Column id="HELP_TEXT" size="200" prop="default" type="STRING"/>
          <Column id="COMM_CODE" type="STRING" size="256"/>
          <Column id="DRCR_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="DRCR_TYPE" type="STRING" size="2"/>
          <Column id="MUST_YSNO" type="STRING" size="2"/>
          <Column id="USEX_YSNO" size="2" prop="default" type="STRING"/>
          <Column id="DRCR_GUBN" size="1" prop="default" type="STRING"/>
          <Column id="COND_CODE" size="4" prop="default" type="STRING"/>
          <Column id="COND_NAME" size="100" prop="default" type="STRING"/>
          <Column id="UNUS_YSNO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTA_VATXXM" useclientlayout="true" oncolumnchanged="dsTA_VATXXM_oncolumnchanged">
        <ColumnInfo>
          <Column id="CRUD_TYPE" type="STRING" size="256"/>
          <Column id="VATX_SEQN" size="9" prop="default" type="STRING"/>
          <Column id="SLIP_DATE" size="8" prop="default" type="STRING"/>
          <Column id="SLIP_NUMB" size="5" prop="default" type="STRING"/>
          <Column id="SLIP_LINE" size="4" prop="default" type="STRING"/>
          <Column id="TRNS_DATE" size="8" prop="default" type="STRING"/>
          <Column id="ACCT_GUBN" size="1" prop="default" type="STRING"/>
          <Column id="EVID_DOCU" size="8" prop="default" type="STRING"/>
          <Column id="SLIP_INPU" size="1" prop="default" type="STRING"/>
          <Column id="VATX_GUBN" size="8" prop="default" type="STRING"/>
          <Column id="VATX_TYPE" size="8" prop="default" type="STRING"/>
          <Column id="BULG_GUBN" size="8" prop="default" type="STRING"/>
          <Column id="PURC_GUBN" size="8" prop="default" type="STRING"/>
          <Column id="EBIL_GUBN" size="1" prop="default" type="STRING"/>
          <Column id="CUST_CODE" size="16" prop="default" type="STRING"/>
          <Column id="CUST_NAME" size="256" prop="default" type="STRING"/>
          <Column id="BSNS_NUMB" size="10" prop="default" type="STRING"/>
          <Column id="CARD_NUMB" size="20" prop="default" type="STRING"/>
          <Column id="ITEM_NAME" size="50" prop="default" type="STRING"/>
          <Column id="SUPP_AMNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="VATX_AMNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SUMX_AMNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="REMK_NAME" size="100" prop="default" type="STRING"/>
          <Column id="VATX_CHNG" size="8" prop="default" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsUserCombo" useclientlayout="true">
        <ColumnInfo>
          <Column id="DSNAME" size="256" prop="default" type="STRING"/>
          <Column id="COMBOID" type="STRING" size="256"/>
          <Column id="HEADFLAG" size="256" prop="default" type="STRING"/>
          <Column id="USEYSNO" type="STRING" size="256"/>
          <Column id="PARAM" size="256" prop="default" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="DSNAME">dsSLIP_GUBN</Col>
            <Col id="HEADFLAG">EMPTY</Col>
            <Col id="PARAM">전표종류</Col>
            <Col id="USEYSNO">0</Col>
            <Col id="COMBOID">FAM0003</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsTA_ACCTXM" useclientlayout="true">
        <ColumnInfo>
          <Column id="ACCT_INTL" size="256" prop="default" type="STRING"/>
          <Column id="ACCT_NAME" size="256" prop="default" type="STRING"/>
          <Column id="ACCT_BFNM" size="256" prop="default" type="STRING"/>
          <Column id="UPPR_ACCT" size="256" prop="default" type="STRING"/>
          <Column id="PRNT_LEVL" size="256" prop="default" type="STRING"/>
          <Column id="SORT_ORDR" size="256" prop="default" type="STRING"/>
          <Column id="DRCR_GUBN" size="256" prop="default" type="STRING"/>
          <Column id="SLIP_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="ACCT_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="BUDG_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="REMK_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="CONT_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="GUNB_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="CHUL_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="CHUN_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="CSUS_YSNO" type="STRING" size="256"/>
          <Column id="ZERO_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="FNCR_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="EVID_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="FUND_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="CUST_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="BANK_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="ACNT_YSNO" size="256" prop="default" type="STRING"/>
          <Column id="ACCT_GUBN" size="256" prop="default" type="STRING"/>
          <Column id="INOU_GUBN" size="256" prop="default" type="STRING"/>
          <Column id="ACCT_TYPE" size="256" prop="default" type="STRING"/>
          <Column id="SPSA_GUBN" size="256" prop="default" type="STRING"/>
          <Column id="OVER_GUBN" size="256" prop="default" type="STRING"/>
          <Column id="COST_GUBN" size="256" prop="default" type="STRING"/>
          <Column id="ACCT_REMK" size="256" prop="default" type="STRING"/>
          <Column id="BEFO_ACCT" size="256" prop="default" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTA_ACCTXD" useclientlayout="true">
        <ColumnInfo>
          <Column id="ACCT_INTL" type="STRING" size="256"/>
          <Column id="COND_CODE" type="STRING" size="256"/>
          <Column id="COND_NAME" type="STRING" size="256"/>
          <Column id="COND_VACD" type="STRING" size="256"/>
          <Column id="COND_VANM" type="STRING" size="256"/>
          <Column id="CODE_SEQN" type="STRING" size="256"/>
          <Column id="DRCR_YSNO" type="STRING" size="256"/>
          <Column id="UNUS_YSNO" type="STRING" size="256"/>
          <Column id="USEX_YSNO" type="STRING" size="256"/>
          <Column id="COND_KIND" type="STRING" size="256"/>
          <Column id="INPT_GUBN" type="STRING" size="256"/>
          <Column id="COMB_IDXX" type="STRING" size="256"/>
          <Column id="COND_COLM" type="STRING" size="256"/>
          <Column id="COND_YSNO" type="STRING" size="256"/>
          <Column id="HELP_TEXT" type="STRING" size="256"/>
          <Column id="DRCR_GUBN" type="STRING" size="256"/>
          <Column id="MUST_YSNO" type="STRING" size="256"/>
          <Column id="DRCR_TYPE" type="STRING" size="256"/>
          <Column id="COMM_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTA_SLIPRF2" useclientlayout="true">
        <ColumnInfo>
          <Column id="ACCT_GUBN" size="1" prop="default" type="STRING"/>
          <Column id="SLIP_NUMB" size="15" prop="default" type="STRING"/>
          <Column id="SLIP_LINE" size="4" prop="default" type="STRING"/>
          <Column id="COND_VACD" size="20" prop="default" type="STRING"/>
          <Column id="COND_VANM" size="30" prop="default" type="STRING"/>
          <Column id="ACCT_INTL" size="10" prop="default" type="STRING"/>
          <Column id="COND_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="CODE_SEQN" size="256" prop="default" type="STRING"/>
          <Column id="COND_KIND" size="4" prop="default" type="STRING"/>
          <Column id="INPT_GUBN" size="256" prop="default" type="STRING"/>
          <Column id="COMB_IDXX" size="15" prop="default" type="STRING"/>
          <Column id="HELP_TEXT" size="200" prop="default" type="STRING"/>
          <Column id="COMM_CODE" type="STRING" size="256"/>
          <Column id="DRCR_YSNO" size="1" prop="default" type="STRING"/>
          <Column id="DRCR_TYPE" type="STRING" size="2"/>
          <Column id="MUST_YSNO" type="STRING" size="2"/>
          <Column id="USEX_YSNO" size="2" prop="default" type="STRING"/>
          <Column id="DRCR_GUBN" size="1" prop="default" type="STRING"/>
          <Column id="COND_CODE" size="4" prop="default" type="STRING"/>
          <Column id="COND_NAME" size="100" prop="default" type="STRING"/>
          <Column id="UNUS_YSNO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTA_EXRTXM" useclientlayout="true">
        <ColumnInfo>
          <Column id="STDS_DATE" type="string" size="32" prop=""/>
          <Column id="CURR_GUBN" type="string" size="32" prop=""/>
          <Column id="STND_RATE" type="bigdecimal" size="255" prop=""/>
          <Column id="USDS_RATE" type="bigdecimal" size="255" prop=""/>
          <Column id="NOTI_RATE" type="bigdecimal" size="255" prop=""/>
          <Column id="VALU_RATE" type="bigdecimal" size="255" prop=""/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsBUDG_AMNT" useclientlayout="true">
        <ColumnInfo>
          <Column id="BUDG_AMNT" type="bigdecimal" size="255" prop=""/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsMAGA_YSNO" useclientlayout="true">
        <ColumnInfo>
          <Column id="MAGA_DATE" type="STRING" size="255" prop=""/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTA_SLIPXM_RPT" useclientlayout="true">
        <ColumnInfo>
          <Column id="ACCT_GUBN" type="string" size="32" prop=""/>
          <Column id="ACCT_GBNM" type="string" size="32" prop=""/>
          <Column id="DEPT_CODE" type="string" size="32" prop=""/>
          <Column id="DEPT_NAME" type="string" size="32" prop=""/>
          <Column id="SLIP_NUMB" type="string" size="32" prop=""/>
          <Column id="SLIP_DATE" type="string" size="32" prop=""/>
          <Column id="ACCT_DATE" type="string" size="32" prop=""/>
          <Column id="EMPL_NUMB" type="string" size="32" prop=""/>
          <Column id="EMPL_NAME" type="string" size="32" prop=""/>
          <Column id="TITL_NAME" type="string" size="32" prop=""/>
          <Column id="APPR_EMPL" type="string" size="32" prop=""/>
          <Column id="APPR_EMNM" type="string" size="32" prop=""/>
          <Column id="SLIP_AMNT" type="bigdecimal" size="255" prop=""/>
          <Column id="HANG_AMNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTA_SLIPNT_RPT" useclientlayout="true">
        <ColumnInfo>
          <Column id="SLIP_NUMB" type="STRING" size="256"/>
          <Column id="SORT_NUMB" type="STRING" size="256"/>
          <Column id="DISP_NUMB" type="STRING" size="256"/>
          <Column id="ACCT_INTLD" type="STRING" size="256"/>
          <Column id="ACCT_BFNMD" type="STRING" size="256"/>
          <Column id="ACCT_UPNMD" type="STRING" size="256"/>
          <Column id="REMK_NAMED" type="STRING" size="256"/>
          <Column id="SLIP_AMNTD" type="BIGDECIMAL" size="255"/>
          <Column id="CSTC_CODED" type="STRING" size="256"/>
          <Column id="CSTC_NAMED" type="STRING" size="256"/>
          <Column id="BDSB_CODED" type="STRING" size="256"/>
          <Column id="BDSB_NAMED" type="STRING" size="256"/>
          <Column id="COND_CDNMD1" type="STRING" size="256"/>
          <Column id="COND_VANMD1" type="STRING" size="256"/>
          <Column id="INPT_GUBND1" type="STRING" size="256"/>
          <Column id="COND_CDNMD2" type="STRING" size="256"/>
          <Column id="COND_VANMD2" type="STRING" size="256"/>
          <Column id="INPT_GUBND2" type="STRING" size="256"/>
          <Column id="COND_CDNMD3" type="STRING" size="256"/>
          <Column id="COND_VANMD3" type="STRING" size="256"/>
          <Column id="INPT_GUBND3" type="STRING" size="256"/>
          <Column id="COND_CDNMD4" type="STRING" size="256"/>
          <Column id="COND_VANMD4" type="STRING" size="256"/>
          <Column id="INPT_GUBND4" type="STRING" size="256"/>
          <Column id="COND_CDNMD5" type="STRING" size="256"/>
          <Column id="COND_VANMD5" type="STRING" size="256"/>
          <Column id="INPT_GUBND5" type="STRING" size="256"/>
          <Column id="COND_CDNMD6" type="STRING" size="256"/>
          <Column id="COND_VANMD6" type="STRING" size="256"/>
          <Column id="INPT_GUBND6" type="STRING" size="256"/>
          <Column id="OSLI_NUMBD" type="STRING" size="256"/>
          <Column id="ACCT_INTLC" type="STRING" size="256"/>
          <Column id="ACCT_BFNMC" type="STRING" size="256"/>
          <Column id="ACCT_UPNMC" type="STRING" size="256"/>
          <Column id="REMK_NAMEC" type="STRING" size="256"/>
          <Column id="SLIP_AMNTC" type="BIGDECIMAL" size="255"/>
          <Column id="CSTC_CODEC" type="STRING" size="256"/>
          <Column id="CSTC_NAMEC" type="STRING" size="256"/>
          <Column id="BDSB_CODEC" type="STRING" size="256"/>
          <Column id="BDSB_NAMEC" type="STRING" size="256"/>
          <Column id="COND_CDNMC1" type="STRING" size="256"/>
          <Column id="COND_VANMC1" type="STRING" size="256"/>
          <Column id="INPT_GUBNC1" type="STRING" size="256"/>
          <Column id="COND_CDNMC2" type="STRING" size="256"/>
          <Column id="COND_VANMC2" type="STRING" size="256"/>
          <Column id="INPT_GUBNC2" type="STRING" size="256"/>
          <Column id="COND_CDNMC3" type="STRING" size="256"/>
          <Column id="COND_VANMC3" type="STRING" size="256"/>
          <Column id="INPT_GUBNC3" type="STRING" size="256"/>
          <Column id="COND_CDNMC4" type="STRING" size="256"/>
          <Column id="COND_VANMC4" type="STRING" size="256"/>
          <Column id="INPT_GUBNC4" type="STRING" size="256"/>
          <Column id="COND_CDNMC5" type="STRING" size="256"/>
          <Column id="COND_VANMC5" type="STRING" size="256"/>
          <Column id="INPT_GUBNC5" type="STRING" size="256"/>
          <Column id="COND_CDNMC6" type="STRING" size="256"/>
          <Column id="COND_VANMC6" type="STRING" size="256"/>
          <Column id="INPT_GUBNC6" type="STRING" size="256"/>
          <Column id="OSLI_NUMBC" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTM_APPROVAL" oncolumnchanged="dsHR_GRTINS_oncolumnchanged">
        <ColumnInfo>
          <Column id="documentID" size="8" prop="default" type="STRING"/>
          <Column id="documentType" size="8" prop="default" type="STRING"/>
          <Column id="HtmlDocument" size="20" prop="default" type="STRING"/>
          <Column id="subject" size="10" prop="default" type="STRING"/>
          <Column id="recipient" size="10" prop="default" type="STRING"/>
          <Column id="creator" size="12" prop="default" type="STRING"/>
          <Column id="documentStatus" size="150" prop="default" type="STRING"/>
          <Column id="isUsedFile" size="3" prop="default" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="edtDEPT_NAM1_value" compid="edtDEPT_NAM1" propid="value" datasetid="dsTA_SLIPNT" columnid="DEPT_NAME"/>
      <BindItem id="Tab0_TabD2_cmbVATX_TYPE_value" compid="Tab0.TabD2.cmbVATX_TYPE" propid="value" datasetid="dsTA_VATXXM" columnid="VATX_TYPE"/>
      <BindItem id="Tab0_TabD2_cmbBULG_GUBN_value" compid="Tab0.TabD2.cmbBULG_GUBN" propid="value" datasetid="dsTA_VATXXM" columnid="BULG_GUBN"/>
      <BindItem id="Tab0_TabD2_mskVATX_AMNT_value" compid="Tab0.TabD2.mskVATX_AMNT" propid="value" datasetid="dsTA_VATXXM" columnid="VATX_AMNT"/>
      <BindItem id="Tab0_TabD2_calTRNS_DATE_value" compid="Tab0.TabD2.calTRNS_DATE" propid="value" datasetid="dsTA_VATXXM" columnid="TRNS_DATE"/>
      <BindItem id="Tab0_TabD2_cmbVATX_GUBN_value" compid="Tab0.TabD2.cmbVATX_GUBN" propid="value" datasetid="dsTA_VATXXM" columnid="VATX_GUBN"/>
      <BindItem id="Tab0_TabD2_cmbPURC_GUBN_value" compid="Tab0.TabD2.cmbPURC_GUBN" propid="value" datasetid="dsTA_VATXXM" columnid="PURC_GUBN"/>
      <BindItem id="Tab0_TabD2_mskSUPP_AMNT_value" compid="Tab0.TabD2.mskSUPP_AMNT" propid="value" datasetid="dsTA_VATXXM" columnid="SUPP_AMNT"/>
      <BindItem id="Tab0_TabD2_edtITEM_NAME_value" compid="Tab0.TabD2.edtITEM_NAME" propid="value" datasetid="dsTA_VATXXM" columnid="ITEM_NAME"/>
      <BindItem id="Tab0_TabD2_edtVATX_REMK_value" compid="Tab0.TabD2.edtVATX_REMK" propid="value" datasetid="dsTA_VATXXM" columnid="REMK_NAME"/>
      <BindItem id="Tab0_TabD2_edtCUST_CODE_value" compid="Tab0.TabD2.edtCUST_CODE" propid="value" datasetid="dsTA_VATXXM" columnid="CUST_CODE"/>
      <BindItem id="Tab0_TabD2_edtCUST_NAME_value" compid="Tab0.TabD2.edtCUST_NAME" propid="value" datasetid="dsTA_VATXXM" columnid="CUST_NAME"/>
      <BindItem id="Tab0_TabD2_edtCARD_APPR_value" compid="Tab0.TabD2.edtCARD_APPR" propid="value" datasetid="dsTA_VATXXM" columnid="CARD_APPR"/>
      <BindItem id="Tab0_TabD2_mskCARD_NUMB_value" compid="Tab0.TabD2.mskCARD_NUMB" propid="value" datasetid="dsTA_VATXXM" columnid="CARD_NUMB"/>
      <BindItem id="item1" compid="Tab0.TabD2.chkETIS_YSNO" propid="value" datasetid="dsTA_VATXXM" columnid="ETIS_YSNO"/>
      <BindItem id="item3" compid="Tab0.TabD2.mskSUMX_AMNT" propid="value" datasetid="dsTA_VATXXM" columnid="SUMX_AMNT"/>
      <BindItem id="item4" compid="Tab0.tabpage3.cmbVATX_TYPE" propid="value" datasetid="dsTA_SLIPNT" columnid="VATX_TYPE"/>
      <BindItem id="item5" compid="Tab0.tabpage3.cmbBULG_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="BULG_GUBN"/>
      <BindItem id="item6" compid="Tab0.tabpage3.mskVATX_AMNT" propid="value" datasetid="dsTA_SLIPNT" columnid="VATX_AMNT"/>
      <BindItem id="item7" compid="Tab0.tabpage3.calTRNS_DATE" propid="value" datasetid="dsTA_SLIPNT" columnid="TRNS_DATE"/>
      <BindItem id="item8" compid="Tab0.tabpage3.cmbVATX_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="VATX_GUBN"/>
      <BindItem id="item9" compid="Tab0.tabpage3.cmbPURC_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="PURC_GUBN"/>
      <BindItem id="item10" compid="Tab0.tabpage3.mskSUPP_AMNT" propid="value" datasetid="dsTA_SLIPNT" columnid="SUPP_AMNT"/>
      <BindItem id="item11" compid="Tab0.tabpage3.mskSUMX_AMNT" propid="value" datasetid="dsTA_SLIPNT" columnid="SUMX_AMNT"/>
      <BindItem id="item12" compid="Tab0.tabpage3.edtITEM_NAME" propid="value" datasetid="dsTA_SLIPNT" columnid="ITEM_NAME"/>
      <BindItem id="item13" compid="Tab0.tabpage3.edtVATX_REMK" propid="value" datasetid="dsTA_SLIPNT" columnid="VATX_REMK"/>
      <BindItem id="item14" compid="Tab0.tabpage3.cmbEBIL_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="EBIL_GUBN"/>
      <BindItem id="item15" compid="Tab0.tabpage3.chkEBIL_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="EBIL_GUBN"/>
      <BindItem id="item16" compid="Tab0.tabpage3.edtCUST_CODE" propid="value" datasetid="dsTA_SLIPNT" columnid="CUST_CODE"/>
      <BindItem id="item17" compid="Tab0.tabpage3.edtCUST_NAME" propid="value" datasetid="dsTA_SLIPNT" columnid="CUST_NAME"/>
      <BindItem id="item18" compid="Tab0.tabpage3.edtCARD_APPR" propid="value" datasetid="dsTA_SLIPNT" columnid="CARD_APPR"/>
      <BindItem id="item19" compid="Tab0.tabpage3.mskCARD_NUMB" propid="value" datasetid="dsTA_SLIPNT" columnid="CARD_NUMB"/>
      <BindItem id="item20" compid="Tab0.tabpage3.chkETIS_YSNO" propid="value" datasetid="dsTA_SLIPNT" columnid="ETIS_YSNO"/>
      <BindItem id="item21" compid="Tab0.tabpage3.cmbVATX_CHNG" propid="value" datasetid="dsTA_SLIPNT" columnid="VATX_CHNG"/>
      <BindItem id="item22" compid="Tab0.tabpage3.cmbVATX_TYPE" propid="value" datasetid="dsTA_SLIPNT" columnid="VATX_TYPE"/>
      <BindItem id="item23" compid="Tab0.tabpage3.cmbBULG_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="BULG_GUBN"/>
      <BindItem id="item24" compid="Tab0.tabpage3.mskVATX_AMNT" propid="value" datasetid="dsTA_SLIPNT" columnid="VATX_AMNT"/>
      <BindItem id="item25" compid="Tab0.tabpage3.calTRNS_DATE" propid="value" datasetid="dsTA_SLIPNT" columnid="TRNS_DATE"/>
      <BindItem id="item26" compid="Tab0.tabpage3.cmbVATX_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="VATX_GUBN"/>
      <BindItem id="item27" compid="Tab0.tabpage3.cmbPURC_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="PURC_GUBN"/>
      <BindItem id="item28" compid="Tab0.tabpage3.mskSUPP_AMNT" propid="value" datasetid="dsTA_SLIPNT" columnid="SUPP_AMNT"/>
      <BindItem id="item29" compid="Tab0.tabpage3.mskSUMX_AMNT" propid="value" datasetid="dsTA_SLIPNT" columnid="SUMX_AMNT"/>
      <BindItem id="item30" compid="Tab0.tabpage3.edtITEM_NAME" propid="value" datasetid="dsTA_SLIPNT" columnid="ITEM_NAME"/>
      <BindItem id="item31" compid="Tab0.tabpage3.edtVATX_REMK" propid="value" datasetid="dsTA_SLIPNT" columnid="VATX_REMK"/>
      <BindItem id="item32" compid="Tab0.tabpage3.cmbEBIL_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="EBIL_GUBN"/>
      <BindItem id="item33" compid="Tab0.tabpage3.chkEBIL_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="EBIL_GUBN"/>
      <BindItem id="item34" compid="Tab0.tabpage3.edtCUST_CODE" propid="value" datasetid="dsTA_SLIPNT" columnid="CUST_CODE"/>
      <BindItem id="item35" compid="Tab0.tabpage3.edtCUST_NAME" propid="value" datasetid="dsTA_SLIPNT" columnid="CUST_NAME"/>
      <BindItem id="item36" compid="Tab0.tabpage3.edtCARD_APPR" propid="value" datasetid="dsTA_SLIPNT" columnid="CARD_APPR"/>
      <BindItem id="item37" compid="Tab0.tabpage3.mskCARD_NUMB" propid="value" datasetid="dsTA_SLIPNT" columnid="CARD_NUMB"/>
      <BindItem id="item38" compid="Tab0.tabpage3.chkETIS_YSNO" propid="value" datasetid="dsTA_SLIPNT" columnid="ETIS_YSNO"/>
      <BindItem id="item39" compid="Tab0.tabpage3.cmbVATX_CHNG" propid="value" datasetid="dsTA_SLIPNT" columnid="VATX_CHNG"/>
      <BindItem id="edtACCT_NAME_value" compid="edtACCT_NAME" propid="value" datasetid="dsTA_SLIPNT" columnid="ACCT_NAME"/>
      <BindItem id="edtTITL_NAME_value" compid="edtTITL_NAME" propid="value" datasetid="dsTA_SLIPXM" columnid="TITL_NAME"/>
      <BindItem id="calSLIP_DATE_value" compid="calSLIP_DATE" propid="value" datasetid="dsTA_SLIPXM" columnid="SLIP_DATE"/>
      <BindItem id="edtEMPL_NAME_value" compid="edtEMPL_NAME" propid="value" datasetid="dsTA_SLIPXM" columnid="EMPL_NAME"/>
      <BindItem id="edtDEPT_NAME_value" compid="edtDEPT_NAME" propid="value" datasetid="dsTA_SLIPXM" columnid="DEPT_NAME"/>
      <BindItem id="cmbGW_STATUS_value" compid="cmbAPPS_CODE" propid="value" datasetid="dsTA_SLIPXM" columnid="APPS_CODE"/>
      <BindItem id="cmbACCT_GUB2_value" compid="cmbBUDG_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="BUDG_GUBN"/>
      <BindItem id="cmbACCT_GUB1_value" compid="cmbACCT_UNIT" propid="value" datasetid="dsTA_SLIPXM" columnid="ACCT_UNIT"/>
      <BindItem id="edtEMPL_NUMB_value" compid="edtEMPL_NUMB" propid="value" datasetid="dsTA_SLIPXM" columnid="EMPL_NUMB"/>
      <BindItem id="edtDEPT_CODE_value" compid="edtDEPT_CODE" propid="value" datasetid="dsTA_SLIPXM" columnid="DEPT_CODE"/>
      <BindItem id="edtACCT_INTL_value" compid="edtACCT_INTL" propid="value" datasetid="dsTA_SLIPNT" columnid="ACCT_INTL"/>
      <BindItem id="edtUSEX_DEPT_value" compid="edtUSEX_DEPT" propid="value" datasetid="dsTA_SLIPNT" columnid="USEX_DEPT"/>
      <BindItem id="edtREMK_NAME_value" compid="edtREMK_NAME" propid="value" datasetid="dsTA_SLIPNT" columnid="REMK_NAME"/>
      <BindItem id="chkPAYX_YSNO_value" compid="chkPAYX_YSNO" propid="value" datasetid="dsTA_SLIPNT" columnid="PAYX_YSNO"/>
      <BindItem id="cmbCURR_GUBN_value" compid="cmbCURR_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="CURR_GUBN"/>
      <BindItem id="mskEXCH_RATE_value" compid="mskEXCH_RATE" propid="value" datasetid="dsTA_SLIPNT" columnid="EXCH_RATE"/>
      <BindItem id="rdoDRCR_GUBN_value" compid="rdoDRCR_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="DRCR_GUBN"/>
      <BindItem id="mskFORI_AMNT_value" compid="mskFORI_AMNT" propid="value" datasetid="dsTA_SLIPNT" columnid="FORI_AMNT"/>
      <BindItem id="cmbBANK_INOU_value" compid="cmbBANK_INOU" propid="value" datasetid="dsTA_SLIPNT" columnid="BANK_INOU"/>
      <BindItem id="cmbLEDG_GUBN_value" compid="cmbLEDG_GUBN" propid="value" datasetid="dsTA_SLIPNT" columnid="LEDG_GUBN"/>
      <BindItem id="calPAYX_DATE_value" compid="calPAYX_DATE" propid="value" datasetid="dsTA_SLIPNT" columnid="PAYX_DATE"/>
      <BindItem id="calACCT_DATE_value" compid="calACCT_DATE" propid="value" datasetid="dsTA_SLIPXM" columnid="ACCT_DATE"/>
      <BindItem id="edtAPPR_EMNM_value" compid="edtAPPR_EMNM" propid="value" datasetid="dsTA_SLIPXM" columnid="APPR_EMNM"/>
      <BindItem id="item0" compid="mskSLIP_AMNT" propid="value" datasetid="dsTA_SLIPNT" columnid="SLIP_AMNT"/>
      <BindItem id="cmbEVID_DOCU_value" compid="cmbEVID_DOCU" propid="value" datasetid="dsTA_SLIPNT" columnid="EVID_DOCU"/>
      <BindItem id="item2" compid="mskSORT_ORDR" propid="value" datasetid="dsTA_SLIPNT" columnid="SORT_ORDR"/>
      <BindItem id="item42" compid="Tab0.TabD2.edtCARD_APPR00" propid="value" datasetid="dsTA_VATXXM" columnid="SLIP_NUMB"/>
      <BindItem id="item43" compid="Tab0.TabD2.edtCARD_APPR01" propid="value" datasetid="dsTA_VATXXM" columnid="SLIP_LINE"/>
      <BindItem id="item44" compid="Tab0.TabD2.edtCARD_APPR02" propid="value" datasetid="dsTA_VATXXM" columnid="CRUD_TYPE"/>
      <BindItem id="item45" compid="edtAPPR_EMPL" propid="value" datasetid="dsTA_SLIPXM" columnid="APPR_EMPL"/>
      <BindItem id="item40" compid="mskSLIP_NUMB" propid="value" datasetid="dsTA_SLIPNT" columnid="SLIP_NUMB"/>
      <BindItem id="item41" compid="Tab0.TabD2.cmbEBIL_GUBN" propid="value" datasetid="dsTA_VATXXM" columnid="EBIL_GUBN"/>
      <BindItem id="item46" compid="edtSOUS_LNKY" propid="value" datasetid="dsTA_SLIPXM" columnid="SOUS_LNKY"/>
      <BindItem id="item47" compid="edtBDSB_CODE" propid="value" datasetid="dsTA_SLIPNT" columnid="BDSB_CODE"/>
      <BindItem id="item48" compid="edtBDSB_NAME" propid="value" datasetid="dsTA_SLIPNT" columnid="BDSB_NAME"/>
      <BindItem id="item49" compid="edtCSTC_CODE" propid="value" datasetid="dsTA_SLIPNT" columnid="CSTC_CODE"/>
      <BindItem id="item50" compid="edtCSTC_NAME" propid="value" datasetid="dsTA_SLIPNT" columnid="CSTC_NAME"/>
      <BindItem id="item51" compid="mskBUDG_AMNT" propid="value" datasetid="dsTA_SLIPNT" columnid="BUDG_AMNT"/>
      <BindItem id="item53" compid="cmbSLIP_GUBN" propid="value" datasetid="dsTA_SLIPXM" columnid="SLIP_GUBN"/>
      <BindItem id="item52" compid="mskOSLI_DISP" propid="value" datasetid="dsTA_SLIPNT" columnid="OSLI_DISP"/>
      <BindItem id="item55" compid="edtAPPR_DOCN" propid="value" datasetid="dsTA_SLIPXM" columnid="APPR_DOCN"/>
      <BindItem id="item56" compid="edtUPDT_INFO" propid="value" datasetid="dsTA_SLIPXM" columnid="UPDT_INFO"/>
      <BindItem id="item57" compid="edtGWAP_STAT" propid="value" datasetid="dsTA_SLIPXM" columnid="GWAP_STAT"/>
    </Bind>
    <Script type="xscript5.0"><![CDATA[/***************************************************************************************************
 * # Program:   FAMA0120 재무제표출력설정
 * 
 * # Modification Information
 * -------------------------------------------------------------------------------------------------
 *   Date           Modifier    Comment
 * -------------------------------------------------------------------------------------------------
 *   2016.08.30     권미영     Initial Created.
 *   
 * -------------------------------------------------------------------------------------------------
 * Copyright 1998-2016 By INBUS Co,Ltd. All rights reserved.
 ****************************************************************************************************
 *   Form Common Script
 *      1) 공통 스크립트 위치 및 명칭은 수정 불가 입니다. 
 *      2) 각 함수에서 필요한 부분의 소스를 수정 하세요.  
 *      3) 해당 프로그램의 기능이 없는 경우 해당 함수의 이름만 놓고 공백 처리  
 *
 *  ★ 위 사항의 변경이 있거나 추가 사항이 있을 경우 반드시 개발 PL과 상의 후 수정 요망
 *     현재 총 100 컬럼임 되도록 100 컬럼 안으로 코딩을 하세요                         
 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 123456789 1234567890
 ********************************************************************************INBUS*CO*KR********/
/************************
 *  공통 Script Include  *
 ************************/
include "script::lib_script_common.xjs"
include "script::lib_script_ubireport.xjs"

/*********************
 *  화면 변수 선언부  *
 *********************/
this.sBUTTONLIST    = "TTTTTTTT";   //공통기능정의(버튼순으로 T or F)
this.sPACKAGENAME   = "FAMB0030";
this.sACCT_YEAR     = "";           //(X) 회계년도
this.sSTATUS        = "";           //(X) 신규전표상태
this.sSHRSLIP_NUMB  = "";           //(X) 전표번호 - 연동시 사용
this.sTABLE_TYPE    = "D";          //(X) 발생된 전표 테이블 (일반전표시:TA_SLIPXM, 각 업무별테이블)
this.sTABLE_NAME    = "TA_SLIPXM";  //(X) 발생된 전표 테이블 (일반전표시:TA_SLIPXM, 각 업무별테이블) 
this.sFORM_IDXX     = "";           //호출 폼 ID
this.sDELE_USER     = "";           //(X) 삭제자
this.sDELE_TYPE     = "N";          //(X) 
this.gRow = 0;
this.bFireEvents    = true;         //(X) 
this.sGwStatus      = "";
this.sSLIP_GUBN_RF2 = "";
this.bTEST_FLAG     = false;        //(X) 전표 해더
this.tTITL_NAME     = "테스트입력 - 품의예산 테스트";   //전표라인
this.tACCT_NAME     = "6115241";
this.tBUDG_GUBN     = "10";
this.tSLIP_AMNT     = 10000;
this.tREMK_NAME     = "";

this.sSLIP_NUMB     = "";
this.sSLIP_LINE		= "";
this.sLOAD_FORM     = "NEW"; 

this.bSLIP_CLOS     = false;    //전표일자 마감여부
this.sCHEK_CLDT     = "";       //마감체크할 전표일자 

this.sDOCU_IDXX 	= "";		//결재문서 ID
this.sAPPR_GUBN 	= "";		//결재처리구분 [ list : 목록, deleteDoc : 결재취소, show : 조회, createDoc : 상신 ]
this.sAPPR_DOCN 	= "";		//결재문서 SEQ
this.sAPPR_STAT   	= "";   	//결재문서 상태

this.sCSTC_CDNE		= "";		//귀속부서별 계정별로 매핑되는 코스트센터가 1개인 경우 [코드 + ',' + 명칭] 리턴
this.sSLIP_LIST     = "";       //리포트 출력
this.aKeyValue 		= new Array(2);
    
if (this.getOwnerFrame()["sUSERAUTH"] == undefined) {
    this.sUSERAUTH     = "";   
    this.sFORMCAPTION  = "";   
    this.sFORMLOCATION = "";   
    this.sUSERLAVEL    = "";   
} else {
    this.sUSERAUTH     = this.getOwnerFrame()["sUSERAUTH"];
    this.sFORMCAPTION  = this.getOwnerFrame()["sFORMCAPTION"];
    this.sFORMLOCATION = this.getOwnerFrame()["sFORMLOCATION"];
    this.sUSERLAVEL    = this.getOwnerFrame()["sUSERLAVEL"];
}

if (this.opener != null) {
    this.sSLIP_NUMB = this.parent.sSLIP_NUMB;
    this.sSLIP_LINE = this.parent.sSLIP_LINE;
    this.sLOAD_FORM	= this.parent.sLoadForm;    //로드시 (NEW:직접입력, REV:수정 ,SHR:조회 ,SEM:반자동전표)
    this.sUSERLAVEL = this.parent.sUSERLAVEL
}

/**************************************************************************************************
 *                                         공통 Event 처리 부분                                    *
 ***************************************************************************************************/
/*-----------------------------------+
 |  01.최초 화면 Load時 처리 할 사항  |
 +------------------------------------*/
this.fn_FormLoadSetting = function (obj:Form, e:LoadEventInfo) {

    //전표번호mask
    this.fnc_FormatSlipNumber(this.mskSHRSLIP_NUMB);
    this.fnc_FormatSlipNumber(this.mskSLIP_NUMB);
    this.fnc_FormatSlipNumber(this.mskOSLI_DISP, "", "Y");  //행번호포함
    
    this.mskSHRSLIP_NUMB.set_value(this.sSLIP_NUMB);
    
    this.sDOCU_IDXX = "KFI102";	//결재문서 ID
    
    if (this.sLOAD_FORM == "SHR") {
    
        this.sBUTTONLIST = "TFFFFFFT";
        //this.sFORMCAPTION = "회계전표조회";
        
    } else if (this.sLOAD_FORM == "SEM" || this.sLOAD_FORM == "REV") {
    
        this.sBUTTONLIST = "TFFTTTFT";//Button 사용여부 순서(종료, 조회, 입력, 삭제, 취소, 저장, 엑셀, 인쇄)
        
    }
    
    this.fnc_FormLoadSetting(obj, this.sFORMCAPTION, this.sFORMLOCATION, this.sBUTTONLIST, this.sUSERAUTH);
    this.fnc_GridSetting(this);
    this.fnc_GetComboDs(this.dsCombo);
    this.fnc_GetUserComboDs(this.dsUserCombo);

    //trace("this.sLOAD_FORM " + this.sLOAD_FORM);

    //계정코드를 먼저 모두 가져온다.
    this.fn_Search_ACCT_INTL();

    this.DivExcel.set_visible(false); 

    if (this.sLOAD_FORM == "NEW") {

        this.calSHRSLIP_DATE.set_value(this.fnc_GetServerDateTime("DATE"));
		this.mskSHRSLIP_NUMB.setFocus();

    } else if (this.sLOAD_FORM == "SHR" || this.sLOAD_FORM == "REV") {
        
        this.st_FormLocation.set_text("");          
        
        this.staSHRSLIP_DATE.set_cssclass("styFormItemCap");
        this.calSHRSLIP_DATE.set_value("");
        this.fnc_SetReadonly(this.mskSHRSLIP_NUMB, true);

        this.staSHRSLIP_DATE.set_visible(false);
        this.calSHRSLIP_DATE.set_visible(false);
        this.imgHelpSHRSLIP_NUMB.set_visible(false);
        
        //팝업이면 전표 조회한다.
        this.fn_Search();
        
        if (this.fnc_Length(this.fnc_Trim(this.sSLIP_LINE)) > 0) {	
			var iNtRow = this.dsTA_SLIPNT.findRow("SLIP_LINE", this.sSLIP_LINE)
			if (iNtRow < 0) iNtRow = 0;
			this.dsTA_SLIPNT.set_rowposition(iNtRow);
			this.grdTA_SLIPNT.selectRow(iNtRow);	//해당로우로 포커스
        }
        
        this.grdTA_SLIPNT.setFocus();
            
    } else if (this.sLOAD_FORM == "SEM") {
    
        this.st_FormLocation.set_text("");      

        this.staSHRSLIP_DATE.set_visible(false);
        this.calSHRSLIP_DATE.set_visible(false);
        this.imgHelpSHRSLIP_NUMB.set_visible(false);

        this.fnc_SetReadonly(this.mskSHRSLIP_NUMB, true);
        this.fn_SearchSemiAuto();
        
    }

    //조회만 할때는 계정코드관리항목, 기준환율 가져오지 않는다.
    if (this.sLOAD_FORM != "SHR") {
        this.fn_Search_ACCT_COND_CODE();
    }  
    
    //문서파일첨부 버튼
    if (this.sUSERLAVEL == "1") {
		this.btnAttachDoc.set_visible(true);
	} else {
		this.btnAttachDoc.set_visible(false);
	}	

}
  
/*----------------------------------+
 |  02.도움말 버튼 클릭 時  |
 ------------------------------------*/
this.fn_Help = function (obj) {
    //기능없음
}

/*----------------------------------+
 |  03.화면 종료(닫기) 버튼 클릭 時  |
 ------------------------------------*/
this.fn_End = function (obj:Button, e:nexacro.ClickEventInfo) {

    this.close();
    
}

/*-----------------------+
 |  04.조회 버튼 클릭 時  |
 +------------------------*/
this.fn_Search = function (obj:Button, e:nexacro.ClickEventInfo) {
    
    if (!this.fn_SearchItemCheck()) return;
    
    this.dsTA_SLIPRF.filter("");
    this.fnc_DatasetClear("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM"); 

    var sMethodName = "SEARCH00";
    var sInDataSet  = "";
    var sOutDataSet = "dsTA_SLIPXM=dsTA_SLIPXM dsTA_SLIPNT=dsTA_SLIPNT dsTA_SLIPRF=dsTA_SLIPRF dsTA_VATXXM=dsTA_VATXXM";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack", false);
    this.grdTA_SLIPNT.setFocus();
    
}

/*---------------+
 |  반전표 조회  |
 +---------------*/
this.fn_SearchSemiAuto = function (obj) {

    var sMethodName = "SEARCH01";
    var sInDataSet  = "";
    var sOutDataSet = "dsTA_SLIPXM=dsTA_SLIPXM dsTA_SLIPNT=dsTA_SLIPNT dsTA_SLIPRF=dsTA_SLIPRF dsTA_VATXXM=dsTA_VATXXM ";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");
    this.grdTA_SLIPNT.setFocus();
    
}

/*-----------------------------+
 |  05.입력(신규) 버튼 클릭 時  |
 +------------------------------*/
this.fn_Input = function (obj:Button, e:nexacro.ClickEventInfo) {
    
    if (this.fnc_DatasetChangeCheck("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM")) {
        if (!this.fnc_Message("TMM023")) return false;
    }

    this.fnc_DatasetClear("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM"); 
    
    var iRow = this.dsTA_SLIPXM.addRow();
    this.dsTA_SLIPXM.setColumn(iRow, "CRUD_TYPE", "INS");                 //CRUD_TYPE
    this.dsTA_SLIPXM.setColumn(iRow, "SLIP_NUMB", "");                    //전표번호
    this.dsTA_SLIPXM.setColumn(iRow, "DISP_NUMB", "");                    //전표번호
    
    this.dsTA_SLIPXM.setColumn(iRow, "EMPL_NUMB", application.GBL_EMPLNO);   	//발행자
    this.dsTA_SLIPXM.setColumn(iRow, "EMPL_NAME", application.GBL_USERNM);    	//발행자명
    this.dsTA_SLIPXM.setColumn(iRow, "DEPT_CODE", application.GBL_DEPTCD);    	//부서
    this.dsTA_SLIPXM.setColumn(iRow, "DEPT_NAME", application.GBL_DEPTNM);    	//부서명
    this.dsTA_SLIPXM.setColumn(iRow, "ACCT_GUBN", application.GBL_ACCT_GUBN); 	//사업장
    this.dsTA_SLIPXM.setColumn(iRow, "AUTO_YSNO", "0");                       	//자동전표여부
    this.dsTA_SLIPXM.setColumn(iRow, "APPR_STAT", "N"); 						//결재상태: 기안대기

    this.cmbACCT_UNIT.set_index(1);     //회계단위
    this.cmbSLIP_GUBN.set_index(1);     //전표종류
    this.cmbAPPS_CODE.set_index(1);     //결재상태
    
    this.mskCHAX_AMNT.set_value(0);     //차변합계
    this.mskDAEX_AMNT.set_value(0);     //대변합계
    
    this.dsTA_SLIPXM.setColumn(iRow, "SLIP_DATE",  this.fnc_GetServerDateTime("DATE")); // 전표일자 
	
	this.btn_AddRow.set_enable(true);		//라인추가
    this.btn_InsertRow.set_enable(true);	//라인삽입
    this.btn_CopyRow.set_enable(true); 	//라인복사
    this.btn_DelRow.set_enable(true);  	//라인삭제
    this.fnc_SetReadonly(this.calSLIP_DATE, false); //작성일자
    this.fnc_SetReadonly(this.cmbACCT_UNIT, false); //회계단위
    
    this.edtTITL_NAME.setFocus();
    
}

/*-----------------------------+
 |  06.삭제(제거) 버튼 클릭 時  |
 +------------------------------*/
this.fn_Delete = function (obj:Button, e:nexacro.ClickEventInfo) {
    
    if (!this.fn_DeleteCheck()) return;

    //전표마스터를 제외한 모든 데이터를 삭제후 마스터 삭제
	this.dsTA_SLIPNT.deleteAll();
	this.dsTA_SLIPRF.deleteAll();
	this.dsTA_VATXXM.deleteAll();
    this.dsTA_SLIPXM.deleteRow(this.dsTA_SLIPXM.rowposition);

    this.grdTA_SLIPNT.setFocus();
}

/*-----------------------+
 |  07. 취소 버튼 클릭 時  |
 -------------------------*/
this.fn_Cancel = function (obj:Button, e:nexacro.ClickEventInfo) {

    this.fnc_DataSetCancel("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM");
    
    if (this.dsTA_SLIPXM.rowcount > 0) this.dsTA_SLIPXM.set_rowposition(0);
    if (this.dsTA_SLIPNT.rowcount > 0) this.dsTA_SLIPNT.set_rowposition(0);

    this.fn_SlipAmnt_Changeed();    //차/대변 합계금액 계산
    this.grdTA_SLIPNT.setFocus();   //취소 후 Grid로 Focus
    
}

/*-----------------------+
 |  08.저장 버튼 클릭 時  |
 -------------------------*/
this.fn_Save = function (obj:Button, e:nexacro.ClickEventInfo) {

    if (!this.fn_SaveItemCheck()) return;

	this.aKeyValue[0] = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_NUMB");
	this.aKeyValue[1] = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_LINE");

    //this.dsTA_SLIPNT.set_rowposition(0);
    var sMethodName = "SAVE00";
    var sInDataSet  = "dsTA_SLIPXM=dsTA_SLIPXM:A dsTA_SLIPNT=dsTA_SLIPNT:U dsTA_SLIPRF=dsTA_SLIPRF:U dsTA_VATXXM=dsTA_VATXXM:U";
    var sOutDataSet = "";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");

    this.grdTA_SLIPNT.setFocus();
    
}

/*-----------------------+
 |  09.엑셀 버튼 클릭 時  |
 -------------------------*/
this.fn_ToExcel = function (obj:Button, e:nexacro.ClickEventInfo) {

    this.fnc_ToExcel(this.name);
    
}

/*-----------------------+
 |  10.인쇄 버튼 클릭 時  |
 +------------------------*/
this.fn_Print = function (obj:Button, e:nexacro.ClickEventInfo) {

    if (this.dsTA_SLIPXM.rowcount < 0) return this.fnc_Message("TMM011");
    if (this.dsTA_SLIPXM.rowposition < 0) return;
    
    this.fnc_DatasetClear("dsTA_SLIPXM_RPT,dsTA_SLIPNT_RPT");
	
	var reportfile 	= "/fam/FAMB0030R01.jrf";
	var dataref 	= new Array();
    var params 		= "";
    
	dataref[0] 				= new Object();
	dataref[0].type 		= "TRAN";
	dataref[0].svcUrl 		= "/core/erp/fam/FAMB0030_PRINT00.do";
	dataref[0].inDataset 	= ""
	dataref[0].outDataset 	= "dsTA_SLIPXM_RPT=dsTA_SLIPXM_RPT dsTA_SLIPNT_RPT=dsTA_SLIPNT_RPT";
	dataref[0].arg 			= this.fn_CreateArgument("PRINT00");
	
	this.fn_UbiReport(reportfile, params, dataref, "");
	
}

/*-----------------------------------+
 |  11. 화면 종료時 처리 할 사항  |
 +------------------------------------*/
this.fn_FormUnloadCheckProcess = function (obj:Form,  e:nexacro.CloseEventInfo) {
    
    if (e.fromobject instanceof Div) return;
    
    var sMessage = this.fnc_FormUnloadCheck("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM",this);
    if (!this.fnc_IsEmpty(sMessage)) return sMessage;
    
}
 
this.fn_FormUnloadProcess = function (obj:Form, e:CloseEventInfo) {

//     if (this.sLOAD_FORM == "SHR") { 
//         return this.fnc_FormUnload("", e);
//     } else {            
        return this.fnc_FormUnload(obj, e); // 자료 변경 여부를 체크하고자 하는  DataSet Object를 넘긴다.
//    }
    
}

/*-----------------------------------+
 |  11.단축키 처리(Form KeyDown)      |
 +------------------------------------*/
this.fn_HotKey = function (obj:Form, e:KeyEventInfo) {

    this.fnc_HotKey(this, e.fromreferenceobject, e);

}

/*-----------------------------------+
 |  13.Text Box가 Focus를 받을 때     |
 +------------------------------------*/
this.fn_EditFocus = function (obj) {

    this.fnc_EditFocus(obj);

}

/**************************************************************************************************
 *                                      공통 Function 처리 부분                                    *
 ***************************************************************************************************/
/*----------------------------------------------------------------+
 |  조회 필수 조건 체크!  |
 +-----------------------------------------------------------------*/
this.fn_SearchItemCheck = function () {

// trace("dsTA_SLIPXM : " + this.fnc_DatasetChangeCheck("dsTA_SLIPXM"));
// trace("dsTA_SLIPNT : " + this.fnc_DatasetChangeCheck("dsTA_SLIPNT"));
// trace("dsTA_SLIPRF : " + this.fnc_DatasetChangeCheck("dsTA_SLIPRF"));
// trace("dsTA_VATXXM : " + this.fnc_DatasetChangeCheck("dsTA_VATXXM"));

    if (this.fnc_DatasetChangeCheck("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM")) return this.fnc_Message("TMM023");
    
    if (this.fnc_Length(this.mskSHRSLIP_NUMB.value) < 1) {
        return this.fnc_CheckPostAction("TMM072", "전표번호", "", "", this.mskSHRSLIP_NUMB, "");
    }
    return true;
    
}

/*----------------------------------------------------------------+
 |  삭제 여부 체크!  |
 +-----------------------------------------------------------------*/
this.fn_DeleteCheck = function () {

    if (this.dsTA_SLIPXM.rowcount < 1) {               
        this.fnc_Message("TMM007");
        return false;
    }

    //수정가능확인한다.
    if (!this.fn_IsUpdateOK() && this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "APPS_CODE") != "X") {
        this.fnc_Message("TMM300", "선택한 전표는 삭제 할수 없습니다.\n" 
                                 + " - 결재상태[" + this.cmbAPPS_CODE.text + "]\n" 
                                 + " - 전표유형[" + this.cmbSLIP_GUBN.text + "]");
        return false;
    }
    
    var sQuestionText = "회계전표 " + this.mskSLIP_NUMB.text;
    return this.fnc_Message("TMM002", sQuestionText);

}

/*----------------------------------------------------------------+
 |  저장 여부 체크(결의서)!          |
 +-----------------------------------------------------------------*/
this.fn_SaveItemCheck = function (Obj) {    // 자동전표는 수정할수 없다.

    // 변경된 자료가 있는지 체크
    this.dsTA_SLIPRF.filter("");
    if (!this.fnc_DatasetChangeCheck("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM")) {
		this.fn_dsTA_SLIPRF_Filter();
        this.fnc_Message("TMM003");
        return false;
    }
    this.fn_dsTA_SLIPRF_Filter();

    //현재행을 보관한다.
    var iCurrRow = this.dsTA_SLIPNT.rowposition;

    /******************************** 전표 마스터 체크 *****************************************/
    if (this.dsTA_SLIPXM.rowcount == 1 && this.dsTA_SLIPXM.getRowType(0) != Dataset.ROWTYPE_NORMAL) {
    
        if (this.fnc_IsDate(this.fnc_Trim(this.dsTA_SLIPXM.getColumn(0, "SLIP_DATE"))) == false) {
            return this.fnc_SearchCheckPostAction("TMM072", "정확한 전표일자", this.calSHRSLIP_DATE);
        }

        if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPXM.getColumn(0, "ACCT_UNIT"))) < 1) {
            return this.fnc_CheckPostAction("TMM072", "회계단위", this.dsTA_SLIPXM, 0, this.cmbACCT_UNIT, "ACCT_UNIT");
        }

        if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPXM.getColumn(0, "SLIP_GUBN"))) < 1) {
            return this.fnc_CheckPostAction("TMM072", "전표종류", this.dsTA_SLIPXM, 0, this.cmbSLIP_GUBN, "SLIP_GUBN");
        }

        if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPXM.getColumn(0, "TITL_NAME"))) < 1) {
            return this.fnc_CheckPostAction("TMM072", "제목", this.dsTA_SLIPXM, 0, this.edtTITL_NAME, "TITL_NAME");
        }

        //수정건의 CRUD_TYPE 을 셋팅한다.
        if (this.dsTA_SLIPXM.getRowType(0) == Dataset.ROWTYPE_UPDATE) {
            this.dsTA_SLIPXM.setColumn(0, "CRUD_TYPE", "UPD");
        }
    }
	
	if (this.dsTA_SLIPXM.rowcount == 1) {
		if (nexacro.toNumber(this.mskCHAX_AMNT.value,0) != nexacro.toNumber(this.mskDAEX_AMNT.value,0)) {
			this.fnc_Message("TMM125", "차대변 금액이 맞지 않습니다.(1)"); 
			this.grdTA_SLIPNT.setFocus();
			return false;
		}
	}

    if (nexacro.toNumber(this.dsTA_SLIPNT.getCaseSum("DRCR_GUBN=='D'", "SLIP_AMNT"),0) != nexacro.toNumber(this.dsTA_SLIPNT.getCaseSum("DRCR_GUBN=='C'", "SLIP_AMNT"),0)) {   
        this.fnc_Message("TMM125", "차대변 금액이 맞지 않습니다.(2)"); 
        this.grdTA_SLIPNT.setFocus();
        return false;
    }
    
    if (this.dsTA_SLIPXM.getDeletedRowCount() < 1 && this.dsTA_SLIPNT.rowcount < 2) {   
        this.fnc_Message("TMM125", "전표행은 2건이상 등록해야 합니다."); 
        this.grdTA_SLIPNT.setFocus();
        return false;
    }

    /******************************** 전표 세부(분개내역) 체크 *****************************************/

    for (var i = 0; i < this.dsTA_SLIPNT.rowcount; i++) {
    
        if (this.fnc_ToUpper(this.dsTA_SLIPNT.getRowType(i)) == Dataset.ROWTYPE_NORMAL) continue;
        
        
        var iAcctRow        = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(i, "ACCT_INTL"));
        var sAcct_Drcr_Gubn = this.dsTA_ACCTXM.getColumn(iAcctRow, "DRCR_GUBN");    //계정코드 차대구분
        var sSlip_Drcr_Gubn = this.dsTA_SLIPNT.getColumn(i, "DRCR_GUBN");           //전표행 차대구분
        
        
        var sSlipLine = "행번호[" + this.dsTA_SLIPNT.getColumn(i, "SLIP_LINE") + "] ";
        
        if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "USEX_DEPT"))) < 1) {
            return this.fnc_CheckPostAction("TMM072", sSlipLine + "귀속부서", this.dsTA_SLIPNT, i, this.edtDEPT_NAM1, "");
        }
        
        if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "ACCT_INTL"))) < 1) {
            return this.fnc_CheckPostAction("TMM072", sSlipLine + "계정과목", this.dsTA_SLIPNT, i, this.edtACCT_NAME, "");
        }
        
        if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "DRCR_GUBN"))) < 1) {
            return this.fnc_CheckPostAction("TMM072", sSlipLine + "차대구분", this.dsTA_SLIPNT, i, this.rdoDRCR_GUBN, "");
        }

        if (this.dsTA_ACCTXM.getColumn(iAcctRow, "CSUS_YSNO") == "1" && sSlip_Drcr_Gubn == sAcct_Drcr_Gubn ) {  // 코스트센터사용
            if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "CSTC_CODE"))) < 1) {
                return this.fnc_CheckPostAction("TMM072", sSlipLine + "코스트센터", this.dsTA_SLIPNT, i, this.edtCSTC_NAME, "");
             }
        }       

        if (this.dsTA_ACCTXM.getColumn(iAcctRow, "BUDG_YSNO") == "1" && sSlip_Drcr_Gubn == sAcct_Drcr_Gubn ) {  // 예산사용여부
             if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "BUDG_GUBN"))) < 1) {
                return this.fnc_CheckPostAction("TMM072", sSlipLine + "예산구분", this.dsTA_SLIPNT, i, this.cmbBUDG_GUBN, "");
             }
             
             if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "BDSB_CODE"))) < 1) {
                return this.fnc_CheckPostAction("TMM072", sSlipLine + "예산과목", this.dsTA_SLIPNT, i, this.edtBDSB_NAME, "");
             }
        }
        
        if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "SLIP_AMNT"))) < 1) {
            return this.fnc_CheckPostAction("TMM072", sSlipLine + "금액", this.dsTA_SLIPNT, i, this.mskSLIP_AMNT, "");
        }
        
        // 외화여부
        // 화폐구분
        if (this.dsTA_SLIPNT.getColumn(i, "CURR_GUBN") != "KRW") {
            // 한화
            // 환율
            if (this.dsTA_SLIPNT.getColumn(i, "EXCH_RATE") == 0) {
                return this.fnc_CheckPostAction("TMM072", sSlipLine + "환율", this.dsTA_SLIPNT, i, this.mskEXCH_RATE, "");
            }
            // 외화금액
            if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "FORI_AMNT"))) < 1) {
                return this.fnc_CheckPostAction("TMM072", sSlipLine + "외화금액", this.dsTA_SLIPNT, i, this.mskFORI_AMNT, "");
            }
        }

        if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "REMK_NAME"))) < 1) {
            return this.fnc_CheckPostAction("TMM072", sSlipLine + "적요", this.dsTA_SLIPNT, i, this.edtREMK_NAME, "");
        }

        //발생번호를 확인한다.
        var GUNB_YSNO = this.dsTA_ACCTXM.getColumn(iAcctRow, "GUNB_YSNO");  //건별미결관리항목
        if (GUNB_YSNO == "1") {
            //건별미결관리항목 이면서 계정과목 차대구분과 전표의 차대구분이 다르면 발생전표번호는 필수이다.
            if (sSlip_Drcr_Gubn != sAcct_Drcr_Gubn 
                && this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "OSLI_NUMB"))) < 1) {
                return this.fnc_CheckPostAction("TMM072", sSlipLine + "발생전표번호", this.dsTA_SLIPNT, i, this.btnOSLI_NUMB, "");  
            } 
        }
        
        // 차대변구분 필수항목 체크
        if (this.dsTA_ACCTXM.getColumn(iAcctRow, "DRCR_GUBN") == sSlip_Drcr_Gubn) {
            if (this.dsTA_ACCTXM.getColumn(iAcctRow, "EVID_YSNO") == 1) {
                // 증빙서류가 필수인데 해당사항없음을 선택했을때 처리(FA180090:해당사항없음)
                if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "EVID_DOCU"))) < 1) {
                    return this.fnc_CheckPostAction("TMM072", sSlipLine + "증빙서류", this.dsTA_SLIPNT, i, this.cmbEVID_DOCU, "");
                }
            }   
        }

        // 출납여부
        if (this.dsTA_ACCTXM.getColumn(iAcctRow, "CHUL_YSNO") == 1) {
            // 출납여부가 체크 되어져 있으면
            if (this.dsTA_SLIPNT.getColumn(i, "PAYX_YSNO") == 1) {
                // 출납예정일
                if (this.fnc_IsDate(this.dsTA_SLIPNT.getColumn(i, "PAYX_DATE")) == false) {
                    return this.fnc_CheckPostAction("TMM072", sSlipLine + "출납예정일", this.dsTA_SLIPNT, i, this.calPAYX_DATE, "");
                }
                
                // 출납방법
                if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(i, "LEDG_GUBN"))) < 1) {
                    return this.fnc_CheckPostAction("TMM072", sSlipLine + "출납방법", this.dsTA_SLIPNT, i, this.cmbLEDG_GUBN, "");
                }
            }
        }
        
        //수정건의 CRUD_TYPE 을 셋팅한다.
        if (this.dsTA_SLIPNT.getRowType(i) == Dataset.ROWTYPE_UPDATE) {
            this.dsTA_SLIPNT.setColumn(i, "CRUD_TYPE", "UPD");
        }
    }

    /******************************** 전표 관리항목 체크 *****************************************/
    this.Tab0.TabD1.grdTA_SLIPRF.set_enableredraw(false);  
    this.dsTA_SLIPRF.filter("");

    for (var j = 0; j < this.dsTA_SLIPRF.rowcount; j++) {
        if (this.dsTA_SLIPRF.getRowType(j) == Dataset.ROWTYPE_NORMAL) continue;

        // 전표세부 차대구분 필수가 아니면 확인하지 않는다.
        if (this.dsTA_SLIPRF.getColumn(j, "MUST_YSNO") == "0") continue; 

        var iLineRow = this.dsTA_SLIPNT.findRow("SLIP_LINE", this.dsTA_SLIPRF.getColumn(j, "SLIP_LINE"));

        if (this.dsTA_SLIPRF.getColumn(j, "DRCR_TYPE") == "A"// 관리헝목차대구분 전체
             || (this.dsTA_SLIPRF.getColumn(j, "DRCR_TYPE") == this.dsTA_SLIPNT.getColumn(iLineRow, "DRCR_GUBN"))// 차대구분-차변필수
            ) {

            // 차대구분-대변필수
            if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPRF.getColumn(j, "COND_VACD"))) < 1) {
            
                var sCond_Code = this.dsTA_SLIPRF.getColumn(j, "COND_CODE");
                var sMSG = "행번호[" +  this.dsTA_SLIPRF.getColumn(j, "SLIP_LINE") + "] 관리항목[" + this.dsTA_SLIPRF.getColumn(j, "COND_NAME") + "]";

                this.dsTA_SLIPNT.set_rowposition(iLineRow);
                this.Tab0.set_tabindex(0);
                this.Tab0.TabD1.grdTA_SLIPRF.setFocus();
                this.fn_dsTA_SLIPRF_Filter();
                this.Tab0.TabD1.grdTA_SLIPRF.set_enableredraw(true);

                return this.fnc_CheckPostAction("TMM072", sMSG, this.dsTA_SLIPRF, this.dsTA_SLIPRF.findRow("COND_CODE", sCond_Code), this.Tab0.TabD1.grdTA_SLIPRF, "COND_VANM");
                
            }
        }
        
//         
//         /*********************************************/
//         //관리항목의 거래처값과 다른경우 에러
//         this.dsTA_SLIPRF.filter("");
//         var iRfLineRow  = this.dsTA_SLIPRF.findRowExpr("SLIP_LINE == '" + iLineRow + "' && COND_CODE == '0002'");
//         var sCond_Cust 	= this.dsTA_SLIPRF.getColumn(iRfLineRow, "COND_VACD");	//관리항목의 거래처
//         trace("iRfLineRow : " + iRfLineRow + " sCond_Cust : " + sCond_Cust );
//         this.fn_dsTA_SLIPRF_Filter();
//         
//         if (iRfLineRow < 0) {
//             var sMSG = "행번호[" +  this.dsTA_SLIPRF.getColumn(j, "SLIP_LINE") + "] 관리항목 거래처";
// 			
//             this.dsTA_SLIPNT.set_rowposition(iLineRow);
//             this.Tab0.set_tabindex(0);
//             
//             return this.fnc_CheckPostAction("TMM072", sMSG, this.dsTA_SLIPRF, 0, this.Tab0.TabD1.grdTA_SLIPRF, "");
//         }
//         
//         if (this.dsTA_VATXXM.getColumn(j, "CUST_CODE") != sCond_Cust) {
//             var sMSG = "행번호[" +  this.dsTA_SLIPRF.getColumn(j, "SLIP_LINE") + "] 관리항목의 거래처와 다릅니다.";
//             
//             this.dsTA_SLIPNT.set_rowposition(iLineRow);
//             this.Tab0.set_tabindex(0);
//             this.fn_dsTA_VATXXM_Filter();
//             
//             //return this.fnc_CheckPostAction("TMM300", sMSG, this.dsTA_VATXXM, this.dsTA_VATXXM.findRow("SLIP_LINE", sSlip_Line), this.Tab0.TabD2.edtCUST_NAME, "");
//             return this.fnc_CheckPostAction("TMM300", sMSG, this.dsTA_SLIPRF, this.dsTA_SLIPRF.findRow("COND_CODE", sCond_Code), this.Tab0.TabD1.grdTA_SLIPRF, "COND_VANM");
//         }        
//         /*********************************************/
        
        
    }

    this.fn_dsTA_SLIPRF_Filter();
    this.Tab0.TabD1.grdTA_SLIPRF.set_enableredraw(true);

    /******************************** 증빙세부 체크 *****************************************/
    this.dsTA_VATXXM.filter("");

    //전표증빙에 필요없으면 삭제한다.
    for (var j = this.dsTA_SLIPNT.rowcount - 1; j >= 0; j--) {
        
        var sSLIP_LINE  = this.dsTA_SLIPNT.getColumn(j, "SLIP_LINE");
        var sEVID_DOCU  = this.dsTA_SLIPNT.getColumn(j, "EVID_DOCU");
        var iVatRow     = this.dsTA_VATXXM.findRow("SLIP_LINE", sSLIP_LINE);
        var iCodeRow    = -1;
        if (this.fnc_Length(this.fnc_Trim(sEVID_DOCU)) > 0) {
            iCodeRow    = this.dsEVID_DOCU.findRow("COMD_CODE", sEVID_DOCU);
        }
        var sRef2_Fild  = this.dsEVID_DOCU.getColumn(iCodeRow, "REF2_FILD");

        //trace(" =============== fn_SaveItemCheck : SLIP_LINE " + sSLIP_LINE);
        //trace(" =============== fn_SaveItemCheck : EVID_DOCU " + sEVID_DOCU);
        //trace(" =============== fn_SaveItemCheck : vatRow " + iVatRow);
        //trace(" =============== fn_SaveItemCheck : codeRow " + iCodeRow);
        //trace(" =============== fn_SaveItemCheck : REF2_FILD " + sRef2_Fild);
        
        //증빙이 공란인데 부가세 있으면 부가세 삭제한다
        if (this.fnc_Length(this.fnc_Trim(sEVID_DOCU)) < 1 && iVatRow >= 0)  {
            this.dsTA_VATXXM.deleteRow(iVatRow);
        }
        
        //증빙이 증빙생성여부 불필요인데 부가세 있으면 부가세 삭제한다
        else if (sRef2_Fild != "1" && iVatRow >= 0)  {
            this.dsTA_VATXXM.deleteRow(iVatRow);
        }

        //증빙이 증빙생성여부 필요인데 부가세 없으면 만들어준다.
        else if (sRef2_Fild == "1" && iVatRow < 0)  {
            var iNewRow = this.dsTA_VATXXM.addRow();
            this.dsTA_VATXXM.setColumn(iNewRow, "SLIP_NUMB", this.dsTA_SLIPNT.getColumn(j, "SLIP_NUMB"));
            this.dsTA_VATXXM.setColumn(iNewRow, "SLIP_LINE", this.dsTA_SLIPNT.getColumn(j, "SLIP_LINE"));
            this.dsTA_VATXXM.setColumn(iNewRow, "CRUD_TYPE", "INS");
            //this.dsTA_VATXXM.setColumn(iNewRow, "EBIL_GUBN", "0");    //전자발행여부
            
            this.dsTA_VATXXM.rowposition = iNewRow;
            this.Tab0.TabD2.cmbEBIL_GUBN.set_index(1);
            
        }
    }

    for (var j = 0; j < this.dsTA_VATXXM.rowcount; j++) {

    
        var iLineRow    = this.dsTA_SLIPNT.findRow("SLIP_LINE", this.dsTA_VATXXM.getColumn(j, "SLIP_LINE"));
        var sSlip_Line  = this.dsTA_VATXXM.getColumn(j, "SLIP_LINE");
        
        
        /*********************************************/
        //관리항목의 거래처값과 다른경우 에러
        this.dsTA_SLIPRF.filter("");
        var iRfLineRow  = this.dsTA_SLIPRF.findRowExpr("SLIP_LINE == '" + sSlip_Line + "' && COND_CODE == '0002'");
        var sCond_Cust 	= this.dsTA_SLIPRF.getColumn(iRfLineRow, "COND_VACD");	//관리항목의 거래처
        this.fn_dsTA_SLIPRF_Filter();
        
        if (iRfLineRow < 0) {
            var sMSG = "행번호[" +  sSlip_Line + "] 관리항목 거래처";
			
            this.dsTA_SLIPNT.set_rowposition(iLineRow);
            this.Tab0.set_tabindex(0);
            
            return this.fnc_CheckPostAction("TMM072", sMSG, this.dsTA_SLIPRF, 0, this.Tab0.TabD1.grdTA_SLIPRF, "");
        }
        
        if (this.dsTA_VATXXM.getColumn(j, "CUST_CODE") != sCond_Cust) {
            var sMSG = "행번호[" +  sSlip_Line + "] 관리항목의 거래처와 다릅니다.";
            
            this.dsTA_SLIPNT.set_rowposition(iLineRow);
            this.Tab0.set_tabindex(1);
            this.fn_dsTA_VATXXM_Filter();
            
            return this.fnc_CheckPostAction("TMM300", sMSG, this.dsTA_VATXXM, this.dsTA_VATXXM.findRow("SLIP_LINE", sSlip_Line), this.Tab0.TabD2.edtCUST_NAME, "");
        }        
        /*********************************************/
        
        
        if (this.dsTA_VATXXM.getRowType(j) == Dataset.ROWTYPE_NORMAL) continue;
// 
//         var iLineRow    = this.dsTA_SLIPNT.findRow("SLIP_LINE", this.dsTA_VATXXM.getColumn(j, "SLIP_LINE"));
//         var sSlip_Line  = this.dsTA_VATXXM.getColumn(j, "SLIP_LINE");
//         
        //this.dsTA_SLIPNT.set_rowposition("" + sSlip_Line);
        
        //전표라인의 증빙서류가 증빙자료생성여부 확인
        var iFindRow    = this.dsEVID_DOCU.findRow("COMD_CODE", this.dsTA_SLIPNT.getColumn(iLineRow, "EVID_DOCU"));
        var sRef2_Fild  = this.dsEVID_DOCU.getColumn(iFindRow, "REF2_FILD");    //증빙생성여부
        
        if (iFindRow < 0 || sRef2_Fild != "1") continue;
        
        //계정코드의 차대구분 확인
        var iAcctRow        = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(iLineRow, "ACCT_INTL"));
        var sAcct_Drcr_Gubn = this.dsTA_ACCTXM.getColumn(iAcctRow, "DRCR_GUBN"); //계정코드 차대구분
        var sSlip_Drcr_Gubn = this.dsTA_SLIPNT.getColumn(iLineRow, "DRCR_GUBN"); //전표행 차대구분
        
        if (iAcctRow < 0 || sAcct_Drcr_Gubn != sSlip_Drcr_Gubn) continue;
        

        if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATXXM.getColumn(j, "TRNS_DATE"))) < 1) {
            var sMSG = "행번호[" +  sSlip_Line + "] 증빙항목 발행일자";
            
            this.dsTA_SLIPNT.set_rowposition(iLineRow);
            this.Tab0.set_tabindex(1);
            this.fn_dsTA_VATXXM_Filter();

            return this.fnc_CheckPostAction("TMM072", sMSG, this.dsTA_VATXXM, this.dsTA_VATXXM.findRow("SLIP_LINE", sSlip_Line), this.Tab0.TabD2.calTRNS_DATE, "");
        }

        if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATXXM.getColumn(j, "VATX_GUBN"))) < 1) {
            var sMSG = "행번호[" +  sSlip_Line + "] 증빙항목 매입매출";
            
            this.dsTA_SLIPNT.set_rowposition(iLineRow);
            this.Tab0.set_tabindex(1);
            this.fn_dsTA_VATXXM_Filter();

            return this.fnc_CheckPostAction("TMM072", sMSG, this.dsTA_VATXXM, this.dsTA_VATXXM.findRow("SLIP_LINE", sSlip_Line), this.Tab0.TabD2.cmbVATX_GUBN, "");
        }

        if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATXXM.getColumn(j, "VATX_TYPE"))) < 1) {
            var sMSG = "행번호[" +  sSlip_Line + "] 증빙항목 부가세종류";
            
            this.dsTA_SLIPNT.set_rowposition(iLineRow);
            this.Tab0.set_tabindex(1);
            this.fn_dsTA_VATXXM_Filter();

            return this.fnc_CheckPostAction("TMM072", sMSG, this.dsTA_VATXXM, this.dsTA_VATXXM.findRow("SLIP_LINE", sSlip_Line), this.Tab0.TabD2.cmbVATX_TYPE, "");
        }

        if (nexacro.toNumber(this.dsTA_VATXXM.getColumn(j, "SUPP_AMNT"),0) == 0) {
            var sMSG = "행번호[" +  sSlip_Line + "] 증빙항목 공급가액";
            
            this.dsTA_SLIPNT.set_rowposition(iLineRow);
            this.Tab0.set_tabindex(1);
            this.fn_dsTA_VATXXM_Filter();

            return this.fnc_CheckPostAction("TMM072", sMSG, this.dsTA_VATXXM, this.dsTA_VATXXM.findRow("SLIP_LINE", sSlip_Line), this.Tab0.TabD2.mskSUPP_AMNT, "");
        }

        //부가세종류에서 세액필수여부를 확인한다
        var iFindRow    = this.dsVATX_TYPE.findRow("COMD_CODE", this.dsTA_VATXXM.getColumn(j, "VATX_TYPE"));
        var sREF1_FILD  = this.dsVATX_TYPE.getColumn(iFindRow, "REF1_FILD");
        if (sREF1_FILD == "1") {
            if (nexacro.toNumber(this.dsTA_VATXXM.getColumn(j, "VATX_AMNT"),0) == 0) {
                var sMSG = "행번호[" +  sSlip_Line + "] 증빙항목 세액";
                
                this.dsTA_SLIPNT.set_rowposition(iLineRow);
                this.Tab0.set_tabindex(1);
                this.fn_dsTA_VATXXM_Filter();

                return this.fnc_CheckPostAction("TMM072", sMSG, this.dsTA_VATXXM, this.dsTA_VATXXM.findRow("SLIP_LINE", sSlip_Line), this.Tab0.TabD2.mskVATX_AMNT, "");
            }
        }
        
        if (this.fnc_Length(this.fnc_Trim(this.dsTA_VATXXM.getColumn(j, "CUST_CODE"))) < 1) {
            var sMSG = "행번호[" +  sSlip_Line + "] 증빙항목 거래처";
            
            this.dsTA_SLIPNT.set_rowposition(iLineRow);
            this.Tab0.set_tabindex(1);
            this.fn_dsTA_VATXXM_Filter();

            return this.fnc_CheckPostAction("TMM072", sMSG, this.dsTA_VATXXM, this.dsTA_VATXXM.findRow("SLIP_LINE", sSlip_Line), this.Tab0.TabD2.edtCUST_NAME, "");
        }


//         /*********************************************/
//         //관리항목의 거래처값과 다른경우 에러
//         this.dsTA_SLIPRF.filter("");
//         var iRfLineRow  = this.dsTA_SLIPRF.findRowExpr("SLIP_LINE == '" + sSlip_Line + "' && COND_CODE == '0002'");
//         var sCond_Cust 	= this.dsTA_SLIPRF.getColumn(iRfLineRow, "COND_VACD");	//관리항목의 거래처
//         this.fn_dsTA_SLIPRF_Filter();
//         
//         if (iRfLineRow < 0) {
//             var sMSG = "행번호[" +  sSlip_Line + "] 관리항목 거래처";
// 			
//             this.dsTA_SLIPNT.set_rowposition(iLineRow);
//             this.Tab0.set_tabindex(0);
//             
//             return this.fnc_CheckPostAction("TMM072", sMSG, this.dsTA_SLIPRF, 0, this.Tab0.TabD1.grdTA_SLIPRF, "");
//         }
//         
//         if (this.dsTA_VATXXM.getColumn(j, "CUST_CODE") != sCond_Cust) {
//             var sMSG = "행번호[" +  sSlip_Line + "] 관리항목의 거래처와 다릅니다.";
//             
//             this.dsTA_SLIPNT.set_rowposition(iLineRow);
//             this.Tab0.set_tabindex(1);
//             this.fn_dsTA_VATXXM_Filter();
//             
//             return this.fnc_CheckPostAction("TMM300", sMSG, this.dsTA_VATXXM, this.dsTA_VATXXM.findRow("SLIP_LINE", sSlip_Line), this.Tab0.TabD2.edtCUST_NAME, "");
//         }        
//         /*********************************************/
        
        

        //수정건의 CRUD_TYPE 을 셋팅한다.
        if (this.dsTA_VATXXM.getRowType(j) == Dataset.ROWTYPE_UPDATE) {
            this.dsTA_VATXXM.setColumn(j, "CRUD_TYPE", "UPD");
        }
    }

    this.fn_dsTA_VATXXM_Filter();
    
    return true;
    
}

/*----------------------------------------------------------------+
 |  Service 호출 시 넘어 갈 Argument 생성!  |
 +-----------------------------------------------------------------*/
this.fn_CreateArgument = function (sKind) {
    
    var sReturnString;
    var iNtRow = this.dsTA_SLIPNT.rowposition;

    // 조회 Argument 생성
    if (sKind == "SEARCH00") {
        
        // 조회 버튼 클릭
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME);
        sReturnString += " action="     + this.fnc_Quote(sKind);
        sReturnString += " SLIP_NUMB="  + this.fnc_Quote(this.mskSHRSLIP_NUMB.value); //전표번호
        sReturnString += " USERLAVEL="  + this.fnc_Quote(this.sUSERLAVEL);
        sReturnString += " DEPT_CODE="  + this.fnc_Quote(application.GBL_DEPTCD); 
        sReturnString += " DOCU_IDXX="  + this.fnc_Quote(this.sDOCU_IDXX); // 결재문서 ID
        
        //sReturnString += " EMPL_NUMB=" + this.fnc_Quote(application.GBL_EMPLNO);
        //sReturnString += " ACCT_YEAR=" + this.fnc_Quote(this.fnc_SubStr(this.calSHRSLIP_DATE.value, 0, 4));
    
    } else if (sKind == "SEARCH01") {
    
        // 반자동 조회(업무에서 넘어왔을때)
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME);
        sReturnString += " action="     + this.fnc_Quote(sKind);
        sReturnString += " FORM_IDXX="  + this.fnc_Quote(this.sFORM_IDXX); //연동키값 - 폼ID

    } else if (sKind == "SEARCH21") {
    
        // 반자동 조회(업무에서 넘어왔을때)
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME);
        sReturnString += " action="     + this.fnc_Quote(sKind);
        sReturnString += " SLIP_NUMB="  + this.fnc_Quote(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_NUMB")));
        sReturnString += " SLIP_LINE="  + this.fnc_Quote(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_LINE")));

    } else if (sKind == "SEARCH10") {
    
        //계정코드
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
    
    } else if (sKind == "SEARCH11") {
    
        //계정코드 관리항목
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        
    } else if (sKind == "SEARCH13") {
        
        //발생전표 관리항목
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        sReturnString += " OSLI_NUMB="  + this.fnc_Quote(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "OSLI_NUMB"))); 
        sReturnString += " OSLI_LINE="  + this.fnc_Quote(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "OSLI_LINE"))); 
        
    } else if (sKind == "SEARCH14") {
        
        var sDate = this.fnc_Trim(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "ACCT_DATE"));
        if (this.fnc_Length(sDate) < 1) sDate = this.fnc_Trim(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE"));
        
        // 기준 환율 조회
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        sReturnString += " SLIP_DATE="  + this.fnc_Quote(sDate);
    
    } else if (sKind == "SEARCH15") {
        
        /* 예산 분기 구함 */
        var sSlip_Date = this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE");
        var sBudg_Gubn = this.dsTA_SLIPNT.getColumn(iNtRow, "BUDG_GUBN");
        
        var sYear = this.fnc_SubStr(sSlip_Date, 0, 4);
        var sMnth = this.fnc_SubStr(sSlip_Date, 4, 2);
        
        var sBudg_Ymst = "";
        var sBudg_Ymed = "";

        if (sBudg_Gubn == "10") {
        
            if (sMnth >= "01" && sMnth <= "03") {
                sBudg_Ymst = sYear + "01";
                sBudg_Ymed = sYear + "03";
            } else if (sMnth >= "04" && sMnth <= "06") {
                sBudg_Ymst = sYear + "04";
                sBudg_Ymed = sYear + "06";
            } else if (sMnth >= "07" && sMnth <= "09") {
                sBudg_Ymst = sYear + "07";
                sBudg_Ymed = sYear + "09";
            } else {
                sBudg_Ymst = sYear + "10";
                sBudg_Ymed = sYear + "12";
            }
        }       
        
        // 예산잔액 조회
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        sReturnString += " SLIP_DATE="  + this.fnc_Quote(sSlip_Date); //전표일자(예산 기준일자로 사용)
        sReturnString += " ACCT_UNIT="  + this.fnc_Quote(this.fnc_Trim(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "ACCT_UNIT")));
        sReturnString += " BDSB_CODE="  + this.fnc_Quote(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iNtRow, "BDSB_CODE"))); //예산과목
        sReturnString += " CSTC_CODE="  + this.fnc_Quote(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iNtRow, "CSTC_CODE"))); //코스트센터
        sReturnString += " BUDG_GUBN="  + this.fnc_Quote(sBudg_Gubn);
        sReturnString += " BUDG_YMST="  + this.fnc_Quote(sBudg_Ymst);
        sReturnString += " BUDG_YMED="  + this.fnc_Quote(sBudg_Ymed);
        
    } else if (sKind == "SEARCH16") {
    
        // 마감여부 조회
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        sReturnString += " SLIP_GUBN="  + this.fnc_Quote(this.fnc_Trim(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_GUBN"))); //전표유형
        sReturnString += " SLIP_DATE="  + this.sCHEK_CLDT; //마감체크할 전표일자
        
    } else if (sKind == "SEARCH17") {
		
		var iAcctRow 	= this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(iNtRow, "ACCT_INTL"));
        var sCost_Gubn 	= this.dsTA_ACCTXM.getColumn(iAcctRow, "COST_GUBN");
        
        // 귀속부서별, 계정의 원가구분별 매핑되는 코스트센터 조회
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        sReturnString += " SLIP_DATE="  + this.fnc_Quote(this.fnc_Trim(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE")));
        sReturnString += " DEPT_CODE="  + this.fnc_Quote(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iNtRow, "USEX_DEPT")));
        sReturnString += " COST_GUBN="  + this.fnc_Quote(sCost_Gubn);	//계정의 원가구분

    } else if (sKind == "SAVE00") {
    
        // 저장 Argument 생성
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        
    } else if (sKind == "APPRPROC00") {
    
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME);
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        sReturnString += " ACCT_DATE="  + this.fnc_Quote(this.calACCT_DATE1.value); 
        sReturnString += " SLIP_NUMB="  + this.fnc_Quote(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_NUMB")); //전표번호
    
    } else if (sKind == "APPRPROC01") {
    
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind);
        sReturnString += " ACCT_DATE="  + this.fnc_Quote(this.calACCT_DATE1.value); 
        sReturnString += " SLIP_NUMB="  + this.fnc_Quote(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_NUMB")); //전표번호
    
    } else if (sKind == "SAVE99") {
        
        // 전자결재 연동자료 저장
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        sReturnString += " GWAP_EMPL="  + this.fnc_Quote(application.GBL_EMPLNO);	//사원번호(결재요청자)
        sReturnString += " GWAP_DEPT="  + this.fnc_Quote(application.GBL_DEPTCD);	//부서코드(신청자)
        
        var sGwap_Subj = "[" + this.mskSLIP_NUMB.text + "] 회계전표";
        
        sReturnString += " GWAP_SUBJ="  + this.fnc_Quote(sGwap_Subj);	//전자결재제목
        
    } else if (sKind == "PRINT00") {    
        // 인쇄
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        sReturnString += " SLIP_DATE="  + this.fnc_Quote(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE")); //전표일자
        sReturnString += " SLIP_LIST="  + this.fnc_Quote(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_NUMB")); //전표번호
    
    } else if (sKind == "PRINT02") {
    
        // 인쇄(증빙항목)
        sReturnString  = " pgm="        + this.fnc_Quote(this.sPACKAGENAME); 
        sReturnString += " action="     + this.fnc_Quote(sKind); 
        sReturnString += " SLIP_DATE="  + this.fnc_Quote(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE")); //전표일자
        sReturnString += " SLIP_NUMB="  + this.fnc_Quote(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_NUMB")); //전표번호
        sReturnString += " USERLAVEL="  + this.fnc_Quote(this.sUSERLAVEL);
        sReturnString += " DEPT_CODE="  + this.fnc_Quote(application.GBL_DEPTCD);
        sReturnString += " EMPL_NUMB="  + this.fnc_Quote(application.GBL_EMPLNO);
        sReturnString += " GW_DOCUNO="  + this.fnc_Quote(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "GW_DOCUNO"));
    
    }

    return sReturnString;
    // 생성된 String 반환
}

/*----------------------------------------------------------------+
 |  Transaction 후 처리 해야 할 내용!  |
 +-----------------------------------------------------------------*/
this.fn_CallBack = function (sMethodName, ErrorCode, ErrorMSG) {
    
    if (ErrorCode < 0) {
        if (application.GBL_SESSONCHK == "E0001") {
            this.fnc_ErrorProcess(ErrorCode, ErrorMSG);
        } else {
            this.fnc_Message("SERVERMSG", ErrorMSG);
        }
        
        // 전표일자 마감된 경우
        if (sMethodName == "SEARCH16") this.bSLIP_CLOS = true;
        
    } else {
        this.fn_PostProcess(sMethodName);
    }
    
}

/*----------------------------------------------------------------+
 |  Transaction 후 Post Process!       |
 +-----------------------------------------------------------------*/
this.fn_PostProcess = function (sMethodName) {
    
    //trace(" =====>>> fn_PostProcess : " + sMethodName);
    // 일반 조회
    if (sMethodName == "SEARCH00")  {
        
        if (this.dsTA_SLIPXM.rowcount == 0) this.fnc_DatasetClear("dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM"); 
        
        this.fnc_Information(this.stInformation, this.dsTA_SLIPNT.rowcount, "SHR"); //조회 후 실행 해야 할 이후 작업이 있다면 여기에 기술한다.
        this.fnc_Message("TMM018", this.dsTA_SLIPXM.rowcount);
        
        this.fn_SlipAmnt_Changeed(); //차/대변 합계금액 계산
        
        //전표종류가 입력시점에 필터링 되어 있을수 있어 필터를 해제한다.
        this.dsSLIP_GUBN.filter("");
        
        if (this.cmbCURR_GUBN.value == "KRW") { // 대한민국     
            this.fnc_SetReadonly(this.mskEXCH_RATE, true);
        } else {
            this.fnc_SetReadonly(this.mskEXCH_RATE, false);
        }
        
        this.fn_SetMask_ForiAmt();
        
        
		var iRow = this.dsTA_SLIPNT.findRowExpr("SLIP_NUMB=='" + this.aKeyValue[0] + "' && SLIP_LINE=='" + this.aKeyValue[1] + "'");
		
 		if (iRow < 0) iRow = 0;
 		
 		this.grdTA_SLIPNT.selectRow(iRow);
 		this.dsTA_SLIPNT.set_rowposition(iRow);
 		
		this.aKeyValue[0] = "";
		this.aKeyValue[1] = "";
		this.aKeyValue[2] = "";		
		
        //alert(iRow);
        //this.dsTA_SLIPNT_onrowposchanged();
        
    } else if (sMethodName == "SEARCH01") {
        
        this.dsTA_SLIPNT_onrowposchanged();
    
    } else if (sMethodName == "PRINT00") {
	
		if (this.dsTA_SLIPXM_RPT.rowcount == 0) return;
        
    //계정코드
    } else if (sMethodName == "SEARCH10") {
    
    //계정코드 관리항목
    } else if (sMethodName == "SEARCH11") {
    
    //발생전표 관리항목
    } else if (sMethodName == "SEARCH13") {
        
        this.fn_Osli_Cond_Code_Copy();
        
    // 기준환율 조회 후 처리
    } else if (sMethodName == "SEARCH14") {     
        
    // 예산잔액 조회 후 처리
    } else if (sMethodName == "SEARCH15") {
        
    // 일자별 마감 조회 후 처리
    } else if (sMethodName == "SEARCH16") {
        
        this.bSLIP_CLOS = false;
        
    // 귀속부서별, 계정의 원가구분별 매핑되는 코스트센터 조회
    } else if (sMethodName == "SEARCH17") {
		
    } else if (sMethodName == "SAVE00") {
    
        this.mskSHRSLIP_NUMB.set_value(this.sSLIP_NUMB);
        this.fnc_Message("TMM103"); //정상 종료 Message

        if (this.fnc_Length(this.fnc_Trim(this.sSLIP_NUMB)) > 0) this.fn_Search();
	
	// 전자결재 연동자료 저장
    } else if (sMethodName == "SAVE99") {
    	
		this.dsTA_SLIPXM.setColumn(this.dsTA_SLIPXM.rowposition, "APPR_DOCN", this.sAPPR_DOCN);
		this.dsTA_SLIPXM.applyChange();
		
		this.sAPPR_GUBN = "createDoc";
		this.fn_GwApprProcess(this.sAPPR_GUBN);
	
	// 전자결재 GW 전송
    } else if (sMethodName == "sendApproval") {

		if (this.sAPPR_GUBN == "createDoc") {
			this.fnc_ShowApproval(this.sAPPR_GUBN, this.dsTM_APPROVAL.getColumn(0, "documentID"), this.dsTM_APPROVAL.getColumn(0, "documentType"));
		}
			
		this.fn_Search();
    
    } else if (sMethodName == "GetCommCode") {
    
        var arrParam = new Array();
            arrParam[0]  = "COMBO,cmbACCT_UNIT,dsACCT_UNIT,0";
            arrParam[1]  = "COMBO,cmbAPPS_CODE,dsAPPS_CODE,0";
            arrParam[2]  = "COMBO,cmbBUDG_GUBN,dsBUDG_GUBN,0";          
            arrParam[3]  = "COMBO,cmbCURR_GUBN,dsCURR_GUBN,0";
            arrParam[4]  = "COMBO,cmbEVID_DOCU,dsEVID_DOCU,0";
            arrParam[5]  = "COMBO,cmbBANK_INOU,dsBANK_INOU,0";
            arrParam[6]  = "COMBO,cmbLEDG_GUBN,dsLEDG_GUBN,0";
            arrParam[7]  = "COMBO,Tab0.TabD2.cmbVATX_GUBN,dsVATX_GUBN,0";
            arrParam[8]  = "COMBO,Tab0.TabD2.cmbVATX_TYPE,dsVATX_TYPE,0";
            arrParam[9]  = "COMBO,Tab0.TabD2.cmbPURC_GUBN,dsPURC_GUBN,0";
            arrParam[10] = "COMBO,Tab0.TabD2.cmbBULG_GUBN,dsBULG_GUBN,0";
            arrParam[11] = "COMBO,Tab0.TabD2.cmbEBIL_GUBN,dsEBIL_GUBN,0";
            arrParam[12] = "GRID,Tab0.TabD1.grdTA_SLIPRF,dsINPT_GUBN,INPT_GUBN";
            arrParam[13] = "GRID,Tab0.TabD1.grdTA_SLIPRF,dsDRCR_YSNO,DRCR_YSNO";
            arrParam[14] = "GRID,grdTA_SLIPNT,dsEVID_DOCU,EVID_DOCU";
        this.fnc_CommonCodeInnerBind(arrParam);
        
        //사용중인 것만 표시
        this.dsBUDG_GUBN.filter("USEX_YSNO != '0'");
        
    } else if (sMethodName == "GetUserComboCode") {
    
        var arrParam = new Array();
            arrParam[0] = "COMBO,cmbSLIP_GUBN,dsSLIP_GUBN,0";
        this.fnc_UserComboInnerBind(arrParam);

    }

}

/* ------------------------------------------------------------------------------------+
 |  수정 시 Key Field Disibled 처리     |
 |  전표 해더!! 상태에 따른 입력란 제어
 +-------------------------------------------------------------------------------------*/
 this.fn_KeyFieldDisible = function (obj:Dataset, e:nexacro.DSRowPosChangeEventInfo) {
	
	this.fn_SlipAmnt_Changeed();
	
	if (e.newrow < 0) return;
  
//  trace(" =============== fn_KeyFieldDisible : " + obj.name + " / " + e.newrow);
	//trace("APPS_CODE : " + this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "APPS_CODE") + " " + obj.getColumn(e.newrow, "APPR_STAT"));
  
    // 조회 결과가 없는 경우 초기화를 위해 최초 선언
    this.btnCopy.set_visible(false); 		//전표복사
    this.btn_APPRCANCEL.set_visible(false); //전표 승인/취소
    this.staACCT_DATE1.set_visible(false);
    this.calACCT_DATE1.set_visible(false);

    this.btnSendGW.set_enable(false);      //결재상신
    this.btnCancGW.set_enable(false);      //결재취소
    this.btnSearchDoc.set_enable(false);   //문서보기
    this.btnAttachDoc.set_enable(false);   //문서파일첨부
	
    //임시저장 상태 - 결재상신 가능
    if (obj.getColumn(e.newrow, "APPS_CODE") == "0" || obj.getColumn(e.newrow, "APPR_STAT") == "N") {
		
		this.btnSendGW.set_enable(true); 
    
    //결재대기 상태 - 결재취소 가능
    } else if (obj.getColumn(e.newrow, "APPS_CODE") == "1" || obj.getColumn(e.newrow, "APPR_STAT") == "T") {
	
		this.btnCancGW.set_enable(true);
	
	} else {
		
		//결재문서번호 존재 - 문서보기 가능
		if (this.fnc_Length(obj.getColumn(e.newrow, "APPR_DOCN")) > 0) {
			this.btnSearchDoc.set_enable(true);
			
			//GW 결재완료 - 문서파일첨부 가능
			if (obj.getColumn(e.newrow, "GWAP_STAT") == "Y") {
				this.btnAttachDoc.set_enable(true);
			}
		}
		
	} 
    
    this.btnPrint02.set_visible(false);     //증빙인쇄
	
    this.fnc_SetReadonly(this.calSLIP_DATE, true); //작성일자
    this.fnc_SetReadonly(this.edtTITL_NAME, true); //제목
    this.fnc_SetReadonly(this.cmbACCT_UNIT, true); //회계단위
    this.fnc_SetReadonly(this.cmbSLIP_GUBN, true); //전표종류
    this.fnc_SetReadonly(this.calACCT_DATE, true); //회계일자
    this.fnc_SetReadonly(this.grdTA_SLIPNT, true); //분개목록
    
    if (e.newrow < 0) return;
    
    /* 수기전표 신규저장 시에만 전표종류 선택 가능 */
    this.dsSLIP_GUBN.filter("");
    if (this.dsTA_SLIPXM.getRowType(e.newrow) == Dataset.ROWTYPE_INSERT) {      
        this.dsSLIP_GUBN.filter("SLIP_TYCD == 'MANU' || COMB_NAME == ''");
        this.fnc_SetReadonly(this.cmbSLIP_GUBN, false); //전표종류  
    }
    
    //수정가능하면 enablle 한다.
    if (this.fn_IsUpdateOK()) {
        
        this.fnc_SetReadonly(this.edtTITL_NAME, false); //제목
        this.fnc_SetReadonly(this.grdTA_SLIPNT, false);	//분개목록
        
		//관리자권한 - 회계일자 수정가능
        if (this.sUSERLAVEL == "1") this.fnc_SetReadonly(this.calACCT_DATE, false); //회계일자
    }
    
    if (this.sLOAD_FORM == "NEW") this.btnCopy.set_visible(true);
    
    this.fn_Search_Rate();

}

/*-----------------+
 |  팝업 Setting  |
 +-----------------*/
this.fn_HelpDialoge = function (obj, sFromDs, sOldValue, sColumnID) {

    //trace(" =============== fn_HelpDialoge : " + obj.name);
    
    var arrParam = new Array();

    if ((obj.name == "imgHelpDEPT_COD1") || (obj.name == "edtDEPT_NAM1")) {
		
        arrParam[0] = "FAM0001";
        arrParam[1] = "";
        arrParam[2] = this.fnc_Trim(this.edtDEPT_NAM1.value); 
        arrParam[3] = "Y";
        arrParam[4] = "edtDEPT_NAM1";
        arrParam[5] = "edtUSEX_DEPT,edtDEPT_NAM1";
        arrParam[6] = "0,1";
        arrParam[9] = "fn_HelpPost_DeptCode";
        
    } else if ((obj.name == "imgHelpEMPL_NUMB") || (obj.name == "edtSHREMPL_NAME")) {
   
        arrParam[0] = "FAM0011";                                
        arrParam[1] = "D%";                                      
        arrParam[2] = this.fnc_Trim(this.edtSHREMPL_NAME.value); 
        arrParam[3] = "N";                                       
        arrParam[4] = "edtSHREMPL_NAME";                         
        arrParam[5] = "edtSHREMPL_NUMB,edtSHREMPL_NAME";
        arrParam[6] = "0,1";
      
    } else if ((obj.name == "imgHelpACCT_INTL") || (obj.name == "edtACCT_NAME")) {
    
        arrParam[0] = "FAM0030"; //NDS 농심기획 전용
        arrParam[1] = this.calSLIP_DATE.value + "," + this.edtDEPT_CODE.value;	//작성부서
        arrParam[2] = this.fnc_Trim(this.edtACCT_NAME.value); 
        arrParam[3] = "Y";                                       
        arrParam[4] = "edtACCT_NAME";   
        arrParam[5] = "edtACCT_INTL,edtACCT_NAME";
        arrParam[6] = "0,1";
        arrParam[9] = "fn_HelpPost_AcctIntl";
        
    } else if ((obj.name == "imgHelpCUST_CODE") || (obj.name == "edtCUST_NAME")) {
    
        arrParam[0] = "FAM0021";                                
        arrParam[1] = "";                                      
        arrParam[2] = this.fnc_Trim(this.Tab0.TabD2.edtCUST_NAME.value); 
        arrParam[3] = "Y";
        arrParam[4] = "Tab0.TabD2.edtCUST_NAME";   
        arrParam[5] = "Tab0.TabD2.edtCUST_CODE,Tab0.TabD2.edtCUST_NAME";
        arrParam[6] = "0,1";

    } else if ((obj.name == "imgHelpBDSB_CODE") || (obj.name == "edtBDSB_NAME")) {
        
        if (this.fnc_Length(this.fnc_Trim(this.edtACCT_INTL.value)) < 1) {
            return this.fnc_CheckPostAction("TMM072", "계정과목", "", "", this.edtACCT_NAME, "");
        }
        
        arrParam[0] = "BDM0007";
        arrParam[1] = this.fnc_Trim(this.edtACCT_INTL.value);
        arrParam[2] = this.fnc_Trim(this.edtBDSB_NAME.value);
        arrParam[3] = "N";
        arrParam[4] = "edtBDSB_NAME";
        arrParam[5] = "edtBDSB_CODE,edtBDSB_NAME";
        arrParam[6] = "0,1";
        arrParam[9] = "fn_Search_BudgAmnt"; //예산잔액

    } else if ((obj.name == "imgHelpCSTC_CODE") || (obj.name == "edtCSTC_NAME")) {
		
		if (this.fnc_Length(this.fnc_Trim(this.edtUSEX_DEPT.value)) < 1) {
			return this.fnc_CheckPostAction("TMM072", "귀속부서", "", "", this.edtDEPT_NAM1, "");
		}
		
        var iAcctRow 	= this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL"));
        var sCost_Gubn 	= this.dsTA_ACCTXM.getColumn(iAcctRow, "COST_GUBN");

        if (sCost_Gubn == "10") {	//NDS 농심기획 전용
			arrParam[0] = "BDM0009";
        } else {
			arrParam[0] = "BDM0010";
        }
		
        arrParam[1] = this.calSLIP_DATE.value + ",8,8,8," + this.edtUSEX_DEPT.value;
        arrParam[2] = this.fnc_Trim(this.edtCSTC_NAME.value);
        arrParam[3] = "N";
        arrParam[4] = "edtCSTC_NAME";
        arrParam[5] = "edtCSTC_CODE,edtCSTC_NAME";
        arrParam[6] = "0,1";
        arrParam[9] = "fn_Search_BudgAmnt"; //예산잔액
         
    // 입력(관리코드등록) - 관리코드(Popup)
    } else if (obj.name == "grdTA_SLIPRF") {
        
        if (this.Tab0.TabD1.grdTA_SLIPRF.readonly == true) return;
        
        if (sColumnID == "COND_VANM" || this.fnc_getGridHelpColName(obj, sFromDs) == "COND_VANM") {
        
			var iRow = this.dsTA_SLIPRF.rowposition;
            var sComb_Idxx = this.dsTA_SLIPRF.getColumn(iRow, "COMB_IDXX");
            var sComm_Code = this.dsTA_SLIPRF.getColumn(iRow, "COMM_CODE");
            var sCond_Code = this.dsTA_SLIPRF.getColumn(iRow, "COND_CODE");
			
            if (this.fnc_Length(this.fnc_Trim(sComb_Idxx)) < 1) return;
			
            arrParam[0] = sComb_Idxx;
            arrParam[1] = (sCond_Code == "0001" || sCond_Code == "0064" ? this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL") 
																  + "," + this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL") : sComm_Code);
            arrParam[2] = "COND_VANM";
            arrParam[3] = "Y";
            arrParam[4] = "Tab0.TabD1.grdTA_SLIPRF";
            arrParam[5] = "COND_VACD,COND_VANM";
            arrParam[6] = (sCond_Code == "0001") ? "2,3" : "0,1";
            arrParam[7] = sFromDs;
            arrParam[8] = sOldValue;
            if (sCond_Code == "0001" || sCond_Code == "0064") arrParam[9] = "fn_HelpPost_Bank_Acnt";
            
        }
            
    }
    
    if (this.fnc_Length(this.fnc_Trim(arrParam)) > 0) this.fnc_HelpDialogeAction(this, obj, arrParam);
    
}

/*----------------------------------------------------------------------------------+
 |  귀속부서별 계정별로 매핑되는 코스트센터가 1개인 경우 [코드 + ',' + 명칭] 리턴	|
 +----------------------------------------------------------------------------------*/
this.fn_SetCostCenter = function () {
	
	this.sCSTC_CDNE = "";
	
    var sMethodName = "SEARCH17";
    var sInDataSet  = "";
    var sOutDataSet = "";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack", false);
    
	//trace(" <<< sCSTC_CDNE >>> " + this.sCSTC_CDNE);
	
	if (this.fnc_Length(this.fnc_Trim(this.sCSTC_CDNE)) > 0 && this.edtCSTC_NAME.readonly == false) {
		
		var arrCstc = this.fnc_Split(this.sCSTC_CDNE, ",");	//귀속부서별 계정별로 매핑되는 코스트센터가 1개인 경우 [코드 + ',' + 명칭] 리턴 
		
		this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "CSTC_CODE", arrCstc[0]);
		this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "CSTC_NAME", arrCstc[1]);

	} else {
	
		this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "CSTC_CODE", "");
		this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "CSTC_NAME", "");

	}
}

/*------------------+
 | 귀속부서 변경 시	|
 +------------------*/
this.fn_HelpPost_DeptCode = function (sRtn) {
	
	if (this.fnc_Length(this.fnc_Trim(sRtn)) < 1) return;
	var arrRtn = this.fnc_Split(sRtn, ",");
	
	this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "USEX_DEPT", arrRtn[0]);
	this.fn_SetCostCenter();	// 코스트센터 셋팅
	
}

/*----------------------+
 |  계정과목 변경 시	|
 +----------------------*/
this.fn_HelpPost_AcctIntl = function (sRtn) {
	
	if (this.fnc_Length(this.fnc_Trim(sRtn)) < 1) return;	
	var arrRtn = this.fnc_Split(sRtn, ",");

	this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL", arrRtn[0]);	
	this.fn_Acct_Intl_Changed();
	this.fn_SetCostCenter();	// 코스트센터 셋팅

}

/*--------------------------------------+
 |  금융기관, 계좌번호 관리항목 매핑	|
 +--------------------------------------*/
this.fn_HelpPost_Bank_Acnt = function (sRtn) {
	
	if (this.fnc_Length(this.fnc_Trim(sRtn)) < 1) return;
	
	var arrRtn = this.fnc_Split(sRtn, ",");
	
	var sSlip_Line = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_LINE");
			
	var iAcntRow = this.dsTA_SLIPRF.findRowExpr("SLIP_LINE == '" + sSlip_Line + "' && COND_CODE == '0064'");
	var iBankRow = this.dsTA_SLIPRF.findRowExpr("SLIP_LINE == '" + sSlip_Line + "' && COND_CODE == '0001'");
	
	this.dsTA_SLIPRF.set_enableevent(false);
	
	if (iAcntRow >= 0) {	//계좌번호 관리항목 셋팅
		this.dsTA_SLIPRF.setColumn(iAcntRow, "COND_VACD", arrRtn[0]);
		this.dsTA_SLIPRF.setColumn(iAcntRow, "COND_VANM", arrRtn[1]);
	}
	
	if (iBankRow >= 0) {	//금융기관 관리항목 셋팅
		this.dsTA_SLIPRF.setColumn(iBankRow, "COND_VACD", arrRtn[2]);
		this.dsTA_SLIPRF.setColumn(iBankRow, "COND_VANM", arrRtn[3]);
	}

	this.dsTA_SLIPRF.set_enableevent(true);
	
}

/*--------------+
 |  계정과목	|
 +--------------*/
this.fn_Search_ACCT_INTL = function () {

    this.fnc_DatasetClear("dsTA_ACCTXM");
    var sMethodName = "SEARCH10";
    var sInDataSet  = "";
    var sOutDataSet = "dsTA_ACCTXM=dsTA_ACCTXM ";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack", false);

}

/*---------------------------------------+
 |  계정과목 관리항목                  |
 +---------------------------------------*/
this.fn_Search_ACCT_COND_CODE = function () {

    this.fnc_DatasetClear("dsTA_ACCTXD");
    var sMethodName = "SEARCH11";
    var sInDataSet  = "";
    var sOutDataSet = "dsTA_ACCTXD=dsTA_ACCTXD ";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack", true);

}

/*---------------------------------------+
 |  환율정보조회                     |
 +---------------------------------------*/
this.fn_Search_Rate = function (obj) {

    if (this.dsTA_SLIPXM.rowcount == 0) return;
    if (this.fnc_IsDate(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE")) == false) return;

    this.fnc_DatasetClear("dsTA_EXRTXM");
    var sMethodName = "SEARCH14";
    var sInDataSet  = "";
    var sOutDataSet = "dsTA_EXRTXM=dsTA_EXRTXM";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack", false);
    this.grdTA_SLIPNT.setFocus();
    
}


/*--------------------------------------+
 |  예산잔액 조회
 +---------------------------------------*/
this.fn_Search_BudgAmnt = function(sResponse) {
    
    this.dsTA_SLIPNT.set_enableevent(false);
    this.dsTA_SLIPNT.set_updatecontrol(false);
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "BUDG_AMNT", "");
    this.dsTA_SLIPNT.set_updatecontrol(true);
    this.dsTA_SLIPNT.set_enableevent(true);
    
    if (this.dsTA_SLIPXM.rowcount == 0) return;
    if (this.fnc_IsDate(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE")) == false) return;
    
    var iAcctRow = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL"));
    if (this.dsTA_ACCTXM.getColumn(iAcctRow, "BUDG_YSNO") != 1) return;     // 예산 계정과목 아니면 동작하지 않는다.
    if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "CSTC_CODE"))) < 1 ) return;
    if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "BUDG_GUBN"))) < 1 ) return; 
    if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "BDSB_CODE"))) < 1 ) return;
    
    this.fnc_DatasetClear("dsBUDG_AMNT");
    var sMethodName = "SEARCH15";
    var sInDataSet  = "";
    var sOutDataSet = "dsBUDG_AMNT=dsBUDG_AMNT";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack", false);
    
    this.dsTA_SLIPNT.set_enableevent(false);
    this.dsTA_SLIPNT.set_updatecontrol(false);
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "BUDG_AMNT", nexacro.toNumber(this.dsBUDG_AMNT.getColumn(0, "BUDG_AMNT"), 0));
    this.dsTA_SLIPNT.set_updatecontrol(true);
    this.dsTA_SLIPNT.set_enableevent(true);
            
}

/*---------------------------------------+
 |  마감여부조회                     |
 +---------------------------------------*/
this.fn_Search_SLIPCLOSE = function (obj) {

    // 전표M 가 없으면 안됨
    if (this.dsTA_SLIPXM.getRowCount == 0) return;
    
    // 전표일자가 없으면 안됨
    if (this.fnc_IsDate(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE")) == false) return;

    var sMethodName = "SEARCH16";
    var sInDataSet  = "";
    var sOutDataSet = "";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack", false);
    this.edtTITL_NAME.setFocus(); 

}

/**************************************************************************************************
 *                                사용자 정의  Function 처리 부분                                  *
 ***************************************************************************************************/
/*----------------------------------------------------------------+
 |  전표세부내역 추가시 체크항목        |
 +-----------------------------------------------------------------*/
this.fn_AddRowCheck = function () {
    
    //수정가능확인한다.
    if (!this.fn_IsLineUpdateOK("INS")) {
        this.fnc_Message("TMM300", "선택한 전표는 행추가할 수 없습니다.");
        return false;
    }

    // Head Data가 없을 경우는 존재 할 수 없음
    if (this.dsTA_SLIPXM.rowcount < 1) {
        this.fnc_Message("TMM300", "입력 버튼을 먼저 선택해야 합니다.");
        return false;
    }

	if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPXM.getColumn(0, "TITL_NAME"))) < 1) {
		return this.fnc_CheckPostAction("TMM072", "제목", this.dsTA_SLIPXM, 0, this.edtTITL_NAME, "TITL_NAME");
	}
	
    return true;
    
}
/*----------------------------------------------------------------+
 |  전표세부내역 삭제시 체크항목        |
 +-----------------------------------------------------------------*/
this.fn_DelRowCheck = function (Obj) {

    //수정가능확인한다.
    if (this.fn_IsLineUpdateOK("DEL") != true) {
        this.fnc_Message("TMM300", "선택한 전표는 행삭제할 수 없습니다.");
        return false;
    }

    if (this.dsTA_SLIPNT.rowposition < 0) {
        this.fnc_Message("TMM300", "삭제할 행을 먼저 선택해야 합니다.");
        return false;
    }
    
    if (!this.fnc_Message('TMM002', "행번호:" + this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_LINE"))) {
        return false;
    }

    return true;
    
}

/*----------------------------------------------------------------+
 |  전표세부내역 행삽입시 체크항목        |
 +-----------------------------------------------------------------*/
this.fn_InsertRowCheck = function () {

    //수정가능확인한다.
    if (!this.fn_IsLineUpdateOK("INS")) {
        this.fnc_Message("TMM300", "선택한 전표는 행삽입할 수 없습니다.");
        return false;
    }

    // Head Data가 없을 경우는 존재 할 수 없음
    if (this.dsTA_SLIPXM.rowcount < 1) {
        this.fnc_Message("TMM300", "입력 버튼을 먼저 선택해야 합니다.");
        return false;
    }

    return true;
    
}

/*---------------------------------------+
 |  계정변경시 처리                    |
 +---------------------------------------*/
this.fn_Acct_Intl_Changed = function () {
    
    var iRow = this.dsTA_SLIPNT.rowposition;
    
    // 계정이 바뀐경우 원본 정보를 초기화 한다.
	this.dsTA_SLIPNT.setColumn(iRow, "CSTC_CODE", "");
	this.dsTA_SLIPNT.setColumn(iRow, "CSTC_NAME", "");
	this.dsTA_SLIPNT.setColumn(iRow, "BUDG_GUBN", "");
	this.dsTA_SLIPNT.setColumn(iRow, "BDSB_CODE", "");
	this.dsTA_SLIPNT.setColumn(iRow, "BDSB_NAME", "");
	
    this.dsTA_SLIPNT.setColumn(iRow, "CURR_GUBN", "KRW");
	this.dsTA_SLIPNT.setColumn(iRow, "EXCH_RATE", 1);
    this.dsTA_SLIPNT.setColumn(iRow, "FORI_AMNT", 0);
    this.dsTA_SLIPNT.setColumn(iRow, "SLIP_AMNT", 0);
    //this.dsTA_SLIPNT.setColumn(iRow, "REMK_NAME", "");
    this.dsTA_SLIPNT.setColumn(iRow, "EVID_DOCU", "");
    this.dsTA_SLIPNT.setColumn(iRow, "PAYX_YSNO", "0");
    this.dsTA_SLIPNT.setColumn(iRow, "PAYX_DATE", "");
    this.dsTA_SLIPNT.setColumn(iRow, "LEDG_GUBN", "");
    this.dsTA_SLIPNT.setColumn(iRow, "OSLI_NUMB", "");
    this.dsTA_SLIPNT.setColumn(iRow, "OSLI_LINE", "");
    this.dsTA_SLIPNT.setColumn(iRow, "OSLI_DISP", "");
    
    
    this.Tab0.TabD1.grdTA_SLIPRF.set_enableredraw(false);
    
    this.dsTA_SLIPRF.filter("SLIP_LINE==" + this.fnc_Quote(this.dsTA_SLIPNT.getColumn(iRow, "SLIP_LINE")));
    this.dsTA_SLIPRF.deleteAll(); 	//관리항목 삭제
    
    this.dsTA_VATXXM.deleteAll();	//부가세 삭제
    
    this.fn_SlipAmnt_Changeed();	//합계금액 처리

    var iAcctRow = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(iRow, "ACCT_INTL"));	//계정코드 확인    
    if (iAcctRow < 0) return; 		//계정코드 없으면 관리항목, 증빙세부 처리하지 않는다.
	this.dsTA_SLIPNT.setColumn(iRow, "DRCR_GUBN", this.dsTA_ACCTXM.getColumn(iAcctRow, "DRCR_GUBN") );	//차대구분 셋팅

    this.fn_dsTA_SLIPRF_Add();		//관리항목 추가
    
    this.dsTA_SLIPNT_onrowposchanged();
    
    this.Tab0.TabD1.grdTA_SLIPRF.set_enableredraw(true);
    
}

/* -----------------------------------------+
 |  계정과목 필수 사용여부 항목에 따라
 |  화면및기본값 표시
 +-----------------------------------------*/

/**************************************************************************************************
 *                                  사용자 정의  Event 처리 부분                                   *
 ***************************************************************************************************/

/*********    버튼처리  **********************************************/
/*--------------------+
 |  전표상세내역 추가 |
 +--------------------*/
this.btn_AddRow_onclick = function (obj:Button, e:nexacro.ClickEventInfo) {
    
    //trace(" ============== btn_AddRow_onclick start ");
    if (!this.fn_AddRowCheck()) return;
    
    var sSlip_Numb  = this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_NUMB");
    var sRemk_Name 	= this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "TITL_NAME");
    var sUsex_Dept 	= application.GBL_DEPTCD;
    var sDept_Name 	= application.GBL_DEPTNM;
    
    var iRow        = this.dsTA_SLIPNT.addRow();
    var iPreRow 	= iRow - 1;	//이전로우
    var sSlip_Line  = this.fn_Slip_Line_Max();
    
    this.dsTA_SLIPNT.setColumn(iRow, "CRUD_TYPE", "INS");       // CRUD TYPE(INS,UPD) 
    this.dsTA_SLIPNT.setColumn(iRow, "SLIP_NUMB", sSlip_Numb);  // 전표번호 
    this.dsTA_SLIPNT.setColumn(iRow, "SLIP_LINE", sSlip_Line);  // 전표라인번호 
    this.dsTA_SLIPNT.setColumn(iRow, "SORT_ORDR", nexacro.toNumber(sSlip_Line)); // 정렬순서 
    
    this.cmbCURR_GUBN.set_index(1); // 통화구분 
    this.mskEXCH_RATE.set_value(1); // 환율
    this.cmbCURR_GUBN_onitemchanged();  // 환율조회
    
    if (iRow > 0) {
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iPreRow, "USEX_DEPT"))) > 0) {
			sUsex_Dept = this.dsTA_SLIPNT.getColumn(iPreRow, "USEX_DEPT");
		}

		if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iPreRow, "USEX_DEPT"))) > 0) {
			sDept_Name = this.dsTA_SLIPNT.getColumn(iPreRow, "DEPT_NAME");
		}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iPreRow, "REMK_NAME"))) > 0) {
			sRemk_Name = this.dsTA_SLIPNT.getColumn(iPreRow, "REMK_NAME");
		}
    }
    
    this.dsTA_SLIPNT.setColumn(iRow, "USEX_DEPT", sUsex_Dept);	//부서
    this.dsTA_SLIPNT.setColumn(iRow, "DEPT_NAME", sDept_Name);	//부서명
    this.dsTA_SLIPNT.setColumn(iRow, "REMK_NAME", sRemk_Name);	//적요
    
    this.edtACCT_NAME.setFocus();
    
}

/*--------------------+
 |  전표상세내역 삭제 |
 +--------------------*/
this.btn_DelRow_onclick = function (obj:Button, e:nexacro.ClickEventInfo) {

    //trace(" ============== btn_DelRow_onclick start ");
    if (!this.fn_DelRowCheck()) return;

    this.dsTA_VATXXM.deleteAll();	//증빙세부 삭제
    
    
    this.dsTA_SLIPRF.deleteAll();	//관리항목 삭제
    
    //현재행이 마지막행이 아니면 삭제후에 rowposition chenge 하지 않는다.
    //그래서 삭제전에 현재행을 저장하고 삭제후에 비교한다.
    var iCurRow = this.dsTA_SLIPNT.rowposition;
    
    //선택행을 삭제한다.
    var bSucc = this.dsTA_SLIPNT.deleteRow(this.dsTA_SLIPNT.rowposition);

    trace(" ============== btn_DelRow_onclick bSucc " + bSucc);
    
    // 합계 금액을 다시 조회한다.
    this.fn_SlipAmnt_Changeed();
    
    if (iCurRow == this.dsTA_SLIPNT.rowposition) {
        this.dsTA_SLIPNT_onrowposchanged(this.dsTA_SLIPNT);
    }
    
}

/*--------------------+
 |  전표상세내역 삽입 |
 +--------------------*/
this.btn_InsertRow_onclick = function (obj:Button, e:nexacro.ClickEventInfo) {

    //trace(" ============== btn_InsertRow_onclick start ");
    if (this.dsTA_SLIPNT.rowcount == 0) {
        this.btn_AddRow_onclick(obj, e);
        return;
    }

    if (!this.fn_AddRowCheck()) return;
    
    var sSlip_Numb  = this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_NUMB");
    var sRemk_Name 	= this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "TITL_NAME");
    var sUsex_Dept 	= application.GBL_DEPTCD;
    var sDept_Name 	= application.GBL_DEPTNM;
    
    var iRow        = this.dsTA_SLIPNT.insertRow(this.dsTA_SLIPNT.rowposition);
    var iPreRow 	= iRow - 1;	//이전로우
    var sSlip_Line  = this.fn_Slip_Line_Max();
    
    this.dsTA_SLIPNT.setColumn(iRow, "CRUD_TYPE", "INS");       // CRUD TYPE(INS,UPD) 
    this.dsTA_SLIPNT.setColumn(iRow, "SLIP_NUMB", sSlip_Numb);   // 전표번호 
    this.dsTA_SLIPNT.setColumn(iRow, "SLIP_LINE", sSlip_Line);   // 전표라인번호 
    //this.dsTA_SLIPNT.setColumn(iRow, "SORT_ORDR", nexacro.toNumber(sSlip_Line)); // 정렬순서
    // 정렬순서 재계산
	for (var i = iRow; i < this.dsTA_SLIPNT.rowcount; i++) {
        this.dsTA_SLIPNT.setColumn(i, "SORT_ORDR", nexacro.toNumber(this.dsTA_SLIPNT.getColumn(i - 1, "SORT_ORDR"), 0) + 1);
	}
    
    this.cmbCURR_GUBN.set_index(1); // 통화구분 
    this.mskEXCH_RATE.set_value(1); // 환율 
    this.cmbCURR_GUBN_onitemchanged();  // 환율조회
    
    if (iRow > 0) {
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iPreRow, "USEX_DEPT"))) > 0) {
			sUsex_Dept = this.dsTA_SLIPNT.getColumn(iPreRow, "USEX_DEPT");
		}

		if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iPreRow, "USEX_DEPT"))) > 0) {
			sDept_Name = this.dsTA_SLIPNT.getColumn(iPreRow, "DEPT_NAME");
		}
		
		if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iPreRow, "REMK_NAME"))) > 0) {
			sRemk_Name = this.dsTA_SLIPNT.getColumn(iPreRow, "REMK_NAME");
		}
    }
    
    this.dsTA_SLIPNT.setColumn(iRow, "USEX_DEPT", sUsex_Dept);	//부서
    this.dsTA_SLIPNT.setColumn(iRow, "DEPT_NAME", sDept_Name);	//부서명
    this.dsTA_SLIPNT.setColumn(iRow, "REMK_NAME", sRemk_Name);	//적요
    
    this.edtACCT_NAME.setFocus();
    
}

/*--------------------+
 |  전표상세내역 복사 |
 +--------------------*/
this.btn_CopyRow_onclick = function (obj:Button, e:nexacro.ClickEventInfo) {
	
    if (this.dsTA_SLIPNT.rowcount == 0){
        this.fnc_Message("FAM004");  // 복사할 행이 없습니다. 복사할행을 선택 하시고 진행하시기 바랍니다!.
        return;
    } 
        
    var sSlip_Numb  = this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_NUMB");
    var iRow        = this.dsTA_SLIPNT.rowposition;
    var nRow        = this.dsTA_SLIPNT.addRow();       //Record Add
    var sSlip_Line  = this.fn_Slip_Line_Max();
    
    //행복사
    this.dsTA_SLIPNT.copyRow(nRow, this.dsTA_SLIPNT, iRow);
    
    //초기화
    this.dsTA_SLIPNT.setColumn(nRow, "CRUD_TYPE", "INS");       // CRUD TYPE(INS,UPD) 
    this.dsTA_SLIPNT.setColumn(nRow, "SLIP_NUMB", sSlip_Numb);  // 전표번호 
    this.dsTA_SLIPNT.setColumn(nRow, "SLIP_LINE", sSlip_Line);  // 전표라인번호 
    this.dsTA_SLIPNT.setColumn(nRow, "SORT_ORDR", nexacro.toNumber(sSlip_Line)); // 정렬순서 
    
    this.dsTA_SLIPNT.setColumn(nRow, "OSLI_DISP", "");      // 발생전표번호 + 라인번호
    this.dsTA_SLIPNT.setColumn(nRow, "OSLI_DATE", "");      // 발생전표일자
    this.dsTA_SLIPNT.setColumn(nRow, "OSLI_NUMB", "");      // 발생전표번호
    this.dsTA_SLIPNT.setColumn(nRow, "OSLI_LINE", "");      // 발생전표라인번호
    this.dsTA_SLIPNT.setColumn(nRow, "SEND_KEY1", "");      // BICNET전송키1
    this.dsTA_SLIPNT.setColumn(nRow, "SEND_KEY2", "");      // BICNET전송키2
    this.dsTA_SLIPNT.setColumn(nRow, "SLCT_CODE", "");      // 전표통제유형코드
    
    // 관리항목을 추가시킨다.
    this.fn_Acct_Intl_Changed();
    
    // 코스트센터 복사
    if (this.edtCSTC_NAME.enable && this.edtCSTC_NAME.readonly == false) {
        var sCstc_Code = this.dsTA_SLIPNT.getColumn(iRow, "CSTC_CODE");
        var sCstc_Name = this.dsTA_SLIPNT.getColumn(iRow, "CSTC_NAME");
        
        this.dsTA_SLIPNT.setColumn(nRow, "CSTC_CODE", sCstc_Code);      // 코스트센터코드
        this.dsTA_SLIPNT.setColumn(nRow, "CSTC_NAME", sCstc_Name);      // 코스트센터명
    }

    // 예산 복사
    if (this.cmbBUDG_GUBN.enable && this.cmbBUDG_GUBN.readonly == false) {
        var sBudg_Gubn = this.dsTA_SLIPNT.getColumn(iRow, "BUDG_GUBN");
        var sBdsb_Code = this.dsTA_SLIPNT.getColumn(iRow, "BDSB_CODE");
        var sBdsb_Name = this.dsTA_SLIPNT.getColumn(iRow, "BDSB_NAME");
        
        this.dsTA_SLIPNT.setColumn(nRow, "BUDG_GUBN", sBudg_Gubn);      // 예산구분
        this.dsTA_SLIPNT.setColumn(nRow, "BDSB_CODE", sBdsb_Code);      // 예산과목코드
        this.dsTA_SLIPNT.setColumn(nRow, "BDSB_NAME", sBdsb_Name);      // 예산과목명
    }
    
}

/*----------------------------------------------------------------+
 |  전표행 max 
 +-----------------------------------------------------------------*/
this.fn_Slip_Line_Max = function () {

    //trace(" ============== fn_Slip_Line_Max start "); 
    var sSlip_Line = this.dsTA_SLIPNT.getMax("SLIP_LINE");
    if (this.fnc_Length(this.fnc_Trim(sSlip_Line)) < 1) {
        sSlip_Line = "0001";
    } else {
        sSlip_Line = this.fnc_LPad(nexacro.toNumber(sSlip_Line) + 1, "0",4);
    } 

    return sSlip_Line;
    
}

/*----------------------------------------------------------------+
 |  // 합계금액처리 |
 +-----------------------------------------------------------------*/
this.fn_SlipAmnt_Changeed = function () {

    if (this.dsTA_SLIPNT.rowcount <= 0) {
        this.mskCHAX_AMNT.set_value("");
        this.mskDAEX_AMNT.set_value("");
        this.mskCHAX_DAEX.set_value("");
    } else {
        this.mskCHAX_AMNT.set_value(this.dsTA_SLIPNT.getCaseSum("DRCR_GUBN == 'D'", "SLIP_AMNT"));
        this.mskDAEX_AMNT.set_value(this.dsTA_SLIPNT.getCaseSum("DRCR_GUBN == 'C'", "SLIP_AMNT"));
        this.mskCHAX_DAEX.set_value((this.dsTA_SLIPNT.getCaseSum("DRCR_GUBN == 'D'", "SLIP_AMNT") - this.dsTA_SLIPNT.getCaseSum("DRCR_GUBN == 'C'", "SLIP_AMNT")));
    }
    
}

/*----------------------------------------------------------------+
 |  // 분개내역 변경 시 처리내역 |
 +-----------------------------------------------------------------*/
this.dsTA_SLIPNT_oncolumnchanged = function (obj:Dataset, e:nexacro.DSColChangeEventInfo) {
    
    //trace("====================================== dsTA_SLIPNT_oncolumnchanged start : " + e.columnid);
    var iSlipRow = this.dsTA_SLIPNT.rowposition;
    
    //계정코드  
    if (e.columnid == "ACCT_INTL") {

//		this.fn_Acct_Intl_Changed();
    
    } else if (e.columnid == "USEX_DEPT") {
		
// 		this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "CSTC_CODE", "");
// 		this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "CSTC_NAME", "");

    } else if (e.columnid == "DRCR_GUBN")  {
        
        //차대구분이 변경되고 발생전표번호가 있으면 발생전표를 삭제해야 한다.
        if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iSlipRow, "OSLI_NUMB"))) > 0) {
            this.btnOSLI_DEL_onclick();
        } else {
            //관리항목 필터 
            this.fn_dsTA_SLIPRF_Filter();
        }
        
        // 합계금액처리
        this.fn_SlipAmnt_Changeed();
        
        this.fn_OsilpOrBanje_Button_Visible();  //미결전표,발생전표
        
        //계정코드의 차대구분과 전표행의 차대구분이 다르면 증빙종류는 공란으로 처리한다.
        //계정코드를 확인한다.
        var iAcctRow = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(iSlipRow, "ACCT_INTL"));
        
        //계정코드 차대구분과 행의 차대구분이 다르면 증빙서류는 공란처리한다.
        if (iAcctRow >= 0) {
            if (this.dsTA_ACCTXM.getColumn(iAcctRow, "DRCR_GUBN") != this.dsTA_SLIPNT.getColumn(iSlipRow, "DRCR_GUBN") )    {
                this.dsTA_SLIPNT.setColumn(iSlipRow, "EVID_DOCU", "");

                //증빙서류가 변경되면 무조건 증빙항목은 삭제한다.
                this.dsTA_VATXXM.deleteAll();
            }   
        }   
        
        //증빙세부를 결정한다.
        this.fn_TA_VATXXM_AddOrDelete();
        
        //증빙세부를 dsiable 한다.     
        this.fn_TA_VATXXM_disable();
        
        this.dsTA_SLIPNT_onrowposchanged();
        
    } else if (e.columnid == "CSTC_CODE" || e.columnid == "BUDG_GUBN" || e.columnid == "BDSB_CODE") {
        
        this.fn_Search_BudgAmnt();  //예산잔액

    } else if (e.columnid == "SLIP_AMNT") {
    
        // 합계금액처리
        this.fn_SlipAmnt_Changeed();
        
    } else if (e.columnid == "EXCH_RATE" || e.columnid == "FORI_AMNT") {
    
        var iAmt = 0;
        //if (this.dsTA_SLIPNT.getColumn(e.row, "CURR_GUBN") != "KRW") { // 원화가 아니면
        iAmt = Math.round(obj.getColumn(e.row, "EXCH_RATE") * this.dsTA_SLIPNT.getColumn(e.row, "FORI_AMNT"));
        this.dsTA_SLIPNT.setColumn(e.row, "SLIP_AMNT", iAmt);
        
        // 합계금액처리
        this.fn_SlipAmnt_Changeed();
        //}
        
    } else if (e.columnid == "EVID_DOCU") {
    
        //증빙서류가 변경되면 무조건 증빙항목은 삭제한다.
        this.dsTA_VATXXM.deleteAll();
        
        //증빙세부를 결정한다.
        this.fn_TA_VATXXM_AddOrDelete();
                
        //증빙세부를 dsiable 한다.     
        this.fn_TA_VATXXM_disable();
    
    } else if (e.columnid == "PAYX_YSNO") {
        
        this.staPAYX_DATE.set_cssclass("styFormItemCap");
        this.staLEDG_GUBN.set_cssclass("styFormItemCap");
        
        var iAcctRow = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(e.row, "ACCT_INTL"));
        // 출납여부
        if (this.dsTA_ACCTXM.getColumn(iAcctRow, "CHUL_YSNO") == "1") {
            if (e.newvalue == "1") {
                this.staPAYX_DATE.set_cssclass("styFormItemCapBE");
                this.staLEDG_GUBN.set_cssclass("styFormItemCapBE");
            }
        }

    }
    
}

/*----------------------------------------------------------------+
 |  전표라인 이동후에 처리
 +-----------------------------------------------------------------*/
this.dsTA_SLIPNT_onrowposchanged = function (obj:Dataset, e:nexacro.DSRowPosChangeEventInfo) {

    if (this.dsTA_SLIPNT.rowposition < 0) return;
    
	//trace("================== dsTA_SLIPNT_onrowposchanged start");
    //항목전체를DISABLE 한다.
    this.fnc_SetReadonly(this.grdTA_SLIPNT, true); //분개목록
    this.fnc_SetReadonly(this.mskSORT_ORDR, true); //정렬순서
    this.fnc_SetReadonly(this.edtDEPT_NAM1, true); //귀속부서
    this.fnc_SetReadonly(this.edtACCT_NAME, true); //계정과목
    this.fnc_SetReadonly(this.rdoDRCR_GUBN, true); //계정차대구분
    this.fnc_SetReadonly(this.cmbBUDG_GUBN, true); //예산구분
    this.fnc_SetReadonly(this.edtBDSB_NAME, true); //예산과목   
    this.fnc_SetReadonly(this.edtCSTC_NAME, true); //코스트센터  
    this.fnc_SetReadonly(this.cmbCURR_GUBN, true); //통화구분
    this.fnc_SetReadonly(this.mskEXCH_RATE, true); //환율
    this.fnc_SetReadonly(this.mskFORI_AMNT, true); //외화금액
    this.fnc_SetReadonly(this.edtREMK_NAME, true); //적요
    this.fnc_SetReadonly(this.cmbEVID_DOCU, true); //증빙서류
    this.fnc_SetReadonly(this.chkPAYX_YSNO, true); //출납처리여부
    this.fnc_SetReadonly(this.calPAYX_DATE, true); //출납예정일
    this.fnc_SetReadonly(this.cmbLEDG_GUBN, true); //출납방법
    
    this.staBUDG_GUBN.set_cssclass("styFormItemCap");   //예산구분
    this.staBDSB_CODE.set_cssclass("styFormItemCap");   //예산과목
    this.staCSTC_CODE.set_cssclass("styFormItemCap");   //코스트센터
    this.staEVID_DOCU.set_cssclass("styFormItemCap");	//증빙서류
    this.staPAYX_DATE.set_cssclass("styFormItemCap");   //출납예정일
    this.staLEDG_GUBN.set_cssclass("styFormItemCap");   //출납방법
    
    this.fnc_SetReadonly(this.Tab0.TabD1.grdTA_SLIPRF, true); //관리항목
    this.Tab0.TabD1.grdTA_SLIPRF.setCellProperty("Body", this.fnc_GridColumnIndex(this.Tab0.TabD1.grdTA_SLIPRF, "COND_VANM"), "background", "");
	this.Tab0.TabD1.grdTA_SLIPRF.setCellProperty("Body", this.fnc_GridColumnIndex(this.Tab0.TabD1.grdTA_SLIPRF, "COND_VANM"), "background2", "");
	
    this.btnBUDG_LIST.set_enable(false);   //예산잔액조회
    
    if (this.dsTA_SLIPNT.rowcount == 0) return;

    this.btn_AddRow.set_enable(false);     //라인추가
    this.btn_InsertRow.set_enable(false);  //라인삽입
    this.btn_CopyRow.set_enable(false);    //라인복사
    this.btn_DelRow.set_enable(false);     //라인삭제

    //계정코드를 확인한다.
    var iAcctRow        = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL"));
    var sAcct_Drcr_Gubn = this.dsTA_ACCTXM.getColumn(iAcctRow, "DRCR_GUBN");    //계정코드 차대구분
    var sSlip_Drcr_Gubn = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "DRCR_GUBN"); //전표행 차대구분
//trace(iAcctRow + " " + sAcct_Drcr_Gubn +  " " + sSlip_Drcr_Gubn);
    //필수입력값 표시
    if (iAcctRow >= 0) {        
    
        //코스트센터사용 계정
        if (this.dsTA_ACCTXM.getColumn(iAcctRow, "CSUS_YSNO") == "1" && sAcct_Drcr_Gubn == sSlip_Drcr_Gubn) {
            this.staCSTC_CODE.set_cssclass("styFormItemCapBE"); //코스트센터
        } 
        
        //예산관련 계정
        if (this.dsTA_ACCTXM.getColumn(iAcctRow, "BUDG_YSNO") == "1" && sAcct_Drcr_Gubn == sSlip_Drcr_Gubn) {
            this.staBUDG_GUBN.set_cssclass("styFormItemCapBE"); //예산구분
            this.staBDSB_CODE.set_cssclass("styFormItemCapBE"); //예산과목
            this.btnBUDG_LIST.set_enable(true);    //예산잔액조회
        }
        
        //증빙사용계정
        if (this.dsTA_ACCTXM.getColumn(iAcctRow, "EVID_YSNO") == "1" && sAcct_Drcr_Gubn == sSlip_Drcr_Gubn) {
            this.staEVID_DOCU.set_cssclass("styFormItemCapBE"); //증빙서류
        }
        
        // 출납여부
        if (this.dsTA_ACCTXM.getColumn(iAcctRow, "CHUL_YSNO") == "1") {
            if (this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "PAYX_YSNO") == "1") {
                this.staPAYX_DATE.set_cssclass("styFormItemCapBE");
                this.staLEDG_GUBN.set_cssclass("styFormItemCapBE");
            }
        }
        
    }
   
    if (this.fn_IsLineUpdateOK("INS")) {
        this.btn_AddRow.set_enable(true);    //라인추가
        this.btn_InsertRow.set_enable(true); //라인삽입
        this.btn_CopyRow.set_enable(true);   //라인복사
        this.fnc_SetReadonly(this.grdTA_SLIPNT, false); //분개목록
    }
    
    //수정가능하면 enablle 한다.
    var sDeleGubn = this.fn_IsLineUpdateOK("DEL");
    
    if (sDeleGubn == "MOD" || sDeleGubn == true) { 
    
        if (sDeleGubn == true) this.btn_DelRow.set_enable(true); //라인삭제
		
		this.fnc_SetReadonly(this.grdTA_SLIPNT, false); //분개목록
        this.fnc_SetReadonly(this.mskSORT_ORDR, false); //정렬순서
        this.fnc_SetReadonly(this.edtDEPT_NAM1, false); //귀속부서
        this.fnc_SetReadonly(this.edtACCT_NAME, false); //계정과목
        this.fnc_SetReadonly(this.rdoDRCR_GUBN, false); //계정차대구분
        
        if (iAcctRow >= 0) {
        
            //예산관련 계정
            if (this.dsTA_ACCTXM.getColumn(iAcctRow, "BUDG_YSNO") == "1" && sAcct_Drcr_Gubn == sSlip_Drcr_Gubn) {
                this.fnc_SetReadonly(this.cmbBUDG_GUBN, false); //예산구분
                
                if (this.dsTA_SLIPNT.getRowType(this.dsTA_SLIPNT.rowposition) != Dataset.ROWTYPE_NORMAL) {
					this.cmbBUDG_GUBN.set_index(1);
				}
                this.fnc_SetReadonly(this.edtBDSB_NAME, false); //예산과목
            } else {
				this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "BUDG_GUBN", "");
				this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "BDSB_CODE", "");
				this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "BDSB_NAME", "");
            }
            
            //코스트센터사용 계정
            if (this.dsTA_ACCTXM.getColumn(iAcctRow, "CSUS_YSNO") == "1" && sAcct_Drcr_Gubn == sSlip_Drcr_Gubn) {
                this.fnc_SetReadonly(this.edtCSTC_NAME, false); //코스트센터
            } else {
				this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "CSTC_CODE", "");
				this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "CSTC_NAME", "");
            }
            
            //증빙사용계정
            if (this.dsTA_ACCTXM.getColumn(iAcctRow, "EVID_YSNO") == "1" && sAcct_Drcr_Gubn == sSlip_Drcr_Gubn) {
                this.fnc_SetReadonly(this.cmbEVID_DOCU, false); //증빙서류
            }
            
            //외화사용  
            if (this.dsTA_ACCTXM.getColumn(iAcctRow, "FNCR_YSNO") == "1") {
                this.fnc_SetReadonly(this.cmbCURR_GUBN, false); //통화구분
            }
            
        }   
    
        //this.fnc_SetReadonly(this.cmbCURR_GUBN, false); //통화구분
        //this.fnc_SetReadonly(this.mskEXCH_RATE, false); //환율
        
        if (this.cmbCURR_GUBN.value == "KRW") { // 대한민국     
            this.fnc_SetReadonly(this.mskEXCH_RATE, true);  //환율
        } else {
            this.fnc_SetReadonly(this.mskEXCH_RATE, false);
        }
        
        this.fnc_SetReadonly(this.mskFORI_AMNT, false); //외화금액
        this.fnc_SetReadonly(this.edtREMK_NAME, false); //적요
        
        this.fnc_SetReadonly(this.chkPAYX_YSNO, false); //출납처리여부
        this.fnc_SetReadonly(this.calPAYX_DATE, false); //출납예정일
        this.fnc_SetReadonly(this.cmbLEDG_GUBN, false); //출납방법
        
        this.fnc_SetReadonly(this.Tab0.TabD1.grdTA_SLIPRF, false); //관리항목
        this.Tab0.TabD1.grdTA_SLIPRF.setCellProperty("Body", this.fnc_GridColumnIndex(this.Tab0.TabD1.grdTA_SLIPRF, "COND_VANM"), "background", "#ffff95ff");
        this.Tab0.TabD1.grdTA_SLIPRF.setCellProperty("Body", this.fnc_GridColumnIndex(this.Tab0.TabD1.grdTA_SLIPRF, "COND_VANM"), "background2", "#ffff95ff");
        
    }

    this.fn_dsTA_SLIPRF_Filter();   //관리항목
    this.fn_dsTA_VATXXM_Filter();   //증빙세부
    this.fn_OsilpOrBanje_Button_Visible();  //미결전표,발생전표
    
    this.fn_Search_BudgAmnt();      //예산잔액조회
	
    //return;

}


/**************************************************************************************************
 *                                 관리항목 변경  Event 처리 부분                                   *
 ***************************************************************************************************/
this.dsTA_SLIPRF_oncolumnchanged = function (obj:Dataset, e:nexacro.DSColChangeEventInfo) {
    
    ////trace(" ================================================ dsTA_SLIPRF_oncolumnchanged srart ");
    if (e.columnid == "COND_VANM") {
        var sInpt_Gubn = this.dsTA_SLIPRF.getColumn(e.row, "INPT_GUBN");
        //팝업
        if (sInpt_Gubn == "HELP") {
            this.fn_HelpDialoge(this.Tab0.TabD1.grdTA_SLIPRF, "YES", e.oldvalue, e.columnid);
        } else  {
            this.dsTA_SLIPRF.setColumn(e.row, "COND_VACD", e.newvalue);
        }
    }

}

/*---------------------------------------+
 |  관리항목 필터                 |
 +---------------------------------------*/
this.fn_dsTA_SLIPRF_Filter = function () {

    //trace("===== fn_dsTA_SLIPRF_Filter START ======");
    //this.Tab0.TabD1.grdTA_SLIPRF.set_enableredraw(false);

    //계정코드를 확인한다.
    var iAcctRow = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL"));

    var sFilterStr = "SLIP_LINE==" + this.fnc_Quote(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_LINE"));

    //차대구분 확인한다.
    var sDRCR_GUBN = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "DRCR_GUBN");
	     

    if (this.fnc_Length(this.fnc_Trim(sDRCR_GUBN)) > 0) {
        sFilterStr += " && (DRCR_TYPE == 'A' || DRCR_TYPE == " + this.fnc_Quote(sDRCR_GUBN) + ")";
    }
    
    ////trace(this.dsTA_ACCTXD.saveXML());
    //trace("===== fn_dsTA_SLIPRF_Filter sFilterStr ====== " + sFilterStr);

    //관리항목을 필터한다.
    this.dsTA_SLIPRF.filter(sFilterStr);

	for (var i = 0; i < this.dsTA_SLIPRF.rowcount; i++) {
		this.dsTA_SLIPRF.setColumn(i, "DRCR_GUBN", sDRCR_GUBN);	//차대구분 셋팅
	}
	
    this.Tab0.TabD1.grdTA_SLIPRF.set_enableredraw(true);
    
    //this.Tab0.TabD1.grdTA_SLIPRF.setFocus();
    
    //trace("===== fn_dsTA_SLIPRF_Filter END ======");
    
}

/*---------------------------------------+
 |  관리항목 추가/삭제               |
 +---------------------------------------*/
this.fn_dsTA_SLIPRF_Add = function () {

    //trace("===== fn_dsTA_SLIPRF_AddOrDelete START ======");
    //계정코드를 확인한다.
    var iAcctRow = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL"));

    //계정코드 없으면 관리항목 처리하지 않는다.
    if (iAcctRow < 0) return;

    this.dsTA_ACCTXD.filter("ACCT_INTL==" + this.fnc_Quote(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL")));

    this.Tab0.TabD1.grdTA_SLIPRF.set_enableredraw(false);
    
    //관리항목을 추가한다.
    for (var i = 0;  i < this.dsTA_ACCTXD.rowcount; i++) {
        var iNewRow = this.dsTA_SLIPRF.addRow();
        
        this.dsTA_SLIPRF.setColumn(iNewRow, "SLIP_NUMB", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_NUMB"));
        this.dsTA_SLIPRF.setColumn(iNewRow, "SLIP_LINE", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_LINE"));
//         this.dsTA_SLIPRF.setColumn(iNewRow, "DRCR_GUBN", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "DRCR_GUBN"));	//차대구분 셋팅
// trace(">>" + this.dsTA_SLIPRF.getColumn(iNewRow, "DRCR_GUBN"));        
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_CODE", this.dsTA_ACCTXD.getColumn(i, "COND_CODE"));   //관리항목코드
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_NAME", this.dsTA_ACCTXD.getColumn(i, "COND_NAME"));   //관리항목명
        this.dsTA_SLIPRF.setColumn(iNewRow, "CODE_SEQN", this.dsTA_ACCTXD.getColumn(i, "CODE_SEQN"));   //코드순번
        this.dsTA_SLIPRF.setColumn(iNewRow, "DRCR_YSNO", this.dsTA_ACCTXD.getColumn(i, "DRCR_YSNO"));   //차대필수여부
        this.dsTA_SLIPRF.setColumn(iNewRow, "UNUS_YSNO", this.dsTA_ACCTXD.getColumn(i, "UNUS_YSNO"));   //미불사용여부
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_KIND", this.dsTA_ACCTXD.getColumn(i, "COND_KIND"));   //관리항목입력형태[COND_KIND]
        this.dsTA_SLIPRF.setColumn(iNewRow, "INPT_GUBN", this.dsTA_ACCTXD.getColumn(i, "INPT_GUBN"));   //입력구분
        this.dsTA_SLIPRF.setColumn(iNewRow, "COMB_IDXX", this.dsTA_ACCTXD.getColumn(i, "COMB_IDXX"));   //관리항목팝업콤보ID
        this.dsTA_SLIPRF.setColumn(iNewRow, "COMM_CODE", this.dsTA_ACCTXD.getColumn(i, "COMM_CODE"));   //공통코드
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_COLM", this.dsTA_ACCTXD.getColumn(i, "COND_COLM"));   //관리항목컬럼
        this.dsTA_SLIPRF.setColumn(iNewRow, "HELP_TEXT", this.dsTA_ACCTXD.getColumn(i, "HELP_TEXT"));   //도움말
        this.dsTA_SLIPRF.setColumn(iNewRow, "DRCR_TYPE", this.dsTA_ACCTXD.getColumn(i, "DRCR_TYPE"));   //관리헝목차대구분
        this.dsTA_SLIPRF.setColumn(iNewRow, "MUST_YSNO", this.dsTA_ACCTXD.getColumn(i, "MUST_YSNO"));   //관리헝목차대필수  
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_YSNO", this.dsTA_ACCTXD.getColumn(i, "COND_YSNO"));   //관리항목사용여부  
    }

    //필터해제한다.
    this.dsTA_ACCTXD.filter("");
    
    //관리항목 필터 
    this.fn_dsTA_SLIPRF_Filter();
    
    this.Tab0.TabD1.grdTA_SLIPRF.set_enableredraw(true);
    
}

/*---------------------------------------+
 |  부가세 필터                 |
 +---------------------------------------*/
this.fn_dsTA_VATXXM_Filter = function () {

    var iRow = this.dsTA_SLIPNT.rowposition;
    this.dsTA_VATXXM.filter("SLIP_LINE==" + this.fnc_Quote(this.dsTA_SLIPNT.getColumn(iRow, "SLIP_LINE")));
    this.dsTA_VATXXM.set_rowposition(0);
    
    //부가세 탭 정리한다.
    this.fn_TA_VATXXM_disable();
    
}
/*---------------------------------------+
 |  부가세 추가/삭제               |
 +---------------------------------------*/
this.fn_TA_VATXXM_AddOrDelete = function () {

    //trace("===== fn_TA_VATXXM_AddOrDelete START ======");

    //계정코드를 확인한다.
    var iAcctRow = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL"));
    
    if (iAcctRow < 0) {
        if (this.dsTA_VATXXM.rowcount > 0) {
            var iRowCnt = this.dsTA_VATXXM.deleteAll();
            //trace("===== fn_TA_VATXXM_AddOrDelete 삭제건수 : " + iRowCnt);    
        }
        return;
    }   

    var iRow        = this.dsTA_SLIPNT.rowposition;
    var sEVID_DOCU  = this.dsTA_SLIPNT.getColumn(iRow, "EVID_DOCU");
    
    //증빙이 없으면 부가세는 삭제한다.
    if (this.fnc_Length(this.fnc_Trim(sEVID_DOCU)) < 1) {
        if (this.dsTA_VATXXM.rowcount > 0) {
            var iRowCnt = this.dsTA_VATXXM.deleteAll();
            //trace("===== fn_TA_VATXXM_AddOrDelete 삭제건수 : " + iRowCnt);    
        }
        return;
    }
    
    //증빙이 있어도 계정코드 차대구분과 행의 차대구분이 다르면 부가세는 삭제한다.
    if (this.dsTA_ACCTXM.getColumn(iAcctRow, "DRCR_GUBN") != this.dsTA_SLIPNT.getColumn(iRow, "DRCR_GUBN") ) {
        if (this.dsTA_VATXXM.rowcount > 0) {
            var iRowCnt = this.dsTA_VATXXM.deleteAll();
            //trace("===== fn_TA_VATXXM_AddOrDelete 삭제건수 : " + iRowCnt);    
        }
        return;
    }
    
    //전표라인의 증빙서류가 증빙을 필요로 할때생성을 결정한다.
    var iFindRow    = this.dsEVID_DOCU.findRow("COMD_CODE", sEVID_DOCU);
    
    //증빙생성여부
    var sRef2_Fild  = this.dsEVID_DOCU.getColumn(iFindRow, "REF2_FILD");

    //증빙서류의 증빙생성여부가 0 이면 증빙세부를 삭제한다.
    if (iFindRow < 0 || sRef2_Fild != "1") {
        if (this.dsTA_VATXXM.rowcount > 0) {
            var iRowCnt = this.dsTA_VATXXM.deleteAll();
            //trace("===== fn_TA_VATXXM_AddOrDelete 삭제건수 : " + iRowCnt);    
        }
        return;
    }
    
    //증빙서류의 증빙생성여부가 1 이면 증빙세부가 없으면 부가세 행 만들어주고 진행한다.
    if (this.dsTA_VATXXM.rowcount == 0) {
        
        var iNewRow = this.dsTA_VATXXM.addRow();
        
        var sSlip_Numb = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_NUMB");
        var sSlip_Line = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_LINE");
        
        this.dsTA_VATXXM.setColumn(iNewRow, "SLIP_NUMB", sSlip_Numb);
        this.dsTA_VATXXM.setColumn(iNewRow, "SLIP_LINE", sSlip_Line);
        //this.dsTA_VATXXM.setColumn(iNewRow, "EBIL_GUBN", "0");    //전자발행여부
        
        //관리항목의 거래처값으로 셋팅한다.
        this.dsTA_SLIPRF.filter("");
        var iRfLineRow  = this.dsTA_SLIPRF.findRowExpr("SLIP_LINE == '" + sSlip_Line + "' && COND_CODE == '0002'");
        this.fn_dsTA_SLIPRF_Filter();
        
        if (iRfLineRow >= 0) {
            var sCust_Code = this.dsTA_SLIPRF.getColumn(iRfLineRow, "COND_VACD");
            var sCust_Name = this.dsTA_SLIPRF.getColumn(iRfLineRow, "COND_VANM");
            
            this.dsTA_VATXXM.setColumn(iNewRow, "CUST_CODE", sCust_Code);
            this.dsTA_VATXXM.setColumn(iNewRow, "CUST_NAME", sCust_Name);
        }
        
        this.dsTA_VATXXM.setColumn(iNewRow, "CRUD_TYPE", "INS");
        
        this.dsTA_VATXXM.rowposition = iNewRow;
        this.Tab0.TabD2.cmbEBIL_GUBN.set_index(1);
    }
    
}

/*---------------------------------------+
 |  부가세 disable                 |
 +---------------------------------------*/
this.fn_TA_VATXXM_disable = function () {

    this.fnc_SetReadonly(this.Tab0.TabD2.calTRNS_DATE, true);       //발행일자
    this.fnc_SetReadonly(this.Tab0.TabD2.mskCARD_NUMB, true);       //카드번호
    this.fnc_SetReadonly(this.Tab0.TabD2.edtCARD_APPR, true);       //카드승인번호
    this.fnc_SetReadonly(this.Tab0.TabD2.mskSUPP_AMNT, true);       //공급가액
    this.fnc_SetReadonly(this.Tab0.TabD2.mskVATX_AMNT, true);       //세액
    this.fnc_SetReadonly(this.Tab0.TabD2.mskSUMX_AMNT, true);       //합계
    this.fnc_SetReadonly(this.Tab0.TabD2.cmbEBIL_GUBN, true);       //전자발행여부
    this.fnc_SetReadonly(this.Tab0.TabD2.chkETIS_YSNO, true);       //타사이트발행여부
    this.fnc_SetReadonly(this.Tab0.TabD2.edtITEM_NAME, true);       //품목
    this.fnc_SetReadonly(this.Tab0.TabD2.edtVATX_REMK, true);       //적요
    this.fnc_SetReadonly(this.Tab0.TabD2.edtCUST_NAME, true);       //거래처
    this.Tab0.TabD2.imgHelpCUST_CODE.set_enable(false); //거래처
    this.Tab0.TabD2.imgHelpVATX_GUBN.set_enable(false); //매입매출팝업
    
    this.Tab0.TabD2.staTRNS_DATE.set_cssclass("styFormItemCap");    //발행일자
    this.Tab0.TabD2.staVATX_GUBN.set_cssclass("styFormItemCap");    //매출매입
    this.Tab0.TabD2.staVATX_TYPE.set_cssclass("styFormItemCap");    //부가세종류
    this.Tab0.TabD2.staSUPP_AMNT.set_cssclass("styFormItemCap");    //공급가액
    this.Tab0.TabD2.staVATX_AMNT.set_cssclass("styFormItemCap");    //세액
    this.Tab0.TabD2.staCUST_CODE.set_cssclass("styFormItemCap");    //거래처
    
    //전표라인의 증빙서류가 증빙자료생성여부 확인
    var iFindRow = this.dsEVID_DOCU.findRow("COMD_CODE", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "EVID_DOCU"));
    var sRef2_Fild = this.dsEVID_DOCU.getColumn(iFindRow, "REF2_FILD"); //증빙생성여부
    if (iFindRow < 0 || sRef2_Fild != "1") return;

    //계정코드의 차대구분 확인
    var iAcctRow        = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL"));
    var sAcct_Drcr_Gubn = this.dsTA_ACCTXM.getColumn(iAcctRow, "DRCR_GUBN");    //계정코드 차대구분
    var sSlip_Drcr_Gubn = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "DRCR_GUBN"); //전표행 차대구분
    if (iAcctRow < 0 || sAcct_Drcr_Gubn != sSlip_Drcr_Gubn) return;
    
    //수정가능하면 enablle 한다.
    if (this.fn_IsUpdateOK()) {
        this.fnc_SetReadonly(this.Tab0.TabD2.calTRNS_DATE, false);      //발행일자
        this.fnc_SetReadonly(this.Tab0.TabD2.mskCARD_NUMB, false);      //카드번호
        this.fnc_SetReadonly(this.Tab0.TabD2.edtCARD_APPR, false);      //카드승인번호
        this.fnc_SetReadonly(this.Tab0.TabD2.mskSUPP_AMNT, false);      //공급가액
        this.fnc_SetReadonly(this.Tab0.TabD2.mskVATX_AMNT, false);      //세액
        this.fnc_SetReadonly(this.Tab0.TabD2.cmbEBIL_GUBN, false);      //전자발행여부
        this.fnc_SetReadonly(this.Tab0.TabD2.chkETIS_YSNO, false);      //타사이트발행여부
        this.fnc_SetReadonly(this.Tab0.TabD2.edtITEM_NAME, false);      //품목
        this.fnc_SetReadonly(this.Tab0.TabD2.edtVATX_REMK, false);      //적요
        this.fnc_SetReadonly(this.Tab0.TabD2.edtCUST_NAME, false);      //거래처
        this.Tab0.TabD2.imgHelpCUST_CODE.set_enable(true);  //거래처
        this.Tab0.TabD2.imgHelpVATX_GUBN.set_enable(true);  //매입매출팝업
        
        this.Tab0.TabD2.staTRNS_DATE.set_cssclass("styFormItemCapBE");  //발행일자
        this.Tab0.TabD2.staVATX_GUBN.set_cssclass("styFormItemCapBE");  //매출매입
        this.Tab0.TabD2.staVATX_TYPE.set_cssclass("styFormItemCapBE");  //부가세종류
        this.Tab0.TabD2.staSUPP_AMNT.set_cssclass("styFormItemCapBE");  //공급가액
        this.Tab0.TabD2.staVATX_AMNT.set_cssclass("styFormItemCapBE");  //세액
        this.Tab0.TabD2.staCUST_CODE.set_cssclass("styFormItemCapBE");  //거래처
    }
    
}

/*---------------------------------------+
 | 발생, 미결조회버튼                 |
 +---------------------------------------*/
this.fn_OsilpOrBanje_Button_Visible = function () {

    //trace("===== fn_OsilpOrBanje_Button_Visible START ======");
    
    var iSlipRow = this.dsTA_SLIPNT.rowposition;
    
    //일단 버튼은 모두 숨긴다.
    this.mskOSLI_DISP.set_visible(false);   //발생번호
    this.staOSLI_DISP.set_visible(false);   //발생번호
    
    this.btnBanje.set_visible(false);       //미결전표조회
    this.btnOSLI_NUMB.set_visible(false);   //발생전표조회
    this.btnOSLI_DELE.set_visible(false);   //발생전표삭제

    //계정코드를 확인한다.
    if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(iSlipRow, "ACCT_INTL"))) < 1) return;

    //계정코드를 찾는다.
    var iFindRow = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(iSlipRow, "ACCT_INTL"));
    
    if (iFindRow < 0) return;
    
    var sSlip_Drcr_Gubn = this.dsTA_SLIPNT.getColumn(iSlipRow, "DRCR_GUBN");
    var sGunb_Ysno      = this.dsTA_ACCTXM.getColumn(iFindRow, "GUNB_YSNO");
    var sAcct_Drcr_Gubn = this.dsTA_ACCTXM.getColumn(iFindRow, "DRCR_GUBN");
    
    //건별미결가 아니면 적용하지 않는다.
    if (sGunb_Ysno != "1") return;

    //전표행 차대구분이 공란이면 처리하지 않는다.
    if (this.fnc_Length(this.fnc_Trim(sSlip_Drcr_Gubn)) < 1) return;
    
    //계정코드 차대구분과 전표의 차대구분이 같으면 미결전표조회 버튼을 보여준다
    if (sAcct_Drcr_Gubn == sSlip_Drcr_Gubn) { 
    
        //현재행이 작업중이 아니면 보여준다.
        if (this.dsTA_SLIPNT.getRowType(this.dsTA_SLIPNT.rowposition) == Dataset.ROWTYPE_NORMAL) {
            this.btnBanje.set_visible(true);
        }   
    
    //아니면 발생전표 버튼을 보여준다.
    } else {

        this.staOSLI_DISP.set_visible(true);    //발생번호
        this.mskOSLI_DISP.set_visible(true);    //발생번호
        
        //수정가능여부를 확인한다.
        if (this.fn_IsUpdateOK()) { 
            this.btnOSLI_NUMB.set_visible(true);    //발생전표조회
            this.btnOSLI_DELE.set_visible(true);    //발생전표삭제
        }
    }
    
    return;
        
}

/*---------------------------------------+
 | 수정가능 여부확인                 |
 +---------------------------------------*/
this.fn_IsUpdateOK = function () {

    //전표호출이 조회이면 수정 못한다.
    if (this.sLOAD_FORM == "SHR") return false;

    //결재상태 확인한다.
    var sApps_Code = this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "APPS_CODE");
    
    //전표유형에 따른 전표수정범위
    var sSlip_Gubn = this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_GUBN");

    if (this.fnc_Length(this.fnc_Trim(sSlip_Gubn)) > 0) {
        var iFindRow    = this.dsSLIP_GUBN.findRow("COMB_CODE", sSlip_Gubn);
        var sSlmd_Rgcd  = this.fn_getSlmd_Rgcd();   //전표수정범위
        
        if (sSlmd_Rgcd != "ALL") {// && this.sLOAD_FORM == "NEW") { 
            return false;
        } else {
			this.btnCopy.set_visible(true); 		//전표복사
        }
    }

    if (this.fnc_Length(this.fnc_Trim(sApps_Code)) > 0) {
        var iFindRow = this.dsAPPS_CODE.findRow("COMD_CODE", sApps_Code);
        
        //수정가능여부
        if (this.dsAPPS_CODE.getColumn(iFindRow, "REF1_FILD") == "0") {         
            return false;
        }
        
        //if (sApps_Code == "X") return true; //작성오류는 삭제 가능해야함
    }

    return true;
    
}

/*---------------------------------------+
 | 전표세부 라인추가 가능 여부확인       |
 +---------------------------------------*/
this.fn_IsLineUpdateOK = function (sEditGubn) {
    
    //전표호출이 조회이면 수정 못한다.
    if (this.sLOAD_FORM == "SHR") return false;
    
    //결재상태 확인한다.
    var sApps_Code = this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "APPS_CODE");
    
    if (this.fnc_Length(this.fnc_Trim(sApps_Code)) > 0) {
        var iFindRow = this.dsAPPS_CODE.findRow("COMD_CODE", sApps_Code);
        
        //수정가능여부
        if (this.dsAPPS_CODE.getColumn(iFindRow, "REF1_FILD") == "0") {         
            return false;
        }   
    }

    var sSlmd_Rgcd = this.fn_getSlmd_Rgcd();    //전표수정범위
    var sSlct_Code = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLCT_CODE"); //전표통제유형코드
    
    //수정범위가 전체 NON 이면 무조건 수정불가
    if (sSlmd_Rgcd == "NON") {
        return false;
    }
    
    if (sEditGubn == "DEL") {
		if (this.fnc_Length(this.fnc_Trim(sSlct_Code)) > 0) {
			if (sSlmd_Rgcd == "MOD") { //행추가 및 변경 가능. (행삭제 불가)
				return "MOD";
			} else if (sSlmd_Rgcd == "ADD") {	//행추가 만 가능. (행삭제, 데이터 수정 불가)
				return false;
			}
		}
    }
    
    return true;
    
}

/**************************************************************************************************
 *                                 관리항목 변경  Event 처리 부분                                   *
 ***************************************************************************************************/
/*------------------------------------------+
 |  전표 복사 클릭 時  |
 +------------------------------------------*/
this.btnCopy_onclick = function (obj:Button, e:nexacro.ClickEventInfo) {

    // 복사할내역이 없을때
    if (this.dsTA_SLIPXM.rowcount < 1) {
        this.fnc_Message("TMM125", "복사할 전표내역이 없습니다.");
        return;
    }
    
    // 전표번호가 신규이면 안됨
    if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_NUMB"))) < 1) {
        this.fnc_Message("TMM125", "신규전표는 복사할수 없습니다.");
        return;
    }
    
    if (this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "AUTO_YSNO") != "0") {
        this.fnc_Message("TMM125", "자동전표는 복사할수 없습니다.");
        return;
    }
    
	this.popSlip_Copy.trackPopupByComponent(this.btnCopy, 0, 0);
    this.popSlip_Copy.calCopy_SLIP_DATE.setFocus();
    this.popSlip_Copy.calCopy_SLIP_DATE.set_value(this.fnc_GetServerDateTime("DATE"));
    
}

/*------------------------------------------+
 | 발생전표
 +------------------------------------------*/
this.btnOSLI_NUMB_onclick = function (obj:Button, e:nexacro.ClickEventInfo) {

    // 이전발생전표가 존재하면 발생번호삭제를 먼저해야한다.
    if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "OSLI_NUMB"))) > 0) {
        this.fnc_Message("TMM300", "발생번호삭제를 먼저해야 합니다.");
        this.btnOSLI_DELE.setFocus();
        return;
    }
    
    var sOpenStyle  = "modeless=false";   //Open Sytle(되도록 Modal 사용)
        sOpenStyle += ",autosize=true";   //Autosize true면 width, Height 안먹음
        sOpenStyle += ",top=-1";          //원하는 위치(단 -1은 소유창의 Middle)
        sOpenStyle += ",left=-1";         //원하는 위치(단 -1은 소유창의 Center)
        sOpenStyle += ",width=800";       //현재 반응 없음
        sOpenStyle += ",height=500";      //현재 반응 없음
        sOpenStyle += ",title=true";      //Form Title Bar Visible 여부
        sOpenStyle += ",titletext=";      //Form Title여부
        sOpenStyle += ",status=false";    //Form Title Bar Visible 여부
        sOpenStyle += ",resizable=true";  //Form Title Bar Visible 여부

    var iRow = this.dsTA_SLIPNT.rowposition;
    var sAcct_Unit = this.cmbACCT_UNIT.value;   
    var sAcct_Intl = this.dsTA_SLIPNT.getColumn(iRow, "ACCT_INTL");
    var sAcct_Name = this.dsTA_SLIPNT.getColumn(iRow, "ACCT_NAME");
    var sSlip_Numb = this.dsTA_SLIPNT.getColumn(iRow, "SLIP_NUMB");
    var sSlip_Line = this.dsTA_SLIPNT.getColumn(iRow, "SLIP_LINE");
    var sUnus_Ysno = "1";

    var iFindRow = this.dsTA_ACCTXD.findRowExpr("ACCT_INTL=='" + sAcct_Intl + "' && UNUS_YSNO=='" + sUnus_Ysno + "'");
	
    var sCond_Code = this.dsTA_ACCTXD.getColumn(iFindRow, "COND_CODE");
     
    this.fnc_OpenPopup("FAMB0030P02", "fam::FAMB0030P02.xfdl"
		, {  sACCT_UNIT : sAcct_Unit
			,sACCT_INTL : sAcct_Intl
			,sACCT_NAME : sAcct_Name
			,sSLIP_NUMB : sSlip_Numb
			,sSLIP_LINE : sSlip_Line
			,sCOND_CODE : sCond_Code }, sOpenStyle, "fn_OSLI_NUMB_After"); 
			
}

/*------------------------------------------+
 | 발생전표 팝업 Callback
 +------------------------------------------*/
this.fn_OSLI_NUMB_After = function(sPopupId, Variant) {

    var rtn = this.fnc_GetPopupRtn();

    //선택건이 없으면 처리하지 않는다.
    if (rtn == null) return;

    //trace("====fn_OSLI_NUMB_After ==== rtn " + rtn);
    
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "OSLI_NUMB", rtn[0]);  //발생전표번호
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "OSLI_LINE", rtn[1]);  //발생전표라인번호
    
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "SLIP_AMNT", rtn[10]); //전표금액(잔액)
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "CURR_GUBN", rtn[6]);  //통화
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "EXCH_RATE", rtn[7]);  //환율
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "FORI_AMNT", rtn[10]); //외화금액(잔액)
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "REMK_NAME", rtn[9]);  //적요
    
    this.mskOSLI_DISP.set_value(rtn[2]);    //발생전표라인번호
    
    var sSlip_Numb = rtn[3]; //현재전표번호
    var sSlip_Line = rtn[4]; //현재전표라인번호
    
    //선택된 행의 관리항목을 삭제한다.
    var sFilterStr = "SLIP_LINE==" + this.fnc_Quote(sSlip_Line);
    
    //trace("===== fn_OSLI_NUMB_After sFilterStr ====== " + sFilterStr);

    //관리항목을 필터한다.
    this.dsTA_SLIPRF.filter(sFilterStr);
    this.dsTA_SLIPRF.deleteAll();
    
    //발생전표의 관리항목을 가져온다.
    var sMethodName = "SEARCH13";
    var sInDataSet  = "";
    var sOutDataSet = "dsTA_SLIPRF2=dsTA_SLIPRF2";
    var sArgument   = this.fn_CreateArgument(sMethodName);
		sArgument  += " SLIP_NUMB=" + this.fnc_Quote(sSlip_Numb); //현재전표번호
		sArgument  += " SLIP_LINE=" + this.fnc_Quote(sSlip_Line); //현재전표라인번호

    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack", false);

}   

/*------------------------------------------+
 | 발생전표 관리항목 복사
 +------------------------------------------*/
this.fn_Osli_Cond_Code_Copy = function() {

    //관리항목을 추가한다.
    for (var i = 0;  i < this.dsTA_SLIPRF2.rowcount; i++) {
        var iNewRow = this.dsTA_SLIPRF.addRow();
        
        this.dsTA_SLIPRF.setColumn(iNewRow, "SLIP_NUMB", this.dsTA_SLIPRF2.getColumn(i, "SLIP_NUMB"));
        this.dsTA_SLIPRF.setColumn(iNewRow, "SLIP_LINE", this.dsTA_SLIPRF2.getColumn(i, "SLIP_LINE"));
        
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_CODE", this.dsTA_SLIPRF2.getColumn(i, "COND_CODE"));  //관리항목코드
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_NAME", this.dsTA_SLIPRF2.getColumn(i, "COND_NAME"));  //관리항목명
        this.dsTA_SLIPRF.setColumn(iNewRow, "CODE_SEQN", this.dsTA_SLIPRF2.getColumn(i, "CODE_SEQN"));  //코드순번
        this.dsTA_SLIPRF.setColumn(iNewRow, "DRCR_YSNO", this.dsTA_SLIPRF2.getColumn(i, "DRCR_YSNO"));  //차대필수여부
        this.dsTA_SLIPRF.setColumn(iNewRow, "UNUS_YSNO", this.dsTA_SLIPRF2.getColumn(i, "UNUS_YSNO"));  //미불사용여부
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_KIND", this.dsTA_SLIPRF2.getColumn(i, "COND_KIND"));  //관리항목입력형태[COND_KIND]
        this.dsTA_SLIPRF.setColumn(iNewRow, "INPT_GUBN", this.dsTA_SLIPRF2.getColumn(i, "INPT_GUBN"));  //입력구분
        this.dsTA_SLIPRF.setColumn(iNewRow, "COMB_IDXX", this.dsTA_SLIPRF2.getColumn(i, "COMB_IDXX"));  //관리항목팝업콤보ID
        this.dsTA_SLIPRF.setColumn(iNewRow, "COMM_CODE", this.dsTA_SLIPRF2.getColumn(i, "COMM_CODE"));  //공통코드
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_COLM", this.dsTA_SLIPRF2.getColumn(i, "COND_COLM"));  //관리항목컬럼
        this.dsTA_SLIPRF.setColumn(iNewRow, "HELP_TEXT", this.dsTA_SLIPRF2.getColumn(i, "HELP_TEXT"));  //도움말
        this.dsTA_SLIPRF.setColumn(iNewRow, "DRCR_TYPE", this.dsTA_SLIPRF2.getColumn(i, "DRCR_TYPE"));  //관리헝목차대구분
        this.dsTA_SLIPRF.setColumn(iNewRow, "MUST_YSNO", this.dsTA_SLIPRF2.getColumn(i, "MUST_YSNO"));  //관리헝목차대필수
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_YSNO", this.dsTA_SLIPRF2.getColumn(i, "COND_YSNO"));  //관리항목사용여부
        
        this.dsTA_SLIPRF.set_enableevent(false);
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_VACD", this.dsTA_SLIPRF2.getColumn(i, "COND_VACD"));
        this.dsTA_SLIPRF.setColumn(iNewRow, "COND_VANM", this.dsTA_SLIPRF2.getColumn(i, "COND_VANM"));
        this.dsTA_SLIPRF.set_enableevent(true);
    }

    //관리항목 필터 
    this.fn_dsTA_SLIPRF_Filter();
    
}   

/*---------------------------------------+
 | 발생전표 취소                 |
 +---------------------------------------*/
this.btnOSLI_DEL_onclick = function (obj:Button, e:nexacro.ClickEventInfo) {

    //trace("===============>>>btnOSLI_DEL_onclick");
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "OSLI_NUMB", "");
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "OSLI_LINE", "");
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "OSLI_DISP", "");
    
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "SLIP_AMNT", 0);   //전표금액
    //this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "CURR_GUBN", "");    //통화
    this.cmbCURR_GUBN.set_index(1);
    
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "EXCH_RATE", 1);   //환율
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "FORI_AMNT", 0);   //외화금액
    this.dsTA_SLIPNT.setColumn(this.dsTA_SLIPNT.rowposition, "REMK_NAME", "");  //적요
    
    var sFilterStr = "SLIP_LINE==" + this.fnc_Quote(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_LINE"));
    
    //trace("===== btnOSLI_DEL_onclick sFilterStr ====== " + sFilterStr);

    //관리항목을 필터한다.
    this.dsTA_SLIPRF.filter(sFilterStr);
    this.dsTA_SLIPRF.deleteAll();
    
    //관리항목 추가한다.
    this.fn_dsTA_SLIPRF_Add();
    
}

/*---------------------------------------+
 | 상계전표 조회
 +---------------------------------------*/
this.btnBanje_onclick = function (obj:Button, e:nexacro.ClickEventInfo) {

    // 현재행이 수정중이면 조회 할 수 없다.
    if (this.dsTA_SLIPNT.getRowType(this.dsTA_SLIPNT.rowposition) != Dataset.ROWTYPE_NORMAL ) {
        this.fnc_Message("TMM300", "작업중인 행의 미결전표는 조회 할수 없습니다."); //Message 처리
        return;
    }
    
    var sOpenStyle  = "modeless=false";   //Open Sytle(되도록 Modal 사용)
        sOpenStyle += ",autosize=true";   //Autosize true면 width, Height 안먹음
        sOpenStyle += ",top=-1";          //원하는 위치(단 -1은 소유창의 Middle)
        sOpenStyle += ",left=-1";         //원하는 위치(단 -1은 소유창의 Center)
        sOpenStyle += ",width=900";       //현재 반응 없음
        sOpenStyle += ",height=500";      //현재 반응 없음
        sOpenStyle += ",title=true";      //Form Title Bar Visible 여부
        sOpenStyle += ",titletext=";      //Form Title여부
        sOpenStyle += ",status=false";    //Form Title Bar Visible 여부
        sOpenStyle += ",resizable=true";  //Form Title Bar Visible 여부
        
    this.fnc_OpenPopup("FAMB0030P03", "fam::FAMB0030P03.xfdl", {sSHRDISP_NUMB:this.mskSHRSLIP_NUMB.value
															   ,sSLIP_LINE:this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_LINE")
															   }, sOpenStyle, "fn_popupAfter3");
        
}


// 추가버튼에서 엔터시 로우 생성
this.btn_AddRow_OnKeyDown = function (obj:Button, e:nexacro.KeyEventInfo) {
    
    if (e.keycode == 13) this.btn_AddRow_onclick(obj); //dsTA_SLIPXD 초기화
    
}



/*===============================================================
 승인 처리 / 취소
 2014-11-03 : 버튼 합침
 ===============================================================*/
this.btn_APPRCANCEL_onclick = function (obj:Button, e:nexacro.ClickEventInfo) {
    
    var sProcType 	= "";
    var sMethodName = "";
    if (this.btn_APPRCANCEL.text == "승인처리") {
        sProcType 	= "PROC";
        sMethodName = "APPRPROC00";
    } else {
        sProcType 	= "CANCEL";
        sMethodName = "APPRPROC01";
    }

    if (!this.fn_APPRCheck(sProcType)) return;
    
    this.gRow = this.dsTA_SLIPXM.rowposition;

    // var sMethodName = "APPRPROC01";                        //서버에서 호출 될 Method 명
    var sInDataSet  = "dsTA_SLIPXM=dsTA_SLIPXM:A";
    var sOutDataSet = "";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");
    this.grdTA_SLIPNT.setFocus();
    
}

/*===============================================================
 승인 체크
 ===============================================================*/
this.fn_APPRCheck = function (sMode) {
    
    // 2014-12-10 : 마감 체크 필요
    if (sMode == "PROC") {
        // 승인 처리 시
        if (this.fnc_IsDate(this.calACCT_DATE1.value) == false) {
            this.fnc_Message("TMM072", "정확한 회계처리일");
            this.calACCT_DATE1.setFocus(); //예산년도 항목으로 Focus
            return false;
        }


        // 처리된건에 대해서는 등록할수 없다.
        for (var i = 0; i < this.dsTA_SLIPXM.rowcount; i++) {
            // 직접 결재시 상태 값을 바꾸지 않는다.
            if (this.fnc_Length(this.dsTA_SLIPXM.getColumn(i, "ACCT_DATE")) == 8) {
                // dsTA_SLIPXM.getColumn(i,'GW_STATUS') == 'GO030006' &&
                this.fnc_Message("TMM125", "승인된 전표는 처리할수 없습니다.");
                this.dsTA_SLIPXM.set_rowposition(i);
                return false;
            }

            if (this.dsTA_SLIPXM.getColumn(i, "GW_STATUS") == "GO030090") {
                this.fnc_Message("TMM125", "임시전표는 처리할수 없습니다.");
                this.dsTA_SLIPXM.set_rowposition(i);
                return false;
            }
            
            // HDJ 2012.06.07 - 승인처리시에도 차대변 금액을 체크하도록 수정
            if (this.dsTA_SLIPXM.getColumn(i, "CHAX_AMNT") != this.dsTA_SLIPXM.getColumn(i, "DAEX_AMNT")) {
                this.fnc_Message("TMM125", "차대변 금액이 맞지 않습니다."); //Message 처리
                this.dsTA_SLIPXM.set_rowposition(i);
                return false;
            }
        }

        if (!this.fnc_Message("M1091", "승인")) return false;
        
    } else {
        // 처리된건에 대해서는 등록할수 없다.
        for (var i = 0; i < this.dsTA_SLIPXM.rowcount; i++) {
            // 직접 결재시 상태 값을 바꾸지 않는다.
            if (this.fnc_Length(this.dsTA_SLIPXM.getColumn(i, "ACCT_DATE")) != 8) {
                // dsTA_SLIPXM.getColumn(i,'GW_STATUS') != 'GO030006' && g
                this.fnc_Message("TMM125", "승인처리 자료만 취소 가능합니다.");
                this.dsTA_SLIPXM.set_rowposition(i);
                return false;
            }
        }

        if (!this.fnc_Message("M1091", "승인취소")) return false;
        
    }

    return true;
    
}

this.btnPrint02_onclick = function (obj:Button, e:nexacro.ClickEventInfo) {
    
    // 인쇄 자료 체크
    if (this.dsTA_SLIPXM.rowcount < 0) {
        this.fnc_Message("TMM011");
        return;
    }

    // 해당 Row가 있는지 확인
    if (this.dsTA_SLIPXM.rowposition < 0) {
        this.fnc_Message("HR1033", "인쇄 할 데이터");
        return;
    }

    this.dsTA_SLIPNT_RT2.clearData(); //증빙서 - 분개내역
    this.dsTA_SLIPFILE.clearData(); //증빙서 - 증빙내역

    var sMethodName = "PRINT02";
    var sInDataSet  = "";
    var sOutDataSet = "dsTA_SLIPXM_RPT=dsTA_SLIPXM_RPT dsTA_SLIPNT_RT2=dsTA_SLIPNT_RT2 dsTA_SLIPFILE=dsTA_SLIPFILE";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");
    this.grdTA_SLIPNT.setFocus();
}

// 그리드의 스타일 재지정
this.fn_grdTA_SLIPRF_ReSetting = function () {

    //trace("================== fn_grdTA_SLIPRF_ReSetting start ");
    var obj = this.Tab0.TabD1.grdTA_SLIPRF;

    obj.setCellProperty("Body", this.fnc_GridColumnIndex(obj, "COND_VANM"), "background", "#ffff95ff");
    obj.setCellProperty("Body", this.fnc_GridColumnIndex(obj, "COND_VANM"), "background2", "#ffff95ff");
    
}

/*--------------------------------------+
 |  전표번호 팝업 호출 후 데이터 바인딩  |
 +---------------------------------------*/
this.fn_SlipDialoge = function (obj) {

    if (this.fnc_DatasetChangeCheck("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM")) {   
        if (!this.fnc_Message("TMM023")) return false;
    }
	
	
    this.fnc_DatasetClear("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM"); 
    
    var sOpenStyle  = "modeless=false";   //Open Sytle(되도록 Modal 사용)
        sOpenStyle += ",autosize=true";   //Autosize true면 width, Height 안먹음
        sOpenStyle += ",top=-1";          //원하는 위치(단 -1은 소유창의 Middle)
        sOpenStyle += ",left=-1";         //원하는 위치(단 -1은 소유창의 Center)
        sOpenStyle += ",width=800";       //현재 반응 없음
        sOpenStyle += ",height=500";      //현재 반응 없음
        sOpenStyle += ",title=true";      //Form Title Bar Visible 여부
        sOpenStyle += ",titletext=";      //Form Title여부
        sOpenStyle += ",status=false";    //Form Title Bar Visible 여부
        sOpenStyle += ",resizable=true";  //Form Title Bar Visible 여부
	
	this.mskSHRSLIP_NUMB.setFocus();
	this.calSHRSLIP_DATE.setFocus();
	
    this.fnc_OpenPopup("FAMB0030P01", "fam::FAMB0030P01.xfdl", {sSHRSLIP_DATE:this.calSHRSLIP_DATE.value
                                                               ,sSHRSLIP_USERID:(application.GBL_EMPLNO)
                                                               ,sSHRSLIP_USERNM:(application.GBL_USERNM)
                                                               ,sSHRSLIP_DEPTCD:(application.GBL_DEPTCD)
                                                               ,sSHRSLIP_DEPTNM:(application.GBL_DEPTNM)
                                                               ,sPARENT_USERLAVEL:this.sUSERLAVEL}, sOpenStyle, "fn_SlipDialoge_After");                                                               
    
}

/*--------------------------------------+
 |  부가세증빙종류 |
 +---------------------------------------*/
this.fn_VatDialoge = function (obj) {

    var sOpenStyle  = "modeless=false";   //Open Sytle(되도록 Modal 사용)
        sOpenStyle += ",autosize=true";   //Autosize true면 width, Height 안먹음
        sOpenStyle += ",top=-1";          //원하는 위치(단 -1은 소유창의 Middle)
        sOpenStyle += ",left=-1";         //원하는 위치(단 -1은 소유창의 Center)
        sOpenStyle += ",width=800";       //현재 반응 없음
        sOpenStyle += ",height=500";      //현재 반응 없음
        sOpenStyle += ",title=true";      //Form Title Bar Visible 여부
        sOpenStyle += ",titletext=";      //Form Title여부
        sOpenStyle += ",status=false";    //Form Title Bar Visible 여부
        sOpenStyle += ",resizable=true";  //Form Title Bar Visible 여부
    
    var sEVID_DOCU= this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "EVID_DOCU");
    var sVATX_GUBN= this.Tab0.TabD2.cmbVATX_GUBN.value;
    
    this.fnc_OpenPopup("FAMB0030P05", "fam::FAMB0030P05.xfdl", { sEVID_DOCU:sEVID_DOCU, sVATX_GUBN:sVATX_GUBN }, sOpenStyle, "fn_VatDialoge_After");    
    
}

/*--------------------------------------+
 |  전표팝업 Callback                       |
 +--------------------------------------*/
this.fn_SlipDialoge_After = function(sPopupId, Variant) {

    var rtn = this.fnc_GetPopupRtn();

    if (this.fnc_Length(rtn) > 0) {
        this.mskSHRSLIP_NUMB.set_value(rtn);
        this.fn_Search();
    }   

}

/*--------------------------------------+
 |  증빙서류팝업 Callback                       |
 +--------------------------------------*/
this.fn_VatDialoge_After = function(sPopupId, Variant) {

    var rtn = this.fnc_GetPopupRtn();
    
    if (!(rtn instanceof Array)) return;
    
    var iRow = this.dsTA_VATXXM.rowposition;
    this.dsTA_VATXXM.setColumn(iRow, "VATX_GUBN", rtn[1]);
    this.dsTA_VATXXM.setColumn(iRow, "VATX_TYPE", rtn[2]);
    this.dsTA_VATXXM.setColumn(iRow, "BULG_GUBN", rtn[3]);
    this.dsTA_VATXXM.setColumn(iRow, "PURC_GUBN", rtn[4]);

	var e = new nexacro.DSColChangeEventInfo();
	e.columnid = "VATX_TYPE";
	e.row =	this.dsTA_VATXXM.rowposition;
	this.dsTA_VATXXM_oncolumnchanged(this.dsTA_VATXXM, e);
	
}

/*--------------------------------------+
 |  증빙세부 컬럼 변경             
 +---------------------------------------*/
this.dsTA_VATXXM_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo) {
    
    //trace("====================================== dsTA_VATXXM_oncolumnchanged start : " + e.columnid);
    //공급가액
    if (e.columnid == "SUPP_AMNT" || e.columnid == "VATX_TYPE") {
    
		//과세의 경우 세액 자동계산
		if (obj.getColumn(e.row, "VATX_TYPE") == "FA210010") {
			var iSupp_Amnt = obj.getColumn(e.row, "SUPP_AMNT");
			var iVatx_Amnt = Math.floor(iSupp_Amnt * 0.1);
			obj.setColumn(e.row, "VATX_AMNT", iVatx_Amnt);
		}
		
        this.fn_Sumx_Amnt(e.row);
        
    //부가세
    } else if (e.columnid == "VATX_AMNT") {
        this.fn_Sumx_Amnt(e.row);
    }
    
}

/*--------------------------------------+
 |  증빙세부 합계             
 +---------------------------------------*/
this.fn_Sumx_Amnt = function(iRow) {
    
    var iSupp_Amnt = nexacro.toNumber(this.dsTA_VATXXM.getColumn(iRow, "SUPP_AMNT"),0);
    var iVatx_Amnt = nexacro.toNumber(this.dsTA_VATXXM.getColumn(iRow, "VATX_AMNT"),0);
    
    this.dsTA_VATXXM.setColumn(iRow, "SUMX_AMNT", iSupp_Amnt + iVatx_Amnt); 
    
}

/*--------------------------------------+
 |  예산잔액조회 팝업
 +---------------------------------------*/
this.btnBUDG_LIST_onclick = function(obj:Button,  e:nexacro.ClickEventInfo) {

    var iAcctRow = this.dsTA_ACCTXM.findRow("ACCT_INTL", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "ACCT_INTL"));
    if (this.dsTA_ACCTXM.getColumn(iAcctRow, "BUDG_YSNO") != 1) {
        this.fnc_Message("TMM300", "예산 계정과목이 아닙니다."); 
        return;     // 예산 계정과목 아니면 동작하지 않는다.
    }
    
    if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "CSTC_CODE"))) < 1 ) {
        return this.fnc_CheckPostAction("TMM072", "코스트센터", "", "", this.edtCSTC_NAME, "");
    }

    if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "BUDG_GUBN"))) < 1 ) {
        return this.fnc_CheckPostAction("TMM072", "예산구분", "", "", this.cmbBUDG_GUBN, "");
    }
    
    if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "BDSB_CODE"))) < 1 ) {
        return this.fnc_CheckPostAction("TMM072", "예산과목", "", "", this.edtBDSB_NAME, "");
    }   
    
    var sName       = "FAMB0030P04";
    var sFormURL    = "fam::FAMB0030P04.xfdl";
    var sOpenStyle  = "modeless=false";
        sOpenStyle += ",autosize=true";
        sOpenStyle += ",top=-1";
        sOpenStyle += ",left=-1";
        sOpenStyle += ",width=1051";
        sOpenStyle += ",height=834";
        sOpenStyle += ",title=true";
        sOpenStyle += ",status=false";
        sOpenStyle += ",resizable=true";

    var objArgumentList = {
             sSLIP_NUMB : this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_NUMB")
            ,sSLIP_LINE : this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "SLIP_LINE")
            ,sSLIP_DATE : this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE")
            ,sACCT_UNIT : this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "ACCT_UNIT")
            ,sBUDG_GUBN : this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "BUDG_GUBN")
            ,sBDSB_CODE : this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "BDSB_CODE")
            ,sBDSB_NAME : this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "BDSB_NAME")
            ,sCSTC_CODE : this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "CSTC_CODE")
            ,sCSTC_NAME : this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "CSTC_NAME")
            
    };
                
    this.fnc_OpenPopup(sName, sFormURL, objArgumentList, sOpenStyle);
    
}

/*--------------------------------------+
 |  화폐_통화 변경시
 +---------------------------------------*/
this.cmbCURR_GUBN_onitemchanged = function(obj:Combo, e:nexacro.ItemChangeEventInfo) {

    //trace("cmbCURR_GUBN_onitemchanged :: " + this.cmbCURR_GUBN.value);
    if (this.cmbCURR_GUBN.value == "KRW") { // 대한민국
        
        this.mskEXCH_RATE.set_value("1");
        this.fnc_SetReadonly(this.mskEXCH_RATE, true);
        
        this.mskFORI_AMNT.setFocus();
        
    } else {
        
        var sRate = this.dsTA_EXRTXM.getColumn(this.dsTA_EXRTXM.findRow("CURR_GUBN", this.cmbCURR_GUBN.value), "STND_RATE");
        this.mskEXCH_RATE.set_value(sRate);
        this.fnc_SetReadonly(this.mskEXCH_RATE, false);
        
        this.mskEXCH_RATE.setFocus();
        
    }
    
    this.fn_SetMask_ForiAmt();

}

/*--------------------------------------+
 |  통화금액 소수점 자릿수 셋팅
 +---------------------------------------*/
this.fn_SetMask_ForiAmt = function() {
    
    var iCurrRow = this.dsCURR_GUBN.findRow("COMD_CODE", this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "CURR_GUBN"));
    var iMaskNum = nexacro.toNumber(this.dsCURR_GUBN.getColumn(iCurrRow, "REF3_FILD"), 0);
    
    var sMask = "###,###";
    for (var i = 0; i < iMaskNum; i++) {
        if (i == 0) sMask = sMask + "." + "#";
        else sMask = sMask + "#";
    }
    
    this.mskFORI_AMNT.set_mask(sMask);
    
}

/*----------------------------+
 |  전표일자 변경  
 +----------------------------*/
this.calSLIP_DATE_onchanged = function(obj:Calendar, e:nexacro.ChangeEventInfo) {
    
    // 마감여부 확인
    this.sCHEK_CLDT = obj.value;
    this.fn_Search_SLIPCLOSE();
    
    if (this.bSLIP_CLOS == true) {
        this.calSLIP_DATE.set_value("");
        return;
    }

    this.fn_Search_Rate();
    
}

/*--------------------------------------+
 |  전표복사처리
 +---------------------------------------*/
this.popSlip_Copy_btnCopyPROC_onclick = function(obj:Button,  e:nexacro.ClickEventInfo) {
    
    var sSlip_Date		= this.popSlip_Copy.calCopy_SLIP_DATE.value;
    var tmpSlip_Date    = "";
    
    if (this.fnc_IsDate(this.popSlip_Copy.calCopy_SLIP_DATE.value) == false) {
        this.fnc_CheckPostAction("TMM072", "정확한 전표일자", "", "", this.popSlip_Copy.calCopy_SLIP_DATE, "");
        this.btnCopy_onclick();
		return;
    }

    // 마감여부 확인 -> 2012-11-15 : 복사대상일로 체크토록 변경!
    tmpSlip_Date    = this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE");
    this.dsTA_SLIPXM.setColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE", sSlip_Date);
    
    // 마감여부 확인
    this.sCHEK_CLDT = this.popSlip_Copy.calCopy_SLIP_DATE.value;
    this.fn_Search_SLIPCLOSE();

    if (this.bSLIP_CLOS == true) {
        this.dsTA_SLIPXM.setColumn(this.dsTA_SLIPXM.rowposition, "SLIP_DATE", tmpSlip_Date);
        this.btnCopy_onclick();
        this.popSlip_Copy.calCopy_SLIP_DATE.setFocus();
        return;
    }
    
    
    this.dsTA_SLIPNT.set_rowposition(-1);
    
    //======================================
    // 전표세부
    //======================================
    for (var i = 0; i < this.dsTA_SLIPNT.rowcount; i++) {
    
        this.dsTA_SLIPNT.set_rowposition(i);
        
        this.dsTA_SLIPNT.setColumn(i, "CRUD_TYPE", "INS");  //CRUD TYPE(INS,UPD)
        this.dsTA_SLIPNT.setColumn(i, "SLIP_NUMB", "");     //전표번호
        this.dsTA_SLIPNT.setColumn(i, "TRNS_DATE", "");     //부가세 발행일자
        this.dsTA_SLIPNT.setColumn(i, "SUPP_AMNT", "");     //공급가액
        this.dsTA_SLIPNT.setColumn(i, "VATX_AMNT", "");     //세액
        
        this.dsTA_SLIPNT.setColumn(i, "OSLI_DISP", "");     //발생전표번호 + 라인번호
        this.dsTA_SLIPNT.setColumn(i, "OSLI_DATE", "");     //발생전표일자
        this.dsTA_SLIPNT.setColumn(i, "OSLI_NUMB", "");     //발생전표번호
        this.dsTA_SLIPNT.setColumn(i, "OSLI_LINE", "");     //발생전표라인번호
        this.dsTA_SLIPNT.setColumn(i, "SEND_KEY1", "");     //BICNET전송키1
        this.dsTA_SLIPNT.setColumn(i, "SEND_KEY2", "");     //BICNET전송키2
		
        // 입력 상태 강제 변경
        // 크게 감쌀경우 정상동작않는다.
        this.dsTA_SLIPNT.set_updatecontrol(false);
        this.dsTA_SLIPNT.setRowType(i, Dataset.ROWTYPE_INSERT);
        this.dsTA_SLIPNT.set_updatecontrol(true);
        
        //======================================
        // 관리항목
        //======================================
        this.dsTA_SLIPRF.filter("");
        for (var j = 0; j < this.dsTA_SLIPRF.rowcount; j++) {
            
            this.dsTA_SLIPRF.setColumn(j, "CRUD_TYPE", "INS");
            this.dsTA_SLIPRF.setColumn(j, "SLIP_NUMB", "");     // 전표번호

            // 2015.03.09.PIH : 공급일자(0045), 과세표준(0049)은 복사하지 않는다! OMA
//             if (this.dsTA_SLIPRF.getColumn(j, "COND_CODE") == "0045" || this.dsTA_SLIPRF.getColumn(j, "COND_CODE") == "0049") {
//                 this.dsTA_SLIPRF.setColumn(j, "COND_VACD", "");
//                 this.dsTA_SLIPRF.setColumn(j, "COND_VANM", "");
//             }
            
            // 입력 상태 강제 변경
            if (this.fnc_Length(this.fnc_Trim(this.dsTA_SLIPRF.getColumn(j, "COND_CODE"))) > 0) {
				this.dsTA_SLIPRF.set_updatecontrol(false);
				this.dsTA_SLIPRF.setRowType(j, Dataset.ROWTYPE_INSERT);
				this.dsTA_SLIPRF.set_updatecontrol(true);
			} else {
				this.dsTA_SLIPRF.set_updatecontrol(false);
				this.dsTA_SLIPRF.setRowType(j, Dataset.ROWTYPE_NORMAL);
				this.dsTA_SLIPRF.set_updatecontrol(true);
			}
            
        }
        this.fn_dsTA_SLIPRF_Filter();
        
        //======================================
        // 증빙항목
        //======================================
        this.dsTA_VATXXM.filter("");
        for (var j = 0; j < this.dsTA_VATXXM.rowcount; j++) {
        
            this.dsTA_VATXXM.set_rowposition(j);
            
            this.dsTA_VATXXM.setColumn(j, "CRUD_TYPE", "INS");      //CRUD TYPE(INS,UPD)
            this.dsTA_VATXXM.setColumn(j, "VATX_SEQN", "");             //부가세일련번호
            this.dsTA_VATXXM.setColumn(j, "SLIP_NUMB", "");             //전표번호
            
            // 입력 상태 강제 변경
            this.dsTA_VATXXM.set_updatecontrol(false);
            this.dsTA_VATXXM.setRowType(j, Dataset.ROWTYPE_INSERT);
            this.dsTA_VATXXM.set_updatecontrol(true);

        }
        this.fn_dsTA_VATXXM_Filter();
        
    }
    
    //======================================
    // 전표마스터
    //======================================
    for (var i = 0; i < this.dsTA_SLIPXM.rowcount; i++) {
        // 초기화 대상 자료 정리
        this.dsTA_SLIPXM.setColumn(i, "CRUD_TYPE", "INS");          //CRUD_TYPE
        this.dsTA_SLIPXM.setColumn(i, "SLIP_NUMB", "");             //전표번호
        this.dsTA_SLIPXM.setColumn(i, "DISP_NUMB", "");             //전표표시번호    
        
        this.dsTA_SLIPXM.setColumn(i, "SLIP_DATE", sSlip_Date);    	//전표일자 
        this.calSHRSLIP_DATE.set_value(sSlip_Date);
        this.dsTA_SLIPXM.setColumn(i, "ACCT_DATE",  "");            //회계일자
        this.dsTA_SLIPXM.setColumn(i, "APPR_EMPL",  "");            //승인자
        this.dsTA_SLIPXM.setColumn(i, "APPR_EMNM",  "");            //승인자
        
        this.dsTA_SLIPXM.setColumn(i, "EMPL_NUMB", application.GBL_EMPLNO);     //발행자
        this.dsTA_SLIPXM.setColumn(i, "EMPL_NAME", application.GBL_USERNM);     //발행자명
        this.dsTA_SLIPXM.setColumn(i, "DEPT_CODE", application.GBL_DEPTCD);     //부서
        this.dsTA_SLIPXM.setColumn(i, "DEPT_NAME", application.GBL_DEPTNM);     //부서명
        this.dsTA_SLIPXM.setColumn(i, "ACCT_GUBN", application.GBL_ACCT_GUBN);  //사업장
        this.dsTA_SLIPXM.setColumn(i, "AUTO_YSNO", "0");                        //자동전표여부
        
        this.cmbACCT_UNIT.set_index(1);     //회계단위
        this.cmbSLIP_GUBN.set_index(1);     //전표종류
        this.cmbAPPS_CODE.set_index(1);     //결재상태
        
        // 입력 상태 강제 변경
        this.dsTA_SLIPXM.set_updatecontrol(false);
        this.dsTA_SLIPXM.setRowType(i, Dataset.ROWTYPE_INSERT);
        this.dsTA_SLIPXM.set_updatecontrol(true);
        
        this.dsTA_SLIPXM.set_rowposition(-1);
        this.dsTA_SLIPXM.set_rowposition(i);
    }
    
    this.dsTA_SLIPNT.set_rowposition(-1);
    this.dsTA_SLIPNT.set_rowposition(0);

    this.popSlip_Copy_btn_CopyCancel_onclick();
    
    this.edtTITL_NAME.setFocus();
    
}

/*--------------------------------------+
 |  전표복사 취소
 +---------------------------------------*/
this.popSlip_Copy_btn_CopyCancel_onclick = function(obj:Button,  e:nexacro.ClickEventInfo) {
    
    this.popSlip_Copy.calCopy_SLIP_DATE.set_value("");
    this.popSlip_Copy.closePopup();
    
}

/*--------------------------------------+
 |  전표 수정범위 값 리턴
 +---------------------------------------*/
this.fn_getSlmd_Rgcd = function () {
    var sSlip_Gubn = this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "SLIP_GUBN");
    var sSlmd_Rgcd = "";
    
    if (this.fnc_Length(this.fnc_Trim(sSlip_Gubn)) > 0) {
        var iFindRow    = this.dsSLIP_GUBN.findRow("COMB_CODE", sSlip_Gubn);    
        sSlmd_Rgcd      = this.dsSLIP_GUBN.getColumn(iFindRow, "SLMD_RGCD");    //수정범위
    }
    
    return sSlmd_Rgcd;
}

/*--------------------------------------+
 |  결재상신 버튼 클릭 시
 +---------------------------------------*/
this.btnSendGW_onclick = function(obj:Button,  e:nexacro.ClickEventInfo) {
	
	if (this.dsTA_SLIPXM.rowcount < 1) return;
	
	if (this.fnc_DatasetChangeCheck("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM")) {
		return this.fnc_Message("TMM015", "결재상신");
	}
	
	if (!this.fnc_Message("TMM061", "전자결재 상신")) return false;
    
	this.sAPPR_GUBN = "createDoc";
	
	this.dsTA_SLIPXM.set_updatecontrol(false);
	this.dsTA_SLIPXM.setColumn(this.dsTA_SLIPXM.rowposition, "DOCU_IDXX", this.sDOCU_IDXX);
	this.dsTA_SLIPXM.set_updatecontrol(true);
	
	//전자결재 연동자료 저장
    var sMethodName = "SAVE99";
    var sInDataSet  = "dsTA_SLIPXM=dsTA_SLIPXM:A";
    var sOutDataSet = "";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");
    
}

/*--------------------------------------+
 |  결재취소 버튼 클릭 시
 +---------------------------------------*/
this.btnCancGW_onclick = function(obj:Button,  e:nexacro.ClickEventInfo) {
	
	if (this.dsTA_SLIPXM.rowcount < 1) return;
	
	if (this.fnc_DatasetChangeCheck("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM")) {
		return this.fnc_Message("TMM015", "상신취소");
	}
	
	if (!this.fnc_Message("TMM061", "전자결재 상신취소")) return false;
	
	this.sAPPR_GUBN = "deleteDoc";
	this.fn_GwApprProcess(this.sAPPR_GUBN);
	
}

/*--------------------------------------+
 |  문서보기 클릭 시
 +---------------------------------------*/
this.btnSearchDoc_onclick = function(obj:Button,  e:nexacro.ClickEventInfo) {
// this.fn_MakeHtml();
// 	return;
	if (this.dsTA_SLIPXM.rowcount < 1) return;
	
	this.sAPPR_GUBN = "show";
	var bPerm = (this.sUSERLAVEL == "5") ? false : true;
	this.fnc_ShowApproval(this.sAPPR_GUBN, this.sDOCU_IDXX + "-" + this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "APPR_DOCN"), "", bPerm);
	
}

/*--------------------------------------+
 |  문서파일첨부 클릭 시
 +---------------------------------------*/
this.btnAttachDoc_onclick = function(obj:Button,  e:nexacro.ClickEventInfo) {
	
	if (this.dsTA_SLIPXM.rowcount < 1) return;
	
	this.sAPPR_GUBN = "attach";
	var sUrl = this.fnc_ShowApproval(this.sAPPR_GUBN, this.sDOCU_IDXX + "-" + this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "APPR_DOCN"), this.sDOCU_IDXX);
	
	this.edtURL.set_value(sUrl);
	
}

/*--------------------------------------+
 |  전자결재상신/취소
 +---------------------------------------*/
this.fn_GwApprProcess = function(sApprGubn) {
	
	if (!this.fn_GwApprCheck(sApprGubn)) return;
	
	var sMethodName = "sendApproval";
	var sInDataSet 	= "dsTM_APPROVAL=dsTM_APPROVAL:U"
	var sOutDataSet = "";
	var sArgument	= this.fn_CreateArgument(sMethodName);
	this.fnc_TransactionCall(this, "gw", sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack");
	
}

/*---------------------------+
 |  전자결재상신/취소 체크!  |
 +---------------------------*/
this.fn_GwApprCheck = function (sApprGubn) {
	
    if (this.dsTA_SLIPXM.rowcount < 1) return this.fnc_Message("TMM011");
	if (this.dsTA_SLIPXM.rowposition < 0) return false;

	if (this.fnc_DatasetChangeCheck("dsTA_SLIPXM,dsTA_SLIPNT,dsTA_SLIPRF,dsTA_VATXXM")) {
		return this.fnc_Message("TMM015", "결재상신");
	}
    
    var sAppr_Docn 	= this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "APPR_DOCN");
    var sSubject 	= "[" + this.mskSLIP_NUMB.text + "] " + this.dsTA_SLIPXM.getColumn(this.dsTA_SLIPXM.rowposition, "TITL_NAME"); 						
	var sApprDocId	= this.sDOCU_IDXX + "-" + sAppr_Docn; //DOCU_IDXX - APPR_DOCN
	
	if (this.fnc_Length(this.fnc_Trim(sAppr_Docn)) < 1) {
		return this.fnc_Message("TMM300", "전자결재문서번호가 없습니다.");
	}
	
    var sXmlStr = this.fn_MakeHtml();	//전자결재용 HTML 생성
    //return false;
	this.fnc_DatasetClear("dsTM_APPROVAL");
	
	var iRow = this.dsTM_APPROVAL.addRow();		
	this.dsTM_APPROVAL.setColumn(iRow, "documentID", sApprDocId);				//문서번호
	this.dsTM_APPROVAL.setColumn(iRow, "documentType", this.sDOCU_IDXX);		//문서종류(결재문서 ID)
	this.dsTM_APPROVAL.setColumn(iRow, "HtmlDocument", sXmlStr);				//결재문서에 그릴 HTML
	this.dsTM_APPROVAL.setColumn(iRow, "subject", sSubject);					//결재문서 제목
	this.dsTM_APPROVAL.setColumn(iRow, "recipient", application.GBL_EMPLNO);	//기안자사번
	this.dsTM_APPROVAL.setColumn(iRow, "creator", application.GBL_USERNM);		//기안자성명
	this.dsTM_APPROVAL.setColumn(iRow, "documentStatus", sApprGubn);			//결재문서 생성:createDoc, 기안대기문서 삭제:deleteDoc
	this.dsTM_APPROVAL.setColumn(iRow, "isUsedFile", "F");						//첨부파일여부
	
	return true;
	
}

/*--------------------------------------+
 |  전자결재용 HTML 생성
 +---------------------------------------*/
this.fn_MakeHtml = function () {
	
    this.fnc_DatasetClear("dsTA_SLIPXM_RPT,dsTA_SLIPNT_RPT");
    var sMethodName = "PRINT00";
    var sInDataSet  = "";
    var sOutDataSet = "dsTA_SLIPXM_RPT=dsTA_SLIPXM_RPT dsTA_SLIPNT_RPT=dsTA_SLIPNT_RPT";
    var sArgument   = this.fn_CreateArgument(sMethodName);
    this.fnc_TransactionCall(this, this.sPACKAGENAME, sMethodName, sInDataSet, sOutDataSet, sArgument, "fn_CallBack", false);
    
	
	var t_head		= " border-top: 2px solid; border-left: 2px solid; border-bottom: 2px solid; background-color:#cccccc; font-weight:bold;";
	var t_head1		= " border-top: 2px solid; border-left: 1px solid; border-bottom: 2px solid; background-color:#cccccc; font-weight:bold;";
	var t_head2		= " border-top: 2px solid; border-left: 2px solid; border-bottom: 2px solid; border-right: 2px solid; background-color:#cccccc; font-weight:bold;";
	
	var t_b			= " font-weight:bold;";
	var f11			= " font-size:11px;";
	var fem			= " font-size:0.75em;";
	var f14			= " font-size:14px; font-weight:bold;";
	var t_bg_c		= " background-color:#cccccc; ";
	
	var t_line_l	= " border-left: 1px solid;";
	var t_line_l2  	= " border-left: 2px solid;";
	var t_line_lb	= " border-left: 1px solid; border-bottom: 1px solid;";
	var t_line_lb2	= " border-left: 1px solid; border-bottom: 2px solid;";
	var t_line_lbr2	= " border-left: 1px solid; border-bottom: 1px solid; border-right: 2px solid;";
	var t_line_lb2r2 = " border-left: 1px solid; border-bottom: 2px solid; border-right: 2px solid;";
	var t_line_l2b	= " border-left: 2px solid; border-bottom: 1px solid;";
	var t_line_l2b2	= " border-left: 2px solid; border-bottom: 2px solid;";
	var t_line_lr2	= " border-left: 1px solid; border-right: 2px solid;";
	var t_line_b2r2	= " border-bottom: 2px solid; border-right: 2px solid;";
	var t_line_l2b2r2	= " border-left: 2px solid; border-bottom: 2px solid; border-right: 2px solid;";
	
	var t_ta_ct		= " text-align:center;";
	var t_ta_rt		= " text-align:right;";
	var t_pd_a3		= " padding:3px;";
	
	var sXmlStr = "";
	
	sXmlStr  = "<work_item work_item_code ='001' work_item_name ='본문내용'>";
	sXmlStr += "<![CDATA[";

	sXmlStr += "\n";
	sXmlStr += "<style>td {font-size:12px;}\n";
	sXmlStr += "</style>\n";
	
	sXmlStr += "<table width='1000px' border='0' cellspacing='0' cellpadding='0'>\n";
	sXmlStr += "  <col width='36px'>\n";
	sXmlStr += "  <col width='133px'>\n";
	sXmlStr += "  <col width='252px'>\n";
	sXmlStr += "  <col width='100px'>\n";
	sXmlStr += "  <col width='133px'>\n";
	sXmlStr += "  <col width='252px'>\n";
	sXmlStr += "  <col width='100px'>\n";

	sXmlStr += "  <tr>\n";
	sXmlStr += "    <td style='" + t_head + t_pd_a3 + t_ta_ct + "'>항순</td>\n";
	sXmlStr += "    <td colspan='3' style='" + t_head1 + t_pd_a3 + t_ta_ct + "'>차 &nbsp; &nbsp; &nbsp; &nbsp; 변</td>\n";
	sXmlStr += "    <td colspan='3' style='" + t_head2 + t_pd_a3 + t_ta_ct + "'>대 &nbsp; &nbsp; &nbsp; &nbsp; 변</td>\n";
	sXmlStr += "  </tr>\n";
	
	for (var i = 0; i < this.dsTA_SLIPNT_RPT.rowcount; i++) {
		
// 		if (i % 3 == 0) {
// 			sXmlStr += "  <div stype='page-break-befor:always;'>\n";
// 		}
		
		sXmlStr += "  <tr>\n";
		sXmlStr += "    <td rowspan='6' style='" + t_line_l2b2 + t_pd_a3 + t_ta_ct + "'>" +  this.dsTA_SLIPNT_RPT.getColumn(i, "DISP_NUMB") + "</td>\n";
		
		sXmlStr += "	<td style='" + t_line_l + t_pd_a3 + t_b + "'>" + this.dsTA_SLIPNT_RPT.getColumn(i, "ACCT_UPNMD") + "</td>\n";
		sXmlStr += "	<td style='" + t_line_lb + t_pd_a3 + "' rowspan='2' >" + this.dsTA_SLIPNT_RPT.getColumn(i,  "REMK_NAMED") + "</td>\n";
		sXmlStr += "	<td style='" + t_line_l + t_pd_a3 + t_ta_rt + "'>&nbsp;</td>\n";		// 금액은 두번째 라인에서 뿌린다.
		sXmlStr += "	<td style='" + t_line_l2 + t_pd_a3 + t_b + "'>" + this.dsTA_SLIPNT_RPT.getColumn(i, "ACCT_UPNMC") + "</td>\n";
		sXmlStr += "	<td style='" + t_line_lb + t_pd_a3 + "' rowspan='2' >" + this.dsTA_SLIPNT_RPT.getColumn(i, "REMK_NAMEC") + "</td>\n";
		sXmlStr += "	<td style='" + t_line_lr2 + t_pd_a3 + t_ta_rt + "'>&nbsp;</td>\n";
		sXmlStr += "  </tr>\n";
		
		sXmlStr += "  <tr>\n";
		sXmlStr += "    <td style='" + t_line_lb + t_pd_a3 + "'>" + this.dsTA_SLIPNT_RPT.getColumn(i, "ACCT_BFNMD") + "</td>\n";
		sXmlStr += "	<td style='" + t_line_lb + t_pd_a3 + t_b + " text-align:right;'>" + this.fnc_AddComma(this.dsTA_SLIPNT_RPT.getColumn(i, "SLIP_AMNTD")) + "</td>\n";
		sXmlStr += "	<td style='" + t_line_l2b + t_pd_a3 + "'>" + this.dsTA_SLIPNT_RPT.getColumn(i, "ACCT_BFNMC") + "</td>\n";
		sXmlStr += "	<td style='" + t_line_lbr2 + t_pd_a3 + t_b + " text-align:right;'>" + this.fnc_AddComma(this.dsTA_SLIPNT_RPT.getColumn(i, "SLIP_AMNTC")) + "</td>\n";
		sXmlStr += "  </tr>\n";
		
		sXmlStr += "  <tr>\n";
		sXmlStr += "    <td style='" + t_line_l + t_pd_a3 + "'>" + this.dsTA_SLIPNT_RPT.getColumn(i, "ACCT_INTLD") + "</td>\n";
		
		// 차변 관리항목
		sXmlStr += "    <td style='" + t_line_lb2 + t_pd_a3 + "' rowspan='4' colspan='2'>\n";
		sXmlStr += "      <table border='0' cellspacing='0' cellpadding='0'>\n";
		sXmlStr += "        <col width='55px'>\n";
		sXmlStr += "        <col width='115px'>\n";
		sXmlStr += "        <col width='55px'>\n";
		sXmlStr += "        <col width='120px'>\n";
		sXmlStr += "        <tr>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMD1")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMD1"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBND1")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMD2")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMD2"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBND2")) + "</td>\n";
		sXmlStr += "        </tr>\n";
		sXmlStr += "        <tr>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMD3")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMD3"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBND3")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMD4")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMD4"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBND4")) + "</td>\n";
		sXmlStr += "        </tr>\n";
		sXmlStr += "        <tr>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMD5")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMD5"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBND5")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMD6")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMD6"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBND6")) + "</td>\n";
		sXmlStr += "        </tr>\n";
		sXmlStr += "        <tr>\n";
		sXmlStr += "          <td  style='" + t_pd_a3 + "' colspan='4'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "OSLI_NUMBD"), "SLIP_NUMB") + "</td>\n";
		sXmlStr += "        </tr>\n";
		sXmlStr += "      </table>\n";
		sXmlStr += "    </td>\n";

		sXmlStr += "    <td style='" + t_line_l2 + t_pd_a3 + "'>" + this.dsTA_SLIPNT_RPT.getColumn(i, "ACCT_INTLC") + "</td>\n";
		
		// 대변 관리항목
		sXmlStr += "    <td style='" + t_line_lb2r2 + t_pd_a3 + "' rowspan='4' colspan='2'>\n";
		sXmlStr += "      <table border='0' cellspacing='0' cellpadding='0'>\n";
		sXmlStr += "        <col width='55px'>\n";
		sXmlStr += "        <col width='115px'>\n";
		sXmlStr += "        <col width='55px'>\n";
		sXmlStr += "        <col width='120px'>\n";
		sXmlStr += "        <tr>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMC1")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMC1"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBNC1")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMC2")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMC2"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBNC2")) + "</td>\n";
		sXmlStr += "        </tr>\n";
		sXmlStr += "        <tr>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMC3")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMC3"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBNC3")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMC4")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMC4"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBNC4")) + "</td>\n";
		sXmlStr += "        </tr>\n";
		sXmlStr += "        <tr>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMC5")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMC5"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBNC5")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_CDNMC6")) + "</td>\n";
		sXmlStr += "          <td style='" + f11 + t_pd_a3 + "'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "COND_VANMC6"), this.dsTA_SLIPNT_RPT.getColumn(i, "INPT_GUBNC6")) + "</td>\n";
		sXmlStr += "        </tr>\n";
		sXmlStr += "        <tr>\n";
		sXmlStr += "          <td style='" + t_pd_a3 + "' colspan='4'>" + this.fn_GetNbsp(this.dsTA_SLIPNT_RPT.getColumn(i, "OSLI_NUMBC"), "SLIP_NUMB") + "</td>\n";
		sXmlStr += "        </tr>\n";
		sXmlStr += "      </table>\n";
		sXmlStr += "    </td>\n";
		sXmlStr += "  </tr>\n";
		
		sXmlStr += "  <tr>\n";
		sXmlStr += "    <td style='" + t_line_l + t_pd_a3 + "'>" + this.dsTA_SLIPNT_RPT.getColumn(i, "CSTC_NAMED") + "</td>\n";
		sXmlStr += "    <td style='" + t_line_l2 + t_pd_a3 + "'>" + this.dsTA_SLIPNT_RPT.getColumn(i, "CSTC_NAMEC") + "</td>\n";
		sXmlStr += "  </tr>\n";
		
		sXmlStr += "  <tr>\n";
		sXmlStr += "    <td style='" + t_line_l + t_pd_a3 + "'>" + this.dsTA_SLIPNT_RPT.getColumn(i, "BDSB_NAMED") + "</td>\n";
		sXmlStr += "    <td style='" + t_line_l2 + t_pd_a3 + "'>" + this.dsTA_SLIPNT_RPT.getColumn(i, "BDSB_NAMEC") + "</td>\n";
		sXmlStr += "  </tr>\n";
		
		sXmlStr += "  <tr>\n";
		sXmlStr += "    <td style='" + t_line_lb2 + f11 + t_pd_a3 + "'>&nbsp;</td>\n";
		sXmlStr += "    <td style='" + t_line_l2b2 + f11 + t_pd_a3 + "'>&nbsp;</td>\n";
		sXmlStr += "  </tr>\n";
		
		
// 		if (i % 3 == 0) {
// 			sXmlStr += "  <div style='page-break-befor:always;'></div>\n";
// 		}

	}
	
	sXmlStr += "  <tr style='" + t_b + "'>\n";
	sXmlStr += "    <td colspan='4' style='" + t_line_l2b2r2 + t_bg_c + f14 + t_ta_rt + t_pd_a3 + "'>\n";
	sXmlStr += "    	합계&nbsp;&nbsp;:&nbsp;&nbsp;" + this.fnc_AddComma(this.dsTA_SLIPXM_RPT.getColumn(0, "SLIP_AMNT")) + "\n";
	sXmlStr += "    </td>\n";
	sXmlStr += "    <td colspan='3' style='" + t_line_b2r2 + t_bg_c + f14 + t_ta_rt + t_pd_a3 + "'>\n";
	sXmlStr += "    	 一金&nbsp;&nbsp;:&nbsp;&nbsp;" + this.dsTA_SLIPXM_RPT.getColumn(0, "HANG_AMNT") + "&nbsp;&nbsp;원整 \n";
	sXmlStr += "    </td>\n";
	sXmlStr += "  <tr>\n";
	sXmlStr += "</table>";
	
	sXmlStr  += "]]]]><![CDATA[>";
	sXmlStr  += "</work_item>";

	sXmlStr += "<work_item work_item_code = '002' work_item_name = '전표일자'>" + this.fnc_GetMaskFormat(this.dsTA_SLIPXM_RPT.getColumn(0, "SLIP_DATE"), "@@@@-@@-@@") + "</work_item>";
	sXmlStr += "<work_item work_item_code = '003' work_item_name = '전표번호'>" + this.mskSLIP_NUMB.text + "</work_item>";
	sXmlStr += "<work_item work_item_code = '004' work_item_name = '작성부서'>" + this.dsTA_SLIPXM_RPT.getColumn(0, "DEPT_NAME") + "</work_item>";

	//trace(sXmlStr);
	return sXmlStr;
	
}

this.fn_GetNbsp = function (sVal, sMaskGubn) {

	if (this.IsNull(sVal)) {
		sVal = "&nbsp;";
	} else if (!this.IsNull(sMaskGubn)) {
		if (sMaskGubn == "SLIP_NUMB") {
			sVal = this.fnc_GetMaskFormat(sVal, application.GBL_SLIPMASK + "-####");
		} else if (sMaskGubn == "NUMB") {
			sVal = this.fnc_AddComma(sVal);
		}
	}
	return sVal;
	
}

this.mskOSLI_DISP_oneditclick = function(obj:MaskEdit,  e:nexacro.EditClickEventInfo) {

	var sSlipNumb = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "OSLI_NUMB");
	var sSlipLine = this.dsTA_SLIPNT.getColumn(this.dsTA_SLIPNT.rowposition, "OSLI_LINE");
	if (this.fnc_Length(this.fnc_Trim(sSlipNumb)) > 0) {
		this.fnc_ViewSlipForm(sSlipNumb, "SHR", this.sUSERLAVEL, "", sSlipLine); //NEW:직접입력, REV:수정, SHR:조회, SEM:반자동전표
	}
	
}

]]></Script>
  </Form>
</FDL>
