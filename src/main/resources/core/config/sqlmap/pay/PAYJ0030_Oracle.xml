<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">
<sqlMap namespace="PAYJ0030">

<!--
 *   프로그램명 : 항목별인건비실적 데이터 처리 SQLMAP
 *   작 성 일 : 2016.08.02
 *   작 성 자 : 고민주
 *   비   고 :
 *   Copyright (c) 2016 Inbus Co.,Ltd All Rights reserved.
 -->
	<!--
	 작 성 자 : 고민주
	 작 성 일 : 2016.08.02
	 내    용 : 평균인원 테이블 조회
	 파라미터 : 
	-->
	<select id="PAYJ0030.SEARCH00" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
 
			SELECT '' AS "대분류" 
			     , '' AS "중분류" 
				 , '' AS "구분" 
				 , '인원' AS "항목" 
				 , COUNT(A.EMPL_NUMB) AS 합계 
				 , COUNT(CASE WHEN A.CLSD_CODE = '01' THEN A.EMPL_NUMB END) AS "임원" 
				 , COUNT(CASE WHEN A.CLSD_CODE = '02' THEN A.EMPL_NUMB END) AS "일반" 
				 , COUNT(CASE WHEN A.CLSD_CODE = '03' THEN A.EMPL_NUMB END) AS "연구소" 
				 , COUNT(CASE WHEN A.CLSD_CODE = '04' THEN A.EMPL_NUMB END) AS "유통일반" 
				 , COUNT(CASE WHEN A.CLSD_CODE = '05' THEN A.EMPL_NUMB END) AS "유통판촉" 
				 , COUNT(CASE WHEN A.CLSD_CODE = '06' THEN A.EMPL_NUMB END) AS "임시직" 
				 , COUNT(CASE WHEN A.CLSD_CODE = '99' THEN A.EMPL_NUMB END) AS "용역" 
				 , 0 AS SORT1 
				 , 0 AS SORT2 
				 , 0 AS SORT3 
			  FROM PY_EMPAVG A			 
		INNER JOIN PY_DEPTQR B
				ON B.DTQR_CODE = #DTQR_CODE#
			   AND B.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = B.DEPT_CODE
			 WHERE A.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
    ]]>        
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	</select>
<!--
	 작 성 자 : 고민주
	 작 성 일 : 2016.08.02
	 내    용 : 항목별인건비실적 테이블 조회
	 파라미터 : 
	-->
	<select id="PAYJ0030.SEARCH01" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
			SELECT F.REF3_FILD    AS "대분류"
			     , F.REF4_FILD    AS "중분류"
				 , F.COMD_CDNM    AS "구분" 
				 , C.EXPD_NAME    AS "항목"   
			     , SUM(B.EXPD_AMOT) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				 , SUM(CASE WHEN A.CLSD_CODE = '01' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임원" 
				 , SUM(CASE WHEN A.CLSD_CODE = '02' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "일반" 
				 , SUM(CASE WHEN A.CLSD_CODE = '03' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "연구소" 
				 , SUM(CASE WHEN A.CLSD_CODE = '04' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통일반" 
				 , SUM(CASE WHEN A.CLSD_CODE = '05' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통판촉" 
				 , SUM(CASE WHEN A.CLSD_CODE = '06' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임시직" 
				 , SUM(CASE WHEN A.CLSD_CODE = '99' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "용역" 
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , '' AS SORT3 
				 , '' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE A.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#	 
			   AND D.QADG_CODE IN ('00076', '00077')		    
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME || '(소급)' 
				 , SUM(B.RTRC_AMOT) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS RTRC_AMOT 
				 , SUM(CASE WHEN A.CLSD_CODE = '01' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임원소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '02' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "일반소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '03' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "연구소소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '04' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통일반소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '05' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통판촉소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '06' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임시직소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '99' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "용역소급" 
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , '' AS SORT3 
				 , '' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#	 
			   AND D.QADG_CODE IN ('00076', '00077')	    
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '급여계' 
				 , '계' 
			     , SUM(CASE WHEN A.CLSD_CODE = '99' THEN 0 ELSE B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS EXPD_AMOT 
				 , SUM(CASE WHEN A.CLSD_CODE = '01' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임원" 
				 , SUM(CASE WHEN A.CLSD_CODE = '02' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "일반" 
				 , SUM(CASE WHEN A.CLSD_CODE = '03' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "연구소" 
				 , SUM(CASE WHEN A.CLSD_CODE = '04' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통일반" 
				 , SUM(CASE WHEN A.CLSD_CODE = '05' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통판촉" 
				 , SUM(CASE WHEN A.CLSD_CODE = '06' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임시직" 
				 , 0 AS "용역" 
				 , 21 AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE IN ('00076', '00077')		
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[    
			 GROUP BY F.REF3_FILD , F.REF4_FILD  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '급여계' 
				 , '(소급)' 
				 , SUM(CASE WHEN A.CLSD_CODE = '99' THEN 0 ELSE B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS RTRC_AMOT 
				 , SUM(CASE WHEN A.CLSD_CODE = '01' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임원소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '02' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "일반소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '03' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "연구소소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '04' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통일반소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '05' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통판촉소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '06' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임시직소급" 
				 , 0 AS "용역" 
				 , 21 AS SORT1 
				 , 0 AS SORT2 
				 , 2 AS SORT3 
				 , '인건비소급' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE IN ('00076', '00077')	  
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[  
			 GROUP BY F.REF3_FILD , F.REF4_FILD  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME 
			     , SUM(CASE WHEN A.CLSD_CODE = '99' THEN 0 ELSE B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS EXPD_AMOT 
				 , SUM(CASE WHEN A.CLSD_CODE = '01' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임원" 
				 , SUM(CASE WHEN A.CLSD_CODE = '02' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "일반" 
				 , SUM(CASE WHEN A.CLSD_CODE = '03' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "연구소" 
				 , SUM(CASE WHEN A.CLSD_CODE = '04' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통일반" 
				 , SUM(CASE WHEN A.CLSD_CODE = '05' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통판촉" 
				 , SUM(CASE WHEN A.CLSD_CODE = '06' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임시직"
				 , 0 AS "용역" 
				 , F.SORT_ORDR AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE = '00079'		    
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME || '(소급)' 
				 , SUM(CASE WHEN A.CLSD_CODE = '99' THEN 0 ELSE B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS RTRC_AMOT 
				 , SUM(CASE WHEN A.CLSD_CODE = '01' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임원소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '02' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "일반소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '03' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "연구소소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '04' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통일반소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '05' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통판촉소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '06' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임시직소급" 
				 , 0 AS "용역소급" 
				 , F.SORT_ORDR AS SORT1 
				 , 0 AS SORT2 
				 , 2 AS SORT3 
				 , '인건비소급' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			  LEFT OUTER JOIN PY_EMPAVG E 
			    ON E.STDS_YMTH = #STDS_YMTH#
			   AND A.EMPL_NUMB = E.EMPL_NUMB  
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE = '00079' 
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			/*퇴직금*/
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '퇴직충당금' 
				 , '계' 
				 , SUM(CASE WHEN A.CLSD_CODE = '99' THEN 0 ELSE B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS WCUR_ALWN 
				 , SUM(CASE WHEN A.CLSD_CODE = '01' THEN B.OCUR_ALWN ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임원퇴직" 
				 , SUM(CASE WHEN A.CLSD_CODE = '02' THEN B.OCUR_ALWN ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "일반퇴직" 
				 , SUM(CASE WHEN A.CLSD_CODE = '03' THEN B.OCUR_ALWN ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "연구소퇴직" 
				 , SUM(CASE WHEN A.CLSD_CODE = '04' THEN B.OCUR_ALWN ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통일반퇴직" 
				 , SUM(CASE WHEN A.CLSD_CODE = '05' THEN B.OCUR_ALWN ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통판촉퇴직" 
				 , SUM(CASE WHEN A.CLSD_CODE = '06' THEN B.OCUR_ALWN ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임시직퇴직" 
				 , 0 AS "용역퇴직" 
				 , 50 AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_RTRESE B 
			    ON B.STDS_DATE LIKE A.STDS_YMTH || '%'
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND F.COMD_CODE = '00084'
			 WHERE A.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD 
			UNION ALL 
			/*용역비*/ 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '용역비' 
				 , '계' 
			     , SUM(CASE WHEN A.CLSD_CODE = '99' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS EXPD_AMOT 
				 , 0 AS "임원" 
				 , 0 AS "일반" 
				 , 0 AS "연구소" 
				 , 0 AS "유통일반" 
				 , 0 AS "유통판촉" 
				 , 0 AS "임시직" 
				 , SUM(CASE WHEN A.CLSD_CODE = '99' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "용역" 
				 , 60 AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE IN ('00076', '00077')		  
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[  
			 GROUP BY F.REF3_FILD , F.REF4_FILD  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME 
			     , SUM(CASE WHEN A.CLSD_CODE = '99' THEN 0 ELSE B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS EXPD_AMOT 
				 , SUM(CASE WHEN A.CLSD_CODE = '01' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임원" 
				 , SUM(CASE WHEN A.CLSD_CODE = '02' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "일반" 
				 , SUM(CASE WHEN A.CLSD_CODE = '03' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "연구소" 
				 , SUM(CASE WHEN A.CLSD_CODE = '04' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통일반" 
				 , SUM(CASE WHEN A.CLSD_CODE = '05' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통판촉" 
				 , SUM(CASE WHEN A.CLSD_CODE = '06' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임시직" 
				 , 0 AS "용역" 
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , 1 AS SORT3 
				 , '복리후생비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#	 
			   AND D.QADG_CODE = '00083'		    
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME || '(소급)' 
				 , SUM(CASE WHEN A.CLSD_CODE = '99' THEN 0 ELSE B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS RTRC_AMOT 
				 , SUM(CASE WHEN A.CLSD_CODE = '01' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임원소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '02' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "일반소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '03' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "연구소소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '04' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통일반소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '05' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유통판촉소급" 
				 , SUM(CASE WHEN A.CLSD_CODE = '06' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "임시직소급" 
				 , 0 AS "용역소급" 
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , 2 AS SORT3 
				 , '복리후생비소급' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE = '00083' 
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			 ORDER BY SORT1,SORT2,SORT3 
			 
    ]]>         
	</select>
		
<!--
	 작 성 자 : 고민주
	 작 성 일 : 2016.08.02
	 내    용 : 항목별인건비실적 테이블 조회
	 파라미터 : 
	-->
	<select id="PAYJ0030.SEARCH02" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
 
			SELECT '' AS "대분류" 
			     , '' AS "중분류" 
				 , '' AS "구분" 
				 , '인원' AS "항목" 
			    , COUNT(A.EMPL_NUMB) AS 합계 
				, COUNT(CASE WHEN A.CPOS_CODE IN ('001', '002','003','004','005',
												  '006','007','008','009','010','071')	THEN A.EMPL_NUMB END) AS '임원'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('011')		THEN A.EMPL_NUMB END) AS 'S1'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('012')		THEN A.EMPL_NUMB END) AS 'S2'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('013')		THEN A.EMPL_NUMB END) AS 'M1'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('014')		THEN A.EMPL_NUMB END) AS 'M2'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('015', '016')	THEN A.EMPL_NUMB END) AS 'SA'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('017', '018')	THEN A.EMPL_NUMB END) AS 'A'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('021', '022')	THEN A.EMPL_NUMB END) AS 'JA'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('063', '067')	THEN A.EMPL_NUMB END) AS 'T1'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('064', '068')	THEN A.EMPL_NUMB END) AS 'T2'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('065', '069')	THEN A.EMPL_NUMB END) AS 'T3'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('066', '070')	THEN A.EMPL_NUMB END) AS 'T4'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('025', '026')	THEN A.EMPL_NUMB END) AS '연봉계약직'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('040', '062')	THEN A.EMPL_NUMB END) AS '판매전문계약직'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('072', '073')	THEN A.EMPL_NUMB END) AS '무기계약직'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('044')		THEN A.EMPL_NUMB END) AS '판촉전문직1급'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('045')		THEN A.EMPL_NUMB END) AS '판촉전문직2급'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('046')		THEN A.EMPL_NUMB END) AS '판촉전문직3급'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('047')		THEN A.EMPL_NUMB END) AS '판촉전문직4급'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('048')		THEN A.EMPL_NUMB END) AS '판촉전문직5급'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('049')		THEN A.EMPL_NUMB END) AS '판촉전문직6급'
				, COUNT(CASE WHEN A.CPOS_CODE IN ('050')		THEN A.EMPL_NUMB END) AS '판촉전문직7급' 
				 , 0 AS "용역" 
				 , 0 AS SORT1 
				 , 0 AS SORT2 
				 , 0 AS SORT3 
			  FROM PY_EMPAVG A			 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 WHERE A.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
    ]]>         
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	</select>
<!--
	 작 성 자 : 고민주
	 작 성 일 : 2016.08.02
	 내    용 : 항목별인건비실적 테이블 조회
	 파라미터 : 
	-->
	<select id="PAYJ0030.SEARCH03" parameterClass="hashmap" resultClass="hashmap">
	
	<![CDATA[			

			SELECT F.REF3_FILD    AS "대분류"
			    , F.REF4_FILD    AS "중분류"
				, F.COMD_CDNM    AS "구분" 
				, C.EXPD_NAME    AS "항목"   
			    , SUM(B.EXPD_AMOT) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				, SUM(CASE WHEN A.CPOS_CODE IN ('001', '002','003','004','005',
												  '006','007','008','009','010','071')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '임원'
				, SUM(CASE WHEN A.CPOS_CODE IN ('011')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('012')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('013')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('014')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('015', '016')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'SA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('017', '018')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'A'
				, SUM(CASE WHEN A.CPOS_CODE IN ('021', '022')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'JA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('063', '067')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('064', '068')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('065', '069')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T3'
				, SUM(CASE WHEN A.CPOS_CODE IN ('066', '070')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T4'
				, SUM(CASE WHEN A.CPOS_CODE IN ('025', '026')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '연봉계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('040', '062')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판매전문계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('072', '073')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '무기계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('044')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직1급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('045')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직2급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('046')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직3급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('047')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직4급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('048')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직5급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('049')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직6급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('050')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직7급' 
				 , 0 AS '용역'
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , '' AS SORT3 
				 , '' AS "소계"
			FROM PY_EMPAVG A    
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE A.STDS_YMTH BETWEEN CASE WHEN '0' = '1' THEN SUBSTR('201510',1,4)||'01' ELSE '201510' END AND '201510'	 
			   AND D.QADG_CODE IN ('00076', '00077')	 
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME || '(소급)' 
			    , SUM(B.RTRC_AMOT) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				, SUM(CASE WHEN A.CPOS_CODE IN ('001', '002','003','004','005',
												  '006','007','008','009','010','071')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '임원'
				, SUM(CASE WHEN A.CPOS_CODE IN ('011')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('012')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('013')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('014')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('015', '016')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'SA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('017', '018')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'A'
				, SUM(CASE WHEN A.CPOS_CODE IN ('021', '022')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'JA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('063', '067')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('064', '068')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('065', '069')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T3'
				, SUM(CASE WHEN A.CPOS_CODE IN ('066', '070')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T4'
				, SUM(CASE WHEN A.CPOS_CODE IN ('025', '026')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '연봉계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('040', '062')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판매전문계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('072', '073')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '무기계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('044')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직1급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('045')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직2급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('046')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직3급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('047')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직4급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('048')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직5급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('049')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직6급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('050')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직7급' 
				 , 0 AS '용역'
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , '' AS SORT3 
				 , '' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN '0' = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#	 
			   AND D.QADG_CODE IN ('00076', '00077')	 
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[    
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '급여계' 
				 , '계' 
			    , SUM(CASE WHEN A.CPOS_CODE IN ('999')			THEN 0 ELSE B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				, SUM(CASE WHEN A.CPOS_CODE IN ('001', '002','003','004','005',
												  '006','007','008','009','010','071')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '임원'
				, SUM(CASE WHEN A.CPOS_CODE IN ('011')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('012')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('013')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('014')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('015', '016')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'SA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('017', '018')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'A'
				, SUM(CASE WHEN A.CPOS_CODE IN ('021', '022')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'JA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('063', '067')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('064', '068')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('065', '069')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T3'
				, SUM(CASE WHEN A.CPOS_CODE IN ('066', '070')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T4'
				, SUM(CASE WHEN A.CPOS_CODE IN ('025', '026')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '연봉계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('040', '062')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판매전문계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('072', '073')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '무기계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('044')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직1급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('045')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직2급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('046')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직3급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('047')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직4급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('048')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직5급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('049')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직6급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('050')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직7급' 
				 , 0 AS '용역'
				 , 21 AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN '0' = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE IN ('00076', '00077')		     
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '급여계' 
				 , '(소급)' 
			    , SUM(CASE WHEN A.CPOS_CODE = '999' THEN 0 ELSE B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				, SUM(CASE WHEN A.CPOS_CODE IN ('001', '002','003','004','005',
												  '006','007','008','009','010','071')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '임원'
				, SUM(CASE WHEN A.CPOS_CODE IN ('011')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('012')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('013')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('014')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('015', '016')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'SA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('017', '018')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'A'
				, SUM(CASE WHEN A.CPOS_CODE IN ('021', '022')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'JA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('063', '067')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('064', '068')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('065', '069')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T3'
				, SUM(CASE WHEN A.CPOS_CODE IN ('066', '070')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T4'
				, SUM(CASE WHEN A.CPOS_CODE IN ('025', '026')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '연봉계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('040', '062')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판매전문계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('072', '073')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '무기계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('044')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직1급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('045')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직2급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('046')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직3급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('047')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직4급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('048')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직5급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('049')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직6급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('050')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직7급'  
				 , 0 AS '용역'
				 , 21 AS SORT1 
				 , 0 AS SORT2 
				 , 2 AS SORT3 
				 , '인건비소급' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN '0' = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE IN ('00076', '00077')	     
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME 
			    , SUM(CASE WHEN A.CPOS_CODE IN ('999')			THEN 0 ELSE B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				, SUM(CASE WHEN A.CPOS_CODE IN ('001', '002','003','004','005',
												  '006','007','008','009','010','071')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '임원'
				, SUM(CASE WHEN A.CPOS_CODE IN ('011')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('012')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('013')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('014')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('015', '016')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'SA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('017', '018')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'A'
				, SUM(CASE WHEN A.CPOS_CODE IN ('021', '022')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'JA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('063', '067')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('064', '068')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('065', '069')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T3'
				, SUM(CASE WHEN A.CPOS_CODE IN ('066', '070')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T4'
				, SUM(CASE WHEN A.CPOS_CODE IN ('025', '026')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '연봉계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('040', '062')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판매전문계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('072', '073')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '무기계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('044')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직1급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('045')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직2급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('046')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직3급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('047')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직4급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('048')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직5급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('049')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직6급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('050')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직7급' 
				 , 0 AS '용역'
				 , F.SORT_ORDR AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN '0' = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE = '00079'		     
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME || '(소급)' 
			    , SUM(B.RTRC_AMOT) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				, SUM(CASE WHEN A.CPOS_CODE IN ('001', '002','003','004','005',
												  '006','007','008','009','010','071')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '임원'
				, SUM(CASE WHEN A.CPOS_CODE IN ('011')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('012')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('013')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('014')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('015', '016')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'SA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('017', '018')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'A'
				, SUM(CASE WHEN A.CPOS_CODE IN ('021', '022')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'JA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('063', '067')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('064', '068')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('065', '069')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T3'
				, SUM(CASE WHEN A.CPOS_CODE IN ('066', '070')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T4'
				, SUM(CASE WHEN A.CPOS_CODE IN ('025', '026')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '연봉계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('040', '062')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판매전문계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('072', '073')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '무기계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('044')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직1급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('045')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직2급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('046')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직3급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('047')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직4급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('048')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직5급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('049')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직6급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('050')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직7급' 
				 , 0 AS '용역'
				 , F.SORT_ORDR AS SORT1 
				 , 0 AS SORT2 
				 , 2 AS SORT3 
				 , '인건비소급' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			  LEFT OUTER JOIN PY_EMPAVG E 
			    ON E.STDS_YMTH = #STDS_YMTH#
			   AND A.EMPL_NUMB = E.EMPL_NUMB  
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN '0' = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE = '00079'  
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			/*퇴직금*/
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '퇴직충당금' 
				 , '계' 
			    , SUM(B.OCUR_ALWN) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				, SUM(CASE WHEN A.CPOS_CODE IN ('001', '002','003','004','005',
												  '006','007','008','009','010','071')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '임원'
				, SUM(CASE WHEN A.CPOS_CODE IN ('011')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('012')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('013')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('014')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('015', '016')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'SA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('017', '018')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'A'
				, SUM(CASE WHEN A.CPOS_CODE IN ('021', '022')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'JA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('063', '067')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('064', '068')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('065', '069')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T3'
				, SUM(CASE WHEN A.CPOS_CODE IN ('066', '070')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T4'
				, SUM(CASE WHEN A.CPOS_CODE IN ('025', '026')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '연봉계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('040', '062')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판매전문계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('072', '073')	THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '무기계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('044')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직1급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('045')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직2급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('046')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직3급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('047')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직4급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('048')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직5급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('049')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직6급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('050')			THEN B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직7급' 
				 , 0 AS '용역'
				 , 50 AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_RTRESE B 
			    ON B.STDS_DATE LIKE A.STDS_YMTH || '%'
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND F.COMD_CODE = '00084'
			 WHERE A.STDS_YMTH BETWEEN CASE WHEN '0' = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH# 
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD 
			UNION ALL 
			/*용역비*/ 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '용역비' 
				 , '계' 
			     , SUM(CASE WHEN A.CPOS_CODE = '999' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				 , 0 AS '임원'
				 , 0 AS 'S1'
				 , 0 AS 'S2'
				 , 0 AS 'M1'
				 , 0 AS 'M2'
				 , 0 AS 'SA'
				 , 0 AS 'A'
				 , 0 AS 'JA'
				 , 0 AS 'T1'
				 , 0 AS 'T2'
				 , 0 AS 'T3'
				 , 0 AS 'T4'
				 , 0 AS '연봉계약직'
				 , 0 AS '판매전문계약직'
				 , 0 AS '무기계약직'
				 , 0 AS '판촉전문직1급'
				 , 0 AS '판촉전문직2급'
				 , 0 AS '판촉전문직3급'
				 , 0 AS '판촉전문직4급'
				 , 0 AS '판촉전문직5급'
				 , 0 AS '판촉전문직6급'
				 , 0 AS '판촉전문직7급' 
				 , SUM(CASE WHEN A.CPOS_CODE = '999' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '용역'
				 , 60 AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN '0' = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE IN ('00076', '00077')	 
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[    
			 GROUP BY F.REF3_FILD , F.REF4_FILD  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME 
			     , SUM(CASE WHEN A.CPOS_CODE IN ('999')			THEN 0 ELSE B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				 , SUM(CASE WHEN A.CPOS_CODE IN ('001', '002','003','004','005',
				 								  '006','007','008','009','010','071')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '임원'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('011')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S1'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('012')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S2'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('013')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M1'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('014')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M2'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('015', '016')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'SA'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('017', '018')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'A'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('021', '022')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'JA'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('063', '067')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T1'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('064', '068')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T2'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('065', '069')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T3'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('066', '070')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T4'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('025', '026')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '연봉계약직'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('040', '062')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판매전문계약직'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('072', '073')	THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '무기계약직'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('044')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직1급'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('045')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직2급'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('046')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직3급'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('047')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직4급'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('048')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직5급'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('049')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직6급'
				 , SUM(CASE WHEN A.CPOS_CODE IN ('050')			THEN B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직7급' 
				 , 0 AS "용역소급" 
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , 1 AS SORT3 
				 , '복리후생비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#	 
			   AND D.QADG_CODE = '00083'			 
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[    
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME || '(소급)' 
			     , SUM(B.RTRC_AMOT) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				, SUM(CASE WHEN A.CPOS_CODE IN ('001', '002','003','004','005',
												  '006','007','008','009','010','071')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '임원'
				, SUM(CASE WHEN A.CPOS_CODE IN ('011')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('012')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'S2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('013')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('014')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'M2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('015', '016')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'SA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('017', '018')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'A'
				, SUM(CASE WHEN A.CPOS_CODE IN ('021', '022')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'JA'
				, SUM(CASE WHEN A.CPOS_CODE IN ('063', '067')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T1'
				, SUM(CASE WHEN A.CPOS_CODE IN ('064', '068')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T2'
				, SUM(CASE WHEN A.CPOS_CODE IN ('065', '069')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T3'
				, SUM(CASE WHEN A.CPOS_CODE IN ('066', '070')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 'T4'
				, SUM(CASE WHEN A.CPOS_CODE IN ('025', '026')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '연봉계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('040', '062')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판매전문계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('072', '073')	THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '무기계약직'
				, SUM(CASE WHEN A.CPOS_CODE IN ('044')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직1급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('045')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직2급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('046')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직3급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('047')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직4급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('048')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직5급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('049')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직6급'
				, SUM(CASE WHEN A.CPOS_CODE IN ('050')			THEN B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS '판촉전문직7급' 
				 , 0 AS "용역소급" 
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , 2 AS SORT3 
				 , '복리후생비소급' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE = '00083' 
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			 ORDER BY SORT1,SORT2,SORT3 			 
    ]]>         
	</select>
	<!--
	 작 성 자 : 고민주
	 작 성 일 : 2016.08.02
	 내    용 : 항목별인건비실적 테이블 조회
	 파라미터 : 
	-->
	<select id="PAYJ0030.SEARCH04" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
 
			SELECT '' AS "대분류" 
			     , '' AS "중분류" 
				 , '' AS "구분" 
				 , '인원' AS "항목" 
				 , COUNT(A.EMPL_NUMB) AS 합계 
				 , COUNT(CASE WHEN A.WRTY_CODE = '1' THEN A.EMPL_NUMB END) AS "고정직" 
				 , COUNT(CASE WHEN A.WRTY_CODE = '2' THEN A.EMPL_NUMB END) AS "무기계약" 
				 , COUNT(CASE WHEN A.WRTY_CODE = '3' THEN A.EMPL_NUMB END) AS "유기계약" 
				 , COUNT(CASE WHEN A.WRTY_CODE = '9' THEN A.EMPL_NUMB END) AS "용역"  
				 , 0 AS SORT1 
				 , 0 AS SORT2 
				 , 0 AS SORT3 
			  FROM PY_EMPAVG A			 
		INNER JOIN PY_DEPTQR B
				ON B.DTQR_CODE = #DTQR_CODE#
			   AND B.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = B.DEPT_CODE
			 WHERE A.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
    ]]>        
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	</select>
	<!--
	 작 성 자 : 고민주
	 작 성 일 : 2016.08.02
	 내    용 : 항목별인건비실적 테이블 조회
	 파라미터 : 
	-->
	<select id="PAYJ0030.SEARCH05" parameterClass="hashmap" resultClass="hashmap">
	
	<![CDATA[
			SELECT F.REF3_FILD    AS "대분류"
			     , F.REF4_FILD    AS "중분류"
				 , F.COMD_CDNM    AS "구분" 
				 , C.EXPD_NAME    AS "항목"   
			     , SUM(B.EXPD_AMOT) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				 , SUM(CASE WHEN A.WRTY_CODE = '1' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "고정직"  
				 , SUM(CASE WHEN A.WRTY_CODE = '2' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "무기계약" 
				 , SUM(CASE WHEN A.WRTY_CODE = '3' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유기계약" 
				 , SUM(CASE WHEN A.WRTY_CODE = '9' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "용역"   
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , '' AS SORT3 
				 , '' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE A.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#	 
			   AND D.QADG_CODE IN ('00076', '00077')		    
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME || '(소급)' 
				 , SUM(B.RTRC_AMOT) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS RTRC_AMOT 
				 , SUM(CASE WHEN A.WRTY_CODE = '1' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "고정직소급" 
				 , SUM(CASE WHEN A.WRTY_CODE = '2' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "무기계약소급" 
				 , SUM(CASE WHEN A.WRTY_CODE = '3' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유기계약소급" 
				 , SUM(CASE WHEN A.WRTY_CODE = '9' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "용역소급" 
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , '' AS SORT3 
				 , '' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#	 
			   AND D.QADG_CODE IN ('00076', '00077')	    
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '급여계' 
				 , '계' 
			     , SUM(CASE WHEN A.WRTY_CODE = '9' THEN 0 ELSE B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				 , SUM(CASE WHEN A.WRTY_CODE = '1' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "고정직"  
				 , SUM(CASE WHEN A.WRTY_CODE = '2' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "무기계약" 
				 , SUM(CASE WHEN A.WRTY_CODE = '3' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유기계약" 
				 , 0 AS "용역"   
				 , 21 AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE IN ('00076', '00077')		
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[    
			 GROUP BY F.REF3_FILD , F.REF4_FILD  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '급여계' 
				 , '(소급)' 
				 , SUM(B.RTRC_AMOT) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS RTRC_AMOT 
				 , SUM(CASE WHEN A.WRTY_CODE = '1' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "고정직소급" 
				 , SUM(CASE WHEN A.WRTY_CODE = '2' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "무기계약소급" 
				 , SUM(CASE WHEN A.WRTY_CODE = '3' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유기계약소급" 
				 , 0 AS "용역소급" 
				 , 21 AS SORT1 
				 , 0 AS SORT2 
				 , 2 AS SORT3 
				 , '인건비소급' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE IN ('00076', '00077')	  
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[  
			 GROUP BY F.REF3_FILD , F.REF4_FILD  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME 
			     , SUM(B.EXPD_AMOT) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				 , SUM(CASE WHEN A.WRTY_CODE = '1' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "고정직"  
				 , SUM(CASE WHEN A.WRTY_CODE = '2' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "무기계약" 
				 , SUM(CASE WHEN A.WRTY_CODE = '3' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유기계약" 
				 , 0 AS "용역"   
				 , F.SORT_ORDR AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE = '00079'		   
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[ 
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME || '(소급)' 
				 , SUM(CASE WHEN A.WRTY_CODE = '9' THEN 0 ELSE B.RTRC_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS RTRC_AMOT 
				 , SUM(CASE WHEN A.WRTY_CODE = '1' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "고정직소급" 
				 , SUM(CASE WHEN A.WRTY_CODE = '2' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "무기계약소급" 
				 , SUM(CASE WHEN A.WRTY_CODE = '3' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유기계약소급" 
				 , 0 AS "용역소급" 
				 , F.SORT_ORDR AS SORT1 
				 , 0 AS SORT2 
				 , 2 AS SORT3 
				 , '인건비소급' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			  LEFT OUTER JOIN PY_EMPAVG E 
			    ON E.STDS_YMTH = #STDS_YMTH#
			   AND A.EMPL_NUMB = E.EMPL_NUMB  
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE = '00079' 
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			/*퇴직금*/
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '퇴직충당금' 
				 , '계' 
			     , SUM(CASE WHEN A.WRTY_CODE = '9' THEN 0 ELSE B.OCUR_ALWN END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				 , SUM(CASE WHEN A.WRTY_CODE = '1' THEN B.OCUR_ALWN ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "고정직"  
				 , SUM(CASE WHEN A.WRTY_CODE = '2' THEN B.OCUR_ALWN ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "무기계약" 
				 , SUM(CASE WHEN A.WRTY_CODE = '3' THEN B.OCUR_ALWN ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유기계약" 
				 , 0 AS "용역"   
				 , 50 AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_RTRESE B 
			    ON B.STDS_DATE LIKE A.STDS_YMTH || '%'
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND F.COMD_CODE = '00084'
			 WHERE A.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD 
			UNION ALL 
			/*용역비*/ 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , '용역비' 
				 , '계' 
			     , SUM(CASE WHEN A.WRTY_CODE = '9' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				 , 0 AS "고정직"  
				 , 0 AS "무기계약" 
				 , 0 AS "유기계약" 
				 , SUM(CASE WHEN A.WRTY_CODE = '9' THEN B.EXPD_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "용역"   
				 , 60 AS SORT1 
				 , 0 AS SORT2 
				 , 1 AS SORT3 
				 , '인건비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE IN ('00076', '00077')		  
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[  
			 GROUP BY F.REF3_FILD , F.REF4_FILD  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME 
			     , SUM(CASE WHEN A.WRTY_CODE = '9' THEN 0 ELSE B.EXPD_AMOT END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS 합계 
				 , SUM(CASE WHEN A.WRTY_CODE = '1' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "고정직"  
				 , SUM(CASE WHEN A.WRTY_CODE = '2' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "무기계약" 
				 , SUM(CASE WHEN A.WRTY_CODE = '3' THEN B.EXPD_AMOT ELSE 0 END)/ CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "유기계약" 
				 , 0 AS "용역"   
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , 1 AS SORT3 
				 , '복리후생비' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#	 
			   AND D.QADG_CODE = '00083'		    
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			UNION ALL 
			SELECT F.REF3_FILD 
			     , F.REF4_FILD  
				 , F.COMD_CDNM 
				 , C.EXPD_NAME || '(소급)' 
				 , SUM(CASE WHEN A.WRTY_CODE = '9' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS RTRC_AMOT 
				 , 0 AS "고정직소급" 
				 , 0 AS "무기계약소급" 
				 , 0 AS "유기계약소급" 
				 , SUM(CASE WHEN A.WRTY_CODE = '9' THEN B.RTRC_AMOT ELSE 0 END) / CASE WHEN #MNUT_CODE# = '01' THEN 1 WHEN #MNUT_CODE# = '02' THEN 1000 WHEN #MNUT_CODE#='03' THEN 1000000 END AS "용역소급" 	
				 , F.SORT_ORDR AS SORT1 
				 , D.SORT_ORDR AS SORT2 
				 , 2 AS SORT3 
				 , '복리후생비소급' AS "소계"
			  FROM PY_EMPAVG A 
			 INNER JOIN PY_DEPTQR X
				ON X.DTQR_CODE = #DTQR_CODE#
			   AND X.QDTG_CODE = #QDTG_CODE#
			   AND A.DEPT_CODE = X.DEPT_CODE
			 INNER JOIN PY_EMPDTL B 
			    ON A.STDS_YMTH = B.STDS_YMTH
			   AND A.EMPL_NUMB = B.EMPL_NUMB 
			 INNER JOIN PY_ALLDED C 
				ON B.EXPD_CODE = C.EXPD_CODE 
			  LEFT OUTER JOIN PY_ALDEQR D 
				ON D.ADQR_CODE = '05'  
			   AND B.EXPD_CODE = D.EXPD_CODE 
			  LEFT OUTER JOIN TM_CODEXD F 
			    ON F.COMM_CODE = 'QADG_CODE' 
			   AND D.QADG_CODE = F.COMD_CODE 
			 WHERE B.STDS_YMTH BETWEEN CASE WHEN #STCK_YSNO# = '1' THEN SUBSTR(#STDS_YMTH#,1,4)||'01' ELSE #STDS_YMTH# END AND #STDS_YMTH#
			   AND D.QADG_CODE = '00083' 
    ]]>  
	<isNotEmpty prepend="AND" property="GNDR_CODE">			  
			       A.GNDR_CODE = #GNDR_CODE#
	</isNotEmpty>	     
	<![CDATA[
			 GROUP BY F.REF3_FILD , F.REF4_FILD , F.COMD_CDNM, C.EXPD_NAME, F.SORT_ORDR, D.SORT_ORDR  
			 ORDER BY SORT1,SORT2,SORT3 
			 
    ]]>         
	</select>
	
	
</sqlMap>
