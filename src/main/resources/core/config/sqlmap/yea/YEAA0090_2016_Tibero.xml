<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
		"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="YEAA0090_2016">
<!--
/*******************************************************************************
     작 성 자 : 김석영
     작 성 일 : 2016.10.28
     내    용 : 제출자레코드 Search 
********************************************************************************/
-->
	<select id="YEAA0090_2016.SEARCH00" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
             SELECT /* YEAA0090_2016.SEARCH00.제출자레코드 Search */
                    A.YEA_BRANCH_NM          /*YEA_사업장명*/
                   ,A.YEA_BIZ_NO             /*YEA_사업자번호*/
                   ,A.YEA_HOMETAX_ID         /*YEA_홈택스ID*/
                   ,'법인' AS YEA_PRESENTER_NM /*제출자구분*/
                   ,#calSHRYEA_SEND_YMD# AS YEA_SEND_YMD /*제출년월일*/
                   ,B.YEA_EMP_NM /*담당자명*/
                   ,B.YEA_OFFICE_TEL_NO      /*YEA_회사전화번호*/
                   ,C.YEA_SECTOR_NM || ' ' || C.YEA_DEPT_NM AS YEA_DEPT_NM
                   ,SF_GET_COMMNAME('CNTL_TXOF', A.YEA_TAXOFFIC_CD) AS YEA_TAXOFFIC_NM
               FROM (
                     SELECT A.*
                           , ROW_NUMBER() OVER(
                                   PARTITION BY A.YEA_BRANCH_CD
                                       ORDER BY A.YEA_BRANCH_YMD DESC
                             ) AS ROW_NUM
                       FROM VI_YEA_BRCHXM A
                     ) A
           LEFT JOIN TABLE(SF_YEA_MASTXM(#edtSHRYEA_EMPL_NUMB#, #medSHRYEA_STD_YY# || '1231')) B
                  ON 1 = 1
           LEFT JOIN VI_YEA_DEPTXM C
                  ON B.YEA_DEPT_CD = C.YEA_DEPT_CD  
               WHERE A.YEA_BRANCH_CD = #cmbSHRYEA_BRANCH_CD#
                 AND A.ROW_NUM = 1
	]]>
	<![CDATA[
           ORDER BY SF_GET_DEPTFCOD(C.YEA_DEPT_CD)
           			, LPAD(A.YEA_POST_NO,5,'0')
           			, A.YEA_SETUP_YMD
    ]]>
	</select>
<!--
/*******************************************************************************
     작 성 자 : 김석영
     작 성 일 : 2016.10.28
     내    용 : 원천징수의무자별 집계레코드 Search 
********************************************************************************/
-->
	<select id="YEAA0090_2016.SEARCH01" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
            SELECT /* YEAA0090_2016.SEARCH01.원천징수의무자별 집계레코드 Search */
             	   A.YEA_BRANCH_NM          /*YEA_사업장명*/
                 , A.YEA_BIZ_NO             /*YEA_사업자번호*/
                 , A.YEA_HOMETAX_ID         /*YEA_홈택스ID*/
                 , A.YEA_TAXOFFIC_CD        /*YEA_관할세무서코드*/
                 , A.YEA_CORP_MASTER        /*YEA_사업장대표*/
                 , A.YEA_CORP_NO            /*YEA_법인번호*/
                 , B.YEA_YEPROC_CNT         /*주근무지수*/
                 , B.YEA_PRC_NUM001         /*총급여*/
                 , B.YEA_PRC_NUM083         /*소득세*/
                 , B.YEA_PRC_NUM084         /*지방소득세*/
                 , B.YEA_PRC_NUM085         /*농특세*/
                 , B.YEA_PRC_SUM001         /*계*/
                 , C.YEA_BFWORK_CNT         /*종근무지수*/
                 , SF_GET_COMMNAME('CNTL_TXOF', A.YEA_TAXOFFIC_CD) AS YEA_TAXOFFIC_NM
              FROM (
                    SELECT A.*
                         , ROW_NUMBER() OVER(
                                 PARTITION BY A.YEA_BRANCH_CD
                                     ORDER BY A.YEA_BRANCH_YMD DESC
                           ) AS ROW_NUM
                      FROM VI_YEA_BRCHXM A
                   ) A
         LEFT JOIN (
                    SELECT A.YEA_PRC_STR005
                         , COUNT(A.YEA_EMP_NO) AS YEA_YEPROC_CNT
                         , SUM(A.YEA_PRC_NUM001) AS YEA_PRC_NUM001
                         , SUM(A.YEA_PRC_NUM083) AS YEA_PRC_NUM083
                         , SUM(A.YEA_PRC_NUM084) AS YEA_PRC_NUM084
                         , SUM(A.YEA_PRC_NUM085) AS YEA_PRC_NUM085
                         , NVL(SUM(A.YEA_PRC_NUM083), 0) + NVL(SUM(A.YEA_PRC_NUM084), 0) + NVL(SUM(A.YEA_PRC_NUM085), 0) AS YEA_PRC_SUM001
                      FROM YEA_YEPROC A
                     WHERE A.YEA_PRC_STR001 = '1'   /*확정여부*/
                       AND A.YEA_STD_YY = #medSHRYEA_STD_YY#
                  GROUP BY A.YEA_PRC_STR005   /*사업장코드*/
                   ) B
                ON A.YEA_BRANCH_CD = B.YEA_PRC_STR005
         LEFT JOIN (
                    SELECT A.YEA_PRC_STR005
                         , COUNT(B.YEA_EMP_NO) AS YEA_BFWORK_CNT
                      FROM YEA_YEPROC A
                INNER JOIN YEA_BFWORK B
                        ON A.YEA_STD_YY = B.YEA_STD_YY
                       AND A.YEA_EMP_NO = B.YEA_EMP_NO
                     WHERE A.YEA_PRC_STR001 = '1'   /*확정여부*/
                       AND A.YEA_STD_YY = #medSHRYEA_STD_YY#
                  GROUP BY A.YEA_PRC_STR005   /*사업장코드*/
                   ) C
                ON A.YEA_BRANCH_CD = C.YEA_PRC_STR005
             WHERE A.YEA_BRANCH_CD = #cmbSHRYEA_BRANCH_CD#
               AND A.ROW_NUM = 1
    ]]>
    </select>	
    
<!--
/*******************************************************************************
     작 성 자 : 김석영
     작 성 일 : 2016.10.28
     내    용 : 주근무처 레코드 Search 
********************************************************************************/
-->
	<select id="YEAA0090_2016.SEARCH02" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
            SELECT /* YEAA0090_2016.SEARCH02.주근무처 레코드 Search  */
                   B.YEA_EMP_NO             /*YEA_사원번호*/
                 , C.YEA_EMP_NM             /*YEA_사원명*/
                 , B.YEA_PRC_NUM001         /*총급여*/
                 , B.YEA_PRC_NUM083         /*결정세액_소득세*/
                 , B.YEA_PRC_NUM084         /*결정세액_지방소득세*/
                 , B.YEA_PRC_NUM085         /*결정세액_농특세*/
                 , B.YEA_PRC_SUM001
                 , B.YEA_PRC_NUM092         /*차감징수_소득세*/
                 , B.YEA_PRC_NUM093         /*차감징수_지방소득세*/
                 , B.YEA_PRC_NUM094         /*차감징수_농특세*/
                 , B.YEA_PRC_SUM002
              FROM (
                    SELECT A.*
                         , ROW_NUMBER() OVER(
                                 PARTITION BY A.YEA_BRANCH_CD
                                     ORDER BY A.YEA_BRANCH_YMD DESC
                           ) AS ROW_NUM
                      FROM VI_YEA_BRCHXM A
                   ) A
        INNER JOIN (
                    SELECT A.YEA_EMP_NO
                         , A.YEA_PRC_STR005    /*사업장코드*/
                         , A.YEA_PRC_NUM001    /*총급여*/
                         , A.YEA_PRC_NUM083    /*결정세액_소득세*/
                         , A.YEA_PRC_NUM084    /*결정세액_지방소득세*/
                         , A.YEA_PRC_NUM085    /*결정세액_농특세*/
                         , NVL(A.YEA_PRC_NUM083, 0) + NVL(A.YEA_PRC_NUM084, 0) + NVL(A.YEA_PRC_NUM085, 0) AS YEA_PRC_SUM001
                         , A.YEA_PRC_NUM092    /*차감징수_소득세*/
                         , A.YEA_PRC_NUM093    /*차감징수_지방소득세*/
                         , A.YEA_PRC_NUM094    /*차감징수_농특세*/
                         , NVL(A.YEA_PRC_NUM092, 0) + NVL(A.YEA_PRC_NUM093, 0) + NVL(A.YEA_PRC_NUM094, 0) AS YEA_PRC_SUM002
                      FROM YEA_YEPROC A
                     WHERE A.YEA_PRC_STR001 = '1'   /*확정여부*/
                       AND A.YEA_STD_YY = #medSHRYEA_STD_YY#
                   ) B
                ON A.YEA_BRANCH_CD = B.YEA_PRC_STR005
        INNER JOIN TABLE(SF_YEA_MASTXD(#medSHRYEA_STD_YY# || '1231')) C
                ON B.YEA_EMP_NO = C.YEA_EMP_NO
             WHERE A.YEA_BRANCH_CD = #cmbSHRYEA_BRANCH_CD#
               AND A.ROW_NUM = 1
               /*AND C.YEA_QUIT_YMD IS null*/
    ]]>
    </select>	
    
<!--
/*******************************************************************************
     작 성 자 : 김석영
     작 성 일 : 2016.10.28
     내    용 : 전산매체자료 Search
********************************************************************************/
-->
	<select id="YEAA0090_2016.SEARCH03" parameterClass="hashmap" resultClass="hashmap">
	<![CDATA[
            SELECT /* YEAA0090_2016.SEARCH03.전산매체자료 Search */
                   YEA_REC_DATA
		      FROM YEA_YEFILE
		     ORDER BY YEA_REC_SEQ1, YEA_EMP_NO, YEA_REC_SEQ2
    ]]>
    </select>	
    
<!--
/*******************************************************************************
     작 성 자 : 김석영
     작 성 일 : 2016.10.28
     내    용 : 전산매체자료 Search
********************************************************************************/
-->
	<insert id="YEAA0090_2016.SAVE00" parameterClass="hashmap">
	<![CDATA[    
			DECLARE      /* YEAA0090_2016.SAVE00.전산매체자료 Search */
			BEGIN
		    
	            /*자료삭제*/                        
	            DELETE FROM YEA_YEFILE;      
	             
		        /*[A레코드] 제출자레코드*/
	            INSERT INTO YEA_YEFILE
	            SELECT  1
	                   ,''
	                   ,1
	                   ,'A'                                                     /*레코드구분*/
	                   || '20'                                                  /*자료구분*/
	                   || RPAD(NVL(A.YEA_TAXOFFIC_CD, ' '), 3, ' ')             /*세무서*/
	                   || #calSHRYEA_SEND_YMD#                                  /*제출년월일*/
	                   || '2'                                                   /*제출자구분(법인)*/
	                   || RPAD(' ', 6, ' ')                                     /*세무대리인관리번호*/
	                   || RPAD(NVL(A.YEA_HOMETAX_ID, ' '), 20, ' ')             /*홈택스ID*/
	                   || '9000'                                                /*세무프로그램코드*/
	                   || RPAD(NVL(A.YEA_BIZ_NO, ' '), 10, ' ')                 /*사업자등록번호*/
	                   || RPAD(NVL(A.YEA_BRANCH_NM, ' '), 40, ' ')              /*업체명*/
	                   || RPAD(NVL(C.YEA_DEPT_NM, ' '), 30, ' ')                /*담당자부서*/
	                   || RPAD(NVL(B.YEA_EMP_NM, ' '), 30, ' ')                 /*담당자성명*/
	                   || RPAD(NVL(B.YEA_OFFICE_TEL_NO, ' '), 15, ' ')          /*담당자전화번호*/
	                   || LPAD('1', 5, '0')                                     /*신고의무자수*/
	                   || '101'                                                 /*사용한글코드(2바이트 완성형)*/
	                   || RPAD(' ', 1442, ' ') AS YEA_REC_DATA                  /*공란 [2016귀속]_길이변경 1402->1432->1442*/
	              FROM (
	                    SELECT A.*
	                         , ROW_NUMBER() OVER(
	                                 PARTITION BY A.YEA_BRANCH_CD
	                                     ORDER BY A.YEA_BRANCH_YMD DESC
	                           ) AS ROW_NUM
	                      FROM VI_YEA_BRCHXM A
	                   ) A
	         LEFT JOIN TABLE(SF_YEA_MASTXM(#edtSHRYEA_EMPL_NUMB#, #medSHRYEA_STD_YY# || '1231')) B
	                ON 1 = 1
	         LEFT JOIN VI_YEA_DEPTXM C
	                ON B.YEA_DEPT_CD = C.YEA_DEPT_CD
	             WHERE A.YEA_BRANCH_CD = #cmbSHRYEA_BRANCH_CD#
	               AND A.ROW_NUM = 1;
	
		
		            /*[B레코드] 원천징수의무자별 집계레코드*/
		            INSERT INTO YEA_YEFILE
		            SELECT  2
		                   ,''
		                   ,1
		                   ,'B'                                                           /*레코드구분*/
		                   || '20'                                                        /*자료구분*/
		                   || RPAD(NVL(A.YEA_TAXOFFIC_CD,' '), 3, ' ')                    /*세무서*/
		                   || LPAD(ROW_NUMBER() OVER (ORDER BY A.YEA_BRANCH_CD), 6, '0')  /*일련번호*/
		                   || RPAD(NVL(A.YEA_BIZ_NO,' '), 10, ' ')                        /*사업자등록번호*/
		                   || RPAD(NVL(A.YEA_BRANCH_NM,' '), 40, ' ')                     /*업체명*/
		                   || RPAD(NVL(A.YEA_CORP_MASTER,' '), 30, ' ')                   /*대표자*/
		                   || RPAD(NVL(A.YEA_CORP_NO,' '), 13, ' ')                       /*법인등록번호*/
		                   || LPAD(NVL(B.YEA_YEPROC_CNT,'0'), 7, '0')                     /*주근무처수*/
		                   || LPAD(NVL(C.YEA_BFWORK_CNT,'0'), 7, '0')                     /*종근무처수*/
		                   || LPAD(NVL(B.YEA_PRC_NUM001,'0'), 14, '0')                    /*총급여총계*/
		                   || LPAD(NVL(B.YEA_PRC_NUM083,'0'), 13, '0')                    /*소득세결정세액총계*/
		                   || LPAD(NVL(B.YEA_PRC_NUM084,'0'), 13, '0')                    /*주민세결정세액총계*/
		                   || LPAD(NVL(B.YEA_PRC_NUM085,'0'), 13, '0')                    /*농특세결정세액총계*/
		                   || LPAD(NVL(B.YEA_PRC_SUM001,'0'), 13, '0')                    /*결정세액총계*/
		                   || '1'                                                         /*제출대상기간코드(연간지급분)*/
		                   || RPAD(' ', 1434, ' ') AS YEA_REC_DATA                        /*공란 [2016귀속]_길이변경 1394->1424->1434*/
		              FROM (
		                    SELECT A.*
		                         , ROW_NUMBER() OVER(
		                                 PARTITION BY A.YEA_BRANCH_CD
		                                     ORDER BY A.YEA_BRANCH_YMD DESC
		                           ) AS ROW_NUM
		                      FROM VI_YEA_BRCHXM A
		                   ) A
		         LEFT JOIN (
		                    SELECT A.YEA_PRC_STR005
		                         , COUNT(A.YEA_EMP_NO) AS YEA_YEPROC_CNT
		                         , SUM(A.YEA_PRC_NUM001) AS YEA_PRC_NUM001
		                         , SUM(A.YEA_PRC_NUM083) AS YEA_PRC_NUM083
		                         , SUM(A.YEA_PRC_NUM084) AS YEA_PRC_NUM084
		                         , SUM(A.YEA_PRC_NUM085) AS YEA_PRC_NUM085
		                         , NVL(SUM(A.YEA_PRC_NUM083), 0) + NVL(SUM(A.YEA_PRC_NUM084), 0) + NVL(SUM(A.YEA_PRC_NUM085), 0) AS YEA_PRC_SUM001
		                      FROM YEA_YEPROC A
		                     WHERE A.YEA_PRC_STR001 = '1'   /*확정여부*/
		                       AND A.YEA_STD_YY = #medSHRYEA_STD_YY#
		                  GROUP BY A.YEA_PRC_STR005   /*사업장코드*/
		                   ) B
		                ON A.YEA_BRANCH_CD = B.YEA_PRC_STR005
		         LEFT JOIN (
		                    SELECT A.YEA_PRC_STR005
		                         , COUNT(B.YEA_EMP_NO) AS YEA_BFWORK_CNT
		                      FROM YEA_YEPROC A
		                INNER JOIN YEA_BFWORK B
		                        ON A.YEA_STD_YY = B.YEA_STD_YY
		                       AND A.YEA_EMP_NO = B.YEA_EMP_NO
		                     WHERE A.YEA_PRC_STR001 = '1'   /*확정여부*/
		                       AND A.YEA_STD_YY = #medSHRYEA_STD_YY#
		                  GROUP BY A.YEA_PRC_STR005   /*사업장코드*/
		                   ) C
		                ON A.YEA_BRANCH_CD = C.YEA_PRC_STR005
		             WHERE A.YEA_BRANCH_CD = #cmbSHRYEA_BRANCH_CD#
		               AND A.ROW_NUM = 1;
		
		
		            /*[C레코드] 주(현)근무처 레코드*/
		            INSERT INTO YEA_YEFILE
		            SELECT  3
		                   ,A.YEA_EMP_NO
		                   ,1
		                   ,'C'                                                           /*레코드구분*/
		                   || '20'                                                        /*자료구분*/
		                   || RPAD(NVL(D.YEA_TAXOFFIC_CD,' '), 3, ' ')                    /*세무서*/
		                   || LPAD(ROW_NUMBER() OVER (ORDER BY A.YEA_EMP_NO), 6, '0')     /*일련번호*/
		                   /*[원천징수 의무자]*/
		                   || RPAD(NVL(D.YEA_BIZ_NO,' '), 10, ' ')                        /*사업자등록번호*/
		                   /*[소득자(근로자)]*/
		                   || LPAD(NVL(G.YEA_BFWORK_CNT,'0'), 2, '0')                     /*종근무처수*/
		                   || NVL(B.YEA_LIVE_CD,'1')                                      /*거주자구분코드*/
		                   || RPAD(NVL(B.YEA_LIVE_NATION_CD,' '), 2, ' ')                 /*거주지국코드*/
		                   || CASE WHEN B.YEA_RATE_YN = '1' THEN '1' ELSE '2' END         /*외국인단일세율적용(적용함 : 1 / 적용안함 : 2)*/
		                   || '2'                                                         /*[2016귀속]외국법인소속파견근로자여부(여 : 1 / 부 : 2)*/
		                   
		                   || RPAD(NVL(B.YEA_EMP_NM,' '), 30, ' ')                        /*성명*/
		                   || NVL(B.YEA_LOFO_CD, '1')                                     /*내외국인구분(내국인 : 1 / 외국인 : 9)*/
		                   || RPAD(REPLACE(SF_YEA_DECRYPT(#SSEC_KSTR#, B.YEA_EMP_SSN), '-', ''), 13, ' ')              /*주민등록번호*/
		                   
		                   || RPAD(NVL(B.YEA_NATION_CD, ' '), 2, ' ')                     /*국적코드*/
		                   || CASE WHEN E.YEA_INC_STR024 = '1' THEN '1' ELSE '2' END      /*세대주여부(세대주 : 1 / 세대원 : 2)*/
		                   || CASE WHEN B.YEA_INOFFICE_YN = '1' THEN '1' ELSE '2' END     /*연말정산구분(계속근로 : 1 / 중도퇴사 : 2)*/
		                   /*[근무처별 소득명세 - 주(현근무지) ]*/
		                   || RPAD(NVL(D.YEA_BIZ_NO, ' '), 10, ' ')                       /*사업자등록번호*/
		                   || RPAD(NVL(D.YEA_BRANCH_NM,' '), 40, ' ')                     /*근무처명 */
		                   || LPAD(CASE WHEN B.YEA_HIRE_YMD < #medSHRYEA_STD_YY# || '0101' THEN #medSHRYEA_STD_YY# || '0101' ELSE B.YEA_HIRE_YMD END, 8, '0')  /*귀속시작일*/
		                   || LPAD(CASE WHEN NVL(B.YEA_QUIT_YMD, '29991231') > #medSHRYEA_STD_YY# || '1231' THEN #medSHRYEA_STD_YY# || '1231' WHEN NVL(B.YEA_QUIT_YMD, '29991231') < #medSHRYEA_STD_YY# || '0101' THEN #medSHRYEA_STD_YY# || '0101' ELSE  B.YEA_QUIT_YMD END, 8, '0')  /*귀속종료일*/
		                   || REPLACE(LEAST(CASE WHEN NVL(E.YEA_INC_STR008, '99999999') < #medSHRYEA_STD_YY# || '0101' THEN #medSHRYEA_STD_YY# || '0101' ELSE NVL(TO_CHAR(E.YEA_INC_STR008), '99999999') END
		                    , CASE WHEN NVL(E.YEA_INC_STR004, '99999999') < #medSHRYEA_STD_YY# || '0101' THEN #medSHRYEA_STD_YY# || '0101' ELSE NVL(TO_CHAR(E.YEA_INC_STR004), '99999999') END), '99999999', '00000000')      /*감면시작일 (2012변경)*/
		                   || GREATEST(NVL(E.YEA_INC_STR009, '00000000'), NVL(E.YEA_INC_STR005, '00000000'))   /*감면종료일 (2012변경)*/
		                   || LPAD(F.YEA_PAY_NUM001, 11, '0')                             /*급여총액*/
		                   || LPAD(F.YEA_PAY_NUM003, 11, '0')                             /*상여총액*/
		                   || LPAD(F.YEA_PAY_NUM004, 11, '0')                             /*인정상여*/
		                   || LPAD(F.YEA_PAY_NUM005, 11, '0')                             /*주식매수선택권행사이익*/
		                   || LPAD(F.YEA_PAY_NUM006, 11, '0')                             /*우리사주조합인출금*/
		                   || LPAD(F.YEA_PAY_NUM007, 11, '0')                             /*임원 퇴직소득금액 한도초과액 (2013 추가)*/
		                   || RPAD('0', 21, '0')                                          /*공란 (2016_수정) */
		                   || LPAD(F.YEA_PAY_SUM001, 11, '0')                             /*계*/
		                   /*[주(현)근무처 비과세 및 감면소득]*/
		                   || LPAD(F.G01, 10, '0')                                        /*비과세학자금*/
		                   || LPAD(F.H01, 10, '0')                                        /*무보수위원수당*/
		                   || LPAD(F.H05, 10, '0')                                        /*경호,승선수당*/
		                   || LPAD(F.H06, 10, '0')                                        /*유아초중등*/
		                   || LPAD(F.H07, 10, '0')                                        /*고등교육법*/
		                   || LPAD(F.H08, 10, '0')                                        /*특별법*/
		                   || LPAD(F.H09, 10, '0')                                        /*연구기관등*/
		                   || LPAD(F.H10, 10, '0')                                        /*기업연구소*/
		                   || LPAD(F.H14, 10, '0')                                        /*보육교사 근무환경개선비  (2012추가)*/
		                   || LPAD(F.H15, 10, '0')                                        /*사립유치원 수석교사, 교사의 인건비  (2012추가)*/
		                   || LPAD(F.H11, 10, '0')                                        /*취재수당*/
		                   || LPAD(F.H12, 10, '0')                                        /*벽지수당*/
		                   || LPAD(F.H13, 10, '0')                                        /*재해관련급여 */
		                   || LPAD(F.H16, 10, '0')                                        /*정부공공기관 지방이전기관 종사자 이주수당  (2013추가)*/
		                   || LPAD(F.I01, 10, '0')                                        /*외국정부등근무자*/
		                   || LPAD(F.K01, 10, '0')                                        /*외국주둔군인등*/
		                   || LPAD(F.M01, 10, '0')                                        /*국외근로100만원*/
		                   || LPAD(F.M02, 10, '0')                                        /*국외근로300만원 (2013변경)*/
		                   || LPAD(F.M03, 10, '0')                                        /*국외근로*/
		                   || LPAD(F.O01, 10, '0')                                        /*야간근로수당*/
		                   || LPAD(F.Q01, 10, '0')                                        /*출산보육수당*/
		                   || LPAD(F.R10, 10, '0')                                        /*근로장학금*/
		                   || LPAD(F.S01, 10, '0')                                        /*주식매수선택권*/
		                   || LPAD(F.T01, 10, '0')                                        /*외국인기술자*/
		                   || LPAD(F.Y02, 10, '0')                                        /*우리사주조합인출금50%*/
		                   || LPAD(F.Y03, 10, '0')                                        /*우리사주조합인출금75%*/
		                   || LPAD(NVL(F.Y04, '0'), 10, '0')                              /*[2016귀속] 우리사주조합인출금100%*/		                   
		                   || LPAD(F.Y21, 10, '0')                                        /*장기미취업자중소기업취업*/
		                   /*|| LPAD(F.Z01, 10, '0')                                        해저광물자원개발 [2015귀속]_삭제*/
		                   || LPAD(F.Y22, 10, '0')                                        /*전공의 수련보조수당(2012변경)*/
		                   || LPAD(NVL(F.T10, '0'), 10, '0')                              /*[2016귀속]중소기업취업 청년 소득세 감면 100%*/
		                   || LPAD(NVL(F.T11, '0'), 10, '0')                              /*[2016귀속]중소기업취업 청년 소득세 감면 50%*/
		                   || LPAD(NVL(F.T12, '0'), 10, '0')                              /*[2016귀속]중소기업취업 청년 소득세 감면 70%*/
		                   || LPAD(F.T20, 10, '0')                                        /*조세조약상 교직자 감면(2012추가)*/
		                   || LPAD(F.YEA_PAY_SUM002, 10, '0')                             /*비과세계*/
		                   || LPAD(F.YEA_PAY_SUM003, 10, '0')                             /*감면소득계*/
		                   /*|| RPAD('0', 10, '0')                                          공란 [2015귀속]_공란추가 (2016삭제)*/
		                   /*[정산명세]*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM001, 0), 11, '0')                             /*총급여*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM002, 0), 10, '0')                             /*근로소득공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM003, 0), 11, '0')                             /*근로소득금액*/
		                   /*[기본공제]*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM004, 0), 8, '0')                              /*본인공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM005, 0), 8, '0')                              /*배우자공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM006, 0), 2, '0')                              /*부양가족인원*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM007, 0), 8, '0')                              /*부양가족공제*/
		                   /*[추가공제]*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM008, 0), 2, '0')                              /*경로우대인원*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM009, 0), 8, '0')                              /*경로우대공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM010, 0), 2, '0')                              /*장애인인원*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM011, 0), 8, '0')                              /*장애인공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM012, 0), 8, '0')                              /*부녀자공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM013, 0), 10, '0')                             /*한부모 가족 공제 (2013 추가)*/
		                   /*[연금보험료공제]*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM014, 0), 10, '0')                             /*국민연금보험료공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM015, 0), 10, '0')                             /*기타연금보험료공제 (공무원연금)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM016, 0), 10, '0')                             /*기타연금보험료공제 (군인연금)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM017, 0), 10, '0')                             /*기타연금보험료공제 (사립학교교직원연금)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM018, 0), 10, '0')                             /*기타연금보험료공제 (별정우체국연금)*/
		                   /*[특별공제]*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM019, 0), 10, '0')                             /*보험료    (건강보험료(노인장기요양보험료 포함))*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM020, 0), 10, '0')                             /*보험료    (고용보험)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM021, 0), 8, '0')                              /*주택임차차입금상환_대출기관*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM022, 0), 8, '0')                              /*주택임차차입금상환_거주자*/
		                   /*|| CASE WHEN NVL(A.YEA_PRC_NUM081, 0) = 0 THEN LPAD(NVL(NULL, 0), 8, '0')
		                      ELSE LPAD(A.YEA_PRC_NUM080, 8, '0') END                     월세세액공제_공제대상금액 [2015귀속]_세액공제로이동*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM023, 0), 8, '0')                              /*장기주택저당차입금_2011년이전(15년미만)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM024, 0), 8, '0')                              /*장기주택저당차입금 _2011년이전(15년~29년)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM025, 0), 8, '0')                              /*장기주택저당차입금_2011년이전(30년이상)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM026, 0), 8, '0')                              /*2012년 이후 차입분, 고정금리.비거치상환대출(2012추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM027, 0), 8, '0')                              /*2012년 이후 차입분, 기타대출(2012추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM104, 0), 8, '0')                              /*[2015귀속]_추가 (2015년 이후 차입분, 상환기관15년이상)고정금리 AND 비거치 상환 대출*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM105, 0), 8, '0')                              /*[2015귀속]_추가 (2015년 이후 차입분, 상환기관15년이상)고정금리 OR 비거치 상환 대출*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM106, 0), 8, '0')                              /*[2015귀속]_추가 (2015년 이후 차입분, 상환기관15년이상)기타 대출*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM107, 0), 8, '0')                              /*[2015귀속]_추가 (2015년 이후 차입분, 상환기관10년~15년)고정금리 OR 비거치 상환 대출*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM028, 0), 11, '0')                             /*기부금(이월분)(2014추가)*/
		                   /*|| LPAD('0', 20, '0')                                          공란 (2013 삭제)*/
		                   || LPAD(NVL(A.YEA_PRC_NUM029, 0), 11, '0')                     /*특별소득공제 계 (2013 변경)*/
		                   || LPAD(NVL(A.YEA_PRC_NUM030, 0), 11, '0')                     /*차감소득금액*/
		                   /*[그 밖의 소득공제]*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM031, 0), 8, '0')                              /*개인연금저축 */
		                   || LPAD(Nvl(A.YEA_PRC_NUM032, 0), 10, '0')                             /*소기업공제부금*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM033, 0), 10, '0')                             /*주택마련저축(청약저축)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM034, 0), 10, '0')                             /*주택마련저축(주택청약종합)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM035, 0), 10, '0')                             /*주택마련저축(근로자주택마련)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM036, 0), 10, '0')                             /*투자조합출자*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM037, 0), 8, '0')                              /*신용카드*/
		                   || LPAD(ABS(Nvl(A.YEA_PRC_NUM038, 0)), 10, '0')                        /*우리사주조합 출연금*/
		                   /*|| RPAD('0', 11, '0')                                          [2015귀속]_변경 우리사주조합 기부금(2014년 이전 기부분) 0으로기재 (2016 삭제)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM040, 0), 10, '0')                             /*고용유지중소기업근로자 소득공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM041, 0), 10, '0')                             /*목돈안드는전세이자상환액 (2013 추가) */
		                   || LPAD(ABS(Nvl(A.YEA_PRC_NUM042, 0)), 10, '0')                        /*장기집합투자증권저축 (2014 추가)*/
		                   || LPAD(ABS(Nvl(A.YEA_PRC_NUM043, 0)), 11, '0')                        /*그 밖의 소득공제계*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM044, 0), 11,'0')                              /*소득공제 종합한도 초과액 (2013 추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM045, 0), 11, '0')                             /*종합소득 과세표준*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM046, 0), 10, '0')                             /*산출세액*/
		                   /*[세액감면]*/
		                   || LPAD(NVL(A.YEA_PRC_NUM047, 0), 10, '0')                     /*소득세법 */
		                   || LPAD(NVL(A.YEA_PRC_NUM048, 0), 10, '0')                     /*조특법 (제30조제외) (2012변경)*/
		                   || LPAD(NVL(A.YEA_PRC_NUM049, 0), 10, '0')                     /*조특법 제30조세액감면 (2012추가)*/
		                   || LPAD(NVL(A.YEA_PRC_NUM050, 0), 10, '0')                     /*조세조약 (2012변경)*/
		                   /*|| LPAD('0', 10, '0')                                          공란 (2016 삭제)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM051, 0), 10, '0')                             /*세액감면계*/
		                   /*[세액공제]*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM052, 0), 10, '0')                             /*근로소득세액공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM053, 0), 2,  '0')                             /*세액공제_자녀 인원수 귀속년도2014년 연말정산 재정산(소급)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM054, 0), 10, '0')                             /*세액공제_자녀 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM098, 0), 2,  '0')                             /*6세이하 인원수 귀속년도2014년 연말정산 재정산(소급)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM099, 0), 10, '0')                             /*6세이하 귀속년도2014년 연말정산 재정산(소급)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM100, 0), 2,  '0')                             /*출산입양 인원수 귀속년도2014년 연말정산 재정산(소급)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM101, 0), 10, '0')                             /*출산입양 귀속년도2014년 연말정산 재정산(소급)*/
		                   || CASE WHEN NVL(A.YEA_PRC_NUM056, 0) = 0 THEN LPAD(NVL(NULL, 0), 10, '0')
		                      ELSE LPAD(A.YEA_PRC_NUM055, 10, '0') END                    /*과학기술인공제_공제대상금액 (2014추가)*/
		                   || LPAD(A.YEA_PRC_NUM056, 10, '0')                             /*과학기술인공제_세액공제액 (2014추가)*/
		                   || CASE WHEN NVL(A.YEA_PRC_NUM058, 0) = 0 THEN LPAD(NVL(NULL, 0), 10, '0')
		                      ELSE LPAD(A.YEA_PRC_NUM057, 10, '0') END                    /*근로자퇴직급여보장법_공제대상금액 (2014추가)*/
		                   || LPAD(A.YEA_PRC_NUM058, 10, '0')                                     /*근로자퇴직급여보장법_세액공제액 (2014추가)*/
		                   
		                   || CASE WHEN NVL(A.YEA_PRC_NUM060, 0) = 0 THEN LPAD(NVL(NULL, 0), 10, '0')
		                      ELSE LPAD(A.YEA_PRC_NUM059, 10, '0') END                            /*연금저축_공제대상금액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM060, 0), 10, '0')                             /*연금저축_세액공제액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM061, 0), 10, '0')                             /*보장성보험료_공제대상금액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM062, 0), 10, '0')                             /*보장성보험료_세액공제액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM102, 0), 10, '0')                             /*장애인전용보험료_공제대상금액 귀속년도2014년 연말정산 재정산(소급)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM103, 0), 10, '0')                             /*장애인전용보험료_세액공제액 귀속년도2014년 연말정산 재정산(소급)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM063, 0), 10, '0')                             /*의료비_공제대상금액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM064, 0), 10, '0')                             /*의료비_세액공제액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM065, 0), 10, '0')                             /*교육비_공제대상금액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM066, 0), 10, '0')                             /*교육비_세액공제액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM067, 0), 10, '0')                             /*정치자금기부금_10만원이하_공제대상금액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM068, 0), 10, '0')                             /*정치자금기부금_10만원이하_세액공제액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM069, 0), 11, '0')                             /*정치자금기부금_10만원초과_공제대상금액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM070, 0), 10, '0')                             /*정치자금기부금_10만원초과_세액공제액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM071, '0'), 11, '0')                           /*[2016귀속]순서변경 법정기부금_공제대상금액 (2014추가)*/
                           || LPAD(Nvl(A.YEA_PRC_NUM072, '0'), 10, '0')                           /*[2016귀속]순서변경 법정기부금_세액공제액 (2014추가)*/
                  		   || LPAD(Nvl(A.YEA_PRC_NUM039, '0'), 11, '0')                           /*[2016귀속]순서변경 [2015귀속]_우리사주조합기부금_공제대상금액_세액공제로 이동*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM108, '0'), 10, '0')                           /*[2016귀속]순서변경 [2015귀속]_우리사주조합기부금_세액공제액_추가*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM073, '0'), 11, '0')                           /*[2016귀속]지정기부금(종교단체외)_공제대상금액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM074, '0'), 10, '0')                           /*[2016귀속]지정기부금(종교단체외)_세액공제액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM109, '0'), 11, '0')                           /*[2016귀속]지정기부금(종교단체)_공제대상금액*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM110, '0'), 10, '0')                           /*[2016귀속]지정기부금(종교단체)_세액공제액*/
			               || LPAD(NVL(A.YEA_PRC_NUM075, 0), 10, '0')                             /*특별세액공제 계 (2013 변경)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM076, 0), 10, '0')                             /*표준세액공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM077, 0), 10, '0')                             /*납세조합공제*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM078, 0), 10, '0')                             /*주택차입금*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM079, 0), 10, '0')                             /*외국납부*/
		                   || CASE WHEN NVL(A.YEA_PRC_NUM081, 0) = 0 THEN LPAD(NVL(NULL, 0), 10, '0')
		                      ELSE LPAD(A.YEA_PRC_NUM080, 10, '0') END                    /*[2015귀속]_이동 월세세액공제_공제대상금액*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM081, 0), 8, '0')                              /*[2015귀속]_길이변경 10->8 월세세액공제_세액공제액 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM082, 0), 10, '0')                             /*세액공제계*/
		                   /*[결정세액]*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM083, 0), 10, '0')                             /*결정세액소득세*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM084, 0), 10, '0')                             /*결정세액지방소득세*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM085, 0), 10, '0')                             /*결정세액농특세*/
		                   /*[기납부세액 - 주(현근무지)]*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM089, 0), 10, '0')                             /*주근무지소득세*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM090, 0), 10, '0')                             /*주근무지지방소득세*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM091, 0), 10, '0')                             /*주근무지농특세*/
		                   /*[납부특례세액]*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM095, 0), 10, '0')                             /*납부특례소득세 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM096, 0), 10, '0')                             /*납부특례지방소득세 (2014추가)*/
		                   || LPAD(Nvl(A.YEA_PRC_NUM097, 0), 10, '0')                             /*납부특례농특세 (2014추가)*/
		                   /*[차감징수세액]*/
		                   || CASE WHEN NVL(A.YEA_PRC_NUM092, 0) >= 0 THEN '0' ELSE '1' END  /*음수표시*/
		                   || LPAD(ABS(A.YEA_PRC_NUM092), 10, '0')                           /*차감징수세액소득세*/
		                   || CASE WHEN NVL(A.YEA_PRC_NUM093, 0) >= 0 THEN '0' ELSE '1' END  /*음수표시*/
		                   || LPAD(ABS(A.YEA_PRC_NUM093), 10, '0')                           /*차감징수세액지방소득세*/
		                   || CASE WHEN NVL(A.YEA_PRC_NUM094, 0) >= 0 THEN '0' ELSE '1' END  /*음수표시*/
		                   || LPAD(ABS(A.YEA_PRC_NUM094), 10, '0')                           /*차감징수세액농특세 */
		                   || LPAD(' ', 15, ' ')    AS YEA_REC_DATA                          /*공란[2015귀속]_길이변경 28->5->15 2016*/
		              FROM YEA_YEPROC A
		         LEFT JOIN TABLE(SF_YEA_MASTXD(#medSHRYEA_STD_YY# || '1231')) B
		                ON A.YEA_EMP_NO = B.YEA_EMP_NO
		        INNER JOIN (
		                    SELECT A.*
		                         , ROW_NUMBER() OVER(
		                                 PARTITION BY A.YEA_BRANCH_CD
		                                     ORDER BY A.YEA_BRANCH_YMD DESC
		                           ) AS ROW_NUM
		                      FROM VI_YEA_BRCHXM A
		                   ) D
		                ON A.YEA_PRC_STR005 = D.YEA_BRANCH_CD
		               AND D.ROW_NUM = 1
		         LEFT JOIN YEA_INCDEC E
		                ON A.YEA_STD_YY = E.YEA_STD_YY
		               AND A.YEA_EMP_NO = E.YEA_EMP_NO
		         LEFT JOIN (
		                    SELECT A.YEA_STD_YY
		                         , A.YEA_EMP_NO
		                         , SUM(NVL(A.YEA_PAY_NUM001, 0) + NVL(A.YEA_PAY_NUM002, 0)) AS YEA_PAY_NUM001   /*지급금액+기타소득*/
		                         , SUM(NVL(A.YEA_PAY_NUM003, 0)) AS YEA_PAY_NUM003   /*상여금액*/
		                         , SUM(NVL(A.YEA_PAY_NUM004, 0)) AS YEA_PAY_NUM004   /*인정상여*/
		                         , SUM(NVL(A.YEA_PAY_NUM005, 0)) AS YEA_PAY_NUM005   /*주식매수선택권행사이익*/
		                         , SUM(NVL(A.YEA_PAY_NUM006, 0)) AS YEA_PAY_NUM006   /*우리사주조합인출금*/
		                         , SUM(NVL(A.YEA_PAY_NUM007, 0)) AS YEA_PAY_NUM007   /*임원 퇴직소득금액 한도초과액*/
		                         , SUM(
		                               NVL(A.YEA_PAY_NUM001, 0)
		                             + NVL(A.YEA_PAY_NUM002, 0)
		                             + NVL(A.YEA_PAY_NUM003, 0)
		                             + NVL(A.YEA_PAY_NUM004, 0)
		                             + NVL(A.YEA_PAY_NUM005, 0)
		                             + NVL(A.YEA_PAY_NUM006, 0)
		                             + NVL(A.YEA_PAY_NUM007, 0)
		                           ) AS YEA_PAY_SUM001   /*계*/
		                         , SUM(NVL(A.YEA_PAY_NUM026, 0)) AS G01   /*학자금*/
		                         , 0 AS H01
		                         , 0 AS H05
		                         , 0 AS H06
		                         , 0 AS H07
		                         , 0 AS H08
		                         , SUM(NVL(A.YEA_PAY_NUM012, 0)) AS H09   /*연구활동비과세*/
		                         , 0 AS H10
		                         , 0 AS H14  /*2012추가*/
		                         , 0 AS H15  /*2012추가*/
		                         , SUM(NVL(A.YEA_PAY_NUM027, 0)) AS H16  /*정부공공기관 지방이전기관 종사자 이주수당  (2013추가)*/
		                         , 0 AS H11
		                         , 0 AS H12   /*계*/
		                         , 0 AS H13
		                         , 0 AS I01
		                         , 0 AS K01
		                         , SUM(NVL(A.YEA_PAY_NUM009, 0)) AS M01   /*국외근로원화금액*/
		                         , 0 AS M02
		                         , 0 AS M03
		                         , SUM(NVL(A.YEA_PAY_NUM010, 0)) AS O01   /*야간근로비과세*/
		                         , SUM(NVL(A.YEA_PAY_NUM011, 0)) AS Q01   /*출산보육비과세*/
		                         , 0 AS R10
		                         , 0 AS S01
		                         , 0 AS T01
		                         , 0 AS Y02
		                         , 0 AS Y03
		                         , 0 AS Y04
		                         , 0 AS Y21
		                         , 0 AS Z01
		                         , 0 AS Y22
		                         , SUM(NVL(A.YEA_PAY_NUM014, 0)) AS T10  /*중소기업취업청년 소득세 감면100%*/
		                         , SUM(NVL(A.YEA_PAY_NUM031, 0)) AS T11  /*중소기업취업청년 소득세 감면50% (2016추가)*/
                                 , SUM(NVL(A.YEA_PAY_NUM032, 0)) AS T12  /*중소기업취업청년 소득세 감면70% (2016추가)*/		                         
		                         , 0 AS T20  /*2012추가*/
		                         , SUM(
		                               NVL(A.YEA_PAY_NUM012, 0)
		                             + NVL(A.YEA_PAY_NUM009, 0)
		                             + NVL(A.YEA_PAY_NUM010, 0)
		                             + NVL(A.YEA_PAY_NUM011, 0)
		                             + NVL(A.YEA_PAY_NUM026, 0)
		                             + NVL(A.YEA_PAY_NUM027, 0)
		                           ) AS YEA_PAY_SUM002   /*계(S01, Z01, T10, T20 제외)*/
		                         , SUM(NVL(A.YEA_PAY_NUM014, 0)+NVL(A.YEA_PAY_NUM031, 0)+NVL(A.YEA_PAY_NUM032, 0)) AS YEA_PAY_SUM003   /*감면소득(S01+Z01+T10+T20)*/
		                      FROM YEA_PAYDTL A
		                INNER JOIN YEA_YEPROC B
		                        ON A.YEA_STD_YY = B.YEA_STD_YY
		                       AND A.YEA_EMP_NO = B.YEA_EMP_NO
		                     WHERE A.YEA_STD_YY = #medSHRYEA_STD_YY#
		                       AND B.YEA_PRC_STR001 = '1'   /*확정여부*/
		                  GROUP BY A.YEA_STD_YY
		                         , A.YEA_EMP_NO
		                   ) F
		                ON A.YEA_STD_YY = F.YEA_STD_YY
		               AND A.YEA_EMP_NO = F.YEA_EMP_NO
		         LEFT JOIN (
		                    SELECT A.YEA_STD_YY
		                         , A.YEA_EMP_NO
		                         , COUNT(A.YEA_EMP_NO) AS YEA_BFWORK_CNT
		                      FROM YEA_BFWORK A
		                INNER JOIN YEA_YEPROC B
		                        ON A.YEA_STD_YY = B.YEA_STD_YY
		                       AND A.YEA_EMP_NO = B.YEA_EMP_NO
		                     WHERE A.YEA_STD_YY = #medSHRYEA_STD_YY#
		                       AND B.YEA_PRC_STR001 = '1'   /*확정여부*/
		                  GROUP BY A.YEA_STD_YY
		                         , A.YEA_EMP_NO
		                ) G
		                ON A.YEA_STD_YY = G.YEA_STD_YY
		               AND A.YEA_EMP_NO = G.YEA_EMP_NO
		             WHERE A.YEA_PRC_STR001 = '1'   /*확정여부*/
		               AND A.YEA_STD_YY = #medSHRYEA_STD_YY#
		               AND D.YEA_BRANCH_CD = #cmbSHRYEA_BRANCH_CD#;   /*사업장코드*/
		
		
		            /*[D레코드] 종(전)근무처 레코드*/
		            INSERT INTO YEA_YEFILE
		            SELECT  3
		                   ,A.YEA_EMP_NO
		                   ,2
		                   ,'D'                                                             /*레코드구분*/
		                   || SUBSTR(E.YEA_REC_DATA, 2, 21)                                 /*자료구분, 세무서, 일련번호, 사업자등록번호*/
		                   || RPAD(' ', 50, ' ')                                            /*공란*/
		                   /*[소득자]*/
		                   || RPAD(REPLACE(SF_YEA_DECRYPT(#SSEC_KSTR#, D.YEA_EMP_SSN), '-', ''), 13, ' ')                /*주민등록번호*/
		                   
		                   /*[근무처별 소득명세 - 종(전)근무처]*/
		                   || CASE WHEN B.YEA_BFW_STR001 = '0' THEN '1' ELSE '2' END        /*종근무지구분(납세조합이면 1, 아니면 2)*/
		                   || RPAD(NVL(B.YEA_BFW_STR002, ' '), 40, ' ')                     /*법인명*/
		                   || RPAD(NVL(B.YEA_BIZ_NO, ' '), 10, ' ')                         /*사업자등록번호*/		                   
		                   || LPAD(CASE WHEN B.YEA_BFW_STR003 < #medSHRYEA_STD_YY# || '0101' THEN TO_NCHAR(#medSHRYEA_STD_YY# || '0101') ELSE NVL(B.YEA_BFW_STR003, '0') END, 8, '0')        /*근무시간 시작연월일*/
		                   || LPAD(CASE WHEN B.YEA_BFW_STR004 > #medSHRYEA_STD_YY# || '1231' THEN TO_NCHAR(#medSHRYEA_STD_YY# || '1231') ELSE NVL(B.YEA_BFW_STR004, '0') END, 8, '0')        /*근무시간 종료연월일*/
		                   || LPAD(CASE WHEN B.YEA_BFW_STR005 < #medSHRYEA_STD_YY# || '0101' THEN TO_NCHAR(#medSHRYEA_STD_YY# || '0101') ELSE NVL(B.YEA_BFW_STR005, '0') END, 8, '0')        /*감면기간 시작연월일*/
		                   || LPAD(NVL(B.YEA_BFW_STR006, '0'), 8, '0')                      /*감면기간 종료연월일*/
		                   || LPAD(NVL(B.YEA_BFW_NUM001, '0'), 11, '0')                     /*급여총액*/
		                   || LPAD(NVL(B.YEA_BFW_NUM002, '0'), 11, '0')                     /*상여총액*/
		                   || LPAD(NVL(B.YEA_BFW_NUM003, '0'), 11, '0')                     /*인정상여*/
		                   || LPAD(NVL(B.YEA_BFW_NUM004, '0'), 11, '0')                     /*주식매수선택권행사이익*/
		                   || LPAD(NVL(B.YEA_BFW_NUM005, '0'), 11, '0')                     /*우리사주조합인출금*/
		                   || LPAD(NVL(B.YEA_BFW_NUM006, '0'), 11, '0')                     /*임원 퇴직소득금액 한도초과액*/
		                   || LPAD('0', 22, '0')                                            /*공란*/
		                   || LPAD(
		                           NVL(B.YEA_BFW_NUM001, 0)
		                         + NVL(B.YEA_BFW_NUM002, 0)
		                         + NVL(B.YEA_BFW_NUM003, 0)
		                         + NVL(B.YEA_BFW_NUM004, 0)
		                         + NVL(B.YEA_BFW_NUM005, 0)
		                         + NVL(B.YEA_BFW_NUM006, 0)
		                      , 11, '0')
		                   /*[종(전)근무처 비과세 및 감면]*/
		                   || LPAD(NVL(C.G01,0), 10, '0')                                   /*비과세학자금*/
		                   || LPAD(NVL(C.H01,0), 10, '0')                                   /*무보수위원수당*/
		                   || LPAD(NVL(C.H05,0), 10, '0')                                   /*경호,승선수당*/
		                   || LPAD(NVL(C.H06,0), 10, '0')                                   /*유아초중등*/
		                   || LPAD(NVL(C.H07,0), 10, '0')                                   /*고등교육법*/
		                   || LPAD(NVL(C.H08,0), 10, '0')                                   /*특별법*/
		                   || LPAD(NVL(C.H09,0), 10, '0')                                   /*연구기관등*/
		                   || LPAD(NVL(C.H10,0), 10, '0')                                   /*기업연구소*/
		                   || LPAD(NVL(C.H14,0), 10, '0')                                   /*보육교사근무환경개선비 2012추가*/
		                   || LPAD(NVL(C.H15,0), 10, '0')                                   /*사립유치원수석교사교사의 인건비 2012추가*/
		                   || LPAD(NVL(C.H11,0), 10, '0')                                   /*취재수당*/
		                   || LPAD(NVL(C.H12,0), 10, '0')                                   /*벽지수당*/
		                   || LPAD(NVL(C.H13,0), 10, '0')                                   /*재해관련급여*/
		                   || LPAD(NVL(C.H16,0), 10, '0')                                   /*정부공공기관 지방이전기관 종사자 이주수당  (2013추가)*/
		                   || LPAD(NVL(C.I01,0), 10, '0')                                   /*외국정부등근무자*/
		                   || LPAD(NVL(C.K01,0), 10, '0')                                   /*외국주둔군인등*/
		                   || LPAD(NVL(C.M01,0), 10, '0')                                   /*국외근로100만원*/
		                   || LPAD(NVL(C.M02,0), 10, '0')                                   /*국외근로300만원  (2013변경)*/
		                   || LPAD(NVL(C.M03,0), 10, '0')                                   /*국외근로*/
		                   || LPAD(NVL(C.O01,0), 10, '0')                                   /*야간근로수당*/
		                   || LPAD(NVL(C.Q01,0), 10, '0')                                   /*출산보육수당*/
		                   || LPAD(NVL(C.R10,0), 10, '0')                                   /*근로장학금*/
		                   || LPAD(NVL(C.S01,0), 10, '0')                                   /*주식매수선택권*/
		                   || LPAD(NVL(C.T01,0), 10, '0')                                   /*외국인기술자*/
		                   || LPAD(NVL(C.Y02,0), 10, '0')                                   /*우리사주조합인출금50%*/
		                   || LPAD(NVL(C.Y03,0), 10, '0')                                   /*우리사주조합인출금75%*/
		                   || LPAD(NVL(C.Y04,0), 10, '0')                                   /*우리사주조합인출금100%(2016년 추가)*/
		                   || LPAD(NVL(C.Y21,0), 10, '0')                                   /*장기미취업자 중소기업취업*/
		                   /*|| LPAD(NVL(C.Z01,0), 10, '0')                                 해저광물자원개발 [2015귀속]_삭제*/
		                   || LPAD(NVL(C.Y22,0), 10, '0')                                   /*전공의 수련보조수당  2012변경*/
		                   || LPAD(NVL(C.T10,0), 10, '0')                                   /*중소기업청년소득세감면 100%  2012변경*/
		                   || LPAD(NVL(C.T11,0), 10, '0')                                   /*중소기업청년소득세감면 50% 2016추가*/
		                   || LPAD(NVL(C.T12,0), 10, '0')                                   /*중소기업청년소득세감면 70% 2016추가*/
		                   || LPAD(NVL(C.T20,0), 10, '0')                                   /*조세조약상 교직자감면  2012변경*/
		                   || LPAD(NVL(C.YEA_BFN_SUM001, 0), 10, '0')                       /*비과세계*/
		                   || LPAD(NVL(C.YEA_BFN_SUM002, 0), 10, '0')                       /*감면소득계*/
		                   || LPAD('0', 10, '0')                                            /*공란 [2015귀속]_공란추가*/
		                   /*[기납부세액 - 종(전)근무지]*/
		                   || LPAD(NVL(B.YEA_BFW_NUM010, 0), 10, '0')                       /*소득세*/
		                   || LPAD(NVL(B.YEA_BFW_NUM011, 0), 10, '0')                       /*지방소득세*/
		                   || LPAD(NVL(B.YEA_BFW_NUM012, 0), 10, '0')                       /*농특세 */
		                   || LPAD(
		                           ROW_NUMBER() OVER (
		                                  PARTITION BY A.YEA_EMP_NO
		                                      ORDER BY B.YEA_BIZ_NO
		                           )
		                      , 2, '0')                                                             /*일련번호*/
		                   || RPAD(' ', 961, ' ')    AS YEA_REC_DATA                           /*공란 [2015귀속]_길이변경 951->981 ->961*/
		              FROM YEA_YEPROC A
		        INNER JOIN YEA_BFWORK B
		                ON A.YEA_STD_YY = B.YEA_STD_YY
		               AND A.YEA_EMP_NO = B.YEA_EMP_NO
		         LEFT JOIN (
		                    SELECT A.YEA_STD_YY
		                         , A.YEA_EMP_NO
		                         , A.YEA_BIZ_NO
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'G01' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS G01
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H01' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H01
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H05' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H05
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H06' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H06
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H07' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H07
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H08' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H08
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H09' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H09
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H10' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H10
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H14' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H14  /*2012추가*/
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H15' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H15  /*2012추가*/
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H11' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H11
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H12' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H12
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H13' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H13
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'H16' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS H16  /*2013추가*/
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'I01' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS I01
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'K01' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS K01
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'M01' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS M01
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'M02' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS M02
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'M03' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS M03
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'O01' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS O01
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'Q01' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS Q01
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'R10' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS R10
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'S01' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS S01
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'T01' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS T01
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'Y02' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS Y02
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'Y03' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS Y03
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'Y04' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS Y04
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'Y21' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS Y21
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'Z01' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS Z01
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'Y22' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS Y22
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'T10' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS T10  /*2012추가*/
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'T11' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS T11  /*2016추가*/
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'T12' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS T12  /*2016추가*/
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD = 'T20' THEN A.YEA_BFN_NUM001 ELSE 0 END) AS T20  /*2012추가*/
		                         , SUM(CASE WHEN A.YEA_NON_TAX_CD NOT IN ('T01','Z01','T10','T11','T12','T20') THEN A.YEA_BFN_NUM001 ELSE 0 END) AS YEA_BFN_SUM001 /*[2016귀속] T11,T12추가*/
                                 , SUM(CASE WHEN A.YEA_NON_TAX_CD IN ('T01','Z01','T10','T11','T12','T20') THEN A.YEA_BFN_NUM001 ELSE 0 END) AS YEA_BFN_SUM002  /*[2016귀속] T11,T12추가*/
		                      FROM YEA_BFNTAX A
		                     WHERE A.YEA_STD_YY = #medSHRYEA_STD_YY#
		                  GROUP BY A.YEA_STD_YY
		                         , A.YEA_EMP_NO
		                         , A.YEA_BIZ_NO
		              ) C
		                ON B.YEA_STD_YY = C.YEA_STD_YY
		               AND B.YEA_EMP_NO = C.YEA_EMP_NO
		               AND B.YEA_BIZ_NO = C.YEA_BIZ_NO
		        INNER JOIN TABLE(SF_YEA_MASTXD(#medSHRYEA_STD_YY# || '1231')) D
		                ON A.YEA_EMP_NO = D.YEA_EMP_NO
		         LEFT JOIN YEA_YEFILE E
		                ON A.YEA_EMP_NO = E.YEA_EMP_NO
		               AND E.YEA_REC_SEQ1 = '3'
		               AND E.YEA_REC_SEQ2 = '1'
		             WHERE A.YEA_PRC_STR001 = '1'   /*확정여부*/
		               AND A.YEA_STD_YY = #medSHRYEA_STD_YY#
		               AND A.YEA_PRC_STR005 = #cmbSHRYEA_BRANCH_CD#   /*사업장코드*/
		          ORDER BY ROW_NUMBER() OVER (
		                          PARTITION BY A.YEA_EMP_NO
		                              ORDER BY B.YEA_BIZ_NO
		                   )
		                 ;
		
		
		
		            /*[E레코드] 소득공제명세 레코드*/
		            INSERT INTO YEA_YEFILE
		            SELECT  Y.YEA_REC_SEQ1
		                   ,Y.YEA_EMP_NO
		                   ,Y.YEA_REC_SEQ2
		                   ,Y.YEA_E_SEQ
		                   || RPAD(NVL(Y.YEA_REC_DATA1,' '), 258, ' ')   /*2013변경(218) -> 2014변경(236) -> 2014소급변경(258)*/
		                   || RPAD(NVL(Y.YEA_REC_DATA2,' '), 258, ' ')   /*2013변경(218) -> 2014변경(236) -> 2014소급변경(258)*/
		                   || RPAD(NVL(Y.YEA_REC_DATA3,' '), 258, ' ')   /*2013변경(218) -> 2014변경(236) -> 2014소급변경(258)*/
		                   || RPAD(NVL(Y.YEA_REC_DATA4,' '), 258, ' ')   /*2013변경(218) -> 2014변경(236) -> 2014소급변경(258)*/
		                   || RPAD(NVL(Y.YEA_REC_DATA5,' '), 258, ' ')   /*2013변경(218) -> 2014변경(236) -> 2014소급변경(258)*/
		                   || LPAD(
		                           ROW_NUMBER() OVER (
		                                  PARTITION BY Y.YEA_EMP_NO
		                                      ORDER BY Y.ROWN
		                           )
		                      , 2, '0')
		                   || RPAD(' ', 293, ' ') AS YEA_REC_DATA   /*공란 [2016귀속]_길이변경 253->283 ->293*/
		              FROM (
		                    SELECT Z.YEA_REC_SEQ1
		                         , Z.YEA_EMP_NO
		                         , Z.YEA_REC_SEQ2 + TRUNC((ROWNUMBER - 1) / 5 , 0) AS YEA_REC_SEQ2
		                         , Z.YEA_E_SEQ
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 5) = 1 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA1
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 5) = 2 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA2
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 5) = 3 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA3
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 5) = 4 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA4
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 5) = 0 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA5
		                         , TRUNC((ROWNUMBER - 1) / 5, 0) AS ROWN
		                      FROM (
		                            SELECT  3 AS YEA_REC_SEQ1
		                                   ,A.YEA_EMP_NO
		                                   ,30 AS YEA_REC_SEQ2
		                                   ,'E'                                                     /*레코드구분*/
		                                   || SUBSTR(D.YEA_REC_DATA, 2, 21)                         /*자료구분, 세무서, 일련번호, 사업자등록번호*/
		                                   /*[소득자]*/
		                                   || RPAD(REPLACE(SF_YEA_DECRYPT(#SSEC_KSTR#, C.YEA_EMP_SSN), '-', ''), 13, ' ') AS YEA_E_SEQ       /*소득자주민번호*/
		                                   
		                                   /*[인적사항]*/
		                                   ,  RPAD(B.YEA_FAM_STR001, 1, ' ')     /*관계코드*/
		                                   || RPAD(B.YEA_FAM_STR002, 1, ' ')     /*내외국인*/
		                                   || RPAD(B.YEA_FAM_STR003, 20, ' ')    /*성명*/
		                                   || RPAD(REPLACE(SF_YEA_DECRYPT(#SSEC_KSTR#, B.YEA_FAM_STR004), '-', ''), 13, ' ')    /*주민등록번호*/
		                                   
		                                   || CASE WHEN B.YEA_FAM_STR005 = '1' THEN '1' ELSE ' ' END /*기본공제*/
		                                   
		                                   || CASE WHEN B.YEA_FAM_STR009 IN ('1','2','3') THEN TO_CHAR(B.YEA_FAM_STR009) ELSE ' ' END /*장애인*/
		                                   || CASE WHEN B.YEA_FAM_STR007 = '1' THEN '1' ELSE ' ' END /*부녀자*/
		                                   || CASE WHEN B.YEA_FAM_STR006 = '1' THEN '1' ELSE ' ' END /*경로우대*/
		                                   || CASE WHEN B.YEA_FAM_STR008 = '1' THEN '1' ELSE ' ' END /*한부모(2013추가)*/
		                                   || CASE WHEN B.YEA_FAM_STR012 = '1' THEN '1' ELSE ' ' END /*출산입양 귀속년도2014년 연말정산 재정산(소급) */
		                                   || CASE WHEN B.YEA_FAM_STR011 = '1' THEN '1' ELSE ' ' END /*6세이하 귀속년도2014년 연말정산 재정산(소급) */
		                                   /*[소득공제명세 국세청자료]*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM001, 0), 10, '0')  /*보험료_건강고용(국세청)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM003, 0), 10, '0')  /*보험료_보장성(국세청)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM020, 0), 10, '0')  /*보험료_장애인전용(국세청) 귀속년도2014년 연말정산 재정산(소급)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM005, 0) + NVL(B.YEA_FAM_NUM022, 0) , 10, '0')  /*의료비(국세청) [2015귀속]_난임시술비국세청추가*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM007, 0), 10, '0')  /*교육비(국세청)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM009, 0), 10, '0')  /*신용카드(국세청)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM011, 0), 10, '0')  /*직불카드(국세청)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM013, 0), 10, '0')  /*현금영수증(국세청)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM014, 0), 10, '0')  /*전통시장사용액(국세청) 2012추가*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM016, 0), 10, '0')  /*대중교통이용액(국세청) 2013추가*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM018, 0), 13, '0')  /*기부금(국세청) 2012변경*/
		                                   /*[소득공제명세 기타자료]*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM002, 0), 10, '0')  /*보험료_건강고용(기타)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM004, 0), 10, '0')  /*보험료_보장성(기타)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM021, 0), 10, '0')  /*보험료_장애인전용(기타) 귀속년도2014년 연말정산 재정산(소급)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM006, 0) + NVL(B.YEA_FAM_NUM023, 0), 10, '0')  /*의료비(기타) [2015귀속]_난임시술비기타추가*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM008, 0), 10, '0')  /*교육비(기타)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM010, 0), 10, '0')  /*신용카드(기타)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM012, 0), 10, '0')  /*직불카드(기타)*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM015, 0), 10, '0')  /*전통시장사용액(기타) 2012추가*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM017, 0), 10, '0')  /*대중교통이용액(기타) 2013추가*/
		                                   || LPAD(NVL(B.YEA_FAM_NUM019, 0), 13, '0') AS YEA_REC_DATA  /*기부금(기타) 2012변경*/
		                                   ,ROW_NUMBER() OVER (
		                                           PARTITION BY A.YEA_EMP_NO
		                                               ORDER BY B.YEA_FAMI_SEQ
		                                    ) AS ROWNUMBER
		                              FROM YEA_YEPROC A
		                        INNER JOIN YEA_YEFAMI B
		                                ON A.YEA_STD_YY = B.YEA_STD_YY
		                               AND A.YEA_EMP_NO = B.YEA_EMP_NO
		                        INNER JOIN TABLE(SF_YEA_MASTXD(#medSHRYEA_STD_YY# || '1231')) C
		                                ON A.YEA_EMP_NO = C.YEA_EMP_NO
		                         LEFT JOIN YEA_YEFILE D
		                                ON A.YEA_EMP_NO = D.YEA_EMP_NO
		                               AND D.YEA_REC_SEQ1 = '3'
		                               AND D.YEA_REC_SEQ2 = '1'
		                             WHERE A.YEA_STD_YY = #medSHRYEA_STD_YY#
		                               AND A.YEA_PRC_STR005 = #cmbSHRYEA_BRANCH_CD#
		                               AND A.YEA_PRC_STR001 = '1'   /*확정여부*/
		                           ) Z
		                  GROUP BY Z.YEA_REC_SEQ1
		                         , Z.YEA_EMP_NO
		                         , Z.YEA_REC_SEQ2
		                         , Z.YEA_E_SEQ
		                         , TRUNC((ROWNUMBER - 1) / 5 , 0)
		              ) Y;
		
		            /*[F레코드] 연금.저축등 소득공제 레코드*/
		            INSERT INTO YEA_YEFILE
		            SELECT  Y.YEA_REC_SEQ1
		                   ,Y.YEA_EMP_NO
		                   ,Y.YEA_REC_SEQ2
		                   ,Y.YEA_F_SEQ
		                   || RPAD(NVL(Y.YEA_REC_DATA1,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA2,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA3,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA4,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA5,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA6,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA7,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA8,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA9,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA10,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA11,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA12,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA13,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA14,' '), 95, ' ')
		                   || RPAD(NVL(Y.YEA_REC_DATA15,' '), 95, ' ')
		                   || RPAD(' ', 160, ' ') AS YEA_REC_DATA  /*공란 [2016귀속]_길이변경 120->150->160*/
		              FROM (
		                    SELECT Z.YEA_REC_SEQ1
		                         , Z.YEA_EMP_NO
		                         , Z.YEA_REC_SEQ2 + TRUNC((ROWNUMBER - 1) / 15 , 0) AS YEA_REC_SEQ2
		                         , Z.YEA_F_SEQ
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 1 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA1
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 2 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA2
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 3 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA3
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 4 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA4
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 5 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA5
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 6 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA6
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 7 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA7
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 8 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA8
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 9 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA9
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 10 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA10
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 11 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA11
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 12 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA12
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 13 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA13
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 14 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA14
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 15) = 0 THEN Z.YEA_REC_DATA END) AS YEA_REC_DATA15
		                      FROM (
		                            SELECT  3 AS YEA_REC_SEQ1
		                                   ,A.YEA_EMP_NO
		                                   ,40 AS YEA_REC_SEQ2
		                                   ,'F'                                                                 /*레코드구분*/
		                                   || SUBSTR(D.YEA_REC_DATA, 2, 21)                                     /*자료구분, 세무서, 일련번호, 사업자등록번호*/
		                                   /*[소득자]*/
		                                   || RPAD(REPLACE(SF_YEA_DECRYPT(#SSEC_KSTR#, C.YEA_EMP_SSN), '-', ''), 13, ' ') AS YEA_F_SEQ       /*소득자주민번호*/
		                                   /*[연금저축 등 소득공제]*/
		                                   ,RPAD(B.YEA_PEN_STR001, 2, ' ')                                      /*공제구분*/
		                                   || RPAD(B.YEA_PEN_STR002, 3, ' ')                                    /*금융기관코드*/
		                                   || RPAD(NVL(E.YEA_COMD_NM, ' '), 50, ' ')                                      /*금융기관상호  귀속년도2014년 연말정산 재정산(소급)*/
		                                   || RPAD(SF_YEA_DECRYPT(#ACNO_KSTR#,  B.YEA_PEN_STR003), 20, ' ')           /*계좌번호*/
		                                   || LPAD(NVL(B.YEA_PEN_NUM001, 0), 10, '0')                           /*불입금액*/
		                                   || LPAD(NVL(B.YEA_PEN_NUM002, 0), 10, '0') AS YEA_REC_DATA           /*연금및저축공제액*/
		                                   ,ROW_NUMBER() OVER (
		                                           PARTITION BY A.YEA_EMP_NO
		                                               ORDER BY B.YEA_PENS_SEQ
		                                    ) AS ROWNUMBER
		                              FROM YEA_YEPROC A
		                        INNER JOIN YEA_PENSAV B
		                                ON A.YEA_STD_YY = B.YEA_STD_YY
		                               AND A.YEA_EMP_NO = B.YEA_EMP_NO
		                               AND NVL(B.YEA_PEN_NUM002, 0) <> 0
		                        INNER JOIN TABLE(SF_YEA_MASTXD(#medSHRYEA_STD_YY# || '1231')) C
		                                ON A.YEA_EMP_NO = C.YEA_EMP_NO
		                         LEFT JOIN YEA_YEFILE D
		                                ON A.YEA_EMP_NO = D.YEA_EMP_NO
		                               AND D.YEA_REC_SEQ1 = '3'
		                               AND D.YEA_REC_SEQ2 = '1'
		                         LEFT JOIN VI_YEA_CODEXD E
		                                ON E.YEA_COMM_CD = 'YEA_90001'
		                               AND B.YEA_PEN_STR002 = E.YEA_COMD_CD    /*연금·저축공제금융회사코드*/
		                             WHERE A.YEA_STD_YY = #medSHRYEA_STD_YY#
		                               AND A.YEA_PRC_STR005 = #cmbSHRYEA_BRANCH_CD#
		                               AND A.YEA_PRC_STR001 = '1'   /*확정여부*/
		                           ) Z
		                  GROUP BY Z.YEA_REC_SEQ1
		                         , Z.YEA_EMP_NO
		                         , Z.YEA_REC_SEQ2
		                         , Z.YEA_F_SEQ
		                         , TRUNC((ROWNUMBER - 1) / 15 , 0)
		              ) Y;
		
		            /*[G레코드] 월세·거주자간 주택임차차입금 원리금 상환액 소득공제명세 레코드*/
		            INSERT INTO YEA_YEFILE
		            SELECT YEA_REC_SEQ1
		                   ,YEA_EMP_NO
		                   ,YEA_REC_SEQ2||ROW_NUMBER() OVER (PARTITION BY YEA_EMP_NO ORDER BY ROWN)
		                   ,YEA_G_SEQ
		                    || RPAD(NVL(RECD_DATA1,
		                    /*월세액 소득공제명세*/
		                       RPAD(NVL(NULL, ' '), 20, ' ')  /*임대인 성명*/
		                    || RPAD(NVL(NULL, ' '), 13, ' ')  /*임대인주민등록번호*/
		                    || RPAD(NVL(NULL, ' '), 1, ' ')              /*주택유형구분코드*/
							          || LPAD(NVL(NULL, '0'), 5, '0')              /*주택계약면적*/
		                    || RPAD(NVL(NULL, ' '), 100, ' ') /*임대차 계약서상 주소지*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간 시작*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간 종료*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*월세액*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*공제금액*/
		                    /*거주자간 주택임차차입금 원리금 상환액 - 금전소비대차 계약*/
		                    || RPAD(NVL(NULL, ' '), 20, ' ')  /*대주 성명*/
		                    || RPAD(NVL(NULL, ' '), 13, ' ')  /*대주 주민등록번호*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*금전소비대차 계약기간 시작*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*금전소비대차 계약기간 종료*/
		                    || LPAD(NVL(NULL, 0), 4, '0')   /*차입금이자율*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*원리금 상환액계 */
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*원금*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*이자*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*공제금액*/
		                    /*거주자간 주택임차차입금 원리금 상환액 - 임대차 계약*/
		                    || RPAD(NVL(NULL, ' '), 20, ' ')  /*임대인 성명*/
		                    || RPAD(NVL(NULL, ' '), 13, ' ')  /*주민등록번호*/
		                    || RPAD(NVL(NULL, ' '), 1, ' ')              /*주택유형구분코드*/
						           	|| LPAD(NVL(NULL, '0'), 5, '0')              /*주택계약면적*/
		                    || RPAD(NVL(NULL, ' '), 100, ' ') /*임대차계약서상 주소지*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간  시작*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간 종료*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*전세보증금*/
		                    ), 433, ' ')
		                    || RPAD(NVL(RECD_DATA2,
		                    /*월세액 소득공제명세*/
		                       RPAD(NVL(NULL, ' '), 20, ' ')  /*임대인 성명*/
		                    || RPAD(NVL(NULL, ' '), 13, ' ')  /*임대인주민등록번호*/
		                    || RPAD(NVL(NULL, ' '), 1, ' ')              /*주택유형구분코드*/
						          	|| LPAD(NVL(NULL, '0'), 5, '0')              /*주택계약면적*/
		                    || RPAD(NVL(NULL, ' '), 100, ' ') /*임대차 계약서상 주소지*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간 시작*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간 종료*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*월세액*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*공제금액*/
		                    /*거주자간 주택임차차입금 원리금 상환액 - 금전소비대차 계약*/
		                    || RPAD(NVL(NULL, ' '), 20, ' ')  /*대주 성명*/
		                    || RPAD(NVL(NULL, ' '), 13, ' ')  /*대주 주민등록번호*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*금전소비대차 계약기간 시작*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*금전소비대차 계약기간 종료*/
		                    || LPAD(NVL(NULL, 0), 4, '0')   /*차입금이자율*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*원리금 상환액계 */
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*원금*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*이자*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*공제금액*/
		                    /*거주자간 주택임차차입금 원리금 상환액 - 임대차 계약*/
		                    || RPAD(NVL(NULL, ' '), 20, ' ')  /*임대인 성명*/
		                    || RPAD(NVL(NULL, ' '), 13, ' ')  /*주민등록번호*/
		                    || RPAD(NVL(NULL, ' '), 1, ' ')              /*주택유형구분코드*/
						          	|| LPAD(NVL(NULL, '0'), 5, '0')              /*주택계약면적*/
		                    || RPAD(NVL(NULL, ' '), 100, ' ') /*임대차계약서상 주소지*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간  시작*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간 종료*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*전세보증금*/
		                    ), 433, ' ')
		                    || RPAD(NVL(RECD_DATA3,
		                    /*월세액 소득공제명세*/
		                       RPAD(NVL(NULL, ' '), 20, ' ')  /*임대인 성명*/
		                    || RPAD(NVL(NULL, ' '), 13, ' ')  /*임대인주민등록번호*/
		                    || RPAD(NVL(NULL, ' '), 1, ' ')              /*주택유형구분코드*/
						           	|| LPAD(NVL(NULL, '0'), 5, '0')              /*주택계약면적*/
		                    || RPAD(NVL(NULL, ' '), 100, ' ') /*임대차 계약서상 주소지*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간 시작*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간 종료*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*월세액*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*공제금액*/
		                    /*거주자간 주택임차차입금 원리금 상환액 - 금전소비대차 계약*/
		                    || RPAD(NVL(NULL, ' '), 20, ' ')  /*대주 성명*/
		                    || RPAD(NVL(NULL, ' '), 13, ' ')  /*대주 주민등록번호*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*금전소비대차 계약기간 시작*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*금전소비대차 계약기간 종료*/
		                    || LPAD(NVL(NULL, 0), 4, '0')   /*차입금이자율*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*원리금 상환액계 */
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*원금*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*이자*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*공제금액*/
		                    /*거주자간 주택임차차입금 원리금 상환액 - 임대차 계약*/
		                    || RPAD(NVL(NULL, ' '), 20, ' ')  /*임대인 성명*/
		                    || RPAD(NVL(NULL, ' '), 13, ' ')  /*주민등록번호*/
		                    || RPAD(NVL(NULL, ' '), 1, ' ')              /*주택유형구분코드*/
							          || LPAD(NVL(NULL, '0'), 5, '0')              /*주택계약면적*/
		                    || RPAD(NVL(NULL, ' '), 100, ' ') /*임대차계약서상 주소지*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간  시작*/
		                    || LPAD(NVL(NULL, 0), 8, '0')   /*임대차계약기간 종료*/
		                    || LPAD(NVL(NULL, 0), 10, '0')  /*전세보증금*/
		                    ), 433, ' ')
		                    || LPAD(ROW_NUMBER() OVER (PARTITION BY YEA_EMP_NO ORDER BY ROWN), 2, '0')
		                    || RPAD(' ', 284, ' ') AS RECD_DATA   /*공란 [2016귀속]_길이변경 244->274->284*/
		               FROM (
		                    SELECT Z.YEA_REC_SEQ1
		                         , Z.YEA_EMP_NO
		                         , Z.YEA_REC_SEQ2 + TRUNC((ROWNUMBER - 1) / 3 , 0) AS YEA_REC_SEQ2
		                         , Z.YEA_G_SEQ
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 3) = 1 THEN Z.RECD_DATA END) AS RECD_DATA1
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 3) = 2 THEN Z.RECD_DATA END) AS RECD_DATA2
		                         , MAX(CASE WHEN MOD(ROWNUMBER, 3) = 0 THEN Z.RECD_DATA END) AS RECD_DATA3
		                         , TRUNC((ROWNUMBER - 1) / 3, 0) AS ROWN
		                      FROM (
		                            SELECT  3 AS YEA_REC_SEQ1    /*레코드순번*/
		                                   ,A.YEA_EMP_NO
		                                   ,50 AS YEA_REC_SEQ2  /*2012변경*/
		                                   /*자료관리번호 및 원천징수의무자*/
		                                   ,'G'                          /*레코드구분*/
		                                   || SUBSTR(D.YEA_REC_DATA, 2, 21)                         /*자료구분, 세무서, 일련번호, 사업자등록번호*/
		                                   /*소득자*/
		                                   || RPAD(REPLACE(SF_YEA_DECRYPT(#SSEC_KSTR#, C.YEA_EMP_SSN), '-', ''), 13, ' ') AS YEA_G_SEQ       /*소득자주민번호*/
		                                   
		                                   /*월세액 소득공제명세*/
		                                   ,  RPAD(NVL(B.YEA_RT1_STR001, ' '), 20, ' ')             /*임대인 성명*/
		                                   || RPAD(NVL(B.YEA_RT1_STR002, ' '), 13, ' ')             /*임대인주민등록번호*/
		                                   || RPAD(NVL(B.YEA_RT1_STR003, ' '), 1, ' ')              /*주택유형구분코드*/
		                                   || LPAD(NVL(B.YEA_RT1_NUM003, '0') * 100, 5, '0')              /*주택계약면적*/
		                                   || RPAD(NVL(B.YEA_RT1_STR004, ' '), 100, ' ')            /*임대차 계약서상 주소지*/
		                                   || LPAD(NVL(B.YEA_RT1_STR005, '0'), 8, '0')              /*임대차계약기간 시작*/
		                                   || LPAD(NVL(B.YEA_RT1_STR006, '0'), 8, '0')              /*임대차계약기간 종료*/
		                                   || LPAD(B.YEA_RT1_NUM001, 10, '0')                       /*월세액*/
		                                   || LPAD(B.YEA_RT1_NUM002, 10, '0')                       /*공제금액*/
		                                   /*거주자간 주택임차차입금 원리금 상환액 - 금전소비대차 계약*/
		                                   || RPAD(NVL(B.YEA_RT2_STR001, ' '), 20, ' ')  /*대주 성명*/
		                                   || RPAD(NVL(B.YEA_RT2_STR002, ' '), 13, ' ')  /*대주 주민등록번호*/
		                                   || LPAD(NVL(B.YEA_RT2_STR003, '0'), 8, '0')   /*금전소비대차 계약기간 시작*/
		                                   || LPAD(NVL(B.YEA_RT2_STR004, '0'), 8, '0')   /*금전소비대차 계약기간 종료*/
		                                   || LPAD(NVL(B.YEA_RT2_NUM001, '0') * 100, 4, '0')   /*차입금이자율*/
		                                   || LPAD(NVL(B.YEA_RT2_NUM002, '0'), 10, '0')  /*원리금 상환액계 */
		                                   || LPAD(NVL(B.YEA_RT2_NUM003, '0'), 10, '0')  /*원금*/
		                                   || LPAD(NVL(B.YEA_RT2_NUM004, '0'), 10, '0')  /*이자*/
		                                   || LPAD(NVL(B.YEA_RT2_NUM005, '0'), 10, '0')  /*공제금액*/
		                                   /*거주자간 주택임차차입금 원리금 상환액 - 임대차 계약*/
		                                   || RPAD(NVL(B.YEA_RT2_STR005 ,' '), 20, ' ')  /*임대인 성명*/
		                                   || RPAD(NVL(B.YEA_RT2_STR006, ' '), 13, ' ')  /*주민등록번호*/
		                                   || RPAD(NVL(B.YEA_RT2_STR007, ' '), 1, ' ')              /*주택유형구분코드*/
		                                   || LPAD(NVL(B.YEA_RT2_NUM006, '0') * 100, 5, '0')              /*주택계약면적*/
		                                   || RPAD(NVL(B.YEA_RT2_STR008, ' '), 100, ' ') /*임대차계약서상 주소지*/
		                                   || LPAD(NVL(B.YEA_RT2_STR009, '0'), 8, '0')   /*임대차계약기간  시작*/
		                                   || LPAD(NVL(B.YEA_RT2_STR010, '0'), 8, '0')   /*임대차계약기간 종료*/
		                                   || LPAD(Nvl(B.YEA_RT2_NUM007, '0'), 10, '0') AS RECD_DATA  /*전세보증금*/
		                                   ,ROW_NUMBER() OVER (
		                                           PARTITION BY A.YEA_EMP_NO
		                                               ORDER BY B.ROW_NUM
		                                    ) AS ROWNUMBER
		                              FROM YEA_YEPROC A
		                        INNER JOIN (
		                                    SELECT NVL(R1.YEA_STD_YY, R2.YEA_STD_YY) AS YEA_STD_YY
		                                         , NVL(R1.YEA_EMP_NO, R2.YEA_EMP_NO) AS YEA_EMP_NO
		                                         , NVL(R1.ROW_NUM, R2.ROW_NUM) AS ROW_NUM
		                                           /*월세액*/
		                                         , R1.YEA_RT1_NUM001     /*월세액*/
		                                         , R1.YEA_RT1_NUM002     /*공제액*/
		                                         , R1.YEA_RT1_NUM003     /*주택계약면적*/
		                                         , R1.YEA_RT1_STR001     /*임대인성명*/
		                                         , REPLACE(SF_YEA_DECRYPT(#SSEC_KSTR#, R1.YEA_RT1_STR002),'-','') AS YEA_RT1_STR002     /*임대인주민등록번호*/
		                                         
		                                         , R1.YEA_RT1_STR003     /*주택유형구분코드*/
		                                         , R1.YEA_RT1_STR004     /*계약서상주소지*/
		                                         , R1.YEA_RT1_STR005     /*계약시작일*/
		                                         , R1.YEA_RT1_STR006     /*계약종료일*/
		                                           /*거주자차입금*/
		                                         , R2.YEA_RT2_NUM001     /*차입금이자율*/
		                                         , R2.YEA_RT2_NUM002     /*주택차입이자상환액*/
		                                         , R2.YEA_RT2_NUM003     /*원리금상환액*/
		                                         , R2.YEA_RT2_NUM004     /*이자액*/
		                                         , R2.YEA_RT2_NUM005     /*공제액*/
		                                         , R2.YEA_RT2_NUM006     /*주택계약면적*/
		                                         , R2.YEA_RT2_NUM007     /*보증금액*/
		                                         , R2.YEA_RT2_STR001     /*대주성명*/
		                                         , REPLACE(SF_YEA_DECRYPT(#SSEC_KSTR#, R2.YEA_RT2_STR002),'-','') AS YEA_RT2_STR002     /*대주주민등록번호*/
		                                         
		                                         , R2.YEA_RT2_STR003     /*금전소비대차계약시작일*/
		                                         , R2.YEA_RT2_STR004     /*금전소비대차계약종료일*/
		                                         , R2.YEA_RT2_STR005     /*임대인성명*/
		                                         , REPLACE(SF_YEA_DECRYPT(#SSEC_KSTR#, R2.YEA_RT2_STR006),'-','') AS YEA_RT2_STR006     /*임대인주민등록번호*/
		                                         
		                                         , R2.YEA_RT2_STR007     /*주택유형구분코드*/
		                                         , R2.YEA_RT2_STR008     /*계약서상주소지*/
		                                         , R2.YEA_RT2_STR009     /*계약시작일*/
		                                         , R2.YEA_RT2_STR010     /*계약종료일*/
		                                      FROM (
		                                            SELECT S1.*
		                                                 , ROW_NUMBER() OVER (
		                                                          PARTITION BY S1.YEA_STD_YY
		                                                                  , S1.YEA_EMP_NO
		                                                           ORDER BY S1.YEA_RENT_SEQ1
		                                                   ) ROW_NUM
		                                              FROM YEA_RENTA1 S1
		                                           ) R1
		                                 FULL JOIN (
		                                            SELECT S2.*
		                                                 , ROW_NUMBER() OVER (
		                                                          PARTITION BY S2.YEA_STD_YY
		                                                                     , S2.YEA_EMP_NO
		                                                              ORDER BY S2.YEA_RENT_SEQ2
		                                                   ) ROW_NUM
		                                              FROM YEA_RENTA2 S2
		                                           ) R2
		                                        ON R1.YEA_STD_YY = R2.YEA_STD_YY
		                                       AND R1.YEA_EMP_NO = R2.YEA_EMP_NO
		                                       AND R1.ROW_NUM = R2.ROW_NUM
		                                   ) B
		                                ON A.YEA_STD_YY = B.YEA_STD_YY
		                               AND A.YEA_EMP_NO = B.YEA_EMP_NO
		                               AND (NVL(B.YEA_RT1_NUM002, 0) <> 0 OR NVL(B.YEA_RT2_NUM005, 0) <> 0)
		                        INNER JOIN TABLE(SF_YEA_MASTXD(#medSHRYEA_STD_YY# || '1231')) C
		                                ON A.YEA_EMP_NO = C.YEA_EMP_NO
		                         LEFT JOIN YEA_YEFILE D
		                                ON A.YEA_EMP_NO = D.YEA_EMP_NO
		                               AND D.YEA_REC_SEQ1 = '3'
		                               AND D.YEA_REC_SEQ2 = '1'
		                             WHERE A.YEA_STD_YY = #medSHRYEA_STD_YY#
		                               AND A.YEA_PRC_STR005 = #cmbSHRYEA_BRANCH_CD#
		                               AND A.YEA_PRC_STR001 = '1'   /*확정여부*/
		                           ) Z
		                  GROUP BY Z.YEA_REC_SEQ1
		                         , Z.YEA_EMP_NO
		                         , Z.YEA_REC_SEQ2
		                         , Z.YEA_G_SEQ
		                         , TRUNC((ROWNUMBER - 1) / 3 , 0)
		              ) Y;
		
		    END;

    ]]>
    </insert>                
</sqlMap>
